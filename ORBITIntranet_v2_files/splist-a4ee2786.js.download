define("odsp-next/SPList",["require","exports","knockout","./resources/ControlResourceKeys","./resources/DataSourceResourceKeys","./resources/ProviderResourceKeys","./resources/UtilityResourceKeys","./resources/SPOResourceKeys","./utilities/features/Features","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","./controls/spoApp/SPOAppBoot","@ms/odsp-utilities/lib/uri/Uri","./controls/list/layouts/LayoutType","./dataSources/url/splist/UrlDataSource","./dataSources/url/odb/UrlQueryKeys","./dataSources/item/odb/ListItemsDataSource","./models/store/ItemsStore","./models/suiteNav/SuiteNavLinkIds","./resources/ModelResourceKeys","./providers/moveCopy/MoveCopyProvider","./actions/splist/ActionMap","./pages/files/spo/routes/StandaloneListRoute","./dataSources/spotlight/spo/SpotlightDataSource","./GroupsAddOn","./dataSources/item/odb/ShortcutLinkDataSource","./dataSources/url/QueryType","./providers/error/ErrorProvider","./dataSources/error/splist/ErrorDataSource","./dataSources/rating/RatingDataSource","./providers/rating/RatingProvider","./dataSources/publish/odb/PublishDataSource","./providers/publish/PublishProvider","./dataSources/leftNav/splist/LeftNavDataSource","./dataSources/leftNav/splist/LeftNavSettingsBuilder","./dataSources/search/SearchShared.resx","./dataSources/like/LikeDataSource","./providers/like/LikeProvider","./dataSources/language/odb/LanguageDataSource","./dataSources/encoding/odb/EncodingDataSource","./providers/encoding/EncodingProvider","./dataSources/url/PageType","./dataSources/footer/spList/SPListFooterDataSource","@ms/odsp-utilities/lib/logging/ErrorHelper","./dataSources/search/odb/SearchCenterDataSource","./dataSources/item/spo/MoveCopyDataSource","./providers/engagement/Engagement","./dataSources/settings/odb/SettingsDataSource","./dataSources/firstRunExperience/spo/FirstRunExperienceDataSource","./providers/firstRunExperience/FirstRunExperienceProvider","./dataSources/videoItem/odb/VideoItemDataSource","./providers/peopleCard/PeopleCardProvider","./dataSources/list/odb/ListDataSource","./utilities/logging/LoggingContextHelper","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","./dataSources/flow/spo/FlowDataSource","./dataSources/itemCommand/odb/ItemCommandDataSource","./dataSources/microService/odb/MicroServiceDataSource","./models/store/SmartFiltersStore","./dataSources/pushChannel/spo/PushChannelDataSource.key","./providers/pushChannel/PushChannelProvider.key","./providers/customAction/CustomActionProvider","@ms/odsp-utilities/lib/performance/PerformanceCollection","./dataSources/web/odb/WebDataSource.key","./dataSources/policyTip/odb/PolicyTipDataSource","@ms/odsp-datasources/lib/interfaces/ISpPageContext","./controls/siteHeader/SiteHeaderKnockoutHost","./controls/list/CustomList"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k,P,L,R,F,A,M,E,U,B,O,N,V,H,K,q,z,G,j,W,X,Q,Z,J,$,Y,ee,te,ie,re,oe,ne,se,ae,le,ue,de,ce,pe){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var me=function(){function t(){}t.prototype.getScenarioSettings=function(){var e=this,t={scenarioName:"SPList",initializeScenario:function(t){return e._initializeScenario(t)},getPageSettings:function(){return e._getPageSettings()},getPageType:function(){return e._getPageType()},getPageModulePath:function(t){return e._getPageModulePath(t)},asyncLoadingResourceAfterPLT:!0};this._shouldAddGroupsFeatures()&&(new w.default).addGroupsFeatures(t);return t};t.prototype._initializeScenario=function(t){var c=this;le.default.mark("EUPL.SPList._initializeScenario.Start");var p=t.resourceScope,b=t.pageContext,w=t.navigation;this._resourceScope=p;this._navigation=w;this._route=new x.default({id:"List",onViewChanged:function(e){c._updateBackToClassicSettings(e,b)}});p.exposeAsync(o.engagementHandlers,new u.AliasResourceLoader(function(){return d.loadModuleExport({path:"./dataSources/engagement/spo/EngagementHandlers",require:e,getExport:function(e){return e.resourceKey}})}));p.exposeAsync(o.zip,new u.AliasResourceLoader(function(){return d.loadModuleExport({require:e,path:"odsp-next/dataSources/zip/odb/ZipDataSource",getExport:function(e){return e.resourceKey}})}));m.Details=m.CustomList;m.Grid=m.CustomGridList;p.expose(o.url,new(p.injected(f.default)));var M=p.consume(v.resourceKey);p.expose(r.groupThrottle,i.observable(!1));p.exposeFactory(o.shortcut,new u.AliasResourceFactory(C.resourceKey));p.expose(o.microService,new(p.injected(re.default)));p.expose(y.smartFiltersStore,new(p.injected(oe.default)));p.expose(o.items,new(p.injected(g.default))({itemsStore:M,pageContext:b,listId:b.listId||this._navigation.viewParams[h.default.listIdKey],listRootFolderServerRelativeUrl:b.listUrl||this._navigation.viewParams[h.default.listUrlKey]}));p.expose(o.list,new(p.injected($.default))(b));p.expose(o.flow,l.isFeatureEnabled(l.ProcessSimple)?new(p.injected(te.default))(b):null);this._searchCenterDataSource=new(p.injected(z.default))(b);p.expose(o.copy,new(p.injected(G.default))(b));p.expose(_.resourceKey,new(p.resolved(_.default))({}));p.expose(r.actionMap,new S);if(ee.isDocumentLibrary(Number(b.listBaseTemplate))){p.expose(o.spotlight,new(p.injected(I.default))(b));this._firstRunScenarioType=l.isFeatureEnabled(l.ShowFirstRunInLibraries)?1:null}else this._firstRunScenarioType=l.isFeatureEnabled(l.ShowFirstRunInLists)?2:null;p.exposeAsync(n.teachingBubble,new u.AliasResourceLoader(function(){return d.loadModuleExport({path:"./providers/teachingBubble/TeachingBubbleProvider",require:e,getExport:function(e){return e.resourceKey}})}));p.expose(n.error,new(p.injected(D.default)));p.expose(o.error,new(p.injected(k.default)));p.expose(o.rating,new(p.injected(P.default))(b));p.expose(n.ratingProvider,new(p.injected(L.default)));p.expose(o.publish,new(p.injected(R.default))(b));p.expose(n.publish,new(p.injected(F.default)));p.expose(o.like,new(p.injected(U.default))(b));p.expose(n.likeProvider,new(p.injected(B.default)));p.expose(o.language,new(p.injected(O.default)));p.expose(o.encoding,new(p.injected(N.default)));p.expose(n.encoding,new(p.injected(V.default)));p.expose(o.videoItem,new(p.injected(Z.default)));p.exposeAsync(o.sites,new u.AliasResourceLoader(function(){return d.loadModuleExport({path:"./dataSources/sites/odb/SitesDataSource",require:e,getExport:function(e){return e.resourceKey}})}));p.exposeAsync(o.folder,new u.AliasResourceLoader(function(){return d.loadModuleExport({path:"./dataSources/folder/odb/FolderDataSource",require:e,getExport:function(e){return e.resourceKey}})}));p.expose(o.itemCommand,new(p.injected(ie.default)));p.expose(r.isItemSetRendered,i.observable(!1));this._backToClassicUrl=i.observable(null);p.expose(r.backToClassicUrl,this._backToClassicUrl);this._leftNavDataSource=new(p.injected(A.default))({backToClassicUrl:this._backToClassicUrl});this._urlDataSource=p.consume(o.url);this._footerDataSource=new(p.injected(K));p.expose(o.footer,this._footerDataSource);p.expose(o.settings,new(p.injected(W)));p.expose(a.contentTypes,i.observableArray());var E=this._firstRunScenarioType;if(E){p.expose(o.firstRunExperience,new(p.resolved(X.default))({scenario:E}));p.expose(n.firstRunExperience,new(p.injected(Q.default)));p.expose(r.isFirstRunExperienceVisible,i.observable(!1))}if(l.isFeatureEnabled(l.PeopleCardsOnLoki)&&!l.isFeatureEnabled(l.PeopleCardsReactComponent)){p.expose(o.peopleCardFactory,function(){return d.loadModule({require:e,path:"odsp-next/dataSources/peopleCard/loki/PeopleCardDataSource"}).then(function(e){if(p.isExposed(o.peopleCard))return p.consume(o.peopleCard);var t=new(p.injected(e));return p.expose(o.peopleCard,t)})});p.expose(n.peopleCard,new(p.injected(J)))}i.computed(function(){c._urlDataSource.getQueryType(t.viewParams())!==T.Search?p.consume(a.loggingContext).delete(Y.LoggingContextBuckets.Search):p.consume(a.loggingContext).set(Y.LoggingContextBuckets.Search,"isOn",!0)});p.exposeAsync(o.customAction,new u.AliasResourceLoader(function(){return d.loadModuleExport({require:e,path:"odsp-next/dataSources/customAction/spo/CustomActionDataSource",getExport:function(e){return e.resourceKey}})}));p.expose(n.customAction,new(p.resolved(ae.default))({}));p.exposeAsync(o.vroomItemIdentityProcessor,new u.AliasResourceLoader(function(){return d.loadModuleExport({require:e,path:"./dataSources/base/odb/vroom/ItemIdentityProcessor",getExport:function(e){return e.resourceKey}})}));p.exposeAsync(o.batchUploaderType,new u.AliasResourceLoader(function(){return d.loadModuleExport({path:"./dataSources/upload/odb/BatchUploader",require:e,getExport:function(e){return e.typeResourceKey}})}));var H=function(t,i){p.exposeAsync(t,new u.AliasResourceLoader(function(){return d.loadModuleExport({require:e,path:i,getExport:function(e){return e.resourceKey}})}))};if(l.isFeatureEnabled(l.FileHandlersV2)){H(o.fileHandler,"odsp-next/dataSources/fileHandler/vroom/FileHandlerDataSource");H(o.appUrl,"odsp-next/dataSources/appUrl/odb/AppUrlDataSource");H(s.fileHandlerHelper,"odsp-next/actions/fileHandler/FileHandlerHelper")}H(o.graph,"odsp-next/dataSources/graph/odb/GraphDataSource");if(l.isFeatureEnabled(l.EnablePushChannel)){p.exposeFactory(o.pushChannel,new u.AliasResourceFactory(ne.resourceKey));p.consumeAsync(se.resourceKey)}p.exposeFactory(o.web,new u.AliasResourceFactory(ue.resourceKey));p.exposeFactory(o.policyTip,new u.AliasResourceFactory(de.resourceKey));le.default.mark("EUPL.SPList._initializeScenario.End")};t.prototype._getPageSettings=function(){var e={workloadId:b.SITES,showTrimmedSettings:!0,firstRunScenarioType:this._firstRunScenarioType};return{route:this._route,leftNavSettings:M.default.buildLeftNavSettings(this._leftNavDataSource),headerComponent:this._determineHeaderComponent(),searchSettings:{submitAction:l.isFeatureEnabled(l.SpListInPageSearch)?this._handleSearch.bind(this):null,searchText:i.observable(this._navigation.viewParams[h.default.queryParamKey]||""),submitOnClear:!0,submitPlaceholder:i.observable(E.strings.SubmitInPageSearchLink)},commandBarCustomClass:"ms-siteHeader-commandBarCustomization",firstRunScenarioType:this._firstRunScenarioType,suiteNavParams:e,teachingBubbleEnabled:!0}};t.prototype._handleSearch=function(e){var t=this,i=e.searchText.peek();if(i){this._resourceScope.consume(j.resourceKey).logData({name:"InPage.Search.Click"});this._navigation.updateViewParams((o={},o[h.default.queryTypeParamKey]=T.Search,o[h.default.queryParamKey]=i,o));e.hideResultsUntilChange(!0);this._searchCenterDataSource.getSearchCenterResultsUrl(i).done(function(e){t._footerDataSource.setSearchFooterLink(e)},function(e){q.default.log(e)});var r=document.getElementById("alertInPageSearchResults");r&&r.parentElement.removeChild(r);(r=document.createElement("div")).id="alertInPageSearchResults";r.className="ms-accessible";r.innerText=E.strings.SearchResultsInPageAlert;r.setAttribute("role","alert");document.body.appendChild(r)}else{this._footerDataSource.setSearchFooterLink();delete this._navigation.viewParams[h.default.queryTypeParamKey];delete this._navigation.viewParams[h.default.queryParamKey];this._navigation.updateViewParams({})}var o};t.prototype._shouldAddGroupsFeatures=function(){var e=window._spPageContextInfo;return ce.isGroupWebContext(e)};t.prototype._getPageType=function(){return this._urlDataSource.getPageType()};t.prototype._getPageModulePath=function(e){return e===H.OneUp?"odsp-next/pages/oneUp/spo/OneUp":this._urlDataSource.getPageModulePath(this._navigation.viewParams)};t.prototype._determineHeaderComponent=function(){var e=null;l.isFeatureEnabled(l.UseReactSPOHeader)&&(e={name:pe.tagName,params:{}});return e};t.prototype._updateBackToClassicSettings=function(e,t){if(e&&e.serverRelativeUrl){var i=e.serverRelativeUrl;e.isPersonal&&(i+="?PageView=Personal&ShowWebPart={"+e.id.toUpperCase()+"}");this._backToClassicUrl(p.default.concatenate(ce.getServerUrl(t),i))}else this._backToClassicUrl(null)};return t}(),fe=!!window.__onePageContext,he=new me;fe||c.boot(he.getScenarioSettings());t.SPListBoot=function(){c.boot(he.getScenarioSettings())}});define("odsp-next/controls/spoApp/SPOAppBoot",["require","exports","knockout","./SPOApp","../../utilities/features/Features","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider"],function(e,t,i,r,o,n){"use strict";var s=function(){function e(){}e.boot=function(t){n.default.mark("EUPL.SPOAppBoot.Start");var o=t.minSupportedIEVersion?t.minSupportedIEVersion:e._defaultMinSupportedIEVersion;if(e._verifyBrowserSupport(o)){var s={name:r.tagName,params:t},a=document.createElement("div");a.id="spoAppComponent";a.setAttribute("data-bind","component: spoAppComponent");document.body.appendChild(a);i.applyBindings({spoAppComponent:s},a);n.default.mark("EUPL.SPOAppBoot.End")}};e.abortSPOApp=function(){var e=new Date;e.setTime(e.getTime()+31536e6);document.cookie="splnu=0;expires="+e.toUTCString()+";path=/";location.reload()};e._verifyBrowserSupport=function(t){if(!o.isFeatureEnabled(o.SPOAppPrecludeIE9))return!0;var i=!0;try{var r=navigator.userAgent.toLowerCase(),n=r.indexOf("msie");if(-1!==n){var s=n+5,a=r.indexOf(".",n),l=parseInt(r.substring(s,a),10),u=document;if(l<t&&Boolean(u.documentMode)&&u.documentMode<t){e.abortSPOApp();i=!1}}}catch(e){}return i};return e}();s._defaultMinSupportedIEVersion=10;return s});define("@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider",["require","exports","knockout"],function(e,t,i){"use strict";var r=function(){function e(){this._originalProvider=new i.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}e.getInstance=function(){return e._instance};e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var i=this._originalProvider.getBindings(e,t);return i&&this._remapKeys(i,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var i=this._originalProvider.getBindingAccessors(e,t);return i&&this._remapKeys(i,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var r=this._getLocalBindingHandlers(t);if(r){var o=r[e];e=o&&this.getUniqueKeyForBindingHandler(o,e)||e}}return this._bindingHandlers[e]||i.bindingHandlers[e]};e.prototype.getUniqueKeyForBindingHandler=function(t,r){var o=e._BINDING_PROVIDER_UNIQUE_KEY,n=t[o]=t[o]||r+"-local-"+ ++e._lastUniqueKeyOrdinal;this._bindingHandlers[n]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)};this._bindingHandlers[n].after=t.after;t.supportsVirtualElements&&(i.virtualElements.allowedBindings[n]=!0);return n};e.prototype._remapKeys=function(e,t){var i=e,r=this._getLocalBindingHandlers(t);if(r){i={};for(var o in e){var n=r[o];i[n&&this.getUniqueKeyForBindingHandler(n,o)||o]=e[o]}}return i};e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};return e}();r._instance=new r;r._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";r._lastUniqueKeyOrdinal=0;var o=r.getInstance();i.getBindingHandler=o.getBindingHandler.bind(o);i.bindingProvider.instance=o;return r});define("odsp-next/controls/list/layouts/LayoutType",["require","exports"],function(e,t){"use strict";var i=function(){return function(){}}();i.Albums="ms-albums-list";i.AllPhotos="ms-all-photos-list";i.CustomGridList="ms-grid-customlist";i.CustomList="ms-details-customlist";i.Details="ms-details-list";i.Grid="ms-grid-list";i.SingleAlbum="ms-single-album-list";i.TagGrid="od-tag-grid";i.TagsList="od-tags-list";i.DocumentCardsGrid="od-doccard-grid";i.SitesGrid="od-sites-grid-list";i.Path=(r={},r[i.Albums]="AlbumsList",r[i.AllPhotos]="AllPhotosList",r[i.CustomGridList]="CustomGridList",r[i.CustomList]="CustomList",r[i.Details]="DetailsList",r[i.Grid]="GridList",r[i.SingleAlbum]="SingleAlbumList",r[i.TagGrid]="TagGrid",r[i.TagsList]="TagsList",r[i.DocumentCardsGrid]="DocumentCardsGridList",r[i.SitesGrid]="SitesGridList",r);var r;return i});define("odsp-next/dataSources/url/splist/UrlDataSource",["require","exports","tslib","knockout","../odb/UrlDataSource","../PageType","@ms/odsp-utilities/lib/string/StringHelper","../../../models/item/ItemType","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../odb/UrlQueryKeys","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,i,r,o,n,s,a,l,u,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getAppSubfolder=function(e){return e?"odb":"splist"};t.prototype.getPageModulePath=function(e){void 0===e&&(e={});var t=this.getPageType(e),i=n[t],r=t===n.TextFileEditor||t===n.Embed?"odb":"splist";return"odsp-next/pages/"+s.decapitalize(i)+"/"+r+"/"+i};t.prototype.getDefaultClickUrl=function(t,i){void 0===i&&(i={});return t?l.isGenericList(this._listContext().listTemplateType)&&t.type===a.File?this.getDisplayFormUrl(t):e.prototype.getDefaultClickUrl.call(this,t,i):""};t.prototype.getRecycleBinQueryUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/RecycleBin.aspx"};t.prototype.getNewFormUrl=function(){return e.prototype._getListItemFormUrl.call(this,this._listContext().newFormUrl)};t.prototype.getQuickLaunchSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/quiklnch.aspx"};t.prototype.getAreaNavigationSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/AreaNavigationSettings.aspx"};t.prototype.getTopNavSettingsUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/topnav.aspx"};t.prototype.getWACResourcesPreloadUrl=function(){return e.prototype.getWACResourcesPreloadUrl.call(this)};t.prototype.getWopiDocUrl=function(){return e.prototype.getWopiDocUrl.call(this)};t.prototype.getSitePagesUrl=function(){return this.getWebUrl()+"/SitePages/Forms/AllPages.aspx"};t.prototype.getNavLinkClickUrl=function(e){var t=null;if(e.isDocLib){var i=e.url.toLowerCase().indexOf("/forms/");if(-1!==i){var o=e.url.substring(0,i),n=(p={},p[d.default.idParamKey]=o,p[d.default.newTargetListUrlKey]=o,p),s=new c.default(e.url),a=s.getPath();a&&(n[d.default.viewPathKey]=a);var l=u.deserializeQuery(s.getQuery());r.utils.extend(n,l);t="#"+u.serializeQuery(n,null,!0)}}return t;var p};return t}(o.default);t.default=p});define("odsp-next/dataSources/item/odb/ListItemsDataSource",["require","exports","tslib","./ColumnsHelper","./BaseItemDataSource","../ItemDataSource.resx","./ODBDataSource.resx","../../search/SearchShared.resx","@ms/odsp-datasources/lib/interfaces/ISpPageContext","@ms/odsp-datasources/lib/models/view/View","../../url/QueryType","../../url/odb/UrlQueryKeys","../../../models/item/ItemType","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-datasources/lib/Permissions","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/encoding/UriEncoding","../../../utilities/features/Features","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities","../../../providers/engagement/Engagement","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/string/StringHelper","../spo/ListItemBuilder","../spo/ListItemResultProcessor","../spo/SubsiteItemResultProcessor","../ItemTaskObserver","../../../models/task/Task","../../url/odb/ItemUrlHelper","@ms/odsp-datasources/lib/SPListItemRetriever","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/SPListItemProcessorHelpers","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-utilities/lib/logging/events/Verbose.event","../../../utilities/killSwitch/KillSwitch","@ms/odsp-datasources/lib/dataSources/filter/ListFilterDataSource","@ms/odsp-datasources/lib/utilities/caml/CamlParsingBasic","@ms/odsp-datasources/lib/utilities/caml/CamlUtilities","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k,P,L,R,F,A,M,E,U,B,O,N,V,H,K,q,z,G){"use strict";function j(e){return!!e.ListData}Object.defineProperty(t,"__esModule",{value:!0});var W=new XMLSerializer;t.subsiteItemDataSourceAsyncResourceKey=new G.ResourceKey({name:e("module").id+".subsiteItemDataSource",loader:new G.AliasResourceLoader(function(){return y.loadModuleExport({path:"../spo/SubsiteItemDataSource",require:e,getExport:function(e){return e.resourceKey}})})});t.vroomSharedItemDataSourceAsyncResourceKey=new G.ResourceKey({name:e("module").id+".vroomSharedItemDataSource",loader:new G.AliasResourceLoader(function(){return y.loadModuleExport({path:"../vroom/SharedItemDataSource",require:e,getExport:function(e){return e.resourceKey}})})});var X=n.strings,Q=function(o){function n(e){void 0===e&&(e={});var t=this,i=e.itemsStore,r=e.pageContext,n=e.useFolderScopedSearch,s=void 0===n||n;t=o.call(this,i,r)||this;var a=new C.Qos({name:t.getDataSourceName()+".constructor"});try{t._useFolderScopedSearch=s;t._alwaysRenderFilesTitle=e.listShouldRenderFilesTitle;t._navigation=t.resources.consume(T.navigation);t._microServiceDataSource=t.resources.consume(g.microService);e.listContext?t._listContext=e.listContext:t._initListContext(e);t.resources.isExposed(v.listContext)||t.resources.expose(v.listContext,t._listContext);t._itemsPerGroup=t.createObservable(-1);t.resources.isExposed(v.itemsPerGroup)||t.resources.expose(v.itemsPerGroup,t._itemsPerGroup);var l=[t._urlDataSource.getRootItemKey(d.Files),t._urlDataSource.getRootItemKey(d.Recent),t._urlDataSource.getRootItemKey(d.SharedWithMe),t._urlDataSource.getRootItemKey(d.RecycleBin)],u=new(t.resources.consume(R.resourceKey));u.update(l.map(function(e){return new F.default(e).succeed({item:{key:e,type:p.Folder,isRootFolder:!0}})}));u.flush();t._listItemBuilder=t.resources.consume(k.resourceKey);t._listItemResultProcessor=t.resources.consume(P.resourceKey);t._subsiteItemResultProcessor=t.resources.consume(L.resourceKey);t.resources.isExposed(g.identity)&&(t._userIsAnonymous=t.resources.consume(g.identity).getIdentity().type===h.IdentityType.anonymous);a.end({resultType:C.ResultTypeEnum.Success})}catch(e){var c=void 0;c=e.message?e.message+" "+e.stack:"object"==typeof e?JSON.stringify(e):e;a.end({resultType:C.ResultTypeEnum.Failure,error:c})}return t}i.__extends(n,o);n.prototype.updateListContext=function(e){this._initListContext({listFullUrl:e})};n.prototype.getItem=function(e){var t,i=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(i);switch(r){case d.RecycleBin:case d.SecondStageRecycleBin:t=this._getRecycleBinDataSource().then(function(t){return t.getItem(e)});break;case d.Hashtag:case d.Search:case d.Discover:t=this._useFolderScopedSearch&&r===d.Search?this._getItem(e):this._getSearchDataSource().then(function(t){return t.getItem(e)});break;case d.SharedWithMe:t=(this._pageContext.groupId?this._getSharedItemDataSource():this._getVroomSharedItemDataSource()).then(function(t){return t.getItem(e)});break;case d.DocsInCommon:t=this._getSharedItemDataSource().then(function(t){return t.getItem(e)});break;case d.Recent:t=this._getRecentDataSource().then(function(t){return t.getItem(e)});break;case d.RecentActivity:t=this._getRecentActivityDataSource().then(function(t){return t.getItem(e)});break;case d.Popular:case d.RecentUnpopular:t=this._getPopularDataSource().then(function(t){return t.getItem(e)});break;case d.DocumentLibraries:t=this._getSiteDocumentLibrariesDataSource().then(function(t){return t.getItem(e)});break;case d.Subsites:t=this._getSubsiteItemDataSource().then(function(t){return t.getItem(e)});break;default:t=this._getItem(e)}return t};n.prototype.getSpecifiedItems=function(e){var t=this,i={parentKey:e.parentKey||this._urlDataSource.getDefaultRootItemId(),itemKeys:e.itemKeys,recurseInFolders:e.recurseInFolders,getRootFolderFromParentKey:e.getRootFolderFromParentKey,viewId:null,needContentTypes:e.needContentTypes},r={};for(var o in Object.keys(this._listContext))r[o]=this._listContext[o];r.itemIds||(r.itemIds=null);r.recurseInFolders||(r.recurseInFolders=!1);r.folderPath||(r.folderPath=null);this._listContext.itemIds=e.itemKeys;this._listContext.recurseInFolders=e.recurseInFolders;this._listContext.needSchema=!!e.needSchema;this._listContext.needForm=!!e.needForm;this._listContext.isGrouped=!1;this._listContext.group=null;this._listContext.groupBy=null;this._listContext.groupByOverride=null;this._listContext.groupLevel=null;this._listContext.groupSchema=null;this._listContext.isGrouped=!1;this._listContext.lastGroup=null;this._listContext.viewResult=null;this._listContext.viewIdForRequest=null;this._listContext.viewXmlForRequest=null;this._listContext.filterParams="";this._listContext.sortField=null;this._listContext.searchTerm=null;this._listContext.requestToken=null;i.parentKey&&(this._listContext.folderPath=this._getFolderPath(i.parentKey));var n=new C.Qos({name:this.getDataSourceName()+".GetSpecifiedItems"});return this._getItemInternal(i).then(function(e){e.children&&e.children[0]?n.end({resultType:C.ResultTypeEnum.Success}):n.end({resultType:C.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});for(var i=0,o=Object.keys(r);i<o.length;i++){var s=o[i];t._listContext[s]=r[s]}return b.default.wrap(e)},function(e){n.end({resultType:C.ResultTypeEnum.Failure,resultCode:"ServerError",extraData:{error:e}});for(var i,o=0,s=Object.keys(t._listContext);o<s.length;o++){i=s[o];t._listContext[i]=null}for(var a=0,l=Object.keys(r);a<l.length;a++){i=l[a];t._listContext[i]=r[i]}return b.default.wrapError(e)})};n.prototype.getFilterData=function(e,t,i,r){if(this._urlDataSource.isCurrentQuery(d.SharedWithMe))return b.default.wrap();var o=this._urlDataSource.getCurrentItemKey(U.deserializeQuery(t)),n=this._getFolderPath(o);return new K.ListFilterDataSource({parentKey:o,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this.itemUrlHelper,apiUrlHelper:this.apiUrlHelper}).getFilterData(e,t,i,r)};n.prototype.createDocument=function(e,t,i,r){return this._getDeferredDataSource().then(function(o){return o.createDocument(e,t,i,r)})};n.prototype.createCustomDocument=function(e,t,i){return this._getDeferredDataSource().then(function(r){return r.createCustomDocument(e,t,i)})};n.prototype.createFolder=function(e){return this._getDeferredDataSource().then(function(t){return t.createFolder(e)})};n.prototype.deleteItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.deleteItems(e)})};n.prototype.moveItems=function(e){return this._getDeferredDataSource().then(function(t){return t.moveItems(e)})};n.prototype.copyItems=function(e){return this._getDeferredDataSource().then(function(t){return t.copyItems(e)})};n.prototype.getWorkProgress=function(e){return this._getDeferredDataSource().then(function(t){return t.getWorkProgress(e)})};n.prototype.cancelWork=function(e){return this._getDeferredDataSource().then(function(t){return t.cancelWork(e)})};n.prototype.restoreItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.restoreItems(e)})};n.prototype.renameItem=function(e){return this._getDeferredDataSource().then(function(t){return t.renameItem(e)})};n.prototype.removeFromSharedList=function(e){return this._getDeferredDataSource().then(function(t){return t.removeFromSharedList(e)})};n.prototype.getDataSourceName=function(){return"ListItemDataSource"};n.prototype._getPostDataContext=function(e){var t=!!this._listContext.needSchema||!this._listContext.listSchema||this._listContext.isGrouped&&!this._isExpandingGroup(),i=!!e.needContentTypes,r=this._needsQuickLaunch();this._isFirstGroupOnlyQuery=!this._supportsNestedGroups&&0===this._listContext.groupLevel&&this._listContext.groupBy&&this._listContext.groupBy.length>1;var o=!1;if(e.parentKey&&this.resources.isExposed(g.spotlight)&&!this._isSpecifiedItemRequest()){var n=this._listContext.viewIdForRequest;o=this.resources.consume(g.spotlight).shouldFetchSpotlight(e.parentKey,n,this._listContext)}var s=!!this._listContext.viewIdForRequest&&!this._listContext.viewResult,a=this._userIsAnonymous,l=this._fetchNextGroup(),u=e.additionalFiltersXml;if(l){var d=E.getFilterXmlToFetchNextGroup(this._listContext.lastGroup);if(this._listContext.viewXmlForRequest){var c=q.getViewDomParts(this._listContext.viewXmlForRequest);if(c&&c.where){c.where.innerHTML=c.where.innerHTML?z.combineFilters([c.where.innerHTML,d]):d;this._listContext.viewXmlForRequest=W.serializeToString(c.view)}}else u=u?"<And>"+u+d+"</And>":d}return{needsSchema:t,needsContentTypes:i,needsForms:!!this._listContext.needForm,needsQuickLaunch:r,needsSpotlight:o,needsViewMetadata:s,needsParentInfo:a,viewXml:this._getViewXml(),firstGroupOnly:this._isFirstGroupOnlyQuery,expandGroups:this._expandGroup,allowMultipleValueFilterForTaxonomyFields:!!this._pageContext.isSPO||void 0,fieldNames:this._listContext.fieldNames,requestToken:this._listContext.requestToken,isListDataRenderOptionChangeFeatureEnabled:S.isFeatureEnabled(S.ListDataRenderOptionChange),isSpotlightFeatureEnabled:S.isFeatureEnabled(S.Spotlight),groupByOverride:this._listContext.groupByOverride,requestDatesInUtc:Number(this._pageContext.webTemplate)===f.WebTemplateType.mySite&&S.isFeatureEnabled(S.RequestDatesInUtc),needUpdatePageContext:!!this._listContext.needUpdatePageContext,needClientSideComponentManifest:!1,groupReplace:!!this._groupReplace,additionalFiltersXml:u}};n.prototype._processData=function(e,t,o){N.default.mark("EUPL.ListItemDataSource.ProcessData.Start");var n,s=e.parentKey,a=o.ListData||o,l=a.Row,u=this._urlDataSource.getKeyParams(s),p=u[c.default.idParamKey],f=this._listContext.listSchema,h=o.ListContenTypes,g=o.NewExperienceRendering,b=void 0===g||g,y=o.ListSchema;if(!b){throw{code:"-2, newExperieceRenderingNotSupported"}}o.PageContextInfo&&this._updatePageContextInfo(o.PageContextInfo);B.ListItemBuilderHelpers.updateListContext(o,this._listContext);if(y){var _={};(f=this._listContext.listSchema=r.default.getListSchema(y,this.resources,_,this._listContext.listTemplateType===m.ListTemplateType.mySiteDocumentLibrary,this._listContext,e))&&(n=f.filter(function(e){return e.isRequired&&Boolean(e.name)}));y.group1&&(this._listContext.groupSchema=_)}o.Navigation&&(this._listContext.leftNavigationData={quickLaunchNodes:o.Navigation.Nodes});if(o.ViewMetadata){var I=this._listContext.viewResult.serverRelativeUrl,C=this._listContext.viewResult.id,T=this.resources.consume(v.onePageContext.optional),D=T&&T.newTargetListViewUrl,k=T&&T.newTargetListViewId;if(!H.default.isActivated("D7313E3C-6575-4C76-AD10-A6088359FD92","4/02/2017","fall back to normal navigation when list view url mismatch")&&I&&D&&-1===D.toLowerCase().indexOf(I.toLowerCase())&&C&&k!==C)throw{code:"-3, onePageNavigationViewMismatch"};T.newTargetListViewId=T.newTargetListViewUrl=void 0}var P=y&&"TRUE"===y.Collapse,L=!P&&l?l.slice(0):[];p&&p!==this._urlDataSource.getDefaultRootItemId()||(p=this._listContext.listUrl);var F="";a.NextHref&&(F=(F=a.NextHref).replace("&View="+x.default.Empty,""));var A=new(this.resources.consume(R.resourceKey));this._processResponse({response:o,observer:A,requestKey:s});var M=i.__assign({},u);M.folder={childCount:L.length,startIndex:0,children:L};M.nextRequestToken=F;M.PermMask=a.FolderPermissions;M.groups=P?l:null;t===d.Search&&this.resources.consume(w.resourceKey).logData({name:"Search.InpageNumResults",extraData:{count:L.length}});var E=null;if(this._listContext.groupByOverride)E=[this._listContext.groupByOverride];else if(this._listContext.rawListSchema&&this._listContext.rawListSchema.group1){(E=[]).push(this._listContext.rawListSchema.group1);this._listContext.rawListSchema.group2&&E.push(this._listContext.rawListSchema.group2);this._isFirstGroupOnlyQuery||(this._listContext.groupBy=E)}this._listContext.groupLevel=this._getGroupLevel();this._listContext.isGrouped=Boolean(E);var U=this._listItemBuilder.getItemResult({requestKey:s,queryType:t,itemFromServer:M,groupBy:E,itemGroups:null,requiredColumns:n,supportsNestedGroups:this._supportsNestedGroups,observer:A}),O=U.children,V=U.item,K=U.groupings,q=U.totalChildren;this._processListTitleOverride({response:o,listUrl:this._getListUrl(s),requestKey:s,observer:A});A.flush();S.isFeatureEnabled(S.Spotlight)&&this._cacheSpotlightItemsFromServerData({requestKey:s,parentItem:this._itemsStore.getItem(s),queryType:t,spdata:o});var z,G=this._itemsStore.getItem(V.key);if(O){z=[];for(var j=0,W=O;j<W.length;j++){var X=W[j];z.push(this.peekUnwrapObservable(this._itemsStore.getItem(X.key)))}}if(K){var Q=K[0].itemGroups,Z=Q[Q.length-1];Boolean(this._listContext.groupSchema[Z.fieldSchema.Name])&&(this._listContext.lastGroup=Z)}if(this.resources.isExposed(v.contentTypes)){var J=this.resources.consume(v.contentTypes);h?J(h):h=J.peek()}for(var $,Y=0,ee=f;Y<ee.length;Y++){var te=ee[Y];if(te.internalName===this._listContext.sortField){$=te.key;break}}var ie={item:this.peekUnwrapObservable(G),groupings:K,children:z,totalChildren:q,schema:f,contentTypes:h,nextRequestToken:F,sortField:$,isAscending:"true"===this._listContext.isAscending,viewId:this._listContext.viewResult?this._listContext.viewResult.id:void 0};this._listContext.group?ie.startIndex=this._listContext.group.startIndex:a.FirstRow&&(ie.startIndex=a.FirstRow-1);N.default.mark("EUPL.ListItemDataSource.ProcessData.End");return ie};n.prototype._processResponse=function(e){var t,i=e.response,r=e.requestKey,o=e.observer,n=this.itemUrlHelper.getItemUrlParts(r);if(j(i)){t=i;var s=i.ListSchema;s&&this._microServiceDataSource.setBaseInfo({data:s,allowCookies:this._isOneDrive(n.normalizedListUrl)})}else t={ListData:i};this._listItemResultProcessor.processResponse({response:t,requestKey:r,observer:o})};n.prototype._updatePageContextInfo=function(e){try{var t=JSON.parse(e);t.serverRequestPath=void 0;this.updateContext(t)}catch(e){}};n.prototype._getFolderPath=function(e,t){var i=this._urlDataSource.getKeyParams(e)[c.default.idParamKey];return i&&i!==this._urlDataSource.getDefaultRootItemId()?i:null};n.prototype._getListUrl=function(e){var t=this._urlDataSource.getKeyParams(e),i=t&&t[c.default.listUrlKey];i||(i=this._listContext.listUrl);return i};n.prototype._isOneDrive=function(e){return!this.itemUrlHelper.getItemUrlParts(e).isCrossList&&this._listContext.listTemplateType===m.ListTemplateType.mySiteDocumentLibrary};n.prototype._processListTitleOverride=function(e){var t,i=e.response,r=e.requestKey,o=e.observer;t=j(i)?i:{ListData:i};var n,l=this._urlDataSource.getKeyParams(r),u=l[c.default.queryParamKey],p=this.itemUrlHelper.getItemUrlParts(r),f=this.itemUrlHelper.getUrlParts({path:p.serverRelativeListUrl,listUrl:p.fullListUrl}),h=t.ListTemplateType;this._urlDataSource.isCurrentQuery(d.Search,l)&&u?n=D.format(a.strings.SearchResultsTitle,u):f.isCrossList&&(this._pageContext.listUrl||!this._pageContext.groupId)||Number(h)!==m.ListTemplateType.mySiteDocumentLibrary&&!this._alwaysRenderFilesTitle||(n=s.strings.Files);if(n){var g=this._urlDataSource.getKey((v={},v[c.default.idParamKey]=f.serverRelativeItemUrl,v[c.default.listUrlKey]=f.normalizedListUrl,v[c.default.queryTypeParamKey]=l[c.default.queryTypeParamKey],v[c.default.queryParamKey]=l[c.default.queryParamKey],v[c.default.typeFiltersKey]=l[c.default.typeFiltersKey],v));o.update([new F.default(g).succeed({item:{key:g,name:n,displayName:n}})])}var v};n.prototype._setContext=function(e){var t=this,i=this._urlDataSource.getKeyParams(e.parentKey),r=e.newTargetListUrl||i[c.default.listUrlKey]||this._defaultListUrl,o=this._urlDataSource.getItemTypeFilter(i),n=e.baseViewId,s=e.viewXml,a=e.filters,l=void 0===a?{}:a,u=e.sortField,d=e.isAscending,p=e.requestToken,m=e.needSchema,f=e.pageSize,h=void 0===f?30:f,g=e.parentKey,v=e.groupBy,b=e.group,y=e.query,S=e.queryType,x=e.needUpdatePageContext,I=e.resultSetOptions,w=(void 0===I?{}:I).fieldNames,C=void 0===w?[]:w,T=e.supportsNestedGroups,D=e.viewPath;this._supportsNestedGroups=T;this._listContext.filterParams=Object.keys(l||{}).map(function(e){return"&"+e+"="+_.default.encodeURIComponent(l[e])}).join("");this._listContext.itemIds=null;this._listContext.requestToken=p;this._listContext.needSchema=!!m;this._listContext.pageSize=h;this._listContext.folderPath=this._getFolderPath(g,e);this._listContext.groupByOverride=v;this._listContext.groupLevel=this._getGroupLevel();this._listContext.group=b;this._listContext.searchTerm=y;this._listContext.queryType=S;this._listContext.typeFilter=o;this._listContext.fieldNames=C;this._listContext.listUrl=r;var k=this._urlDataSource.getKeyParams(g);!k[c.default.listUrlKey]&&e.newTargetListUrl&&(k[c.default.listUrlKey]=e.newTargetListUrl);var P=this._urlDataSource.getKey(k);this._listContext.urlParts=this.itemUrlHelper.getItemUrlParts(P);this._listContext.needUpdatePageContext=!!x;!this._listContext.refreshClientForm&&this._listContext.needUpdatePageContext&&(this._listContext.refreshClientForm=!0);try{var L=JSON.stringify({defaultFullWebUrl:this._pageContext.webAbsoluteUrl,defaultListUrl:this._pageContext.listUrl,keyParts:i});V.Verbose.logData({name:"ListItemsDataSource._setContext",message:L})}catch(e){}return this._loadRemoteParentWeb({parentKey:g}).then(function(){return t._loadView({fieldNames:C,typeFilter:o,baseViewId:n,viewXml:s,viewPath:D,listFullUrl:t._listContext.urlParts.fullListUrl})}).then(function(){if(u){t._listContext.sortField=u;t._listContext.isAscending=!1===d?"false":"true"}else if(t._isUsingView()){t._listContext.sortField=null;t._listContext.isAscending=null}else if(!t._isTeamSiteLike()){t._listContext.sortField="LinkFilename";t._listContext.isAscending="true"}})};n.prototype._loadRemoteParentWeb=function(e){var t=this,i=e.parentKey;delete this._listContext.remoteParentWeb;var r,o=this.itemUrlHelper.getItemUrlParts(i);o.isCrossList&&o.siteRelation!==A.SiteRelation.sameSite&&(r=this._getRemoteSiteService().then(function(e){return e.getSiteForList(o.fullListUrl)}).then(function(e){t._listContext.remoteParentWeb=e;var r=new(t.resources.consume(R.resourceKey));t._subsiteItemResultProcessor.processSubsite({subsite:e,requestKey:i,observer:r});r.flush()}));return b.default.as(r).then(function(){})};n.prototype._loadView=function(e){var t=this,i=e.fieldNames,r=e.typeFilter,o=e.baseViewId,n=e.viewXml,s=e.viewPath,a=e.listFullUrl;this._setViewIdAndPath(o,s);var l,u=i.filter(function(e){return"name.FileSystemItemId"!==e});(r.filters.length||u.length)&&o&&!n&&(l=this.resources.consume(g.list).getView({id:o},a).then(function(e){n=e.getEffectiveViewXml();t._listContext.viewResult=e}));return b.default.as(l).then(function(){t._listContext.viewXmlForRequest=n})};n.prototype._getViewXml=function(){var e=this._listContext,t=e.fieldNames,i=void 0===t?[]:t,r=e.typeFilter,o=void 0===r?{filters:[]}:r,n=e.viewXmlForRequest,s=e.sortField,a=e.groupByOverride,l=i.filter(function(e){return"name.FileSystemItemId"!==e}),d="";if(this._isSpecifiedItemRequest()||!this._isUsingView())d=E.getViewXml({sortField:s,itemIds:this._listContext.itemIds,isAscending:this._listContext.isAscending,pageSize:this._listContext.pageSize,fetchNextGroup:void 0,lastGroup:this._listContext.lastGroup,recurseInFolders:this._listContext.recurseInFolders,fieldNames:l,typeFilter:o,groupBy:this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,userIsAnonymous:this._userIsAnonymous,requestMetaInfo:S.isFeatureEnabled(S.EnablePowerPointWrsPreview)||S.isFeatureEnabled(S.EnableWordWrsPreview)});else if(n)if(s||a||o.filters.length||l.length){var c=new u.default(n);s&&c.updateSort(null,{overwriteAll:!0});a&&c.updateGroupBy({isCollapsed:!1,group1:{fieldName:a}});o.filters.length&&c.addFilters([E.getTypeFilterViewXml(o)]);l.length&&c.replaceFields(c.getEffectiveFieldNames().concat(l));d=c.getEffectiveViewXml()}else d=this._listContext.viewXmlForRequest;return d};n.prototype._getItem=function(e){var t=this,i=this.itemUrlHelper.getItemUrlParts(e.parentKey),r=this.peekUnwrapObservable(this._itemsStore.getItem(e.parentKey));if(H.default.isActivated("F48345E5-09D5-443E-A900-2D1F155CDF8A","4/17/2017","Dedicated single item request for OneUp")||e.newTargetListUrl||e.requestToken||r&&r.type===p.Folder||i.fullItemUrl===i.fullListUrl)return this._getAsFolder(e);if(r.type===p.File||r.type===p.Media||r.type===p.Unknown||r.type===p.Shortcut||e.ignoreChildren){N.default.mark("EUPL.OneUP.GetSingleItem.Start");return this._getSingleItem(e)}return this._getAsFolder(e).then(function(i){var r=t.peekUnwrapObservable(t._itemsStore.getItem(i.item.key));if(!h.PermissionMask.hasPermission(r.permissions,h.PermissionMask.openItems)&&!i.totalChildren){N.default.mark("EUPL.NoOneUP.GetSingleItem.Start");return t._getSingleItem(e).then(function(e){var r=i&&t.peekUnwrapObservable(t._itemsStore.getItem(i.item.key));return r&&r.type!==p.Folder?e:i})}return i})};n.prototype._getAsFolder=function(e){var t=this;return this._setContext(e).then(function(){return t._getItemInternal(e)})};n.prototype._getSingleItem=function(e){var t=this,i=this.itemUrlHelper.getItemUrlParts(e.parentKey),r=new M.SPListItemRetriever({hostSettings:this._pageContext}),o=this.itemUrlHelper.getUrlParts({path:i.serverRelativeListUrl,listUrl:i.fullListUrl}),n=this._urlDataSource.getKey((g={},g[c.default.idParamKey]=o.serverRelativeItemUrl,g[c.default.listUrlKey]=o.normalizedListUrl,g)),s=i.serverRelativeItemUrl.split("/"),a=s.slice(0,-1).join("/"),l=s[s.length-1],u=E.getViewXml({sortField:void 0,itemIds:void 0,isAscending:void 0,requestMetaInfo:!0,pageSize:1}),m=new C.Qos({name:"GetSingleItem"}),f={viewXml:u,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:S.isFeatureEnabled(S.ListDataRenderOptionChange)},h={urlParts:o,folderPath:a,filterParams:"&"+U.serializeQuery({FilterField1:"FileLeafRef",FilterValue1:l})};return this.tryGetPrefetchedListViewData(function(){return r.getUrl(h,t._convertToSPGetItemContext(e))},function(e){return JSON.parse(e)},"GetData",m,function(){return r.getAdditionalPostData(f)},function(){return r.getItem({parentKey:n,postDataContext:f},h,{qosEvent:m,qosName:"GetData"})}).then(function(i){var r=new(t.resources.consume(R.resourceKey));t._processResponse({response:i,requestKey:n,observer:r});var o=i.ListData.Row,s=!o.length&&t._getError(-2147024894);if(s)r.update([new F.default(e.parentKey).succeed({item:{key:e.parentKey,type:p.Error,error:{type:2,data:s},isPlaceholder:!1}})]);else for(var a=0,l=o;a<l.length;a++){var u=l[a];t._listItemBuilder.getItemResult({requestKey:n,queryType:d.Files,itemFromServer:u,supportsNestedGroups:!1,observer:r})}r.flush();m.end({resultType:C.ResultTypeEnum.Success});return s?b.default.wrapError(s):{item:{key:e.parentKey},children:[],totalChildren:0}},function(e){var i=e.code?e.code.split(","):e.error.code.split(","),r=i.length>1?Number(i[0]):-1;return b.default.wrapError(t._getError(r,void 0,e))});var g};n.prototype._isUsingView=function(){return!(!this._listContext.viewXmlForRequest&&!this._listContext.viewIdForRequest)};n.prototype._isTeamSiteLike=function(){return f.isTeamSiteLike(this._pageContext.webTemplate)};n.prototype._getItemInternal=function(e){var t=this;return o.prototype.getItem.call(this,e).then(function(e){return e},function(e){var i=e.code?e.code.split(","):e.error.code.split(","),r=i.length>1?Number(i[0]):-1;return b.default.wrapError(t._getError(r,void 0,e))})};n.prototype._initListContext=function(e){var t,i=this._listContext.listUrl;e.listRootFolderWebRelativeUrl||e.listRootFolderServerRelativeUrl||!e.listFullUrl?e.listRootFolderWebRelativeUrl?t=l.getSafeWebServerRelativeUrl(this._pageContext)+"/"+e.listRootFolderWebRelativeUrl:e.listRootFolderServerRelativeUrl&&(t=e.listRootFolderServerRelativeUrl):t=decodeURIComponent(e.listFullUrl).split(l.getServerUrl(this._pageContext))[1];this._defaultListUrl=t;if(!i||t!==i){for(var r=0,o=Object.keys(this._listContext);r<o.length;r++){var n=o[r];delete this._listContext[n]}this._listContext.listUrl=t;this._listContext.listId=e.listId}!this._listContext.listTitle&&e.pageContext&&(this._listContext.listTitle=e.pageContext.listTitle);this._listContext.customWidthDictionary||(this._listContext.customWidthDictionary={})};n.prototype._setViewIdAndPath=function(e,t){if(e){e=x.default.normalizeLower(e,!1);this._listContext.viewIdForRequest=e;this._listContext.viewResult&&this._listContext.viewResult.id!==e&&(this._listContext.viewResult=null)}e&&e!==x.default.Empty||!t||(this._listContext.viewPathForRequest=t)};n.prototype._getError=function(e,t,i){var r,o,n;switch(e){case-2147024894:r=X.ItemNotFoundTitle;o=X.ItemNotFoundSubText;break;case-2147024809:r=X.InvalidViewTitle;o=X.InvalidViewSubText;break;case-1:r=X.InvalidListTitle;o=X.InvalidListSubText;break;case-2147024860:r=X.DefaultTitle;var s='<a href="'+O.default.encodeText("https://support.office.com/en-us/article/Manage-lists-and-libraries-with-many-items-b8588dae-9387-48c2-9248-c24122f07c59")+'">'+X.QueryThrottledLinkText+"</a>";n=D.format(X.QueryThrottledSubText,s);this.resources.consume(w.resourceKey).logData({name:"listView.Throttled",extraData:{correlationId:i.correlationId}});break;case-2:case-3:r=null;n=null;break;default:r=X.DefaultTitle;o=X.DefaultSubText}return{errorCode:e,errorDetailedText:o,errorTitle:r,errorDetailedHtml:n,correlationId:i&&i.correlationId}};n.prototype._fetchNextGroup=function(){return this._listContext.isGrouped&&this._listContext.group&&"__next__"===this._listContext.group.groupingId&&!(this._groupReplace&&this._listContext.lastGroup&&this._listContext.lastGroup.count<this._itemsPerGroup.peek())&&!this._isSpecifiedItemRequest()};n.prototype._isSpecifiedItemRequest=function(){return this._listContext.itemIds&&this._listContext.itemIds.length>0};n.prototype._needsQuickLaunch=function(){return!this._listContext.leftNavigationData&&this._isTeamSiteLike()&&S.isFeatureEnabled(S.RenderListDataAsStreamLeftNavOpt)};n.prototype._isExpandingGroup=function(){return this._listContext.group&&"__next__"!==this._listContext.group.groupingId};n.prototype._getGroupLevel=function(){var e=-1,t=this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,i=this._listContext.rawListSchema&&"TRUE"===this._listContext.rawListSchema.Collapse;if(t&&t.length>0){e=0;if(this._supportsNestedGroups){if(this._listContext.filterParams&&!i){var r=!(!(o=Boolean(I.default.getFilterFieldByName(this._listContext.filterParams,t[0])))||!t[1])&&Boolean(I.default.getFilterFieldByName(this._listContext.filterParams,t[1]));(o&&1===t.length||r&&2===t.length)&&(e=-1)}}else if(this._listContext.filterParams){var o=Boolean(I.default.getFilterFieldByName(this._listContext.filterParams,t[0]));o&&(e=(r=Boolean(I.default.getFilterFieldByName(this._listContext.filterParams,t[1])))&&!i?-1:1)}}return e};n.prototype._cacheSpotlightItemsFromServerData=function(e){var t=e.requestKey,i=e.parentItem,r=e.queryType,o=e.spdata;if(this.resources.isExposed(g.spotlight)&&o.SpotlightInfo&&this._listContext.viewIdForRequest&&i&&i.peek()&&i.peek().key){var n=[],s=this.resources.consume(g.spotlight);if(o.SpotlightInfo.Items&&o.SpotlightInfo.Items.Row&&o.SpotlightInfo.Order&&o.SpotlightInfo.Order.length){for(var a=o.SpotlightInfo.Items.Row,l=o.SpotlightInfo.Order,u=new(this.resources.consume(R.resourceKey)),d=[],c=0,p=a;c<p.length;c++){var m=p[c];d.push(this._listItemBuilder.getItemResult({requestKey:t,queryType:r,itemFromServer:m,groupBy:null,itemGroups:null,requiredColumns:[],supportsNestedGroups:this._supportsNestedGroups,observer:u}).item)}u.flush();for(var f={},h=0,v=d;h<v.length;h++){var b=v[h].key;(S=this._itemsStore.getItem(b))&&(f[S.peek().properties.ID]=S)}for(var y=0,_=l;y<_.length;y++){var S=f[_[y]];S&&n.push(S)}}var I=this._listContext.viewIdForRequest===x.default.Empty?this._listContext.viewResult.id:this._listContext.viewIdForRequest;s.cacheSpotlightItems(i,I,n)}};n.prototype._getDeferredDataSource=function(){var t=this,i=y.loadModule({require:e,path:"odsp-next/dataSources/item/odb/ListItemsDataSourceDeferred"}).then(function(e){return new(t.managed(e))});this._getDeferredDataSource=function(){return i};return i};n.prototype._getRecentDataSource=function(){var t=this,i=y.loadModule({require:e,path:"./RecentDataSource"}).then(function(e){return new(t.managed(e))});this._getRecentDataSource=function(){return i};return i};n.prototype._getRecentActivityDataSource=function(){var t=this,i=y.loadModule({require:e,path:"./RecentActivityDataSource"}).then(function(e){return new(t.managed(e))});this._getRecentActivityDataSource=function(){return i};return i};n.prototype._getPopularDataSource=function(){var t=this,i=y.loadModule({require:e,path:"./PopularDataSource"}).then(function(e){return new(t.managed(e))});this._getPopularDataSource=function(){return i};return i};n.prototype._getSearchDataSource=function(){var t=this,i=y.loadModule({require:e,path:"./SearchDataSource"}).then(function(e){return new(t.managed(e))(t._itemsStore,t._pageContext)});this._getSearchDataSource=function(){return i};return i};n.prototype._getSharedItemDataSource=function(){var t=this,i=y.loadModule({require:e,path:"../spo/SharedItemDataSource"}).then(function(e){return new(t.managed(e))});this._getSharedItemDataSource=function(){return i};return i};n.prototype._getVroomSharedItemDataSource=function(){return S.isFeatureEnabled(S.ODBVroomSharedWithMe)?this.resources.consumeAsync(t.vroomSharedItemDataSourceAsyncResourceKey):this._getSharedItemDataSource()};n.prototype._getRecycleBinDataSource=function(){var t=this,i=y.loadModule({require:e,path:"./RecycleBinDataSource"}).then(function(e){return new(t.managed(e))});this._getRecycleBinDataSource=function(){return i};return i};n.prototype._getSiteDocumentLibrariesDataSource=function(){var t=this,i=y.loadModule({require:e,path:"./SiteDocumentLibrariesDataSource"}).then(function(e){return new(t.managed(e))});this._getSiteDocumentLibrariesDataSource=function(){return i};return i};n.prototype._getSubsiteItemDataSource=function(){return this.resources.consumeAsync(t.subsiteItemDataSourceAsyncResourceKey)};n.prototype._getRemoteSiteService=function(){var t=this,i=y.loadModule({require:e,path:"odsp-next/dataSources/base/spo/RemoteSiteService"}).then(function(e){return new(t.managed(e))});this._getRemoteSiteService=function(){return i};return i};return n}(o.default);t.default=Q});define("odsp-next/dataSources/item/odb/ColumnsHelper",["require","exports","tslib","knockout","../../../controls/list/interfaces/ColumnFieldType","../../../resources/ControlResourceKeys","../../../resources/SPOResourceKeys","../../../utilities/killSwitch/KillSwitch","../../base/AriaHelper","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-datasources/lib/SPListItemProcessorHelpers"],function(e,t,i,r,o,n,s,a,l,u,d,c){"use strict";function p(e){var t;switch(e){case"FileSizeDisplay":t="size";break;default:t=e}return t}Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(){}e.getListSchema=function(e,t,i,r,o,l){var p=this,m=t.consume(n.disableCalloutInvoker.optional),f=a.default.isActivated("F1F8D352-D1B2-498A-B37F-6B25F9B51FA7","08/14/2016","Disable AutoHyperlink."),h=t.consume(d.platformDetection).isMobile&&t.consume(n.useMobileList.optional);o||(o=t.consume(s.listContext));var g={disableCalloutInvoker:m,hasFixedSchema:r,serverSupportsAutoHyperLink:f,useCustomColumn:h},v=c.SchemaBuilder.buildSchema(e,o,g,i,l),b=t.consume(s.pageContext),y=Number(b.webTemplate)===u.default.mySite;return v.map(function(e){e.groupable=!y&&e.groupable;return p._convertToODNColumn(e,o)})};e.getCustomColumns=function(e,t,i){var r=this,o=this._convertToSPColumn(e),n=t.map(function(e){return e.map(function(e){return r._convertToSPColumn(e)})}),s=i.map(function(e){return r._convertToSPColumn(e)});return c.SchemaBuilder.getCustomColumns(o,n,s).map(function(e){return r._convertToODNColumn(e)})};e.getMappedColumnType=function(e){return c.SchemaBuilder.getMappedColumnType(e)};e.getNameFieldAriaLabelForItem=function(e){var t=l.getIconFieldAriaLabelForItem(e);t&&(t=", "+t);return e.name+t};e.getIconColumnWidth=function(e){return e.consume(d.platformDetection).isMobile&&e.consume(n.useMobileList.optional)?48:16};e.getIconColumnMinWidth=function(e){return e.consume(d.platformDetection).isMobile&&e.consume(n.useMobileList.optional)?48:16};e.fillColumnDefinitionDefaults=function(e,t,n){void 0===t&&(t={});void 0===n&&(n={});var s=t.isCollapsible,a=void 0===s||s;return e.map(function(e,s){var l=e.isIcon,u=void 0!==l&&l,d=e.sortable,c=void 0===d?!!t.sortable:d,p=e.resizable,m=void 0===p?!!t.resizable:p,f=e.isCollapsable,h=void 0===f?a:f,g=e.fieldType,v=void 0===g?o.Text:g,b=e.name,y=e.key,_=e.width,S=!!n.sortField&&n.sortField===e.internalName,x=!!n.groupBy&&n.groupBy===e.internalName;return i.__assign({},e,{key:y,name:b,width:_,index:s,fieldType:v,isCollapsable:h,isIcon:u,isVisible:!0,isVisibleMobile:!0,isGrouped:x,sortable:c,isSorted:S,isAscending:S&&n.isAscending,filterable:!1,isFocused:r.observable(!1),resizable:m})})};e._convertToODNColumn=function(e,t){var o=this;return i.__assign({},e,{key:p(e.key),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:r.observable(e.isFiltered),isMenuOpen:r.observable(!1),isFocused:r.observable(!1),customWidth:r.observable(0),filterValues:r.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return o._convertToODNColumn(e,t)}):void 0})};e._convertToSPColumn=function(e){var t=this;return i.__assign({},e,{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})};return e}();t.default=m});define("odsp-next/controls/list/interfaces/ColumnFieldType",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice";e[e.ClientSideCustom=34]="ClientSideCustom";e[e.FileActivity=35]="FileActivity"}(i||(i={}));return i});define("odsp-next/dataSources/base/AriaHelper",["require","exports","../../models/item/ItemType","../../models/item/Item.resx","@ms/odsp-utilities/lib/list/SharingTypeHelper","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIconFieldAriaLabelForItem=function(e){var t="",s=e.appMap,a=e.extension;if(e.type===i.Folder)t=o.useSharedFolderAriaLabel(e.sharingType)?r.strings.fileTypeSharedFolder:r.strings.fileTypeFolder;else{if(s){var l=s.toLowerCase();-1!==l.indexOf("ms-word")?t=r.strings.fileTypeDoc:-1!==l.indexOf("ms-excel")?t=r.strings.fileTypeXls:-1!==l.indexOf("ms-powerpoint")?t=r.strings.fileTypePpt:-1!==l.indexOf("onenote")&&(t=r.strings.fileTypeOneNotebook)}else if(e.type===i.Media&&e.photo)t=n.format(r.strings.fileTypeImage,a||"").trim();else if(a){0===a.indexOf(".")&&(a=a.substring(1));t=a+" "+r.strings.fileTypeNoExtension}if(e.tooltipText){t&&(t+=", ");t+=e.tooltipText}}return t}});define("@ms/odsp-utilities/lib/list/SharingTypeHelper",["require","exports","./SharingType"],function(e,t,i){"use strict";t.usePrivateFolderIcon=function(e){return void 0===e||e===i.default.Private||e===i.default.Unknown};t.showSubTextSharingIcon=function(e){return void 0!==e&&e!==i.default.Private&&e!==i.default.Unknown};t.shouldRequestSharedWithData=function(e){return e!==i.default.Private};t.useSharedFolderAriaLabel=function(e){return e===i.default.Shared}});define("@ms/odsp-utilities/lib/list/SharingType",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"}(i||(i={}));Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-datasources/lib/SPListItemProcessorHelpers",["require","exports","./dataSources/item/spListItemProcessor/ListItemBuilderHelpers","./dataSources/item/spListItemProcessor/SPListItemEnums","./dataSources/item/spListItemProcessor/SchemaBuilder","./dataSources/item/spListItemProcessor/GroupBuilder"],function(e,t,i,r,o,n){"use strict";function s(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});s(i);s(r);s(o);s(n)});define("@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/ListItemBuilderHelpers",["require","exports","@ms/odsp-utilities/lib/icons/ItemType","../../listCollection/ListTemplateType","../../../utilities/list/ListFilterUtilities","../../../models/view/View"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.getItemName=function(e,t,r){return r&&!r.isDocLib&&t!==i.default.Folder?e.Title||e["URL.desc"]||e.FileLeafRef:e.FileLeafRef};e.updateListContext=function(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=r.isDocumentLibrary(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&!t.listUrl&&(t.listUrl=e.listUrlDir);e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);var i=e.BasePermissions;i&&(t.permissions={manageLists:i.ManageLists,managePersonalViews:i.ManagePersonalViews,openItems:i.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);if(e.ViewMetadata){var o=e.ViewMetadata;if(e.VisualizationInfo)try{o.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}t.viewResult=new n.default(o)}t.isPlaceholder=!1};e.updateListContextGroupInfo=function(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var i=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){i=0;if(e.filterParams&&!r){var n=Boolean(o.default.getFilterFieldByName(e.filterParams,t[0])),s=!(!n||!t[1])&&Boolean(o.default.getFilterFieldByName(e.filterParams,t[1]));(n&&1===t.length||s&&2===t.length)&&(i=-1)}}e.groupLevel=i;e.groupBy=i>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}}(t.ListItemBuilderHelpers||(t.ListItemBuilderHelpers={}))});define("@ms/odsp-utilities/lib/icons/ItemType",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"}(i=t.ItemType||(t.ItemType={}));Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities",["require","exports","@ms/odsp-utilities/lib/encoding/UriEncoding","../../dataSources/item/spListItemRetriever/ListItemDataHelpers","../../utilities/caml/CamlUtilities"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s="useFiltersInViewXml";!function(e){function t(e,t){t=i.default.encodeURIComponent(t);var r=e.match(new RegExp("FilterField([0-9]+)="+t+"&"));Boolean(r)||(r=e.match(new RegExp("FilterFields([0-9]+)="+t+"&")));return r}function n(e,t){return f(v,e,t)}function a(e,t){return f(b,e,t)}function l(e,t){return f(y,e,t)}function u(e,t){return f(g,e,t)}function d(e,i,r,o,s,d){var p=t(e,i);if(Boolean(p)){var f=parseInt(p[1],10),g=a(e,f),v=l(e,f),b=u(e,f),y=p[0]+g[0];v&&(y+="&"+v[0]);b&&(y+="&"+b[0]);var _=y,S="";if(Boolean(o))_=new RegExp("(\\?|\\&)"+y);else{var x=[],I=!1,w=c(String(g[0].substr(g[0].indexOf("=")+1)),";#",!0);for(var C in w)if(C){if(w[C]===r){I=!0;continue}x.push(w[C])}I||x.push(r);x.length>0&&(S=h(p[1],i,x,s,d))}var T=e.replace(_,S);o&&T===e&&(T=e.replace(y,S));e=m(T,f)}else{var D=0,k=[];do{k=n(e,++D)}while(Boolean(k));if(!Boolean(o)){""!==e&&(e+="&");e+=h(D,i,[r],s,d)}}return e}function c(e,t,i){var r=t.charAt(0),o=r+r,n=new RegExp(o,"g");i&&(e=decodeURIComponent(e));var s=e.split(t);return s=s.map(function(e){return e.replace(n,r)})}function p(e,t){var r=t.charAt(0),o=r+r,n=new RegExp(r,"g");e=e.map(function(e){return e.replace(n,o)});return i.default.encodeURIComponent(e.join(t))}function m(e,t){var i=t+1,r=e.match(new RegExp("FilterField"+String(i)+"=[^&]*")),o=!1;if(!Boolean(r)){r=e.match(new RegExp("FilterFields"+String(i)+"=[^&]*"));o=Boolean(r)}for(var s=t;Boolean(r);s++){var a=o?"FilterFields"+String(s):"FilterField"+String(s),l=o?"FilterFields"+String(i):"FilterField"+String(i);e=e.replace(l,a);a=o?"FilterValues"+String(s):"FilterValue"+String(s);l=o?"FilterValues"+String(i):"FilterValue"+String(i);e=e.replace(l,a);a=o?"FilterTypes"+String(s):"FilterType"+String(s);l=o?"FilterTypes"+String(i):"FilterType"+String(i);e=e.replace(l,a);a=g+String(s);l=g+String(i);r=n(e=e.replace(l,a),++i)}return e}function f(e,t,i){var r=t.match(new RegExp(e+String(i)+"=[^&#]*"));Boolean(r)||(r=t.match(new RegExp(e+"s"+String(i)+"=[^&#]*")));return r}function h(e,t,i,r,o){var n="FilterField",s="&FilterValue",a="&FilterType";if(i.length>1){n="FilterFields";s="&FilterValues";a="&FilterTypes"}var l=n+e+"="+t+s+e+"="+p(i,";#");r&&(l+=a+e+"="+r);o&&(l+="&"+g+e+"=1");return l}var g="FilterLookupId",v="FilterField",b="FilterValue",y="FilterType";e.getFilterFieldByName=t;e.getFilterValueByName=function(e,t){t=i.default.encodeURIComponent(t);var r=e.match(new RegExp("FilterField([0-9]+)="+t+"&FilterValue([0-9]+)=([^&]+)"));Boolean(r)||(r=e.match(new RegExp("FilterFields([0-9]+)="+t+"&FilterValues([0-9]+)=([^&]+)")));return r?decodeURIComponent(r[r.length-1]):void 0};e.getFilterFieldByIndex=n;e.getFilterValueByIndex=a;e.getFilterTypeByIndex=l;e.getFilterUseLookupIdByIndex=u;e.getFilterParams=function(e){var t,i,r,o="",s=0;do{t=n(e,++s);i=a(e,s);r=l(e,s);null!==t&&null!==i&&(o+="&"+t.toString()+"&"+i.toString());null!==r&&(o+="&"+r.toString())}while(null!=t);return o};e.isFiltered=function(e){var t=!1;for(var i in e)if(0===i.indexOf("FilterField")){t=!0;break}return t};e.updateFilterInfo=function(t,i,r,o,s){t=e.addFilterInfo(t,i,"",!0,o,s);if(r&&r.length>0){var a=0,l=[];do{l=n(t,++a)}while(Boolean(l));""!==t&&(t+="&");t+=h(a,i,r,o,s)}return t};e.addMultipleFilterInfo=function(e,t,i,r){var o=e,n={};r&&r.forEach(function(e){n[e.Name]=e});t.forEach(function(e,t){var r=n&&n[e];o=r?d(o,e,i[t],!1,r.FieldType):d(o,e,i[t])});return o};e.addFilterInfo=d;e.parseMultiColumnValue=c;e.isFieldValueInUrl=function(e,i,r,o){var n=t(e,i);if(Boolean(n)){var s=a(e,parseInt(n[1],10)),l=String(s[0].substr(s[0].indexOf("=")+1)),u=decodeURIComponent(l).split(";#");for(var d in u)if(u[d]===r||o&&u[d]===o)return!0}return!1};e.getText=function(e){return Boolean(e.innerText)?e.innerText.toString():Boolean(e.textContent)?e.textContent.toString():e.innerHTML.toString()};e.getFilterList=function(t,i,n,a,l){var u,d,c,p=[],m=0,f="Eq",h=t.indexOf(s+"=1")>=0;do{m++;u=e.getFilterFieldByIndex(t,m);d=e.getFilterValueByIndex(t,m);c=e.getFilterTypeByIndex(t,m);if(null!==u&&null!==d){var g=String(u[0].substr(u[0].indexOf("=")+1)),v=String(d[0].substr(d[0].indexOf("=")+1)),b=decodeURIComponent(g),y=c&&c[0]?String(c[0].substr(c[0].indexOf("=")+1)):i?r.getFieldType(b,i):null,_=e.parseMultiColumnValue(v,";#",!0).map(function(e){return n?e:e||l});h&&y&&"datetime"===y.toLowerCase()&&_&&_.length&&o.isTodayString(_[0])&&(f="Geq");p.push({fieldName:b,values:_,operator:f,type:y,id:a?b:void 0})}}while(u);return p};e.formatBreadcrumbFilterValues=function(e,t,i){return e.map(function(e){return"Boolean"===t?"0"===e?i.booleanFalse:i.booleanTrue:new RegExp("^\\d*\\.0+$").test(e)?parseFloat(e).toString():e}).join(", ")}}(n||(n={}));t.default=n});define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemDataHelpers",["require","exports","./interfaces/IItemUrlHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/logging/events/Verbose.event"],function(e,t,i,r,o){"use strict";function n(e,t){var i=[];if(e){t||i.push("&");i.push("@listUrl='");i.push(r.default.encodeRestUriStringToken(e));i.push("'");t&&i.push("&")}return i.join("")}Object.defineProperty(t,"__esModule",{value:!0});t.getListDataUrl=function(e){var t=e.webUrl,s=e.listId,a=e.view,l=e.searchTerm,u=e.rootFolder,d=e.sortField,c=e.sortDir,p=e.filterParams,m=e.groupString,f=e.requestToken,h=e.viewId,g=e.viewPath,v=e.urlParts,b=[r.default.escapeUrlForCallback(t)];"/"!==t.slice(-1)&&b.push("/");var y;v&&(y=void 0===(S=v.siteRelation)?v.isCrossSite:S);if(y===i.SiteRelation.crossSite&&v.fullListUrl){b.push("_api/SP.List.GetListDataAsStream?listFullUrl='");b.push(r.default.encodeRestUriStringToken(v.fullListUrl));if(f){"?"!==f[0]&&o.Verbose.logData({name:"ListItemDataHelper.InvalidRequestToken",message:f});b.push("'&"+f.substring(1));return b.join("")}b.push("'&View=")}else{var _=v&&v.serverRelativeListUrl;if(_)b.push("_api/web/GetList(@listUrl");else{b.push("_api/web/lists/GetById('");b.push(s);b.push("'")}if(f){b.push(")/RenderListDataAsStream");b.push(f);b.push(n(_));return b.join("")}b.push(")/RenderListDataAsStream?");_&&b.push(n(_,!0));b.push("View=");a&&b.push(a);if(g){b.push("&ViewPath=");b.push(r.default.encodeURIComponent(g))}}h&&b.push("&ViewId="+h);if("string"==typeof l){b.push("&InplaceSearchQuery=");b.push(r.default.encodeURIComponent(l))}if(u){b.push("&RootFolder=");b.push(r.default.encodeURIComponent(u))}if("string"==typeof m){b.push("&IsGroupRender=TRUE");b.push("&DrillDown=1");b.push("&GroupString="+m)}d&&b.push("&SortField="+d);c&&b.push("&SortDir="+c);p&&b.push(p);return b.join("");var S};t.getListRequestHeaders=function(e,t){var i;e.listUrl?i="listUrl="+r.default.encodeURIComponent(e.listUrl):e.listId&&(i="list="+e.listId);return{"X-SP-REQUESTRESOURCES":t?"NAVIGATIONSTRUCTURE,"+i:i}};t.getListEntityTypeName=function(e,t){var i=e;t&&0===e.indexOf(t)&&(i=e.replace(t,""));"/"===i.substring(0,1)&&(i=i.substring(1));0===i.toLowerCase().indexOf("lists/")&&(i=i.substr("lists/".length)+"List");for(var r=[],o=0;o<i.length;o++){var n=i.charAt(o),s=i.charCodeAt(o);s>47&&s<58||s>64&&s<91||s>96&&s<123||(n="_x"+("0000"+s.toString(16)).slice(-4)+"_");r.push(n)}r.length>0&&1===r[0].length&&(r[0]=r[0].toUpperCase());return"SP.Data."+r.join("")+"Item"};t.getEntityPropertyName=function(e,t){var i="_"===e[0]?"OData_"+e:e;if(t)switch(t.toLowerCase()){case"lookup":i+="Id";break;case"user":case"usermulti":i+="StringId"}return i};t.getFieldType=function(e,t,i){void 0===i&&(i="Text");if(!t)return i;for(var r=0,o=t;r<o.length;r++){var n=o[r];if(n.Name===e)return n.FieldType}return i}});define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/interfaces/IItemUrlHelper",["require","exports","../../../../Url"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SiteRelation=i.SiteRelation});define("@ms/odsp-datasources/lib/models/view/View",["require","exports","../../interfaces/view/IViewArrangeInfo","@ms/odsp-utilities/lib/guid/Guid","../../utilities/caml/CamlConstants","../../utilities/caml/CamlParsingBasic","../../utilities/caml/CamlUtilities","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/domUtils/DomUtils"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new XMLSerializer,c=function(){function e(t){if("string"!=typeof t){var i=t;this.id=r.default.normalizeLower(i.Id,!1);this.title=i.Title;this.isDefault=i.DefaultView;this.isHidden=i.Hidden;this.isPersonal=!!i.PersonalView;this.isReadOnly=i.ReadOnlyView;this.modifiedInEditor=i.EditorModified;this.rowLimit=i.RowLimit;this.serverRelativeUrl=i.ServerRelativeUrl;this.baseViewId=i.BaseViewId;this.baseViewXml=i.ListViewXml;if(e.isAppView(i)){this.isHidden=!1;this.viewType=134217728;this.visualizationInfo=i.VisualizationInfo}else if(i.ViewType)switch(i.ViewType.toLowerCase()){case"html":this.viewType=1;break;case"grid":this.viewType=2048;break;case"calendar":this.viewType=524288;break;case"recurrence":this.viewType=8193;break;case"chart":this.viewType=131072;break;case"gantt":this.viewType=67108864}}else this.baseViewXml=t}e.isAppView=function(e){return!!(e&&e.Hidden&&e.VisualizationInfo&&2===e.VisualizationInfo.VisualizationType&&e.VisualizationInfo.VisualizationAppInfo&&e.VisualizationInfo.VisualizationAppInfo.Id)};e.prototype.canUserEdit=function(e){if(!e||this.isReadOnly)return!1;var t=e.managePersonalViews&&this.isPersonal;return e.manageLists||t};Object.defineProperty(e.prototype,"baseViewXml",{get:function(){return this._baseViewXml},set:function(e){this._baseViewXml=e;this.clearXmlOverrides()},enumerable:!0,configurable:!0});e.prototype.getEffectiveViewXml=function(){return this.isDirty()?d.serializeToString(this._viewDom.view):this._baseViewXml};e.prototype.getEffectiveQueryXml=function(e){this._ensureDom();if(this._viewDom)return this._viewDom.query?e?d.serializeToString(this._viewDom.query):(this._viewDom.where?d.serializeToString(this._viewDom.where):"")+(this._viewDom.orderBy?d.serializeToString(this._viewDom.orderBy):"")+(this._viewDom.groupBy?d.serializeToString(this._viewDom.groupBy):""):e?"<Query/>":""};e.prototype.getEffectiveFieldNames=function(){this._ensureDom();return this._viewDom&&this._viewDom.viewFields?n.parseViewFields(this._viewDom.viewFields):void 0};e.prototype.isDirty=function(e){return"number"==typeof e?!!this._modificationTypes&&-1!==this._modificationTypes.indexOf(e):this._isDirty};e.prototype.setIsDirty=function(e,t){this._isDirty=e;e?"number"==typeof t&&-1===this._modificationTypes.indexOf(t)&&this._modificationTypes.push(t):this._modificationTypes=[]};e.prototype.hasParseError=function(){return this._hasParseError};e.prototype.getDomParts=function(){this._ensureDom();return this._viewDom};e.prototype.clearXmlOverrides=function(){this._hasParseError=!1;this._xmlDoc=void 0;this._viewDom=void 0;this.setIsDirty(!1)};e.prototype.prepareForSaving=function(){this._ensureDom();if(this._viewDom&&this._viewDom.where)for(var e=this._viewDom.where.querySelectorAll("[id]"),t=0;t<e.length;t++)e[t].removeAttribute("id")};e.prototype.updateSort=function(e,t){void 0===t&&(t={});this._ensureDom();var r=t.removeSort,n=t.overwriteAll,a=t.prepend,u=!e&&n;if(this._viewDom&&(u||e)&&(!r||this._viewDom.orderBy)){var d=this._viewDom.orderBy;if(u){d&&this._viewDom.query.removeChild(d);this._viewDom.orderBy=void 0;this.setIsDirty(!0,i.ArrangeInfoType.sorts)}else{var c=!1;if(!d&&!u){d=this._viewDom.orderBy=this._xmlDoc.createElement(o.CamlTags.orderBy);this._viewDom.query.appendChild(d);c=!0}var p=d.querySelector(l.format(o.CamlConstants.fieldNameQuery,e.fieldName));if(r){if(p){d.removeChild(p);c=!0;if(!d.childElementCount){this._viewDom.query.removeChild(d);this._viewDom.orderBy=void 0}}}else{c=!0;p&&s.updateBooleanAttr(p,o.CamlAttributes.ascending,e.isAscending);var m=void 0;if(n){for(var f=d.lastChild;f;f=d.lastChild)d.removeChild(f);m=!0}else m=!p;if(m){p=p||s.getFieldRefDom(this._xmlDoc,e);a?d.insertBefore(p,d.firstChild):d.appendChild(p)}}c&&this.setIsDirty(!0,i.ArrangeInfoType.sorts)}}};e.prototype.updateGroupBy=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.query,r=this._viewDom.groupBy;if(e&&e.group1&&e.group1.fieldName){var n=e.isCollapsed,a=e.group1,l=e.group2;if(!r){this._viewDom.groupBy=r=this._xmlDoc.createElement(o.CamlTags.groupBy);t.appendChild(r)}s.updateBooleanAttr(r,o.CamlAttributes.collapse,n);var u,d;r.childElementCount>0&&(d=(u=r.firstElementChild).nextElementSibling);s.replaceField(this._xmlDoc,a,u,r);l&&l.fieldName&&l.fieldName!==a.fieldName?s.replaceField(this._xmlDoc,l,d,r):d&&r.removeChild(d);this.setIsDirty(!0,i.ArrangeInfoType.groupBy)}else if(r){t.removeChild(r);this._viewDom.groupBy=void 0;this.setIsDirty(!0,i.ArrangeInfoType.groupBy)}}};e.prototype.updateField=function(e,t){this._ensureDom();if(this._viewDom&&e){var r=!1,n=this._viewDom.viewFields,a=n.querySelector(l.format(o.CamlConstants.fieldNameQuery,e));if(a){r=!0;n.removeChild(a)}if("number"==typeof t){r=!0;a||(a=s.getFieldRefDom(this._xmlDoc,{fieldName:e}));t>=n.childElementCount?n.appendChild(a):t>=0&&u.default.insertAtIndex(n,a,t,o.CamlTags.fieldRef)}r&&this.setIsDirty(!0,i.ArrangeInfoType.fieldNames)}};e.prototype.replaceFields=function(e){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){for(var t={},r=0;r<e.length;r++)t[e[r]]={index:r};for(var n=this._viewDom.viewFields,a=n.firstElementChild;a;a=a.nextElementSibling)t[p=s.getAttr(a,o.CamlAttributes.name)]&&(t[p].elem=a);var l=this._viewDom.viewFields=this._xmlDoc.createElement(o.CamlTags.viewFields);this._viewDom.view.replaceChild(l,n);for(var u=[],d=0,c=Object.keys(t);d<c.length;d++){var p=c[d],m=t[p];(a=m.elem)||(a=s.getFieldRefDom(this._xmlDoc,{fieldName:p}));u[m.index]=a}for(var f=0,h=u;f<h.length;f++){a=h[f];l.appendChild(a)}this.setIsDirty(!0,i.ArrangeInfoType.fieldNames)}};e.prototype.clearFilters=function(){this._ensureDom();if(this._viewDom.where){this._viewDom.query.removeChild(this._viewDom.where);this._viewDom.where=void 0;this.setIsDirty(!0,i.ArrangeInfoType.filters)}};e.prototype.addFilters=function(e){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){var t=s.combineFilters(e,o.CamlTags.and);if(!t)throw new Error("Invalid filter: must be defined and have values");this.setIsDirty(!0,i.ArrangeInfoType.filters);var r;try{r=s.xmlToDom(t).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}var n=this._viewDom.where;if(!n){n=this._viewDom.where=this._xmlDoc.createElement(o.CamlTags.where);this._viewDom.query.appendChild(n)}if(n.childElementCount){var a=n.firstElementChild,l=this._xmlDoc.createElement(o.CamlTags.and);l.appendChild(a);l.appendChild(r);n.appendChild(l)}else n.appendChild(r)}};e.prototype.updateRowLimit=function(e){this._ensureDom();if(this._viewDom&&e&&"number"==typeof e.rowLimit){this.rowLimit=e.rowLimit;var t=this._viewDom.rowLimit;t||(this._viewDom.rowLimit=t=this._xmlDoc.createElement(o.CamlTags.rowLimit));if(t.firstChild)t.firstChild.nodeValue=String(e.rowLimit);else{var r=this._xmlDoc.createTextNode(String(e.rowLimit));t.appendChild(r)}"boolean"==typeof e.isPerPage&&s.updateBooleanAttr(t,o.CamlAttributes.paged,e.isPerPage);this.setIsDirty(!0,i.ArrangeInfoType.rowLimit)}};e.prototype.updateAll=function(e){var t=e.fieldNames,i=e.groupBy,r=e.sorts,o=e.filters;t&&t.length&&this.replaceFields(t);i&&this.updateGroupBy(i);if(r&&r.length){this.updateSort(r[0],{overwriteAll:!0});for(var n=0,s=r.slice(1);n<s.length;n++){var a=s[n];this.updateSort(a)}}if(o&&o.length&&"string"==typeof o[0]){this.clearFilters();this.addFilters(o)}};e.prototype.compareTo=function(e){if(!e)return 1;if(134217728===this.viewType&&134217728!==e.viewType)return 1;if(134217728!==this.viewType&&134217728===e.viewType)return-1;var t=(this.title||"").toLocaleLowerCase(),i=(e.title||"").toLocaleLowerCase();return t===i?0:t<i?-1:1};e.prototype._ensureDom=function(){if(this._baseViewXml&&!this._viewDom){this._isDirty=!1;this._hasParseError=!1;var e=new a.Qos({name:"View.Parse"});try{this._viewDom=n.getViewDomParts(this._baseViewXml);this._xmlDoc=this._viewDom.xmlDoc;e.end({resultType:a.ResultTypeEnum.Success})}catch(t){this._viewDom=void 0;this._xmlDoc=void 0;this._hasParseError=!0;e.end({resultType:a.ResultTypeEnum.Failure,error:t.message||JSON.stringify(t)})}}};return e}();t.default=c});define("@ms/odsp-datasources/lib/interfaces/view/IViewArrangeInfo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.filters=0]="filters";e[e.sorts=1]="sorts";e[e.groupBy=2]="groupBy";e[e.fieldNames=3]="fieldNames";e[e.rowLimit=4]="rowLimit"}(t.ArrangeInfoType||(t.ArrangeInfoType={}))});define("@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SPListItemEnums",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice"}(t.ColumnFieldType||(t.ColumnFieldType={}));!function(e){e[e.icon=16]="icon";e[e.iconMin=16]="iconMin";e[e.bigIcon=48]="bigIcon";e[e.bigIconMin=48]="bigIconMin";e[e.regularMin=90]="regularMin";e[e.regular=130]="regular";e[e.nameMin=220]="nameMin";e[e.nameODC=440]="nameODC";e[e.nameODB=440]="nameODB";e[e.originalLocation=300]="originalLocation";e[e.custom=900]="custom";e[e.sharedWith=150]="sharedWith";e[e.note=250]="note";e[e.dateModifiedMl=150]="dateModifiedMl";e[e.dotDotDot=32]="dotDotDot";e[e.ratingsMin=110]="ratingsMin"}(t.ColumnWidth||(t.ColumnWidth={}));!function(e){e[e.none=0]="none";e[e.icon=1]="icon";e[e.name=2]="name";e[e.title=3]="title";e[e.calloutInvoker=4]="calloutInvoker";e[e.modified=5]="modified";e[e.url=6]="url"}(t.MappedColumnType||(t.MappedColumnType={}));!function(e){e[e.none=0]="none";e[e.notify=1]="notify";e[e.block=2]="block";e[e.notifyAndBlock=3]="notifyAndBlock"}(t.PolicyTipType||(t.PolicyTipType={}));!function(e){e[e.Auto=0]="Auto";e[e.Pinned=1]="Pinned";e[e.Removed=2]="Removed"}(t.ShowInFiltersPaneStatus||(t.ShowInFiltersPaneStatus={}))});define("@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SchemaBuilder",["require","exports","./SPListItemEnums","../../../utilities/list/ListFilterUtilities","@ms/odsp-utilities/lib/list/HashtagUtilities","../../../utilities/caml/CamlParsingBasic"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(u={},u[i.MappedColumnType.icon]={key:"type",index:0,isVisibleMobile:!0,isCollapsable:!1,type:i.ColumnFieldType.FileIcon},u[i.MappedColumnType.name]={key:"name",index:1,isRowHeader:!0,isVisibleMobile:!0,isCollapsable:!1,minWidth:i.ColumnWidth.nameMin,width:i.ColumnWidth.nameODB,type:i.ColumnFieldType.Name},u[i.MappedColumnType.title]={key:"Title",index:1,isVisibleMobile:!0,isCollapsable:!1,minWidth:i.ColumnWidth.nameMin,width:i.ColumnWidth.nameODB,type:i.ColumnFieldType.Title},u[i.MappedColumnType.calloutInvoker]={key:"_calloutInvoker",index:2,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:i.ColumnFieldType.DotDotDot},u[i.MappedColumnType.modified]={key:"dateModified",index:3,isVisibleMobile:!0,isCollapsable:!1,minWidth:i.ColumnWidth.regularMin,width:i.ColumnWidth.regular,type:i.ColumnFieldType.DateTime,sortDescFirst:!0},u[i.MappedColumnType.url]={key:"URL",index:4,isVisibleMobile:!0,isCollapsable:!1,minWidth:i.ColumnWidth.nameMin,width:i.ColumnWidth.nameODB,type:i.ColumnFieldType.Hyperlink},u),a=4;t.EXCLUDED_FIELDS=["_ip_UnifiedCompliancePolicyUIAction","Edit","FolderChildCount","ItemChildCount","MediaServiceFastMetadata","name.FileSystemItemId","SMTotalFileCount","SMTotalSize"];var l=[i.ColumnFieldType.Text,i.ColumnFieldType.Name,i.ColumnFieldType.Title,i.ColumnFieldType.DateTime,i.ColumnFieldType.Number];!function(e){function u(e){switch(e){case"FSObjType":case"DocIcon":return i.MappedColumnType.icon;case"LinkFilename":case"LinkFilenameNoMenu":case"FileLeafRef":return i.MappedColumnType.name;case"LinkTitle":case"LinkTitleNoMenu":case"Title":return i.MappedColumnType.title;case"_calloutInvoker":return i.MappedColumnType.calloutInvoker;case"Modified":return i.MappedColumnType.modified;case"URLwMenu":case"URLNoMenu":return i.MappedColumnType.url;default:return i.MappedColumnType.none}}function d(e,t,i){for(var r=v(),o=0;o<t.length;o++)for(var n=0,s=t[o];n<s.length;n++){var a=s[n];a.customRowNumber=o;r.customFields.push(a)}for(var l=[e,r],u=0,d=i;u<d.length;u++){var c=d[u];c.isVisible=!1;c.isVisibleMobile=!1;l.push(c)}return l}function c(e,t,o,s,a,u){var d=e.Name,c=t?t.type:f(e),g=!!t&&"type"===t.key,v=l.indexOf(c)>-1,b=o.filterParams||"",y=!!r.default.getFilterFieldByName(b,d);!y&&u&&u.additionalFiltersXml&&(y=!!u.additionalFiltersXml.match(new RegExp('FieldRef Name="'+d+'"')));if(o.viewXmlForRequest)try{var _=n.getViewDomParts(o.viewXmlForRequest);_&&_.where&&1===_.where.querySelectorAll('[id="'+d+'"]').length&&(y=!0)}catch(e){}var S={key:t?t.key:d,name:e.DisplayName,internalName:d,staticName:e.StaticName,fieldType:c,width:i.ColumnWidth.regular,minWidth:i.ColumnWidth.regularMin,isVisible:!0,isVisibleMobile:!t||t.isVisibleMobile,isCollapsable:!t||t.isCollapsable,canAutoResize:v,isIcon:g,resizable:!0,isRowHeader:!!t&&t.isRowHeader,sortable:"FALSE"!==e.Sortable,filterable:!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===d||"_IsRecord"===d),groupable:"FALSE"!==e.Groupable&&"FALSE"!==e.Sortable&&h(d,c),editable:!(e.FromBaseType&&"TRUE"===e.FromBaseType),isGrouped:o.groupByOverride===d||a.group1===d||a.group2===d,isSorted:o.sortField===d,isAscending:o.sortField!==d||"true"===o.isAscending,sortDescFirst:!!t&&!!t.sortDescFirst,isFiltered:y,filterValues:r.default.getFilterValueByName(b,d),isRequired:!!e.Required,isAutoHyperLink:t?s.serverSupportsAutoHyperLink:!!e.AutoHyperLink&&s.serverSupportsAutoHyperLink||c===i.ColumnFieldType.Note&&"FALSE"!==e.RichText,isAppendOnly:e.AppendOnly&&"TRUE"===e.AppendOnly,dispFormUrl:e.DispFormUrl,pinnedToFiltersPane:e.PinnedToFiltersPane&&"TRUE"===e.PinnedToFiltersPane,showInFiltersPane:e.ShowInFiltersPane&&i.ShowInFiltersPaneStatus[e.ShowInFiltersPane],clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,customFormatter:e.CustomFormatter,serverFieldType:e.Type,isCalculated:"Calculated"===e.role,isNote:c===i.ColumnFieldType.Note&&"FALSE"===e.RichText,clientSideColumnAdapter:e.ClientSideColumnAdapter,sspId:e.SspId,termSetId:e.TermSetId,anchorId:e.AnchorId};e.ID&&(S.id=e.ID);if(t){S.minWidth=g?m(s.useCustomColumn):t.minWidth;S.width=g?p(s.useCustomColumn):t.width}c===i.ColumnFieldType.SharedWith?S.width=i.ColumnWidth.sharedWith:c===i.ColumnFieldType.Note?S.width=i.ColumnWidth.note:c===i.ColumnFieldType.AverageRating&&(S.minWidth=i.ColumnWidth.ratingsMin);return S}function p(e){return e?i.ColumnWidth.bigIcon:i.ColumnWidth.icon}function m(e){return e?i.ColumnWidth.bigIcon:i.ColumnWidth.iconMin}function f(e){var t=e.FieldType;"Calculated"===t&&(t=e.ResultType);if(o.isHashtagField(t,e.ID))return i.ColumnFieldType.Hashtag;if("Computed"===t)switch(e.Name){case"FileSizeDisplay":return i.ColumnFieldType.FileSize;case"SharedWith":return i.ColumnFieldType.SharedWith;case"_IsRecord":return i.ColumnFieldType.ComplianceRecordFlag;default:return i.ColumnFieldType.Computed}var r=i.ColumnFieldType[t];if("number"==typeof r)return r;switch(t){case"UserMulti":return i.ColumnFieldType.User;case"URL":return"Hyperlink"===e.Format?i.ColumnFieldType.Hyperlink:i.ColumnFieldType.Image;case"LookupMulti":return i.ColumnFieldType.Lookup;case"MultiChoice":return i.ColumnFieldType.Choice;case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":return i.ColumnFieldType.Taxonomy}return i.ColumnFieldType.Text}function h(e,t){switch(t){case i.ColumnFieldType.Attachments:case i.ColumnFieldType.Hyperlink:case i.ColumnFieldType.Image:case i.ColumnFieldType.Note:case i.ColumnFieldType.FileSize:case i.ColumnFieldType.FileIcon:return!1;default:var r=u(e);return r!==i.MappedColumnType.name&&r!==i.MappedColumnType.title}}function g(e,t){return{key:e,name:t,minWidth:i.ColumnWidth.regularMin,width:i.ColumnWidth.regular,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isAscending:!0,fieldType:i.ColumnFieldType.Text,filterable:!1,groupable:!1,resizable:!1,isGrouped:!1,isFiltered:!1}}function v(){return{key:"custom",name:"",minWidth:i.ColumnWidth.regularMin,width:i.ColumnWidth.custom,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:i.ColumnFieldType.Text,filterable:!1,groupable:!1,customFields:[]}}e.buildSchema=function(e,r,o,n,l){if(e&&e.Field){for(var f=-1,h=0,v=0,b=e.Field;v<b.length;v++){if("TRUE"===(C=b[v]).listItemMenu){f=h;break}h++}!o.disableCalloutInvoker&&f>=0&&e.Field.splice(f+1,0,{DisplayName:o.calloutInvokerDisplayName,Name:"_calloutInvoker",Sortable:"FALSE",Type:"Computed"});for(var y,_,S,x=new Array(o.hasFixedSchema?a:0),I=0,w=e.Field;I<w.length;I++){var C=w[I],T=C.Name;if(-1===t.EXCLUDED_FIELDS.indexOf(T))if("TRUE"===C.GroupField&&n)n[T]=C;else{var D=u(T),k=s[D],P=c(C,k,r,o,e,l);x[o.hasFixedSchema&&k&&!x[k.index]?k.index:x.length]=P;switch(D){case i.MappedColumnType.icon:y=P;break;case i.MappedColumnType.name:_=P;break;case i.MappedColumnType.modified:S=P}}}if((r.groupBy||e.group1||e.group2)&&(!y||y!==x[0])){var L=g("other","");L.minWidth=m(o.useCustomColumn);L.width=p(o.useCustomColumn);L.fieldType=i.ColumnFieldType.Computed;x.unshift(L)}return o.useCustomColumn?d(y,[[_],[S]],[_,S]):x.filter(function(e){return!!e})}};e.getMappedColumnType=u;e.getCustomColumns=d}(t.SchemaBuilder||(t.SchemaBuilder={}));var u});define("@ms/odsp-utilities/lib/list/HashtagUtilities",["require","exports","../features/Features"],function(e,t,i){"use strict";function r(){return i.default.isFeatureEnabled(n)&&i.default.isFeatureEnabled(s)}function o(e,i){return r()&&e&&"lookupmulti"===e.toLowerCase()&&i&&i.toLowerCase()===t.HASHTAG_FIELD_ID.toLowerCase()}t.HASHTAG_DISPLAY_PREFIX="#";t.HASHTAG_DELIMITER=";";t.MVL_DELIMITER=";#";t.HASHTAG_FIELD_ID="968052CC-891E-4197-ABBB-19C3EDFF3CD2";var n={ODB:581,ODC:null,Fallback:!1},s={ODB:824,ODC:null,Fallback:!1};t.isHashtagEnabled=r;t.isClientFormHashtagField=function(e){return e&&e.schema&&o(e.schema.FieldType,e.schema.Id)};t.isHashtagField=o});define("@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/GroupBuilder",["require","exports","@ms/odsp-utilities/lib/string/DriveSpaceHelper"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){function t(e,t,i,a,l,u,d){var c=e.groupSchema[i],p=0===a?i+".COUNT.group":i+".COUNT.group2",m=c?c.Type:void 0,f=o(t,i,m),h=r(t,i),g=n(t,i,m),v=s(t,i,f,m),b={groupingType:"SPListGroup",groupingId:(d?d.groupingId+"-":"")+(f||"(null)"),name:g,groupString:h,fieldSchema:c,fieldValue:v,count:Number(t[p]),isCollapsed:l,startIndex:u,isDropEnabled:c&&"TRUE"!==c.ReadOnly&&void 0!==v,parentKey:d?d.groupingId:void 0,level:d?d.level+1:0};if(d){d.children||(d.children=[]);d.children.push(b)}return b}function r(e,t){return e[t+".urlencoded"]}function o(e,t,i){var r=void 0;if(e.hasOwnProperty(t+".urlencoded")){var o=(r=decodeURIComponent(e[t+".urlencoded"])).split(";#");o.length>=2&&(r=o[o.length-2]);"DateTime"===i&&(r=r.split(" ")[0])}else"FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size")&&(r=e.File_x0020_Size);return r}function n(e,t,r){var n=void 0;if("string"!=typeof e[t+".groupdisp"]||"DateTime"===r&&!Boolean(e[t+".groupdisp"])){if("FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size"))n=i.default.getDisplayString(Number(e.File_x0020_Size),{ignoreZero:!0});else if(e.hasOwnProperty(t))switch(r){case"User":var s=e[t];s&&s.length>0&&(n=s[0].title);break;case"Lookup":var a=e[t];a&&(a.Label&&a.TermID?n=a.Label:a.length>0&&(n=a[0].lookupValue));break;case"Boolean":case"ModStat":case"Number":case"Currency":case"Text":case"DateTime":n=e[t]}}else n=e[t+".groupdisp"];"string"!=typeof n&&(n=o(e,t,r));return n}function s(e,t,i,r){var o=void 0;switch(r){case"Lookup":var n=e[t];n&&(n.Label&&n.TermID?o=n.Label+"|"+n.TermID:n.length>0&&(o=String(n[0].lookupId)));break;case"Boolean":o=e[t+".value"];break;case"User":var s=e[t];if(s&&s.length>0){var a=s[0].email;o=JSON.stringify([{Key:a,IsResolved:!1}])}break;default:o=i}return o}e.buildCollapsedGroups=function(e,i,r){for(var o=[],n=0,s=void 0,a=void 0,l=(r=r||i.groupBy)[0],u=r[1],d=0,c=e;d<c.length;d++){var p=c[d];if(l&&"1"===p[l+".newgroup"]){var m=t(i,p,l,0,!0,n);o.push(m);n+=m.count;s=m;a=void 0}u&&"1"===p[u+".newgroup"]&&(a=t(i,p,u,1,!0,a?a.startIndex+a.count:s?s.startIndex:0,s))}return{groups:o,totalCount:n}};e.buildGroupFromItem=function(e,i,r,o){if((o=o||r.groupBy)&&o.length>0){var n=i&&i.length>0?i[i.length-1]:void 0,s=o[0],a=o[1];if(s&&"1"===e[s+".newgroup"]){var l=t(r,e,s,0,!1,d=n?n.startIndex+n.count:0);i||(i=[]);i.push(l);n=l}if(a&&"1"===e[a+".newgroup"]){var u=n&&n.children&&n.children.length>0?n.children[n.children.length-1]:void 0,d=u?u.startIndex+u.count:n?n.startIndex:0;t(r,e,a,1,!1,d,n)}}};e.buildGroup=t}(t.GroupBuilder||(t.GroupBuilder={}))});define("@ms/odsp-utilities/lib/string/DriveSpaceHelper",["require","exports","./StringHelper","./StringUtilities.resx"],function(e,t,i,r){"use strict";var o=function(){function e(){}e.getDisplayString=function(e,t){void 0===t&&(t={});if("number"!=typeof e||t.ignoreZero&&0===e||e<0)return"";if(1===e)return i.format(r.strings.fileSizeBytesSingular);var o=this._getInfo(e),n=this._trimNumber(o.value,t.trimDecimal);return i.format(o.template,n)};e._getInfo=function(e){return e<1024?{template:r.strings.fileSizeBytesPlural,value:e}:e<1024e3?{template:r.strings.fileSizeKB,value:e/1024}:e<1048576e3?{template:r.strings.fileSizeMB,value:e/1048576}:e<0xfa00000000?{template:r.strings.fileSizeGB,value:e/1073741824}:{template:r.strings.fileSizeTB,value:e/1099511627776}};e._trimZeroes=function(e,t){for(var i=e.toFixed(t),r=0;r<t&&"0"===i[i.length-1];r++)i=i.substring(0,i.length-1);"."===i[i.length-1]&&(i=i.substring(0,i.length-1));return i};e._trimNumber=function(e,t){var i;i=e===Math.floor(e)?e.toFixed(0):e>=100?e.toFixed(0):e>=10?t?this._trimZeroes(e,1):e.toFixed(1):t?this._trimZeroes(e,2):e.toFixed(2);var r=1.2.toLocaleString().replace(/\d+/g,"");return i.replace(".",r)};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("odsp-next/dataSources/item/odb/BaseItemDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/odb/DataSource","../../../models/store/ItemsStore","../../../resources/DataSourceResourceKeys","../../url/QueryType","@ms/odsp-utilities/lib/logging/events/Api.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","./ListViewDataPrefetchHelper","@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData","@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger","@ms/odsp-utilities/lib/performance/PerformanceCollection","../../../resources/SPOResourceKeys","../../url/odb/ApiUrlHelper","../../url/odb/ItemUrlHelper","../../../models/item/ItemParentHelper","@ms/odsp-datasources/lib/SPListItemRetriever","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../utilities/features/Features","@ms/odsp-utilities/lib/uri/Uri","../../../providers/engagement/Engagement","../../../resources/UtilityResourceKeys","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/guid/Guid"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=function(t){function o(e,i){var r=t.call(this,i)||this;r._customizerLoaded=!1;r._urlDataSource=r.resources.consume(s.url);r._itemsStore=e||r.resources.consume(n.resourceKey);r._listContext={};r._capabilities={};r._expandGroup=!1;r._groupReplace=!1;r.apiUrlHelper=r.resources.consume(g.resourceKey);r.itemUrlHelper=r.resources.consume(v.resourceKey);r.itemParentHelper=r.resources.consume(b.resourceKey);r._engagement=r.resources.consume(I.resourceKey);return r}i.__extends(o,t);o.prototype.isRequestingListViewData=function(e){return Boolean(e.match(new RegExp("web/.*/RenderListDataAsStream")))};o.prototype.getCapabilities=function(){return this._capabilities};o.prototype.getItem=function(e){var t=this;this._expandGroup=e.expandGroup;this._groupReplace=e.groupReplace;var i=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(i),o=new u.Qos({name:"GetPrefetchedListViewData"}),n=new y.SPListItemRetriever({hostSettings:this._pageContext}),s={qosEvent:o,qosName:r===a.Search?"SearchGetData":"GetData"},l=r===a.Files||r===a.Search,d=l?function(){var i=t._convertToSPGetItemContext(e);i.postDataContext=t._getPostDataContext(e);return n.getItem(i,t._listContext,s).then(function(i){return t._handleDataProcessing(i,r,e)})}:function(){return t.getData(function(){return t._getServerConnectionUrl(e.parentKey,e.getRootFolderFromParentKey)},function(i){var n=t._parseResponseText(i,o,!1);return t._processData(e,r,n)},r===a.Search?"SearchGetData":"GetData",function(){return t._getAdditionalPostData(e.parentKey)},"POST",t._getAdditionalHeaders())};return l?this.tryGetPrefetchedListViewData(function(){return n.getUrl(t._listContext,t._convertToSPGetItemContext(e))},function(i){var n=t._parseResponseText(i,o,!0);return t._handleDataProcessing(n,r,e)},"GetItemFromPrefetchedData",o,function(){return n.getAdditionalPostData(t._getPostDataContext(e))},d):d()};o.prototype.tryGetPrefetchedListViewData=function(e,t,i,o,n,s){var a=this;f.default.mark("EUPL.GetPrefetch.Start");var u=e();if(!this.isRequestingListViewData(u))return s();var g=n(),v=c.createHashCode(u,g);window.ListDataActualHash=v;var b=c.prefetchData(v),y=function(){var e=c.createHashCode("ListContenTypes","ListContenTypes"),t=c.prefetchData(e);t&&t.listData?a.resources.isExposed(h.contentTypes)&&a.resources.consume(h.contentTypes)(t.listData):b&&(b.contentTypesCallback=y)};if(!b){if(c.shouldLogError){var S=-1===u.indexOf("?")?null:_.deserializeQuery(u.substring(u.indexOf("?")+1));o.end({resultType:d.ResultTypeEnum.Failure,resultCode:"PrefetchNotStartedOrUrlOrPayLoadNotMatch",extraData:{AdditionalPostData:null==g?"null":g,QueryStrings:S?Object.getOwnPropertyNames(S):"null"}});c.shouldLogError=!1}return s()}c.shouldLogError=!1;y();var x=function(e,i){var r=function(r){try{var o=t(r);e(o);a.done()}catch(e){i()}},n=function(){s().then(e,i)},l=function(e,t){if(200===e||t){o.end({resultType:d.ResultTypeEnum.Success});var i=m.default.getRUMOneLogger();if(e&&!t){f.default.summary.dataFetchServerTime=b.serverDuration;if(window.performance&&performance.timing){f.default.summary.prefetchStart=b.startTimeMark-f.default.getResponseEnd();window.g_prefetchStart=f.default.summary.prefetchStart}var s=b.correlationId;if(Boolean(i)){var a=new p.default(u,b.serverDuration,s,e,null,(new Date).toISOString());i.writeAPICallPerformanceData(a)}f.default.mark("EUPL.Prefetch.End")}else if(t){if(window.g_deferDataLoadTime&&window.performance&&performance.timing){f.default.summary.deferredListDataRender=Number(window.g_deferDataLoadTime)-f.default.getResponseEnd();window.g_deferredListDataRender=f.default.summary.deferredListDataRender}f.default.mark("EUPL.DeferredListData.End")}r(b.listData)}else if(403===e){o.end({resultType:d.ResultTypeEnum.ExpectedFailure,resultCode:"PrefetchUnauthorized",extraData:{AdditionalPostData:null==g?"null":g,ResponseStatusCode:e}});n()}else{o.end({resultType:d.ResultTypeEnum.Failure,resultCode:"PrefetchFailed",extraData:{AdditionalPostData:null==g?"null":g,ResponseStatusCode:e}});n()}c.clearPrefetchData(v)};b.responseCode||b.deferredListData?l(b.responseCode,b.deferredListData):b.completedCallback=l};return l.Api.instrumentPromise({url:u,name:this.getDataSourceName()+"."+i},function(){return new r.default(x,null)},null,function(e){return e&&"Canceled"===e.name?{error:e,resultCode:"Canceled",resultType:d.ResultTypeEnum.ExpectedFailure}:{error:e,resultType:d.ResultTypeEnum.Failure}})};o.prototype.getSpecifiedItems=function(e){return null};o.prototype.getItemContents=function(e){return this.dataRequestor.getData({url:this._getBinaryStreamApiUrl(this.itemUrlHelper.getItemUrlParts(e.key)).toString(),method:"GET",qosName:"ItemDataSource.getItemContents",responseType:"blob"})};o.prototype.getColumns=function(e,t){void 0===t&&(t={});return null};o.prototype.reportAbuse=function(e){return null};o.prototype.getFilterData=function(e,t,i){return null};o.prototype.createDocument=function(e,t,i,r){return null};o.prototype.createCustomDocument=function(e,t,i){return null};o.prototype.createShortcut=function(e,t,i){return null};o.prototype.createFolder=function(e){return null};o.prototype.deleteItems=function(e){return null};o.prototype.renameItem=function(e){return null};o.prototype.restoreItems=function(e){return null};o.prototype.copyItemsAsync=function(e){return null};o.prototype.restoreAll=function(e){return null};o.prototype.copyItems=function(e){return null};o.prototype.moveItems=function(e){return null};o.prototype.removeFromRecent=function(e){return r.default.wrap(!1)};o.prototype.requestReview=function(e){return null};o.prototype.removeMountPoint=function(e){return r.default.wrap(!1)};o.prototype.createMountPoint=function(e){return null};o.prototype.saveSortOrder=function(e){return null};o.prototype.getWorkProgress=function(e){return null};o.prototype.cancelWork=function(e){return null};o.prototype.getOpenInClientDetails=function(e){return null};o.prototype.removeCoverPhotos=function(e){return null};o.prototype.addCoverPhotos=function(e){return null};o.prototype.changeFolderType=function(e){return null};o.prototype.updateItemProperty=function(e){return null};o.prototype.removeFromSharedList=function(e){return null};o.prototype.getItemOcrTextContent=function(e){return r.default.wrap("")};o.prototype.updateItemOcrInfo=function(e,t,i){return null};o.prototype.processReferral=function(e,t){return null};o.prototype.updateBundle=function(e){return null};o.prototype.rotateItems=function(e){return r.default.wrap()};o.prototype.getDownloadUrl=function(e,t){var i=this;void 0===t&&(t={});var o=t.downloadType,n=void 0===o?0:o,s=this.itemUrlHelper.getItemUrlParts(e.key);if(1===n)return r.default.wrap(s.fullItemUrl);if(3===n){var a=void 0;a=e.video?24:1;var l=this.apiUrlHelper.build().webByItemUrl(s);l=(l=S.isFeatureEnabled(S.SupportPoundPercent)?l.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:s.serverRelativeItemUrl}):l.method("GetFileByServerRelativeUrl",s.serverRelativeItemUrl)).method("GetPreAuthorizedAccessUrl",a);return this.dataRequestor.getData({url:l.toString(),method:"GET",qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}if(2===n)return r.default.wrap(this._getBinaryStreamApiUrl(s).toString());var u=void 0,d=this.peekUnwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"subsite"));if(d||s.siteRelation===v.SiteRelation.sameSite){var c=void 0;c=d?this.itemUrlHelper.getItemUrlParts(d.key).fullItemUrl:this._pageContext.webAbsoluteUrl;u=r.default.wrap(c)}else u=this.dataRequestor.getData({url:this.apiUrlHelper.contextInfoUrl(s.fullItemUrl),method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl});return u.then(function(e){return e+"/"+i._pageContext.layoutsUrl+"/download.aspx?"+_.serializeQuery({SourceUrl:s.serverRelativeItemUrl})})};o.prototype.updateViewCount=function(e){return r.default.wrap(null)};o.prototype.redeemPermissionToken=function(e){return r.default.wrap(null)};o.prototype.getDataSourceName=function(){return"ItemDataSource"};o.prototype.needsRequestDigest=function(e){return!this.isRequestingListViewData(e)};o.prototype._getAdditionalPostData=function(e){return null};o.prototype._getAdditionalHeaders=function(){return null};o.prototype._getServerConnectionUrl=function(e,t){return null};o.prototype._processData=function(e,t,i){return null};o.prototype._getPostDataContext=function(e){return{}};o.prototype._convertToSPGetItemContext=function(e){return i.__assign({},e)};o.prototype._handleDataProcessing=function(e,t,i){var o=this,n=this.loadClientSideCustomizer(e,i.parentKey),s=this._getCustomFormatterModule(e),a=i.parentKey;if(!s&&!n)return this._processData(i,t,e);var l;if(!s||!n){if(s){l="CustomFormatter";return s.then(function(r){window.CustomFormatter=r.CustomFormatter;return o._onCustomLoadersEnd(i,e,t,a,l)},function(r){return o._onCustomLoadersEnd(i,e,t,a,l)})}l="ClientSideCustomizer";return n.then(function(e){return o._onCustomLoadersEnd(i,e,t,a,l)},function(r){return o._onCustomLoadersEnd(i,e,t,a,l)})}l="MultipleCustomizers";r.default.all([n,s]).then(function(e){var r=e[0],n=e[1],s=r;window.CustomFormatter=n.CustomFormatter;return o._onCustomLoadersEnd(i,s,t,a,l)},function(r){return o._onCustomLoadersEnd(i,e,t,a,l)});this._engagement.logData({name:"List."+l});l="EUPL."+l+".LoadModule.";f.default.mark(l+"Start")};o.prototype._onCustomLoadersEnd=function(e,t,i,r,o){f.default.mark(o+"End");return this._processData(e,i,t)};o.prototype._getCustomFormatterModule=function(t){if(!!S.isFeatureEnabled(S.CustomFormatter)&&t&&t.ListSchema&&t.ListSchema.Field)for(var i=t.ListSchema.Field,r=0;r<i.length;r++)if(i[r].CustomFormatter)return C.loadModule({require:e,path:"@ms/odsp-shared-react/lib/components/CustomFormatter/CustomFormatter"});return null};o.prototype._parseResponseText=function(e,t,i){try{if(void 0!==e&&null!==e)return JSON.parse(e)}catch(r){if("{}"!==e.substring(0,2)){t.end({resultType:d.ResultTypeEnum.Failure,resultCode:"BadJSON",extraData:{responseText:e,prefetch:i?"true":"false"}});throw r}return JSON.parse(e.substring(2))}};o.prototype.loadClientSideCustomizer=function(e,t){var i=this;if((S.isFeatureEnabled(S.FieldCustomizerInListNext)||this._pageContext.isTenantDevSite)&&("1"===this._pageContext.webTemplate||"64"===this._pageContext.webTemplate)){var o=this._engagement,n=e.ListSchema?e.ListSchema.Field:this._listContext.listSchema;if(!n||n.length<1){o.logData({name:"LoadSpfx.ListFieldsNotAvailable"});return}n[0].RealFieldName||(n=n.map(function(e,t,i){var r=e;if(!e.RealFieldName)return{RealFieldName:r.internalName,ID:r.id,DisplayName:r.name,ClientSideComponentId:r.clientSideComponentId,ClientSideComponentProperties:r.clientSideComponentProperties}}));if(this.prepareClientSideCustomizedFields(e,n)){var s=new u.Qos({name:"LoadFieldCustomizers"});f.default.mark("EUPL.LoadFieldCustomizers.Start");var a=this.resources.consume(w.clientSideExtensionHelper);if(!a){console.log("Error on consuming ClientSideExtensionHelper");s.end({resultType:d.ResultTypeEnum.Failure,resultCode:"ConsumeClientSideExtensionHelperFailed"});f.default.mark("EUPL.LoadFieldCustomizers.NoClientSideExtensionHelper.End");return r.default.wrap(e)}if(!window.moduleLoaderPromise){o.logData({name:"LoadSpfx.moduleLoaderPromiseNotFound",extraData:{SpModuleLoaderExists:!!window.spModuleLoader}});console.log("sp-client module loader promise does not exist")}return a.getListViewAdapter().then(function(t){try{if(!t){console.log("sp-client listViewHostApp failed to create listViewAdapter");s.end({resultType:d.ResultTypeEnum.Failure,resultCode:"FailToCreateListViewAdapter"});f.default.mark("EUPL.LoadFieldCustomizers.Error.FailListViewAdapter.End");return e}n.forEach(function(e,i,r){try{var o={id:e.ID,internalName:e.Name,fieldType:e.FieldType,isRequired:!!e.Required&&"TRUE"===e.Required.toUpperCase(),isVisible:!0,displayName:e.DisplayName,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,onSetVisible:function(e){console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(t){console.log("Fail to load customizer for column: "+e.Name+", componentId: "+e.ClientSideComponentId+", error: "+t.message)}},n=t.addColumnAdapter(o);if(!n)throw"addColumnAdapter returns null";if(Boolean(o.clientSideComponentId)&&o.clientSideComponentId!==T.default.Empty){e.ClientSideColumnAdapter=n;console.log("Add Spfx column adapter for "+e.RealFieldName)}}catch(t){console.log("Error on addColumnAdapter for column: "+e.Name+", error: "+t)}});return t.loadFieldCustomizers().then(function(t){console.log("fieldCustomizers loaded");i._customizerLoaded=!0;s.end({resultType:d.ResultTypeEnum.Success});f.default.mark("EUPL.LoadFieldCustomizers.End");return e},function(t){console.log("fieldCustomizers failed to load, error:"+t);s.end({resultType:d.ResultTypeEnum.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersPromiseError",error:t});f.default.mark("EUPL.LoadFieldCustomizers.End");return e})}catch(t){s.end({resultType:d.ResultTypeEnum.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersCatch",error:t});f.default.mark("EUPL.LoadFieldCustomizers.Error.End");return e}})}}return null};o.prototype.prepareClientSideCustomizedFields=function(e,t){var i,r=new x.default(document.location.href),o=r.getQueryParameter("fieldCustomizers");try{if(null!=(i=JSON.parse(o)))for(var n in i){var s=i[n],a="",l="";if("string"==typeof s)a=s;else if("object"==typeof s){s.id&&(a=s.id);if(s.properties){var u="";"object"==typeof s.properties&&(u=JSON.stringify(s.properties));l=u}}i[n]={internalName:n,clientSideComponentId:a,clientSideComponentProperties:l}}}catch(e){console.log("Error when parse query parameter: fieldCustomizers, error: "+e)}i||(i=[]);for(var d=!1,c=!1,p=0,m=t;p<m.length;p++){var f=m[p],h=f.RealFieldName,g=void 0;i.hasOwnProperty(h)&&(g=i[h]);if(g&&!f.CustomFormatter){f.ClientSideComponentId=g.clientSideComponentId;f.ClientSideComponentProperties=g.clientSideComponentProperties;d=!0}f.ClientSideComponentId&&f.ClientSideComponentId!==T.default.Empty&&!f.CustomFormatter&&(c=!0)}!c&&d&&(r.getQueryParameter("loadSPFX")||console.log("WARNING! SPFX is required to be loaded. Add 'loadSPFX=true' query parameter"));return d||c};o.prototype._getBinaryStreamApiUrl=function(e){var t=this.apiUrlHelper.build().webByItemUrl(e);return t=(t=S.isFeatureEnabled(S.SupportPoundPercent)?t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl}):t.method("GetFileByServerRelativeUrl",e.serverRelativeItemUrl)).segment("OpenBinaryStream")};return o}(o);t.default=D});define("@ms/odsp-datasources/lib/SPListItemRetriever",["require","exports","./dataSources/item/spListItemRetriever/SPListItemRetriever"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/SPListItemRetriever",["require","exports","tslib","./ListItemDataHelpers","./ListItemPostDataHelpers","../../base/DataSource","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/guid/Guid"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GROUPINGID_NEXT="__next__";var d=function(e){function n(t){return e.call(this,t.hostSettings)||this}i.__extends(n,e);n.prototype.getDataSourceName=function(){return"ListItemDataSource"};n.prototype.getItem=function(t,i,o){var n=this;t.postDataContext.isOnePage=!!t.newTargetListUrl;return e.prototype.getData.call(this,function(){return n.getUrl(i,t)},function(e){return n._parseResponse(e,o.qosEvent)},o.qosName,function(){return n.getAdditionalPostData(t.postDataContext)},"POST",r.getListRequestHeaders(i,t.postDataContext&&t.postDataContext.needsQuickLaunch),void 0,void 0,void 0,void 0,this._qosHandler).then(function(e){return e},function(e){n._errorHandler(o.qosName,e);return s.default.wrapError(e)})};n.prototype.getUrl=function(e,t){var i=t&&t.postDataContext,o={webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath};if(this._isSpecifiedItemRequest(e))o.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest&&!o.urlParts.isCrossList||i&&i.isOnePage)&&e.viewIdForRequest!==u.default.Empty&&(o.view=e.viewIdForRequest);!o.view&&e.viewPathForRequest&&(o.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(o.filterParams=e.filterParams);if(e.sortField){o.sortField=e.sortField;o.sortDir="false"===e.isAscending?"Desc":"Asc"}i&&i.groupReplace?o.requestToken=this._isExpandingGroup(o)?void 0:e.requestToken:o.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||i&&i.groupReplace||(o.groupString=e.group.groupString)}return r.getListDataUrl(o)};n.prototype.getAdditionalPostData=function(e){return o.getAdditionalPostData(e)};n.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};n.prototype._isExpandingGroup=function(e){return e.group&&e.group.groupingId!==t.GROUPINGID_NEXT};n.prototype._parseResponse=function(e,t){try{if(void 0!==e)return JSON.parse(e)}catch(i){if("{}"!==e.substring(0,2)){t.end({resultType:a.ResultTypeEnum.Failure,resultCode:"BadJSON"});throw i}return JSON.parse(e.substring(2))}};n.prototype._qosHandler=function(e){var t=e&&e.code?e.code:"";return t=t.indexOf("2147024860")>-1?"ListViewTreshold":t.indexOf("2147024749")>-1?"LookupColumnTreshold":t.indexOf("2147024809")>-1&&t.indexOf("requestUrl")>-1?"RequestURLFailure":t.indexOf("2147024809")>-1&&t.indexOf("range")>-1?"RangeError":t.indexOf("2147024809")>-1&&t.indexOf("view")>-1?"InvalidView":t.indexOf("2130575340")>-1&&t.indexOf("field")>-1?"FieldTypesNotInstalledProperly":e.status.toString()};n.prototype._errorHandler=function(e,t){var i=t&&t.code?t.code:"";i.indexOf("2147024860")>-1?l.default.logData({name:e+".ListViewTreshold"}):i.indexOf("2147024749")>-1&&l.default.logData({name:e+".LookupColumnTreshold"})};return n}(n.default);t.SPListItemRetriever=d;t.default=d});define("@ms/odsp-datasources/lib/dataSources/base/DataSource",["require","exports","./DataRequestor"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._pageContext=e;this.dataRequestor=new i.default({qosName:this.getDataSourceName()},{pageContext:e})}e.prototype.getDataSourceName=function(){return"DataSource"};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,i,r,o,n,s,a,l,u,d){void 0===o&&(o="POST");var c=e();return this.dataRequestor.getData({url:c,parseResponse:t,qosName:i,qosHandler:d,additionalPostData:r&&r(),method:o,additionalHeaders:n,contentType:s,maxRetries:a,noRedirect:l,crossSiteCollectionCall:u,needsRequestDigest:this.needsRequestDigest(c)})};return e}();t.DataSource=r;t.default=r});define("odsp-next/dataSources/item/spo/ListItemBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../url/odb/UrlQueryKeys","../../../models/item/UrlType","../../../models/store/ItemsStore","../../base/odb/GridPreviewHelpers","../../url/QueryType","@ms/odsp-utilities/lib/uri/Uri","../../../models/item/ItemReputationType","@ms/odsp-utilities/lib/icons/IconSelector","../../../utilities/path/Path","../../../models/item/SharingType","../../../models/item/Item.resx","../../../models/item/ItemType","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/dateTime/DateTime","../odb/ShortcutLinkDataSource","@ms/odsp-utilities/lib/list/ShortcutUtilities","@ms/odsp-shared/lib/base/Double","../../../utilities/features/Features","../odb/ODBDataSource.resx","../../base/odb/ItemHelper","../../../utilities/suiteExtensions/SuiteExtensionsHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/guid/Guid","../odb/ColumnsHelper","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../../resources/DataSourceResourceKeys","../../../utilities/icons/SupportPreviewHelper","../../../resources/SPOResourceKeys","../../../resources/VroomResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../models/task/Task","../ItemTaskObserver","../../../utilities/graft/Graft","../../url/odb/ItemUrlHelper","../../url/vroom/VroomUrlHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-datasources/lib/SPListItemProcessorHelpers","../../base/AriaHelper","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/killSwitch/KillSwitch"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k,P,L,R,F,A,M,E,U,B,O,N,V,H,K,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var z=function(t){function r(e,i){void 0===e&&(e={});var r=t.call(this,e,i)||this;r._pageContext=i.pageContext;r._urlDataSource=i.urlDataSource;r._listContext=i.listContext;r._itemsStore=i.itemsStore;r._navigation=i.navigation;r._microServiceDataSource=i.microServiceDataSource;r._vroomUrlHelper=i.vroomUrlHelper;r._itemUrlHelper=i.itemUrlHelper;r._vroomDataContext=i.vroomDataContext;r._shortcutLinkDataSource=i.shortcutLinkDataSource;r._htmlDecodeDiv=document.createElement("textarea");return r}i.__extends(r,t);r.prototype.getItemResult=function(e){var t=e.requestKey,r=e.queryType,s=void 0===r?this._urlDataSource.getQueryType():r,d=e.itemFromServer,b=e.groupBy,k=e.itemGroups,P=e.requiredColumns,R=e.supportsNestedGroups,F=e.observer;if(!d)return null;var A=this._urlDataSource.getKeyParams(t),B=this._itemUrlHelper.getUrlParts({path:d.id||d.FileRef||d.ServerRelativeUrl,listUrl:A[o.default.listUrlKey]}),O=(pt={},pt[o.default.idParamKey]=B.serverRelativeItemUrl,pt[o.default.listUrlKey]=B.normalizedListUrl,pt),K=d.File_x0020_Type,z=K?"."+K:"",G=this._getMediaServiceMetadata(d),j=this._getOfficeBundleFacet(d,z,G,B),W=this._getItemType(d,z,j,B,G);if(W===h.Folder){var X=this._urlDataSource.getQueryParamValue(A),Q=this._urlDataSource.getItemTypeFilter(A),Z=(mt={},mt[o.default.queryTypeParamKey]=s,mt[o.default.queryParamKey]=X,mt);Q&&N.extend(Z,this._urlDataSource.saveItemTypeFilter(Q));N.extend(O,Z)}var J=this._urlDataSource.getKey(O),$={key:J,extension:z};j&&j.cTag&&($.officeBundle=j);var Y=d.id||d.FileRef;$.id=Y;var ee,te,ie=d[".spItemUrl"];if(ie){var re=this._vroomUrlHelper.getUrlParts(ie);ee=re.itemId;te=re.driveId}else ee=d["name.FileSystemItemId"]||(d.isRootFolder?"root":void 0);this._vroomDataContext&&ee&&this._vroomDataContext.setFileSystemIdMapping(ee,Y);$.itemId=U.optional(ee);$.graph=U.optional(ee&&{itemId:ee,driveId:te});var oe=Number(d._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams[o.default.pseudoPolicyTipKey]&&(oe=4===(oe=Number(d.ID)%6)?5:oe);$.policyTip=U.optional(oe);var ne=L.isDicomFile(z);(ne||".ai"===z||".eps"===z||".psd"===z)&&this._microServiceDataSource.getThumbnail({fileExtension:z,item:d,itemKey:J,mediaServiceMetadata:G})&&(W=h.Media);if(!q.default.isActivated("25712c19-0df9-4933-bee5-b17db22d9c30","05/15/2017","Enable preview markdown with html viewer.")&&".md"===z&&(se=this._microServiceDataSource.getHtmlConversionUrl({fileExtension:z,item:d,mediaServiceMetadata:G}))){W=h.Media;$.htmlConversion={url:se}}if(S.isFeatureEnabled(S.EnableZipFilePreviewing)&&".zip"===z){var se=this._microServiceDataSource.getZipUrl({fileExtension:z,item:d,mediaServiceMetadata:G});if(se){W=h.Media;$.zip={url:se}}}var ae={},le=this._microServiceDataSource.getDownloadAsZipUrl(d);le&&(ae[n.downloadAsZip]=le);ie&&(ae[n.itemUrl]=ie);var ue,de,ce,pe,me=this._listContext;if(W===h.Folder)ue="Sharepoint.DocumentSet"===d.ProgId;else if(W===h.Media){var fe=c.getIconNameFromExtension(K);if(ne)ce={width:0,height:0};else{var he=G&&G.photo,ge=G&&G.video,ve=G&&G.audio,be=G&&G.media;"video"===fe?pe={fourCC:ge&&ge.fourCC||(".mp4"===z.toLowerCase()?"H264":void 0),bitrate:U.optional(ge&&ge.encodingBitrate),width:ge&&ge.frameWidth||0,height:ge&&ge.frameHeight||0,duration:be&&be.duration,audioFormat:ve&&ve.format}:"photo"===fe&&(ce={originalUrl:d.FileRef,width:he&&he.width||0,height:he&&he.height||0})}}else W===h.File&&me&&void 0!==me.isDocLib&&!me.isDocLib&&(de={});var ye=G&&G.media&&G.media.title;$.caption=U.optional(ye);$.photo=U.optional(ce);$.video=U.optional(pe);$.listItem=U.optional(de);$.isDocSet=U.optional(ue);B.serverRelativeItemUrl===B.serverRelativeListUrl&&($.isRootFolder=!0);var _e=V.ListItemBuilderHelpers.getItemName(d,W,me);$.name=U.optional(_e);$.displayName=U.optional(_e);var Se,xe=!0;if(d.Modified&&"21"===this._pageContext.webTemplate&&S.isFeatureEnabled(S.RequestDatesInUtc))try{var Ie=new Date(d.Modified);$.dateModifiedTime=Ie;$.dateModifiedValue=Ie.getTime();Se=v.getShortDisplayDate(Ie);xe=!1}catch(e){}if(xe){$.dateModifiedValue=U.optional(d.Modified);Se=d["Modified.FriendlyDisplay"]?v.getRelativeDateTimeStringForLists(d["Modified.FriendlyDisplay"]):d.Modified?""+d.Modified:""}$.dateModified=U.optional(Se||void 0);$.permissions=U.optional(_.default.fromHexString(d.PermMask));if(k&&b&&b.length>0)if(R){k[0]||(k[0]=[]);var we=k[0]&&k[0].length>0?k[0][k[0].length-1]:null,Ce=b[0],Te=b[1];if(Ce&&"1"===d[Ce+".newgroup"]){var De=we?we.startIndex+we.count:0,ke=V.GroupBuilder.buildGroup(me,d,Ce,0,!1,De),Pe=this._convertToODNGroup(ke);k[0].push(Pe);we=Pe}if(Te&&"1"===d[Te+".newgroup"]){var Le=we&&we.children&&we.children.length>0?we.children[we.children.length-1]:null,De=Le?Le.startIndex+Le.count:we?we.startIndex:0;V.GroupBuilder.buildGroup(me,d,Te,1,!1,De,we);var Re=we.children.pop();we.children.push(this._convertToODNGroup(Re))}}else for(var Fe=0;Fe<b.length;Fe++){var Ae=b[Fe];if(Ae){var Me=k[Fe]&&k[Fe].length>0?k[Fe][k[Fe].length-1]:null;if("1"===d[Ae+".newgroup"]){var De=Me?Me.startIndex+Me.count:0,Pe=V.GroupBuilder.buildGroup(me,d,Ae,Fe,!1,De);k[Fe]||(k[Fe]=[]);k[Fe].push(this._convertToODNGroup(Pe))}}}var Ee;if(P&&P.length>0){Ee=!1;for(var Ue in P)if(!d[P[Ue].internalName]){Ee=!0;break}}$.hasMissingMetadata=U.optional(Ee);var Be,Oe,Ne,Ve,He,Ke=d.folder,qe=[];if(Ke){$.folder={};$.childCount=void 0;Be=[];if(Ke.children){for(var ze=0,Ge=Ke.children,je=Ge.length,We=0,Xe=0;Xe<je;Xe++){var Qe=this.getItemResult({requestKey:t,queryType:s,itemFromServer:Ge[Xe],groupBy:b,itemGroups:qe,requiredColumns:P,supportsNestedGroups:R,observer:F});if(Qe){Be[Xe]=Qe.item;We<10&&Qe.itemType===h.Media&&ze++;We++}}je>0&&(ze>=10||ze>=je)&&($.displayType=l.Photos)}}else{Ne=(Ne=d["serverurl.progid"])?Ne.substring(1):p.canonicalizeDecodedUrl(this._itemUrlHelper.getUrlParts({path:d.FileRef,listUrl:B.normalizedListUrl}).normalizedItemUrl);ae[n.original]=Ne;j&&(ae[n.viewInBrowser]=this._microServiceDataSource.getPdfConversionUrl({fileExtension:z,item:d,mediaServiceMetadata:G},!0));if(S.isFeatureEnabled(S.ShortcutLink)&&y.default.isShortcutItem({key:J,extension:z})){W=h.Shortcut;if(d._ShortcutUrl){$.shortcutInfo={shortcutLinkRewritten:!0};ae[n.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,d._ShortcutUrl,d._ShortcutSiteId,d._ShortcutWebId,d._ShortcutUniqueId);d._ShortcutUniqueId&&(Oe=a.previewImageUrl({url:d._ShortcutUrl,siteId:d._ShortcutSiteId,webId:d._ShortcutWebId,uniqueId:d._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{$.shortcutInfo=U.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(J);ae[n.shortcutTarget]=u.default.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+C.default.encodeURIComponent(d.FileRef)}}ae[n.open]=Ne;Ve=d["File_x0020_Type.mapapp"]||d["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];$.size=U.optional(Number(d.File_x0020_Size)||void 0);$.totalSize=U.optional(Number(d.SMTotalSize)||void 0);Oe||(Oe=this._getThumbnail(d,{extension:z,key:J,type:W,mediaServiceMetadata:G}));$.openUrl=Ne;$.thumbnail=Oe;var Ze=this._getPdfConversionFacet(d,z,G);Ze&&($.pdfConversion=Ze);var Je=this._getFbxConversionFacet(d,z,G);Je&&($.fbxConversion=Je);if(W===h.Folder){var $e=Number(d.ItemChildCount)+Number(d.FolderChildCount);$.childCount=$e;var Ye=Number(d.SMTotalFileCount);$.folder={totalCount:Ye>0?Ye:$e,childCount:$e}}var et=d.ServerRedirectedEmbedUrl;et&&(this._itemUrlHelper.getUrlParts({path:et}).isCrossDomain||(He=et))}$.previewIFrameUrl=He;$.type=W;$.appMap=U.optional(Ve);this._pageContext.blockDownloadsExperienceEnabled&&($.type===h.Media||Ne&&Ve)?$.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled?$.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&($.itemStatus=4);$.type===h.Folder&&($.isDropEnabled=!0);var tt={};for(var it in d)d.hasOwnProperty(it)&&(tt[it]=d[it]);var rt=d.UniqueId&&T.default.normalizeLower(d.UniqueId);rt&&(tt.uniqueId=rt);$.reputationProperties=this.getReputationProperties(d);var ot=_e;z&&(ot=_e.substring(0,_e.toLowerCase().lastIndexOf(z.toLowerCase())));$.sharingRole=0;var nt;nt=Number(d.PrincipalCount)>0?m.Shared:void 0===d.PrincipalCount?m.Unknown:m.Private;$.sharingType=nt;tt.FileName=ot;var st=c.getIconNameFromItem({extension:z,isDocSet:ue,listItem:de,sharingType:nt,type:W});$.iconName=st;$.defaultSubText=I.getGridSubTitleTextFromModifiedBy(I.getModifiedByFromObject(d.Editor));$.isPlaceholder=!d.PermMask;$.queryType=s;$.displayType=U.backup($.queryType);$.isDraggable=$.queryType===l.Files;var at;oe&&(2&oe?at=f.strings.policyTipBlockText:1===oe&&(at=f.strings.policyTipNotifyText));W!==h.Folder&&Ee&&(at?at+=" "+f.strings.missingMetadataText:at=f.strings.missingMetadataText);var lt=d.CheckoutUser;if(lt&&lt[0]&&lt[0].title){var ut=g.format(f.strings.checkedOutTo,lt[0].title);tt.checkedOutToText=ut;at?at+=" "+ut:at=ut}$.tooltipText=U.optional(at);if(S.isFeatureEnabled(S.ODBNextFileHandler)&&!S.isFeatureEnabled(S.FileHandlersV2)){var dt=w.getInstance().updateItem(new(this.resources.injected(E.default)),{id:Y,key:J,previewIFrameUrl:He,extension:z,iconName:st});dt&&N.extend($,dt)}tt.nameFieldAriaLabel=D.default.getNameFieldAriaLabelForItem({name:_e,type:W,sharingType:nt,extension:z,tooltipText:at,appMap:Ve,photo:ce});tt.iconFieldAriaLabel=H.getIconFieldAriaLabelForItem({type:W,sharingType:nt,extension:z,tooltipText:at,appMap:Ve,photo:ce});tt.modifiedFieldAriaLabel=Se?x.strings.ModifiedColumnName+", "+Se:"";tt.calloutInvokerIconAriaLabel=x.strings.calloutInvokerIconAriaLabel;tt.modifiedByFieldAriaLabel=x.strings.ModifiedByColumnName+", "+I.getModifiedByFromObject(d.Editor);$.properties=tt;$.urls=i.__assign({},ae,this._getVideoUrl(d,z,G));F.update([new M.default(J).succeed({item:$})]);var ct=this._getGroupings({itemFromServer:d,supportsNestedGroups:R,groupBy:b,groups:qe});return{item:{key:J},itemType:W,children:Be,groupings:ct.groupings,totalChildren:ct.totalChildren,nextRequestToken:d.nextRequestToken};var pt,mt};r.prototype._getGroupings=function(e){var t=this,i=e.itemFromServer,r=e.supportsNestedGroups,o=e.groupBy,n=e.groups,s=null,a=this._listContext.groupLevel,l=i.folder?i.folder.childCount:0;if(-1!==a)if(i.groups){var u=[],d=0;if(r){var c=V.GroupBuilder.buildCollapsedGroups(i.groups,this._listContext,o),p=c.groups,m=c.totalCount;u=p.map(function(e){return t._convertToODNGroup(e)});d=m}else for(var f=0,h=i.groups;f<h.length;f++){var g=h[f],v=o[a];if(g[v+".newgroup"]){var b=V.GroupBuilder.buildGroup(this._listContext,g,v,a,!0,d);u.push(this._convertToODNGroup(b));d+=b.count}}if(u&&u.length>0){s=[{name:void 0,itemGroups:u,isAllCollapsed:this.createObservable(!0)}];l=d}}else n&&n.length>0&&n[a]&&n[a].length>0&&(s=[{name:void 0,itemGroups:n[a],isAllCollapsed:this.createObservable(!1)}]);return{groupings:s,totalChildren:l}};r.prototype.getReputationProperties=function(e){for(var t={},i=0,r=d.default;i<r.length;i++){var o=r[i];t[o]=U.optional(e[o])}return t};r.prototype._getPdfConversionFacet=function(e,t,i){var r=this._microServiceDataSource.getPdfConversionUrl({fileExtension:t,item:e,mediaServiceMetadata:i});if(r)return{url:r}};r.prototype._getFbxConversionFacet=function(e,t,i){var r=this._microServiceDataSource.getFbxConversionUrl({fileExtension:t,item:e,mediaServiceMetadata:i});if(r)return{url:r}};r.prototype._getOfficeBundleFacet=function(e,t,i,r){var o,n,s=e["File_x0020_Type.mapapp"],a=!r.isCrossDomain&&e["serverurl.progid"]&&("ms-word"===s&&S.isFeatureEnabled(S.EnableWordWrsPreview)||"ms-powerpoint"===s&&S.isFeatureEnabled(S.EnablePowerPointWrsPreview)||"ms-excel"===s&&S.isFeatureEnabled(S.EnableOneUpExcelPreview))&&!this._pageContext.blockDownloadsExperienceEnabled&&("21"===this._pageContext.webTemplate||S.isFeatureEnabled(S.EnableWrsPreviewOutsideODB)),l=this._microServiceDataSource.getOfficeBundleGenerateUrl({fileExtension:t,item:e,mediaServiceMetadata:i}),u=this._microServiceDataSource.getOfficeBundleGetFragmentUrl({fileExtension:t,item:e,mediaServiceMetadata:i}),d=!1,c="",p=e[".ctag"],m=i&&i.officeBundle;if(m){o=m.ctag;n=m.version;d=m.fatalError||!1;c=m.errorInfo||""}if(a)return{officeBundleGenerateUrl:l,officeBundleGetFragmentUrl:u,bundleCTag:o,bundleVersion:n,hasBundleGenerationFailed:d,bundleErrorInfo:c,cTag:p}};r.prototype._getThumbnail=function(t,i){if(i.type!==h.Folder){if(Number(this._listContext.listTemplateType)===k.ListTemplateType.webPageLibrary)return{url:e.toUrl("@ms/odsp-media/lib/images/sitepages/pageheader.png"),width:0,height:0};var r=this._microServiceDataSource.getThumbnail({fileExtension:i.extension,allowCookieAuth:this._listContext.listTemplateType===k.ListTemplateType.mySiteDocumentLibrary,itemKey:i.key,item:t,mediaServiceMetadata:i.mediaServiceMetadata});if(r)return r;if(L.fileTypeSupportsPreview(i.extension)){if(this._listContext.remoteParentWeb){var o=new u.default(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(u.UriPartial.authority),n=encodeURI(t.FileRef);return a.previewImageUrlFromUrl(C.default.encodeURIComponent(o+n),this._pageContext.webAbsoluteUrl,this._pageContext)}return a.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};r.prototype._getVideoUrl=function(e,t,i){var r=this._microServiceDataSource.getVideoUrl({fileExtension:t,item:e,mediaServiceMetadata:i}),o={};r&&(o[n.video]=r);return o};r.prototype._getItemType=function(e,t,i,r,o){var n,s=e["File_x0020_Type.mapapp"];if(e.folder)n=h.Folder;else if("1"===e.FSObjType){var a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];n=s&&"onenote"===s.substring(0,7)||a&&-1!==a.indexOf("onenote")?h.OneNote:h.Folder}else{var l=e.File_x0020_Type;S.isFeatureEnabled(S.ShortcutLink)&&y.default.isShortcutFileType(l)?n=h.Shortcut:S.isFeatureEnabled(S.UseWebPdfViewer)&&("pdf"===l||this._getPdfConversionFacet(e,t,o))?n=h.Media:S.isFeatureEnabled(S.EnableOneUpFbxPreview)&&"cool"===l||this._getFbxConversionFacet(e,t,o)?n=h.Media:(n=c.getItemTypeFromExtension(l))===h.Unknown&&k.isGenericList(this._listContext.listTemplateType)&&(n=h.File)}return n||h.File};r.prototype._convertToODNGroup=function(e){var t=this,i=e;i.state=this.createObservable({isCollapsed:e.isCollapsed});i.children&&i.children.length>0&&(i.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return i};r.prototype._getMediaServiceMetadata=function(e){var t=e.MediaServiceFastMetadata;if(!t)return{};try{this._htmlDecodeDiv.innerHTML=t;return JSON.parse(this._htmlDecodeDiv.innerText)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};return r}(r.default);z.dependencies=i.__assign({},r.default.dependencies,{pageContext:R.pageContext,urlDataSource:P.url,listContext:R.listContext,itemsStore:s.resourceKey,navigation:A.navigation,microServiceDataSource:P.microService,vroomUrlHelper:O.resourceKey,itemUrlHelper:B.resourceKey,vroomDataContext:F.dataContext.optional,shortcutLinkDataSource:b.resourceKey});t.default=z;t.resourceKey=K.createDefaultResourceKey(e,z)});define("odsp-next/dataSources/base/odb/GridPreviewHelpers",["require","exports","@ms/odsp-shared/lib/models/image/Alignments"],function(e,t,i){"use strict";function r(e,t,i,r,o){if(o.isSPO){var s;i&&(s=n(function(n){var s=n?"":"&resolution=Width1024";return r+"/"+o.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+i+"&guidSite="+e+"&guidWeb="+t+s}));return s}}function o(e,t,i){if(i.isSPO){var r;e&&(r=n(function(r){var o=r?"":"&resolution=Width1024";return t+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+o}));return r}}function n(e){return{url:e(!0),width:0,height:0,getAligned:function(t,r){return{url:e(r.name===i.cover.name),width:0,height:0}}}}Object.defineProperty(t,"__esModule",{value:!0});t.previewImageUrl=function(e,t,i,n){if(i.isSPO){var s=e.SiteId||e.SiteID||e.siteId||i.siteId,a=e.WebId||e.webId||i.webId,l=e.UniqueId||e.UniqueID||e.uniqueId,u=e.Url||e.url||e.Path;return l&&s&&a&&!n?r(s,a,l,t,i):o(u,t,i)}};t.previewImageUrlFromProps=r;t.previewImageUrlFromUrl=o});define("odsp-next/models/item/ItemReputationType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"];t.default=i});define("@ms/odsp-utilities/lib/icons/IconSelector",["require","exports","./FileTypeIconMap","./ItemType","../list/SharingTypeHelper"],function(e,t,i,r,o){"use strict";function n(e){if(!s){s={};for(var t in i.default){var r=i.default[t].extensions;if(r)for(var o=0;o<r.length;o++)s[r[o]]=t}}e=e.replace(".","").toLowerCase();return s[e]||a}var s,a="genericfile",l="code",u="one",d="folder",c="sharedfolder",p="docset",m="listitem";t.genericFile=a;t.codeFile=l;t.videoFile="video";t.photoFile="photo";t.getIconNameFromItem=function(e){var t="";if(e.type===r.default.Folder){t=o.usePrivateFolderIcon(e.sharingType)?d:c;e.isDocSet&&(t=p)}else t=e.type===r.default.OneNote?u:e.listItem?m:"text/typescript"===e.textEditorMimeType?l:n(e.extension);return t};t.getItemTypeFromExtension=function(e){var t;try{if(e){var o=n(e);if(i.default[o]){var s=i.default[o].type;void 0===s&&(s=r.default.File);t=s}}}catch(e){}void 0===t&&(t=r.default.Unknown);return t};t.getIconNameFromExtension=n});define("@ms/odsp-utilities/lib/icons/FileTypeIconMap",["require","exports","./ItemType"],function(e,t,i){"use strict";var r={accdb:{extensions:["accdb","mdb"]},archive:{type:i.default.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","rar","z"]},audio:{type:i.default.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},code:{extensions:["Hcp","abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","make","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pt","py","pyw","r","rake","rb","rbx","rc","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:i.default.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:i.default.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:i.default.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{type:i.default.Folder,iconType:"svg"},font:{type:i.default.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:i.default.Unknown},html:{extensions:["htm","html","mht"]},link:{type:i.default.Unknown,extensions:["lnk","link","url","website","webloc"]},listitem:{type:i.default.Unknown,extensions:["listitem"]},model:{extensions:["3ds","blend","dae","df","dwfx","dwg","3mf","fbx","ply","obj","stl","gltf","glb","dxf","layout","off","max","skp","stp","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},odp:{extensions:["odp"]},ods:{extensions:["ods"]},odt:{extensions:["odt"]},one:{type:i.default.OneNote,extensions:["one"]},onepkg:{type:i.default.OneNote,extensions:["onepkg"]},onetoc:{type:i.default.OneNote,extensions:["ms-one-stub","onetoc","onetoc2"]},pdf:{extensions:["pdf"]},photo:{type:i.default.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},rtf:{extensions:["epub","rtf","wri"]},sharedfolder:{type:i.default.Folder,iconType:"svg"},sysfile:{type:i.default.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","md","markdown","out","plist","properties","readme","text","txt"]},vector:{type:i.default.Unknown,extensions:["ai","dgn","pd","emf","eps","indd","indt","ps","svg","svgz","wmf"]},video:{type:i.default.Media,extensions:["3gp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xps:{extensions:["oxps","xps"]},xsn:{extensions:["xsn"]},zip:{type:i.default.Unknown,extensions:["zip"]}};Object.defineProperty(t,"__esModule",{value:!0});t.default=r});define("odsp-next/models/item/SharingType",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"}(i||(i={}));return i});define("@ms/odsp-utilities/lib/dateTime/DateTime",["require","exports","./DateTime.resx","../locale/Locale","../string/StringHelper"],function(e,t,i,r,o){"use strict";function n(e,t){void 0===t&&(t=!1);var n=Date.now()-e.getTime();if(n<-5*S)return e.toLocaleDateString(r.default.language);if(n<S)return t?i.strings.RelativeDateTime_LessThanAMinute_StartWithLowerCase:i.strings.RelativeDateTime_LessThanAMinute;if(n<x)return t?i.strings.RelativeDateTime_AboutAMinute_StartWithLowerCase:i.strings.RelativeDateTime_AboutAMinute;if(n<I){var s=Math.floor(n/S);return o.getLocalizedCountValue(i.strings.RelativeDateTime_XMinutes,i.strings.RelativeDateTime_XMinutesIntervals,s).replace("{0}",String(s))}if(n<w)return t?i.strings.RelativeDateTime_AboutAnHour_StartWithLowerCase:i.strings.RelativeDateTime_AboutAnHour;if(n<C){var a=Math.floor(n/I);return o.getLocalizedCountValue(i.strings.RelativeDateTime_XHours,i.strings.RelativeDateTime_XHoursIntervals,a).replace("{0}",String(a))}if(n<T)return t?i.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase.replace("{0}",e.toLocaleTimeString(r.default.language)):i.strings.RelativeDateTime_YesterdayAndTime.replace("{0}",e.toLocaleTimeString(r.default.language));if(n<k){var l=Math.floor(n/C);return o.getLocalizedCountValue(i.strings.RelativeDateTime_XDays,i.strings.RelativeDateTime_XDaysIntervals,l).replace("{0}",String(l))}return e.toLocaleDateString(r.default.language)}function s(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<C}function a(){var e=d(),t=l();if(window.Intl&&window.Intl.DateTimeFormat){var i={},r={hour:"2-digit",minute:"2-digit"};p=new Intl.DateTimeFormat(e,i);m=new Intl.DateTimeFormat(e,r);if(t){i.timeZone="UTC";r.timeZone="UTC"}f=new Intl.DateTimeFormat(e,i);h=new Intl.DateTimeFormat(e,r);g=p.format;v=m.format;b=f.format;y=h.format}else{g=b=function(t){return t.toLocaleDateString(e)};v=y=function(t){return t.toLocaleTimeString(e)}}}function l(){if(void 0===c)try{var e=d();(new Date).toLocaleDateString(e,{timeZone:"UTC"});c=!0}catch(e){c=!1}return c}function u(e,t){for(var i=e;i.length<t;)i="0"+i;return i}var d,c,p,m,f,h,g,v,b,y,_=621355968e5,S=6e4,x=2*S,I=60*S,w=2*I,C=24*I,T=2*C,D=7*C,k=32*C;t.iso8601DateTimeToJsDate=function(e){var t=!1;e.toUpperCase().indexOf("Z")===e.length-1&&(t=!0);var i=e.split(/[^0-9]/);if(!(i.length<6))return t?new Date(Date.UTC(Number(i[0]),Number(i[1])-1,Number(i[2]),Number(i[3]),Number(i[4]),Number(i[5]))):new Date(Number(i[0]),Number(i[1])-1,Number(i[2]),Number(i[3]),Number(i[4]),Number(i[5]))};t.getRelativeDateTimeStringPast=n;t.getRelativeDateTimeStringPastWithHourMinute=function(e){var t=Date.now()-e.getTime(),s=e.toLocaleDateString(r.default.language),a=e.toLocaleTimeString(r.default.language,{hour:"numeric",minute:"2-digit"});return t<C?n(e):t<T?o.format(i.strings.RelativeDateTime_YesterdayAndTime,a):o.format(i.strings.DateTime_DateAndTime,s,a)};t.isSameDay=s;t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth()};t.isThisWeek=function(e,t){t=t||new Date;var i=new Date(t.getTime()-t.getDay()*C),r=new Date(i.getTime()+D-C);return i.getTime()<=e.getTime()&&e.getTime()<=r.getTime()};t.isLastWeek=function(e,t){t=t||new Date;var i=new Date(t.getTime()-t.getDay()*C-D),r=new Date(i.getTime()+D-C);return i.getTime()<=e.getTime()&&e.getTime()<=r.getTime()};t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var r=null,n=null,s=e.split("|");if("0"===s[0])return e.substring(2);var a="1"===s[1],l=s[2],u=s.length>=4?s[3]:null,d=s.length>=5?s[4]:null;switch(l){case"1":r=a?t?i.strings.RelativeDateTime_AFewSecondsFuture_StartWithLowerCase:i.strings.RelativeDateTime_AFewSecondsFuture:t?i.strings.RelativeDateTime_AFewSeconds_StartWithLowerCase:i.strings.RelativeDateTime_AFewSeconds;break;case"2":r=a?t?i.strings.RelativeDateTime_AboutAMinuteFuture_StartWithLowerCase:i.strings.RelativeDateTime_AboutAMinuteFuture:t?i.strings.RelativeDateTime_AboutAMinute_StartWithLowerCase:i.strings.RelativeDateTime_AboutAMinute;break;case"3":n=o.getLocalizedCountValue(a?t?i.strings.RelativeDateTime_XMinutesFuture_StartWithLowerCase:i.strings.RelativeDateTime_XMinutesFuture:i.strings.RelativeDateTime_XMinutes,a?i.strings.RelativeDateTime_XMinutesFutureIntervals:i.strings.RelativeDateTime_XMinutesIntervals,Number(u));break;case"4":r=a?t?i.strings.RelativeDateTime_AboutAnHourFuture_StartWithLowerCase:i.strings.RelativeDateTime_AboutAnHourFuture:t?i.strings.RelativeDateTime_AboutAnHour_StartWithLowerCase:i.strings.RelativeDateTime_AboutAnHour;break;case"5":null==u?r=a?t?i.strings.RelativeDateTime_Tomorrow_StartWithLowerCase:i.strings.RelativeDateTime_Tomorrow:t?i.strings.RelativeDateTime_Yesterday_StartWithLowerCase:i.strings.RelativeDateTime_Yesterday:n=a?t?i.strings.RelativeDateTime_TomorrowAndTime_StartWithLowerCase:i.strings.RelativeDateTime_TomorrowAndTime:t?i.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase:i.strings.RelativeDateTime_YesterdayAndTime;break;case"6":n=o.getLocalizedCountValue(a?t?i.strings.RelativeDateTime_XHoursFuture_StartWithLowerCase:i.strings.RelativeDateTime_XHoursFuture:i.strings.RelativeDateTime_XHours,a?i.strings.RelativeDateTime_XHoursFutureIntervals:i.strings.RelativeDateTime_XHoursIntervals,Number(u));break;case"7":null===d?r=u:n=i.strings.RelativeDateTime_DayAndTime;break;case"8":n=o.getLocalizedCountValue(a?i.strings.RelativeDateTime_XDaysFuture:i.strings.RelativeDateTime_XDays,a?i.strings.RelativeDateTime_XDaysFutureIntervals:i.strings.RelativeDateTime_XDaysIntervals,Number(u));break;case"9":r=t?i.strings.RelativeDateTime_Today_StartWithLowerCase:i.strings.RelativeDateTime_Today}if(null!==n){r=n.replace("{0}",u);null!==d&&(r=r.replace("{1}",d))}return r};t.convertDateToISOString=function(e){var t=new Date(e),i=t.getTimezoneOffset()<0,r=t.getFullYear().toString(),o=u((t.getMonth()+1).toString(),2),n=u(t.getDate().toString(),2),s=u(t.getHours().toString(),2),a=u(t.getMinutes().toString(),2),l=u(t.getSeconds().toString(),2),d=u(i?Math.ceil(t.getTimezoneOffset()/60).toString().replace("-",""):Math.floor(t.getTimezoneOffset()/60).toString(),2),c=u((t.getTimezoneOffset()%60).toString().replace("-",""),2);return r+o+n+"T"+s+a+l+(i?"+":"-")+d+c};t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t};t.getDateFromDotNetTicks=function(e){if(!e)return null;var t=e/1e4-_;return new Date(t)};t.getShortDisplayDate=function(e,t){if(!e)return"";g||a();var i=s(new Date,e);return(t?i?y:b:i?v:g)(e)};t.getFullDisplayDate=function(e,t,r){g||a();var n=t?b(e):g(e),s=t?y(e):v(e);return o.format(i.strings.DateAndTime,n,s)};d=function(){for(var e,t=0,i=[window.$Config&&window.$Config.mkt,r.default.language,navigator.language,"en"].filter(function(e){return!!e});t<i.length;t++){var o=i[t];try{(new Date).toLocaleDateString(o);e=o;break}catch(e){}}d=function(){return e};return e}});define("odsp-next/dataSources/item/odb/ShortcutLinkDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Semaphore","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/uri/SimpleUri","../../base/odb/GridPreviewHelpers","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/list/ShortcutUtilities","../ItemTaskObserver","../../../models/task/Task","../../../models/item/UrlType","../../url/odb/ApiUrlHelper","../../url/odb/ItemUrlHelper","../../base/odb/DataRequestor","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=function(e){function t(t,i){void 0===t&&(t={});var r=e.call(this,t,i)||this;r._shortcutResolverQueue=new a.default;r._pageContext=i.pageContext;r._urlDataSource=i.urlDataSource;r._apiUrlHelper=i.apiUrlHelper;r._itemUrlHelper=i.itemUrlHelper;r._dataRequestor=new(r.scope.attached(i.dataRequestorType))({qosName:"ShortcutLinkDataSource"});return r}i.__extends(t,e);t.isSharePointUrl=function(e){var t=new l.default(e).getHost().toLowerCase();return t.indexOf("spoppe.com")>=0||(t.indexOf("sharepoint.com")>=0||t.indexOf("sharepoint.cn")>=0)};t.prototype.isInternal=function(e,t){var i=/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i;if(t&&t!==n.default.Empty&&i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var r=new l.default(e).getHost().toLowerCase(),o=new l.default(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(r===o)return!0;var s=void 0,a=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(o);if(!a)return!1;if(void 0!==a[2])s=a[1]+a[3];else if(void 0!==a[3])s=a[1]+"-my"+a[3];else if(void 0!==a[4])return!1;return r===s};t.prototype.createShortcut=function(e,t,i){var r=this._itemUrlHelper.getItemUrlParts(e),o=this._apiUrlHelper.build().webByItemUrl(r).method("GetFolderByServerRelativeUrl",r.serverRelativeItemUrl).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:o.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(i)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?s.default.wrapError(m.default.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?s.default.wrapError(m.default.ShortcutErrors.InvalidCharacterError):s.default.wrapError(m.default.ShortcutErrors.UnknownError)})};t.prototype.getShortcutTargetData=function(e,i){var r=this,o=this._itemUrlHelper.getUrlParts({path:e}),a=this._apiUrlHelper.build().method("SP.Utilities.ShortcutLink.GetShortcutLink",o.fullItemUrl);return this._dataRequestor.getData({url:a.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==n.default.Empty?e.d.siteId:null,webId:e.d.webId!==n.default.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==n.default.Empty?e.d.uniqueId:null,isInternal:r.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(e){return e.uniqueId||i?s.default.wrap(e):t.isSharePointUrl(e.url)?r.getFileByUrl(e.url).then(function(t){var i=!!t&&t.UniqueId&&n.default.normalizeLower(t.UniqueId);i&&(e.uniqueId=i);return e}):s.default.wrap(e)})};t.prototype.generateShortcutsOpenUrl=function(e,t,i,r,o,n){if(r&&o&&n&&-1===i.toLowerCase().indexOf("guestaccess.aspx")){var s="",a="?";if(i){var l=i.indexOf("?");-1!==l&&(a=i.substring(l)+"&")}s=e+"/"+t+"/ShortcutLink.aspx";s+=a+"siteid="+u.default.encodeURIComponent(r);s+="&webid="+u.default.encodeURIComponent(o);return s+="&uniqueid="+u.default.encodeURIComponent(n)}return i};t.prototype.enqueueParseShortcut=function(e){var t=this,i=this._itemUrlHelper.getItemUrlParts(e);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var r=new(t.managed(f.default));return t.getShortcutTargetData(i.fullItemUrl,!0).then(function(i){var o=t.generateShortcutsOpenUrl(t._pageContext.webAbsoluteUrl,t._pageContext.layoutsUrl,i.url,i.siteId,i.webId,i.uniqueId),n={key:e,shortcutInfo:{shortcutLinkRewritten:!0},urls:(s={},s[g.shortcutTarget]=o,s)};i.uniqueId&&(n.thumbnail=c.previewImageUrl(i,t._pageContext.webAbsoluteUrl,t._pageContext));r.update([new h.default(e).succeed({item:n})]);r.flush();var s}).then(function(){r.dispose()},function(e){r.dispose();return s.default.wrapError(e)})}))};t.prototype.getFileByUrl=function(e){var t,i=this,r=this._itemUrlHelper.getUrlParts({path:e});if(r.isCrossDomain||r.siteRelation===b.SiteRelation.sameSite)t=s.default.wrap(e);else{var o=this._apiUrlHelper.contextInfoUrl(r.fullItemUrl);t=this._dataRequestor.getData({url:o,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return t.then(function(t){var r=i._apiUrlHelper.build().webByUrl({path:t,webUrl:t}).method("GetFileByUrl",e);return i._dataRequestor.getData({url:r.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(t){return i._parseGetFileResponse(t,e)})})};t.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"};t.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:Boolean(e.d.Exists),IrmEnabled:Boolean(e.d.IrmEnabled),Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new d.default(t).authority,TimeCreated:o.iso8601DateTimeToJsDate(e.d.TimeCreated),TimeLastModified:o.iso8601DateTimeToJsDate(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}};return t}(r.default);x.dependencies=i.__assign({},r.default.dependencies,{pageContext:_.pageContext,urlDataSource:p.url,apiUrlHelper:v.resourceKey,itemUrlHelper:b.resourceKey,dataRequestorType:y.typeResourceKey});t.default=x;t.resourceKey=S.createDefaultResourceKey(e,x)});define("odsp-next/dataSources/item/ItemTaskObserver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/item/OneDriveItem","../../models/store/ItemsStore","../../utilities/graft/Graft","../../utilities/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=o.default;t.Graft=l;var d=function(e){function t(t,i){void 0===t&&(t={});void 0===i&&(i={});var r=e.call(this,t,i)||this,o=i.itemsStore,n=void 0===o?r.resources.consume(s.resourceKey):o;r._itemsStore=n;r._itemUpdatesByKey={};return r}i.__extends(t,e);t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var i=0,r=e;i<r.length;i++){var o=r[i];this._processTask(o)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),o=0,s=r;o<s.length;o++){var l=s[o],u=t[l],d=new n(l),c=this._getStoreItem(l);if(c){c.parent;var p=i.__rest(c,["parent"]);a.default(d,p)}a.default(d,{revision:0});for(var m=0,f=u.item;m<f.length;m++){var h=f[m];a.default(d,h)}e[l]=d}for(var g=0,v=r;g<v.length;g++){var b=(d=e[l=v[g]]).parentKey;if(b){var y=e[b]||this._getStoreItem(b)||new n(b);e[b]=y;d.parent=y}else delete d.parent}this._pushItemsToStore(e);for(var _=0,S=r;_<S.length;_++){l=S[_];delete(u=t[l]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t=e.parentKey,i=e.startIndex,r=e.endIndex,o=[],n=this._itemUpdatesByKey[t];if(n){var s=n.set;if(s)if(s.childrenByIndex){i=void 0===(m=(p={startIndex:i,endIndex:r}).startIndex)?s.startIndex:m,r=void 0===(f=p.endIndex)?s.endIndex:f;for(var a=i;a<r;a++){var l=s.childrenByIndex[a],u=this._getStoreItem(l);o.push(u)}}else if(s.childrenBySibling)for(var d={},c="";c=s.childrenBySibling[c];){if(d[c])throw new Error("Circular reference encountered enumerating the children of '"+t+"'.");d[c]=!0;u=this._getStoreItem(c);o.push(u)}}return o;var p,m,f};t.prototype._processTask=function(e){var t=e.key,i=e.output,r=i.item,o=i.set,n=this._itemUpdatesByKey,s=n[t];s||(s=n[t]={});if(r){s.item||(s.item=[]);s.item.push(r)}if(o){var a=n[o.parent.key];a||(a=n[o.parent.key]={});a.set||(a.set={});var l=a.set;if(void 0!==o.index){l.childrenByIndex||(l.childrenByIndex=[]);void 0===l.startIndex?l.startIndex=o.index:l.startIndex=Math.min(l.startIndex,o.index);var u=l.childrenByIndex.length;l.childrenByIndex[o.index]=t;void 0===l.endIndex?l.endIndex=o.index+1:l.endIndex>o.index+1?l.endIndex+=l.childrenByIndex.length-u:l.endIndex=Math.max(l.endIndex,o.index+1)}else if(o.after){l.childrenBySibling||(l.childrenBySibling={});l.childrenBySibling[o.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var i in e)(n=t[o=e[(l=e[i]).parentKey]&&l.parentKey||""]||(t[o]=[])).push(i);for(var r=[""];r.length;){var o=r.shift(),n=t[o];if(n){for(var s=0,a=n;s<a.length;s++){var l=e[i=a[s]];if(!l)throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(l,i)}r.push.apply(r,n)}}};return t}(r.default);d.dependencies=i.__assign({},r.default.dependencies,{itemsStore:s.resourceKey});t.ItemTaskObserver=d;t.resourceKey=new u.ResourceKey({name:e("module").id,factory:new u.ResolvedResourceTypeFactory(d)});t.default=d});define("@ms/odsp-shared/lib/base/Double",["require","exports"],function(e,t){"use strict";var i=function(){function e(){}e.fromHexString=function(e,t){var i=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var o=void 0,n=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){o=0;n=parseInt(e,16)}else{o=parseInt(e.slice(0,-8),16);n=parseInt(e.slice(-8),16)}if(!isNaN(o)&&!isNaN(n)){i.High=o;i.Low=n}}return i};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}};return e}();t.Double=i;Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("odsp-next/dataSources/base/odb/ItemHelper",["require","exports","../../item/odb/ODBDataSource.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getGridSubTitleTextFromModifiedBy=function(e){return e?r.format(i.strings.gridViewSubTitle,e):""};t.getModifiedByFromObject=function(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""};t.getModifiedByFromString=function(e){return e?e.substr(e.lastIndexOf("\n")+1):""};t.FOLDER_CONTENT_TYPE_PREFIX="0x0120";t.isFolderContentType=function(e){return e&&e.slice(0,6)===t.FOLDER_CONTENT_TYPE_PREFIX}});define("odsp-next/utilities/icons/SupportPreviewHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[".dcm",".dcm30",".dic",".dicm",".dicom"],r={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0};t.fileTypeSupportsPreview=function(e){return!!e&&r[e.toLowerCase()]};t.isDicomFile=function(e){return i.indexOf(e)>=0}});define("odsp-next/resources/VroomResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataContext=new i.ResourceKey("vroom.dataContext")});define("odsp-next/dataSources/url/vroom/VroomUrlHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getUrlParts=function(e){return new a(e)};return t}(r.default);t.default=s;var a=function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var i=this._getPathSegments();e=i[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var i=this._getPathSegments();e=i[t+1]}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new o.default(t).getPathSegments():[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e}();t.resourceKey=n.createDefaultResourceKey(e,s)});define("odsp-next/dataSources/item/spo/ListItemResultProcessor",["require","exports","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../url/odb/UrlQueryKeys","../../url/QueryType","../../../resources/DataSourceResourceKeys","../../../models/task/Task","../../../utilities/array/ArrayHelper","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/object/ObjectUtil","../../../models/item/ItemType","@ms/odsp-shared/lib/base/Double","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../../utilities/graft/Graft","../../url/odb/ItemUrlHelper","../../url/vroom/VroomUrlHelper","../../../utilities/features/Features","../../../utilities/path/Path","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y){"use strict";function _(){if(!S){i.Engagement.logData({name:"List.openInClient"});S=!0}}Object.defineProperty(t,"__esModule",{value:!0});var S=!1,x=function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper}e.prototype.processResponse=function(e){var t=e.response,i=e.response,r=i.HttpRoot,o=i.ListData,n=i.rootFolder,s=i.ListSchema,l=(void 0===s?{}:s).Collapse,u=void 0===l?"FALSE":l,d=e.requestKey,p=e.observer,m=this._urlDataSource.getKeyParams(d),f="TRUE"===u,h=this._itemUrlHelper.getItemUrlParts(d),g=this._itemUrlHelper.getUrlParts({path:h.serverRelativeListUrl,listUrl:h.fullListUrl});r&&this._processWeb({list:t,requestKeyParts:m,observer:p});this._processList({list:t,listUrlParts:g,requestKeyParts:m,observer:p});var v=[];if(n){b=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:m,observer:p});v.push.apply(v,b.parentItemUrls)}if(o&&!f){var b=this._processListData({listData:o,listUrlParts:g,parentKey:d,requestKeyParts:m,observer:p});v.push.apply(v,b.parentItemUrls)}var y={};if(t.ParentInfo)for(var _=0,S=t.ParentInfo.ParentFolderInfo;_<S.length;_++){var x=S[_];y[x.ServerRelativeUrl]=c.default.fromHexString(x.Permissions)}for(var I=0,w=a.removeDuplicates(v);I<w.length;I++){var C=w[I];this._processParentItem({itemUrl:C,listUrlParts:g,parentInfo:y,requestKeyParts:m,observer:p})}};e.prototype._processListData=function(e){for(var t=e.listData.Row,i=e.parentKey,r=e.requestKeyParts,o=e.listUrlParts,n=e.observer,a=[],l="",u=0,d=t;u<d.length;u++){var c=d[u],p=c.FileRef,m=this._processRow({row:c,observer:n,requestKeyParts:r,listUrlParts:o}).key;a.push.apply(a,this._getParentItemUrls({listUrlParts:o,itemUrl:p}));n.update([new s.default(m).succeed({set:{parent:{key:i},after:{key:l}}})]);l=m}return{parentItemUrls:a}};e.prototype._processRow=function(e){var t=e.row,i=e.row.FileRef,o=e.listUrlParts,n=e.requestKeyParts,a=e.observer,l=this._itemUrlHelper.getUrlParts({path:i,listUrl:o.fullListUrl}),d=(h={},h[r.default.idParamKey]=l.serverRelativeItemUrl,h[r.default.listUrlKey]=l.normalizedListUrl,h);if(this._isFolder(t)){var c=(g={},g[r.default.queryTypeParamKey]=n[r.default.queryTypeParamKey],g[r.default.queryParamKey]=n[r.default.queryParamKey],g[r.default.typeFiltersKey]=n[r.default.typeFiltersKey],g);u.extend(d,c)}var p=this._urlDataSource.getKey(d),m=this._getParentKeyForListItem({listUrlParts:o,itemUrl:i,requestKeyParts:n}),f={key:p};m&&(f.parentKey=m);a.update([new s.default(p).succeed({item:f})]);return{key:p};var h,g};e.prototype._processRootFolder=function(e){var t=e.list,i=e.listUrlParts,o=e.requestKeyParts,n=e.observer,a=t.rootFolder,l=this._itemUrlHelper.getUrlParts({path:a,listUrl:i.fullListUrl}),u=this._urlDataSource.getKey((g={},g[r.default.idParamKey]=l.serverRelativeItemUrl,g[r.default.listUrlKey]=l.normalizedListUrl,g[r.default.queryTypeParamKey]=o[r.default.queryTypeParamKey],g[r.default.queryParamKey]=o[r.default.queryParamKey],g[r.default.typeFiltersKey]=o[r.default.typeFiltersKey],g)),c=this._getParentKeyForListItem({listUrlParts:i,itemUrl:a,requestKeyParts:o}),p={key:u,type:d.Folder};c&&(p.parentKey=c);var f;t.ListData&&(f=t.ListData.FolderId);p.properties={ID:m.optional(f)};if(!this._isListRoot({itemUrl:a,listUrlParts:i})){var h=a.split("/").slice(-1)[0];p.name=h;p.displayName=h}n.update([new s.default(u).succeed({item:p})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:i,itemUrl:a})};var g};e.prototype._processWeb=function(e){var t=e.list,i=e.requestKeyParts,n=e.observer,a=t.HttpRoot,l=t.SiteTitle,u=v.getSharePointPath(a),c=this._itemUrlHelper.getUrlParts({path:u,webUrl:u}),p=this._urlDataSource.getKey((f={},f[r.default.idParamKey]=c.normalizedItemUrl,f[r.default.queryTypeParamKey]=o.DocumentLibraries,f[r.default.typeFiltersKey]=i[r.default.typeFiltersKey],f)),m={key:p,type:d.Folder};if(this._pageContext.webAbsoluteUrl===u){m.name=l;m.displayName=l}n.update([new s.default(p).succeed({item:m})]);var f};e.prototype._processList=function(e){var t,i=e.list,n=e.listUrlParts,a=e.requestKeyParts,l=e.observer,u=i.ListTitle,c=i.HttpRoot,f=this._urlDataSource.getKey((j={},j[r.default.idParamKey]=n.serverRelativeItemUrl,j[r.default.listUrlKey]=n.normalizedListUrl,j[r.default.queryTypeParamKey]=a[r.default.queryTypeParamKey],j[r.default.queryParamKey]=a[r.default.queryParamKey],j[r.default.typeFiltersKey]=a[r.default.typeFiltersKey],j)),h=i.AllowCreateFolder,g=i.EnableMinorVersions,y=i.verEnabled,S=i.AllowGridMode,x=i.ListTemplateType,I=i.BasePermissions,w=void 0===I?{}:I,C=w.ManageLists,T=void 0===C?void 0:C,D=w.ManagePersonalViews,k=void 0===D?void 0:D,P=w.OpenItems,L=void 0===P?void 0:P,R=i.ListSchema,F=void 0===R?{}:R,A=F.DefaultItemOpen,M=void 0===A?void 0:A,E=F[".driveAccessToken"],U=void 0===E?void 0:E,B=i.ExcludeFromOfflineClient,O=i.WebExcludeFromOfflineClient;if(U){var N=b.deserializeQuery(U);t={accessToken:N.access_token,proofToken:N.prooftoken}}var V;if(!(!n.isCrossList||!this._pageContext.listUrl&&this._pageContext.groupId)&&c){var H=v.getSharePointPath(c),K=this._itemUrlHelper.getUrlParts({path:H,webUrl:H});V=this._urlDataSource.getKey((W={},W[r.default.idParamKey]=K.normalizedItemUrl,W[r.default.queryTypeParamKey]=o.DocumentLibraries,W[r.default.typeFiltersKey]=a[r.default.typeFiltersKey],W))}var q="string"==typeof M?"0"===M:void 0;q&&_();var z=i.ListSchema&&i.ListSchema[".driveUrl"],G=this._vroomUrlHelper.getUrlParts(z);l.update([new s.default(f).succeed({item:{key:f,parentKey:m.optional(V),itemId:m.backup("root"),graph:{itemId:m.backup("root"),driveId:m.optional(G.driveId),sessionToken:m.optional(t)},type:d.Folder,name:m.optional(u),displayName:m.optional(u),isRootFolder:!0,isDropEnabled:!0,list:{id:m.optional(i.listName),allowGridMode:"boolean"==typeof S?S:m.backup(!0),allowCreateFolder:m.optional(h),enableMinorVersions:m.optional(g),enableVersions:m.optional(y),templateType:m.optional("string"==typeof x?Number(x):void 0),isDocumentLibrary:m.optional("string"==typeof x?p.isDocumentLibrary(x):void 0),isModerated:m.optional(i.isModerated),newWOPIDocumentEnabled:m.optional(i.NewWOPIDocumentEnabled),permissions:{manageLists:m.optional(T),managePersonalViews:m.optional(k),openItems:m.optional(L)},openInClient:m.optional(q),excludeFromOfflineClient:m.optional("boolean"==typeof B||"boolean"==typeof O?B||O:void 0),contentTypesEnabled:m.optional(i.ContentTypesEnabled),metadataNavFeatureEnabled:m.optional(i.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:m.optional(i.canUserCreateMicrosoftForm)},properties:{commandsSupported:m.optional(i.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]);var j,W};e.prototype._processParentItem=function(e){var t=e.itemUrl,i=e.listUrlParts,o=e.parentInfo,n=e.requestKeyParts,a=e.observer,l=this._itemUrlHelper.getUrlParts({path:t,listUrl:i.fullListUrl}),u=this._urlDataSource.getKey((m={},m[r.default.idParamKey]=l.serverRelativeItemUrl,m[r.default.listUrlKey]=l.normalizedListUrl,m[r.default.queryTypeParamKey]=n[r.default.queryTypeParamKey],m[r.default.queryParamKey]=n[r.default.queryParamKey],m[r.default.typeFiltersKey]=n[r.default.typeFiltersKey],m)),c={key:u,parentKey:this._getParentKeyForListItem({listUrlParts:i,itemUrl:t,requestKeyParts:n})};if(this._isListRoot({itemUrl:t,listUrlParts:i}))c.list={};else{var p=v.getFolderNameFromPath(t,g.isFeatureEnabled(g.SupportPoundPercent));c.name=p;c.displayName=p;c.type=d.Folder;c.isDropEnabled=!0;o&&o[t]&&(c.permissions=o[t])}a.update([new s.default(u).succeed({item:c})]);var m};e.prototype._getParentKeyForListItem=function(e){var t,i=e.listUrlParts,o=e.itemUrl,n=e.requestKeyParts;if(i.serverRelativeListUrl!==o){var s=o.split("/").slice(0,-1).join("/"),a=this._itemUrlHelper.getUrlParts({path:s,listUrl:i.fullListUrl});t=this._urlDataSource.getKey((l={},l[r.default.idParamKey]=a.serverRelativeItemUrl,l[r.default.listUrlKey]=a.normalizedListUrl,l[r.default.queryTypeParamKey]=n[r.default.queryTypeParamKey],l[r.default.queryParamKey]=n[r.default.queryParamKey],l[r.default.typeFiltersKey]=n[r.default.typeFiltersKey],l))}return t;var l};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,i=e.itemUrl,r=[],o=t.serverRelativeListUrl;if(0===i.indexOf(o))for(var n="",s=0,a=i.substring(o.length).split("/").slice(1,-1);s<a.length;s++){var l=""+o+(n+="/"+a[s]);r.push(l)}return r};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var i=e["File_x0020_Type.mapapp"],r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(i&&"onenote"===i.substring(0,7)||r&&-1!==r.indexOf("onenote"))}else t=!1;return t};return e}();x.dependencies={urlDataSource:n.url,pageContext:l.pageContext,itemUrlHelper:f.resourceKey,vroomUrlHelper:h.resourceKey};t.default=x;t.resourceKey=y.createDefaultResourceKey(e,x)});define("odsp-next/dataSources/item/spo/SubsiteItemResultProcessor",["require","exports","../../../models/task/Task","../../url/odb/UrlQueryKeys","../../../resources/DataSourceResourceKeys","../../url/QueryType","../../../models/item/ItemType","@ms/odsp-utilities/lib/icons/IconSelector","../../url/odb/ItemUrlHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._itemUrlHelper=t.itemUrlHelper}e.prototype.processSubsite=function(e){var t=e.subsite,o=e.requestKey,l=e.unique,u=e.observer,d=this._urlDataSource.getKeyParams(o),c=this._itemUrlHelper.getUrlParts({path:t.serverRelativeUrl,webUrl:t.serverRelativeUrl}),p=this._urlDataSource.getKey((h={},h[r.default.idParamKey]=c.normalizedItemUrl,h[r.default.queryTypeParamKey]=n.DocumentLibraries,h[r.default.typeFiltersKey]=d[r.default.typeFiltersKey],h[r.default.uniqueParamKey]=l,h)),m=a.getIconNameFromItem({type:s.Folder}),f={key:p,isRootFolder:!0,isPlaceholder:!1,name:t.title,displayName:t.title,type:s.Folder,iconName:m,subsite:t,queryType:n.DocumentLibraries,properties:{nameFieldAriaLabel:t.title}};u.update([new i.default(p).succeed({item:f})]);return{key:p};var h};return e}();d.dependencies={urlDataSource:o.url,itemUrlHelper:l.resourceKey};t.default=d;t.resourceKey=u.createDefaultResourceKey(e,d)});define("@ms/odsp-datasources/lib/dataSources/filter/ListFilterDataSource",["require","exports","tslib","../base/DataSource","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/navigation/AddressParser","../item/spListItemProcessor/SPListItemEnums","../../utilities/url/ItemUrlHelper","../../utilities/url/ApiUrlHelper","../../utilities/list/ListFilterUtilities","../../utilities/list/DataSourceUtilities"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){var i=e.call(this,t.pageContext)||this;i._listContext=t.listContext;i._itemUrlHelper=t.itemUrlHelper||new a.ItemUrlHelper({},{pageContext:t.pageContext});i._apiUrlHelper=t.apiUrlHelper||new l.ApiUrlHelper({},{pageContext:t.pageContext,itemUrlHelper:i._itemUrlHelper});i._folderPath=t.folderPath;void 0===i._folderPath&&(i._folderPath=d.getFolderPath(t.parentKey,i._listContext));return i}i.__extends(t,e);t.prototype.getFilterData=function(e,t,i,r){var o=this;return this.getData(function(){return o._getFilterDataUrl(e,t,i,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,i,r){var a=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl}),l=this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e);i&&(l=l.parameter("ViewId",i));this._folderPath&&(l=l.parameter("RootFolder",{raw:o.default.encodeURIComponent(this._folderPath)}));r&&r===s.ColumnFieldType.Taxonomy&&(l=l.parameter("ExcludeFieldFilteringHtml",!0));if(!n.deserializeQuery(t).useFiltersInViewXml){var d=u.default.getFilterParams(t);l=l.rawParameter(d)}return l.toString()};return t}(r.default);t.ListFilterDataSource=c;t.default=c});define("@ms/odsp-datasources/lib/utilities/list/DataSourceUtilities",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFolderPath=function(e,t){var i=e;t&&t.urlParts&&(i===t.urlParts.fullListUrl||i===t.urlParts.serverRelativeListUrl)&&(i=void 0);return i}});define("odsp-next/models/suiteNav/SuiteNavLinkIds",["require","exports","@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink"],function(e,t,i){"use strict";return i.SUITE_NAV_LINK_IDS});define("@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_LINK_IDS={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile"};t.ISuiteNavLinkIds=t.SUITE_NAV_LINK_IDS});define("odsp-next/providers/moveCopy/MoveCopyProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","../item/ItemProvider","../quota/UserStateProvider.key","../../resources/DataSourceResourceKeys","../../dataSources/item/ItemTaskObserver","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../operation/OperationProvider","../../models/task/Task","../operation/MoveCopyItemsAsyncOperation"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){function t(t,i){var r=e.call(this,t,i)||this;r._itemDataSource=i.itemDataSource;r._itemProvider=i.itemProvider;r._itemTaskObserver=r.scope.attach(new i.itemTaskObserverType);r._moveCopyHelper=new(r.managed(h.default))({moveCopyProvider:r});r._operationProvider=i.operationProvider;r._updateQuota=i.updateQuota;return r}i.__extends(t,e);t.prototype.copyItemsAsync=function(e){var t=this;if(e.isMove)throw new Error("Async move not implemented in the API layer");return this._itemProvider.getItem({parentKey:e.targetKey}).then(function(i){var r=new c,o=i.item,n=e.items.map(function(i){return t._moveCopyHelper.registerOperation(i,e,o.peek(),null,r)});return t._moveCopyHelper.handleMoveCopyAsyncItems(e,n)})};t.prototype.copyItems=function(e){return this._handleMoveCopyItems(e)};t.prototype.moveItems=function(e){var t=this;return this._handleMoveCopyItems(e).then(function(i){for(var r=[],o={},n=0,s=i.items;n<s.length;n++)(u=s[n]).error||(o[u.id]=!0);for(var a=0,l=e.items;a<l.length;a++){var u=l[a];o[u.id]&&r.push(new f.default(u.key).succeed({item:{key:u.key,parentKey:e.targetKey}}))}if(r.length){var d=t._itemTaskObserver;d.update(r);d.flush()}return i})};t.prototype.moveCopyOperationSuccess=function(e,t,i){for(var r=0,o=t.length;r<o;r++){var n=t[r],s=e.items[r],a=s&&s.error;if(a)this._moveCopyHelper.handleMoveCopyError(a,n);else{if(!e.items)throw new Error("No items returned from MoveCopy API");n.progress.current(1);n.state(d.completed)}}this._itemProvider.invalidateItem(i.parentKey);this._itemProvider.invalidateItem(i.targetKey);i.isMove||this._updateQuota(!0);return e};t.prototype._handleMoveCopyItems=function(e){var t=this,i=this.observables;return this._itemProvider.getItem({parentKey:e.targetKey}).then(function(o){var n=new c,s=o.item,a=e.items.map(function(o){var a,l={items:[o],parentKey:e.parentKey,targetId:e.targetId,targetKey:e.targetKey,cid:e.cid,group:e.group,isMove:e.isMove,nameConflict:e.nameConflict,taskId:e.taskId,deleteSource:e.deleteSource,isAsync:e.isAsync,overrideLock:e.overrideLock};return a=t._operationProvider.register({name:o.name,type:e.isMove?p.moveItems:p.copyItems,iconName:o.iconName,payloads:{moveItems:{item:o,destination:s.peek(),source:o.parent},copyItems:{item:o,destination:s.peek(),source:o.parent}},batch:n,actions:{rename:{isAvailable:i.create(!1),execute:function(){l.nameConflict=2;a.actions().rename.isAvailable(!1);a.actions().overwrite.isAvailable(!1);a.state(d.started);return l.isAsync?t._moveCopyHelper.handleMoveCopyAsyncItems(l,[a]):t._moveCopyItems(l,[a])}},overwrite:{isAvailable:i.create(!1),execute:function(){l.nameConflict=1;a.actions().rename.isAvailable(!1);a.actions().overwrite.isAvailable(!1);a.state(d.started);return l.isAsync?t._moveCopyHelper.handleMoveCopyAsyncItems(l,[a]):t._moveCopyItems(l,[a])}},cancel:{isAvailable:i.create(!1),execute:function(){a.actions().rename.isAvailable(!1);a.actions().overwrite.isAvailable(!1);a.state(d.canceled);return r.default.wrap(null)}},moveAnyway:{isAvailable:i.create(!1),execute:function(){l.deleteSource=!0;l.isMove=!1;l.isAsync=!0;a.actions().moveAnyway.isAvailable(!1);a.actions().rename.isAvailable(!1);a.actions().overwrite.isAvailable(!1);a.state(d.started);return t._moveCopyHelper.handleMoveCopyAsyncItems(l,[a])}},moveLockedFile:{isAvailable:i.create(!1),execute:function(){l.overrideLock=!0;a.actions().moveLockedFile.isAvailable(!1);return t.moveItems(l)}}},progress:{minimum:0,maximum:1,current:0}})});t._moveCopyHelper.markAllOperationsAsStarted(a);return t._moveCopyItems(e,a)})};t.prototype._executeMoveCopy=function(e){var t=this._itemDataSource;return e.isMove?t.moveItems(e):t.copyItems(e)};t.prototype._moveCopyItems=function(e,t){var i=this;return this._executeMoveCopy(e).then(function(r){return i.moveCopyOperationSuccess(r,t,e)},function(o){return r.default.wrapError(i._moveCopyHelper.moveCopyOperationFailure(o,t,e))})};return t}(n.default);g.dependencies=i.__assign({},n.default.dependencies,{itemDataSource:l.items,itemProvider:s.resourceKey,itemTaskObserverType:u.resourceKey,operationProvider:m.resourceKey,updateQuota:a.resourceKey});t.default=g;t.resourceKey=new o.ResourceKey({name:e("module").id})});define("odsp-next/providers/operation/MoveCopyItemsAsyncOperation",["require","exports","tslib","../../models/operation/OperationType","../../models/operation/OperationState","../../models/operation/OperationBatch","../../dataSources/item/IGetWorkProgressContext","./OperationProvider","../item/ItemProvider","../moveCopy/MoveCopyProvider","../../models/operation/OperationError","../../controls/commands/Commands.resx","../../controls/operation/monitor/OperationMonitor.resx","../../models/item/ItemType","../../dataSources/item/ITaskProgress","../../dataSources/item/ItemDataSource.resx","@ms/odsp-shared/lib/base/BaseModel","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../utilities/killSwitch/KillSwitch","../quota/UserStateProvider.key"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S={code:8,name:"InsufficientSpaceAvailable"},x=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this,r=i.resources;i._itemDataSource=r.consume(b.items);var o=i._moveCopyDataSource=r.consume(b.copy.optional);i._itemProvider=r.consume(l.resourceKey);i._moveCopyProvider=t.moveCopyProvider||r.consume(u.resourceKey);i._operationProvider=r.consume(a.resourceKey);i._bundleLoader=i.resources.consume(v.bundleLoader);i._updateQuota=r.consume(_.resourceKey);i._pollsForProgressSinceCancel=null;o&&o.getCapabilities().supportsProgressCaching&&i._resumePendingProgress();return i}i.__extends(t,e);t.prototype.registerOperation=function(e,t,i,s,a){var l=this;a||(a=new n);var u={items:[e],parentKey:t.parentKey,targetId:t.targetId,targetKey:t.targetKey,cid:t.cid,group:t.group,isMove:t.isMove,nameConflict:t.nameConflict,taskId:t.taskId,deleteSource:t.deleteSource,isAsync:t.isAsync},d=this.observables,c=this._operationProvider.register({name:e.name,type:t.isMove?r.moveItems:r.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:i,source:e.parent},copyItems:{item:e,destination:i,source:e.parent,taskId:s}},batch:a,actions:{rename:{isAvailable:d.create(!1),execute:function(){u.nameConflict=2;c.actions().rename.isAvailable(!1);c.actions().overwrite.isAvailable(!1);c.state(o.started);return l.handleMoveCopyAsyncItems(u,[c],s)}},overwrite:{isAvailable:d.create(!1),execute:function(){u.nameConflict=1;c.actions().rename.isAvailable(!1);c.actions().overwrite.isAvailable(!1);c.state(o.started);return l.handleMoveCopyAsyncItems(u,[c],s)}},cancel:{isAvailable:d.create(!0),execute:function(){u.taskId=t.taskId;c.actions().rename.isAvailable(!1);c.actions().overwrite.isAvailable(!1);return l._cachePromise?l._cachePromise.then(function(e){u.taskId=e.id;return l.cancelAsyncOperation(u,c,e.id)}):l.cancelAsyncOperation(u,c,s)}},moveAnyway:{isAvailable:d.create(!1),execute:function(){u.deleteSource=!0;u.isMove=!1;u.isAsync=!0;c.actions().moveAnyway.isAvailable(!1);c.actions().rename.isAvailable(!1);c.actions().overwrite.isAvailable(!1);c.state(o.started);return l.handleMoveCopyAsyncItems(u,[c],s)}},moveLockedFile:{isAvailable:d.create(!1),execute:function(){u.overrideLock=!0;c.actions().moveLockedFile.isAvailable(!1);return l._moveCopyProvider.moveItems(u)}}},progress:{minimum:0,maximum:1,current:0}});c.state(o.started);return c};t.prototype.moveCopyOperationFailure=function(e,t,i){if(t)for(var r=0,n=t;r<n.length;r++){var s=n[r];s.actions().cancel.isAvailable(!1);s.state(o.failed)}return e};t.prototype.handleMoveCopyAsyncItems=function(e,i,r){var o=this;if(e.isMove)throw new Error("Async move not implemented in the API layer");var n=function(e){return o._moveCopyDataSource.copyItemsAsync(e)};this.markAllOperationsAsStarted(i);return function(e,i,r){if(r){var s={id:r,progress:null,pageStats:null,targetId:null};e.taskId||(e.taskId=r);return o.pollForProgress(s,e,i)}t._activeAsyncTasks[o._getKey(e)]=null;o._cachePromise=n(e).then(function(t){var i=e.items.map(function(e){return e.key});o._progressCache&&o._progressCache.saveJobState(t,i,e.targetKey);e.taskId=t.id;return t},function(t){return o.moveCopyOperationFailure(t,i,e)});return o._cachePromise.then(function(t){o.pollForProgress(t,e,i)},function(t){return o.moveCopyOperationFailure(t,i,e)})}(e,i,r)};t.prototype.pollForProgress=function(e,t,i,r,o){var n=this;if(!e)return null;var a={workItemIds:[e.id],jobInfo:e.jobInfo,type:s.IGetWorkProgressTypes.itemCopy,items:t.items,lastProcessedTime:o};this._progressCache&&(a.progressCache=this._progressCache);var l=function(e){n._itemDataSource.getWorkProgress(e).then(function(o){r&&r(i,o);n._handleGetWorkProgressSuccess(o,i,t,e,l)})};if(i)for(var u=0;u<i.length;u++){var d=i[u];!d.payloads.peek().copyItems.taskId&&e&&e.progress&&(e.progress[u]?d.payloads.peek().copyItems.taskId=e.progress[u]&&e.progress[u].id:d.payloads.peek().copyItems.taskId=e.progress[0]&&e.progress[0].id)}r&&r(i,e);this._handleGetWorkProgressSuccess(e,i,t,a,l)};t.prototype.handleMoveCopyError=function(e,t){var i=e.code;t.actions().cancel.isAvailable(!1);t.payloads.peek().copyItems.taskId="";if(1e3===i){t.actions().rename.isAvailable(!0);var r=!0,n=t.payloads.peek();(n.moveItems&&n.moveItems.item||n.copyItems&&n.copyItems.item).type===m.Folder&&(r=!1);t.actions().overwrite.isAvailable(r);t.error(new d({message:r?p.strings.conflictUploadErrorText:p.strings.conflictUploadFolderWithRenameErrorText}))}else if(-2130575257===i||-2146232832===i)if(t.payloads().moveItems.item.parentKey===t.payloads().moveItems.destination.key)t.error(new d({message:p.strings.sameLocationMoveCopyErrorText}));else if(t.payloads().moveItems.item.type===m.Folder)if(y.default.isActivated("6e680b63-2ec4-42d2-8aa8-dda7be13fc11","01/18/2017","Keep both button for move copy"))t.error(new d({message:p.strings.conflictUploadFolderErrorText}));else{t.actions().rename.isAvailable(!0);t.error(new d({message:p.strings.conflictUploadFolderWithRenameErrorText}))}else if(-2146232832===i)t.error(new d({message:p.strings.conflictMoveCopyFileWithoutReplaceErrorText}));else{t.actions().overwrite.isAvailable(!0);if(y.default.isActivated("6e680b63-2ec4-42d2-8aa8-dda7be13fc11","01/18/2017","Keep both button for move copy"))t.error(new d({message:p.strings.conflictUploadWithoutRenameErrorText}));else{t.actions().rename.isAvailable(!0);t.error(new d({message:p.strings.conflictUploadErrorText}))}}else if(-2147018894===i)e.message&&t.error(new d({message:e.message}));else if(2028===i){t.actions().moveAnyway.isAvailable(!0);t.error(new d({message:c.strings.moveItemCannotMoveOwnItemIntoMountPointError}))}else if(2029===i){t.actions().moveAnyway.isAvailable(!0);t.error(new d({message:c.strings.moveItemCannotMoveSharedItemIntoOwnFolderError}))}else if(3e3===i)t.error(new d({message:h.strings.ItemNotFoundSubText}));else if(9001===i){t.actions().moveLockedFile.isAvailable(!0);t.error(new d({message:e.message}))}else if(1007===i)t.error(new d({message:p.strings.moveFolderToSameLocationErrorText}));else if(-2130247142===i){var s=e.message;t.payloads().moveItems.item.type===m.Folder&&(t.payloads().moveItems.item.key===t.payloads().moveItems.destination.key?s=p.strings.moveFolderToSameLocationErrorText:0===t.payloads().moveItems.destination.key.indexOf(t.payloads().moveItems.item.key)&&(s=p.strings.moveFolderToOwnSubfolderErrorText));t.error(new d({message:s}))}else-2147024809===i?t.error(new d({message:p.strings.copyCrossSiteFatalErrorText})):i===S.code?t.error(new d({message:p.strings.overQuotaCreateItemErrorText})):t.error(new d({message:e.message}));t.state(o.failed)};t.prototype.markAllOperationsAsStarted=function(e){if(e)for(var t=0,i=e;t<i.length;t++)i[t].state(o.started)};t.prototype._handleGetWorkProgressSuccess=function(e,i,r,n,s){var a=!1,l=!1,u=r.taskId;null!==this._pollsForProgressSinceCancel&&(this._pollsForProgressSinceCancel+=1);if(i&&e&&e.progress)for(var d=this,c=0,p=i;c<p.length;c++)!function(t){for(var i=void 0,r=t.payloads.peek(),n=0,s=e.progress;n<s.length;n++){var c=s[n];if(r.copyItems&&c.id===t.payloads.peek().copyItems.taskId&&d._hasMatchingItemIds(t,c)&&t.state.peek()!==o.completed&&t.state.peek()!==o.failed){i=c;break}}var p=function(){t.progress.current(1);t.actions().cancel&&t.actions().cancel.isAvailable(!1);t.state(o.completed);l=!0};if(i){var m=i.error,h=f.ITaskStatuses[i.status];if(h===f.ITaskStatuses.Cancelled||d._pollsForProgressSinceCancel>=3){t.actions().cancel.isAvailable(!1);t.state(o.canceled);l=!0}else if(m){i.errorCode===S.name&&(m.code=S.code);if(d._progressCache){t.progress.current(0);t.state()!==o.failed&&d.handleMoveCopyError(m,t)}else d.handleMoveCopyError(m,t)}else if(h===f.ITaskStatuses.Completed)p();else{var g=t.progress.current.peek();if(i.completedBytes>g){t.progress.current(i.completedBytes);t.progress.maximum(i.totalBytes)}a=!0}d._progressCache&&d._progressCache.updateJobState(u,t,i)}else t.state()!==o.failed&&p()}(p[c]);if(l){this._itemProvider.invalidateItem(r.parentKey);this._itemProvider.invalidateItem(r.targetKey);this._updateQuota()}if(a){var m=this.async.setTimeout(function(){s(n)},2e3);t._activeAsyncTasks[this._getKey(r)]=m}else if(this._progressCache){this._pollsForProgressSinceCancel=null;this._progressCache.purgeJobState(u)}};t.prototype._hasMatchingItemIds=function(e,t){var i=e.payloads.peek().copyItems&&e.payloads.peek().copyItems.item;return!t.sourceResourceId||this._moveCopyDataSource.hasMatchingId(t.sourceResourceId,i)};t.prototype.cancelAsyncOperation=function(e,i,r){var n=this,s=r||e.taskId,a=t._activeAsyncTasks[this._getKey(e)];if(!this._cancelPromise){var l={workItemIds:[s]};this._progressCache&&(l.progressCache=this._progressCache);this._cancelPromise=this._itemDataSource.cancelWork(l)}return this._cancelPromise.then(function(e){if(n._progressCache){var t=n._progressCache.getCacheData(),r=t&&t[s];if(e||!r){i.state(o.canceled);n._progressCache.cancelJobs(s);a&&n.async.clearTimeout(a)}else n._pollsForProgressSinceCancel=0}i.actions().cancel.isAvailable(!1);n._cancelPromise=void 0},function(e){n._cancelPromise=void 0})};t.prototype._getKey=function(e){return e.items.map(function(e){return e.key}).join(",")+e.targetKey};t.prototype._resumePendingProgress=function(){var e=this;this._bundleLoader.queueLoad("odsp-next/providers/operation/MoveCopyAsyncProgressCache").then(function(t){e._progressCache=new(e.managed(t))({moveCopyHelper:e});e._progressCache.resumePendingProgress()})};return t}(g.default);x._activeAsyncTasks={};t.default=x});define("odsp-next/dataSources/item/IGetWorkProgressContext",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IGetWorkProgressTypes={itemCopy:"itemCopy",albumFolderExtraction:"albumFolderExtraction"}});define("odsp-next/dataSources/item/ITaskProgress",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotStarted=0]="NotStarted";e[e.InProgress=1]="InProgress";e[e.Completed=2]="Completed";e[e.Cancelled=3]="Cancelled";e[e.Failed=4]="Failed";e[e.Unknown=5]="Unknown"}(t.ITaskStatuses||(t.ITaskStatuses={}))});define("odsp-next/actions/splist/ActionMap",["require","exports","tslib","../odb/ActionMap","../DeferredAction","../UnsupportedAction","./DefaultClickAction","../openInExplorer/splist/OpenInExplorerAction"],function(e,t,i,r,o,n,s,a){"use strict";return function(t){function r(){var i=t.call(this)||this;i.DefaultClickAction=s.default;i.OpenInExplorerAction=a.default;i.OpenNavLinkAction=o.create(e,"./OpenNavLinkAction");i.AddExistingAppViewAction=o.create(e,"./AddExistingAppViewAction");i.AddFlowAction=o.create(e,"../flow/AddFlowAction");i.AddToQuickLaunchAction=o.create(e,"./AddToQuickLaunchAction");i.AddToSpotlightAction=o.create(e,"./AddToSpotlightAction");i.ApproveRejectAction=o.create(e,"./ApproveRejectAction");i.CancelEditAction=o.create(e,"./CancelEditAction");i.ChangeAppViewVisibilityAction=o.create(e,"./ChangeAppViewVisibilityAction");i.ClearFilterAction=o.create(e,"./ClearFilterAction");i.ComplianceDetailsAction=o.create(e,"./ComplianceDetailsAction");i.CopyFieldAction=o.create(e,"../CopyFieldAction");i.CreateAppViewAction=o.create(e,"./CreateAppViewAction");i.CreateColumnAction=o.create(e,"./CreateColumnAction");i.CreateItemAction=o.create(e,"./CreateItemAction");i.CustomizeFormsNavigationAction=o.create(e,"./CustomizeFormsNavigationAction");i.CustomizeViewAction=o.create(e,"./CustomizeViewAction");i.DeleteViewAction=o.create(e,"./DeleteViewAction");i.EditItemAction=o.create(e,"./EditItemAction");i.EditItemCancelAction=o.create(e,"./EditItemCancelAction");i.EditItemSaveAction=o.create(e,"./EditItemSaveAction");i.EditNewAppViewAction=o.create(e,"./EditNewAppViewAction");i.ExportListAction=o.create(e,"./ExportListAction");i.FilterAction=o.create(e,"./FilterAction");i.InvokeFirstRunExperienceAction=o.create(e,"./InvokeFirstRunExperienceAction");i.LaunchChangeTheLookPanelAction=o.create(e,"../launchChangeTheLookPanel/LaunchChangeTheLookPanelAction");i.LaunchCreateAppViewPanelAction=o.create(e,"./LaunchCreateAppViewPanelAction");i.LaunchColumnManagementPanelAction=o.create(e,"../launchColumnManagementPanel/LaunchColumnManagementPanelAction");i.LaunchFilterPanelAction=o.create(e,"./LaunchFilterPanelAction");i.LaunchGroupMembershipPanelAction=o.create(e,"../launchGroupMembershipPanel/LaunchGroupMembershipPanelAction");i.LaunchListFormAction=o.create(e,"../launchListForm/LaunchListFormAction");i.LaunchFlowPanelAction=o.create(e,"./LaunchFlowPanelAction");i.LaunchSitePermissionsPanelAction=o.create(e,"../launchSitePermissionsPanel/LaunchSitePermissionsPanelAction");i.LaunchSiteSettingsPanelAction=o.create(e,"../launchSiteSettingsPanel/LaunchSiteSettingsPanelAction");i.MakeHomepageAction=o.create(e,"./MakeHomepageAction");i.ModifyColumnAction=o.create(e,"./ModifyColumnAction");i.ModifyShowInFiltersPaneAction=o.create(e,"./ModifyShowInFiltersPaneAction");i.MoveLeftSpotlightAction=o.create(e,"./MoveLeftSpotlightAction");i.MoveRightSpotlightAction=o.create(e,"./MoveRightSpotlightAction");i.PinToFiltersPaneAction=o.create(e,"./PinToFiltersPaneAction");i.PublishAction=o.create(e,"./PublishAction");i.RemoveFromSpotlightAction=o.create(e,"./RemoveFromSpotlightAction");i.RenameColumnAction=o.create(e,"./RenameColumnAction");i.SaveViewAction=o.create(e,"./SaveViewAction");i.SetDefaultViewAction=o.create(e,"./SetDefaultViewAction");i.ShowExistingFlowsAction=o.create(e,"../flow/ShowExistingFlowsAction");i.ShowFiltersAction=o.create(e,"./ShowFiltersAction");i.SwitchViewAction=o.create(e,"./SwitchViewAction");i.SynchronizeAppViewAction=o.create(e,"./SynchronizeAppViewAction");i.ToggleAction=o.create(e,"./ToggleAction");i.TriggerFlowAction=o.create(e,"../flow/TriggerFlowAction");i.UnPublishAction=o.create(e,"./UnPublishAction");i.UploadAction=o.create(e,"./UploadAction");i.ViewItemAction=o.create(e,"./ViewItemAction");i.WorkflowAction=o.create(e,"./WorkflowAction");i.ShowVersionHistoryAction=o.create(e,"../odb/ShowVersionHistoryAction");i.ShowHashtagsAction=o.create(e,"../odb/ShowHashtagsAction");i.ShowItemAnalyticsAction=n;return i}i.__extends(r,t);return r}(r)});define("odsp-next/actions/splist/DefaultClickAction",["require","exports","tslib","../odb/DefaultClickAction","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../../models/item/ItemType","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this,t)||this;i._urlDataSource=i.resources.consume(o.url);i._actionMap=i.resources.consume(n.actionMap);return i}i.__extends(t,e);t.prototype.onComputeAction=function(){var t=this.item(),i=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return i&&a.isGenericList(i.list.templateType)&&t.type===s.File?new(this.managed(this._actionMap.LaunchListFormAction))({type:3,item:t,url:this._urlDataSource.getDefaultClickUrl(t,{})}):e.prototype.onComputeAction.call(this)};return t}(r.default);t.default=l});define("odsp-next/actions/openInExplorer/splist/OpenInExplorerAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../OpenInExplorerHelper"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i.name="OpenInExplorer";i._helper=new(i.managed(s.default));return i}i.__extends(t,e);t.prototype.onExecute=function(e,t){if(!this.onIsAvailable())return r.default.wrap({resultType:n.ResultTypeEnum.ExpectedFailure});this._helper.navigateToClassic();return r.default.wrap({resultType:n.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()};return t}(o.default);t.default=a});define("odsp-next/pages/files/spo/routes/StandaloneListRoute",["require","exports","knockout","../PageEvents","../../../../controls/standaloneList/StandaloneList","../../../../utilities/list/odb/ListResources","../../../../resources/PagesResourceKeys","../../../../providers/spotlight/SpotlightProvider","../../../../resources/ProviderResourceKeys","../../../../resources/ControlResourceKeys","../../../../resources/DataSourceResourceKeys","../../../../models/store/ItemsStore","@ms/odsp-utilities/lib/events/EventGroup","../../../../controls/spotlightHost/SpotlightHost","../../../../utilities/features/Features"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(e){this.id=e.id;this._onViewChanged=e.onViewChanged||null;this.component={name:o.tagName,params:{}}}e.prototype.initialize=function(e){this._events=new p.default(this);this.pageResources=e;var t=e.resourceScope,r=e.appResources.pageContext,o=e.commandSet;n.default.exposeResources({resourceScope:t,pageContext:r,viewId:r.viewId});this.dataManager=t.consume(s.dataManager);t.expose(u.canModifySchema,this.dataManager.canModifySchema);var a=t.consume(s.eventScope);this._registerPageLoadCompleteEvent(this.dataManager,a);this._setupViewChangeEventHandler(t);t.expose(s.files.isArrangeControlVisible,i.observable(!1));var l=null;t.isExposed(d.spotlight)&&f.isFeatureEnabled(f.Spotlight)&&(l=this._setupSpotlight(t,o));var c={topCommandSet:o,showViewCommandSet:!0,hideCommandBar:!0,skipNavigation:!0,isCustomList:!0,breadcrumbBuilder:this.dataManager.getCrumbs.bind(this.dataManager),subcomponent:l};this.component.params=c};e.prototype.dispose=function(){this._events.dispose();this._viewChangeSubscription&&this._viewChangeSubscription.dispose()};e.prototype._registerPageLoadCompleteEvent=function(e,t){var i=this;this._events.on(e,"pageLoadComplete",function(){p.default.raise(t,r.default.mainContentLoadComplete);i._events.off(e,"pageLoadComplete")})};e.prototype._setupViewChangeEventHandler=function(e){if(this._onViewChanged){var t=e.consume(u.currentView);this._viewChangeSubscription=t.subscribe(this._onViewChanged,this)}};e.prototype._setupSpotlight=function(e,t){e.expose(l.spotlight,new(e.injected(a.default))({itemSet:e.consume(u.currentItemSet),itemsStore:e.consume(c.resourceKey),spotlightDataSource:e.consume(d.spotlight),currentView:e.consume(u.currentView)}));return{name:m.default.tagName,params:{topLevelCommandSet:t,boundingElementClass:"StandaloneList-content"}}};return e}();t.StandaloneListRoute=h;t.default=h});define("odsp-next/controls/standaloneList/StandaloneList",["require","exports","./StandaloneListViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./StandaloneList.html","./StandaloneList.css","../breadcrumbBar/BreadcrumbBar","../footer/Footer","../progressSpinnerFlat/ProgressSpinnerFlat","../commandBar/CommandBar","../overlays/oneUp/OneUpOverlay"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-standalone-list",template:e("./StandaloneList.html"),viewModel:i,synchronous:!0})});define("odsp-next/controls/standaloneList/StandaloneListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared/lib/utilities/knockout/AsyncComponentLoader","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/features/Features","../../models/item/ItemParentHelper","../../bindings/contextMenu/ContextMenuHelper","../../bindings/contextMenu/ContextMenuBinding","../../bindings/dragAndDrop/DragAndDropBinding","../../bindings/scrollContainer/ScrollContainerBinding","../../bindings/interactionScope/InteractionScopeBinding","@ms/odsp-utilities/lib/performance/PerformanceCollection","../../bindings/component/ControlBinding","../list/layouts/LayoutType","../emptyFolder/odb/EmptyFolder","../appView/AppView","../error/Error","../progressSpinnerFlat/ProgressSpinnerFlat","../progressSpinnerFlat/ProgressSpinnerFlat","../dragAndDrop/DropHelper","../infoPane/InfoPane.key","../../dataSources/upload/UploadProcessorType","../dragAndDrop/dragAndDropHint/DragAndDropHint","../listFooter/ListFooter","../ipeEditor/InPlaceEditor","../smartBannerV2/SmartBannerV2","../oneUp/OneUp.key","../../dataSources/url/QueryType"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k,P,L,R,F,A,M,E,U,B,O,N,V){"use strict";var H=300;return function(t){function r(i){void 0===i&&(i={});var r=t.call(this,i)||this;r.listRegionLabel="";r.folderPathRegionLabel="";r.infoPaneRegionLabel="";r.commandBarRegionLabel="";w.default.mark("EUPL.StandaloneList.constructor");r.addBindingHandlers({contextMenu:_,scrollContainer:x.default,dragAndDrop:S.default,interactionScope:I.default,control:C.default});r.loadingSpinnerTagName=R.default.tagName;r.emptyFolderTagName=D.tagName;var a=r,d=a.observables,p=a.resources,m=p.consume(s.infoPane),f=i.isDefaultDrop,h=void 0===f||f,y=i.isScrollable,k=void 0===y||y,P=i.responsiveToContainer,M=void 0!==P&&P;r._itemParentHelper=p.consume(b.resourceKey);var K=p.consume(s.bundleLoader).isPageLoaded;r.hideCommandBar=i.hideCommandBar;r.isCustomList=i.isCustomList;r.hideContextMenus=i.hideContextMenus;r.isTitleVisible=i.title?d.create(!0):d.pureCompute(r._computeTitleVisible,{deferEvaluation:!0});r.isScrollable=k;var q=v.isFeatureEnabled(v.UseReactGridList),z=v.isFeatureEnabled(v.UseReactGridListGroup);r._computeViewCommandBarVisible=!q||q&&z?function(){return!!r.isCustomList&&r.layoutType()===T.CustomGridList}:function(){return!1};r.isViewCommandBarVisible=d.pureCompute(r._computeViewCommandBarVisible,{deferEvaluation:!0});r.breadcrumbBuilder=i.breadcrumbBuilder;r._isDefaultDrop=h;r._currentView=p.consume(o.currentView.optional)||d.create(null);r._pageContext=p.consume(l.pageContext.optional);r._isDocLib=d.pureCompute(r._computeIsDocLib);r.autoScrollEnabled=d.create(!1);r.autoScrollYPosition=d.create(0);var G=r.dataManager=p.consume(n.dataManager);r.layoutIteration=d.create(0);G.setLayoutIteration(r.layoutIteration);r.onLayoutRenderComplete=G.onLayoutRenderComplete&&G.onLayoutRenderComplete.bind(G);r.title=i.title||G.title;r.item=G.item;r.itemSet=G.itemSet;r.children=G.currentItemChild;r.requiredRange=G.requiredRange;r.itemsPerGroup=G.itemsPerGroup;r.requiredGroup=G.requiredGroup;r.itemSelectionModel=p.consume(o.itemsSelection);r.isRetrievingData=G.isRetrievingData;r.renderSeeMoreAsLink=d.create(!1);r.showSeeMore=v.isFeatureEnabled(v.RenderLargeListPartialResult)?d.compute(function(){var e=r.itemSet().content().partialResultStatus;if(0!==e){1===e?r.renderSeeMoreAsLink(!0):r.renderSeeMoreAsLink(!1);return!0}return!1}).extend({rateLimit:{timeout:H,method:"notifyWhenChangesStop"}}):d.compute(function(){return!1});r.isOneUp=G.isOneUp;r.focusItem=r.resources.expose(o.focusItem,G.focusItem);r.oneUpControlParams={specification:C.toSpecification(N.resourceKey,{}),placeholder:C.toSpecification(L.resourceKey,{})};r.layoutType=p.consume(n.files.layoutType);r.layoutTypeComponent=d.create();r.responsiveToContainer=M;r.infoPaneTransclusionContentParams={provider:m};var j=n.base.infoPane;r.isInfoPaneExpanded=p.consume(j.isInfoPaneExpanded);p.expose(j.hidePreview,d.pureCompute(function(){return!r._isDocLib()}));r.infoPaneControlParams={specification:C.toSpecification(A.resourceKey,{}),placeholder:C.toSpecification(L.resourceKey,{})};r.infoPaneRole=d.create("contentinfo");r.filtersPaneComponent=d.create({name:R.default.tagName,params:{}});r.isFiltersPaneExpanded=p.consume(n.base.filtersPane.isFiltersPaneExpanded.optional)||d.create(!1);r.isFiltersPaneVisible=d.pureCompute(function(){return r.dataManager.queryType()===V.Files&&r.isFiltersPaneExpanded()});var W=r.isFiltersPaneExpanded.subscribe(function(t){if(t&&r.filtersPaneComponent().name===R.default.tagName){c.loadModule({require:e,path:"../filtersPane/FiltersPane"}).then(function(e){r.filtersPaneComponent({name:e.tagName,params:{}})});W.dispose()}},r);r.isDroppable=d.create(!0);r.isDroppingTarget=d.create(!1);r.dropHelper=p.consume(F.resourceKey);r._actionMap=p.consume(o.actionMap);r._uploadActionObservable=d.create(null);r._isUploadAvailable=d.pureCompute(function(){return!!r._uploadActionObservable()&&r._uploadActionObservable().isAvailable()});r.dragAndDropHintTagName=E.default.tagName;r.listFooterTagName=U.default.tagName;var X=p.consume(l.inplaceEditorUrl.optional);r._hasIPEView=!!X;r.ipeEditorName=B.default.tagName;r.inPageEditorUrl=X||d.create("");p.expose(l.inplaceEditorClosing,d.create(!1));p.expose(n.base.infoPane.isInfoPaneAvailable,d.create(!0));var Q=p.consume(n.files.resx);if(Q){r.listTooltip=Q.listTooltip;r.listRegionLabel=Q.listRegionLabel;r.folderPathRegionLabel=Q.folderPathRegionLabel;r.infoPaneRegionLabel=Q.infoPaneRegionLabel;r.commandBarRegionLabel=Q.commandBarRegionLabel;r.partialResultStatusString=d.pureCompute(function(){var e=r.itemSet().content().partialResultStatus;return 3===e?Q.largeListFoundAllItemsStatus:2===e?Q.largeListLoadingMoreResultStatus:1===e?Q.largeListLoadMoreItemsLabel:void 0})}r.isEmptyView=G.isEmptyView;d.backgroundCompute(r._computeUpdateViewOnLayoutTypeChange).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});r._showErrorPage=G.showErrorPage;if(r.isCustomList){r._onLayoutTypeChanged(r.layoutType.peek());r._initLayoutType=r.layoutType.peek()}r.error=G.error.peek();r.platform=p.consume(g.platformDetection);r.printEnabled=!r.platform.isIE9;r.isActive=d.create(!1);r.subcomponent=i.subcomponent;r.loadBackgroundPowerApp=r.createObservable(!1);r.smartBannerTagName=O.tagName;r._setUpSmartBanner();r._showViewCommandSet=!!i.showViewCommandSet;r.viewCommandSet=d.create(null);r._setupCommandSets(i.topCommandSet);d.compute(function(){K.peek()?r._initializeDeferredComponents():K()});r._viewParams=p.consume(o.viewParams);if(!i.skipNavigation){var Z=p.consume(u.navigation);r.events.on(Z,"change",function(){r._viewParams(Z.viewParams)});r._viewParams(Z.viewParams)}r._robotRootOverride=r._viewParams.peek().robotMimicRoot;r._dragAndDropRobotExperiment=d.create(null);r._dragAndDropRobotProvider=p.consume(s.dragAndDropRobot.optional);r.isDragAndDropRobotApplicable=d.pureCompute(r._getIsRobotApplicable);r.isGridBasedView=d.pureCompute(r._computeIsGridBasedView);r.dragAndDropGridHintComponent=d.pureCompute(function(){return r._dragAndDropRobotProvider?r._dragAndDropRobotProvider.getGridHintComponent(r.isGridBasedView,r.isDragAndDropRobotApplicable):null});r.dragAndDropFooterHintComponent=d.pureCompute(function(){return r._dragAndDropRobotProvider?r._dragAndDropRobotProvider.getFooterHintComponent(r.isGridBasedView,r.isDragAndDropRobotApplicable):null});r.isHeaderVisible=d.pureCompute(r._computeIsHeaderVisible);return r}i.__extends(r,t);r.prototype.onMayReceiveDrop=function(e){if(this._isUploadAvailable()){var t=this.item&&this.item.peek();return t&&0===e.type?{targetName:t.name}:void 0}};r.prototype.onDragging=function(e,t){var i=e&&0===t.dragData.type&&this._isDefaultDrop&&this._isUploadAvailable();this.isDroppingTarget(i)};r.prototype.onReceiveDrop=function(e){if(!this._isUploadAvailable())return!1;e.itemSet=this.itemSet.peek();return this.dropHelper.processDrop(e,this.item.peek(),this.isCustomList)};r.prototype.isAppView=function(){var e=this._currentView();return!(!e||!e.viewType||134217728!==e.viewType)};r.prototype.isIPEView=function(){return!(!this.inPageEditorUrl||!this.inPageEditorUrl()||""===this.inPageEditorUrl())};r.prototype.onShowMoreButtonClick=function(){this.dataManager.getMorePartialResult()};r.prototype._computeTitleVisible=function(){if(this.isAppView())return!1;var e=this.unwrapObservable(this.item());if(e){var t=f.default.isFiltered(this._viewParams());if(e.parent||t)return!1;if(e.subsite)return!1;if(e.queryType===V.Subsites)return!1}return!0};r.prototype._computeIsDocLib=function(){var e=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(this.item(),"list"));return!e||!!e.list.isDocumentLibrary};r.prototype._onIPEUrlChanged=function(){var e=this.isIPEView(),t=this.resources,i=n.base.commandBar,r=t.consume(i.commandSet);e?this._loadIPECommandSet(t):t.isExposed(i.originalCommandSet)&&r(t.consume(i.originalCommandSet))};r.prototype._loadIPECommandSet=function(t){var i=this,r=t||this.resources,o=r.consume(n.base.commandBar.commandSet);c.loadModule({require:e,path:"odsp-next/pages/files/splist/commandSets/InPageEditTopLevelCommandSet"}).then(function(e){r.expose(n.base.commandBar.originalCommandSet,o());o(new(i.managed(e))({}))})};r.prototype._onLayoutTypeChanged=function(t){var i=this,r=this.isAppView();if(this._showErrorPage()){this.error=this.dataManager.error.peek();this.layoutTypeComponent(P.tagName)}else if(this._initLayoutType!==t){w.default.mark("EUPL.StandaloneList.LayoutTypeChanged");p.loadComponent(e,"../list/"+T.Path[t],t).then(function(e){var o=t,n=i.layoutTypeComponent.peek();(r&&n!==k.default.tagName||!r&&n===k.default.tagName)&&i._toggleAppViewCommandSet();r?o=k.default.tagName:i.dataManager.cacheLayoutContext();i.layoutTypeComponent(o)})}else this._initLayoutType=void 0};r.prototype._computeUpdateViewOnLayoutTypeChange=function(){this._onLayoutTypeChanged(this.layoutType())};r.prototype._setUpSmartBanner=function(){v.isFeatureEnabled(v.ShowGetOneDriveAppsLink)?this._pageContext&&!this._pageContext.isSPO?this.isBannerApplicable=this.platform.isIOS:this.isBannerApplicable=this.platform.isIOS||this.platform.isAndroid||this.platform.isWinPhone:this.isBannerApplicable=!1;this.isSmartBannerVisible=this.observables.create(!1)};r.prototype._setupCommandSets=function(e){var t=this.observables;this.listViewContextMenuHelper=this.resources.expose(n.listViewContextMenuHelper,t.create(new y({items:[],rootElementClass:"",engagementSource:"ListItem"})));this.contextMenuHelper=t.create(new y({items:[],rootElementClass:""}));this.topLevelCommandSet=e||!this.hideCommandBar&&t.create(null)||void 0;this.topLevelCommandSet&&(this.topLevelCommandSet.equalityComparer=m.objectStrictEquality)};r.prototype._initializeDeferredComponents=function(){var t=this,i=this.resources,r=i.consume(a.url).getPageModulePath();r=r.substr(0,r.lastIndexOf("/"));var o=Number(this._pageContext.listBaseTemplate)===h.default.genericList,s={topLevelCommandSetType:c.loadModule({path:r+"/commandSets/TopLevelCommandSet",require:e}),viewCommandSetType:this._showViewCommandSet?c.loadModule({path:"../../pages/files/splist/commandSets/ViewCommandSet",require:e}):d.default.wrap(null)};d.default.all(s).then(function(e){if(t.topLevelCommandSet){t._topLevelCommands=new(t.managed(e.topLevelCommandSetType))({sourceNameEngagement:t.platform.isMobile?".MobileTopMenu":".TopMenu",isForCommandBar:!0});t.createComputed(t._computeUpdateTopCommandBar);t.topLevelCommandSet(t._topLevelCommands)}t._initializeContextMenuCommandSet(e.topLevelCommandSetType);t._showViewCommandSet&&t.viewCommandSet(new(i.injected(e.viewCommandSetType))({isArrangeControlVisible:i.consume(n.files.isArrangeControlVisible)}));t.isAppView()&&t._toggleAppViewCommandSet();t._hasIPEView&&t.createComputed(t._onIPEUrlChanged)},function(e){});o&&c.loadModule({path:"../../controls/powerAppHost/PowerAppHost",require:e}).then(function(e){t.powerAppHostTagName=e.tagName;t.loadBackgroundPowerApp(!0)});this._uploadActionObservable(new(this.managed(this._actionMap.UploadAction))({uploadProcessorType:M.Html5file}))};r.prototype._initializeContextMenuCommandSet=function(e){var t=this;if(!this.hideContextMenus){var i=this.observables;this.listViewContextMenuCommandSet=this.resources.expose(n.listViewContextMenuCommandSet,new(this.managed(e))({sourceNameEngagement:".InListViewRight",isForContextMenu:!0}));var r;i.compute(function(){r&&r.dispose();var e=t.dataManager.queryType()===V.Search?"SearchItem":"ListItem";r=new y({items:t.listViewContextMenuCommandSet.commands(),rootElementClass:"List",boundingElementClass:"StandaloneList-content",engagementSource:e,shouldHideIcons:!0});t.listViewContextMenuHelper(r)});var o,s=new(this.managed(e))({sourceNameEngagement:".OutListViewRight",isForContextMenu:!0});i.compute(function(){o&&o.dispose();o=new y({items:s.commands(),rootElementClass:"StandaloneList",boundingElementClass:"StandaloneList-content",engagementSource:"List",shouldHideIcons:!0});t.contextMenuHelper(o)})}};r.prototype._computeUpdateTopCommandBar=function(){!this.itemSelectionModel.selectedCount()||this.isAppView()||this.isIPEView()||this.topLevelCommandSet(this._topLevelCommands)};r.prototype._toggleAppViewCommandSet=function(){var t=this,i=this.resources.consume(n.base.commandBar.commandSet);this.isAppView()?c.loadModule({require:e,path:"odsp-next/pages/files/splist/commandSets/AppViewTopLevelCommandSet"}).then(function(e){t.resources.expose(n.base.commandBar.originalCommandSet,i());i(new(t.managed(e))({}))}):this.resources.isExposed(n.base.commandBar.originalCommandSet)&&i(this.resources.consume(n.base.commandBar.originalCommandSet))};r.prototype._getIsRobotApplicable=function(){if(v.isFeatureEnabled(v.EnableFirstRunExperienceRobot)&&this._dragAndDropRobotProvider){var e=this.itemSet(),t=e.item(),i=e.content().items,r=this.resources.consume(a.url);if((t.key===r.getRootItemKey()||this._robotRootOverride)&&!e.isPlaceholder&&!t.isPlaceholder&&!e.isExpired&&0===i.length){this._dragAndDropRobotProvider.setExperimentSeen();return!0}}return!1};r.prototype._computeIsGridBasedView=function(){var e=this.layoutType();return e===T.Grid||e===T.SingleAlbum};r.prototype._computeIsHeaderVisible=function(){return!this.inPageEditorUrl()&&(this.isTitleVisible()||!this.isEmptyView()&&this.isViewCommandBarVisible()||(this.breadcrumbBuilder?this.breadcrumbBuilder(this.item()).length>0:!!this.item().parent))};return r}(r.default)});define("@ms/odsp-shared/lib/utilities/knockout/AsyncComponentLoader",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/RequireJSErrorHandler","knockout"],function(e,t,i,r,o){"use strict";t.loadComponent=function(e,t,n){return new i.default(function(i,s){o.components.isRegistered(n)?o.components.get(n,i):e([t],i,function(e){r.default.log(e);s(e)})})}});define("odsp-next/bindings/contextMenu/ContextMenuHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r){"use strict";function o(e){return 8==(8&e.location)}return function(e){function t(t){var i=e.call(this,t)||this;i.items=t.items.filter(o);i.rootElementClass=t.rootElementClass||null;i.boundingElementClass=t.boundingElementClass||null;i.shouldHideIcons=!!t.shouldHideIcons;i.engagementSource=t.engagementSource||null;i.alignment=t.alignment;i.point=t.point;i.anchorElement=t.anchorElement;i.isMenuOpen=t.isMenuOpen;var r=t.dismissOnClick,n=void 0===r||r;i.dismissOnClick=n;return i}i.__extends(t,e);return t}(r.default)});define("odsp-next/bindings/contextMenu/ContextMenuBinding",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider","../dismiss/DismissBinding","./ContextMenuAlignment","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/math/Rectangle","../BaseBinding","../../providers/engagement/Engagement","../keyboard/KeyboardBinding","../../utilities/features/Features","@uifabric/utilities/lib/dom","../../utilities/dom/Dom","../../controls/contextualMenu/ContextualMenu"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;i.events.on(i.element,"contextmenu",i._onContextMenu);i._keyboardBinding=new(i.managed(h))({element:i.element,bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor,valueAccessor:function(){return{mappings:{ShiftF10:function(e,t){i._onContextMenu(t);return!0}},preventDefault:!0,context:i.bindingContext.$data}}});return i}i.__extends(t,e);t.createContextMenu=function(e,t,i,o){var l=null,u=t.anchorElement||b.findAncestor(e.target,t.rootElementClass);if(u&&t.items&&t.items.length>0){var m=void 0;if(t.anchorElement||e.clientX<=0&&e.clientY<=0||!Boolean(e.clientX)&&!Boolean(e.clientY)){var f=(t.anchorElement?t.anchorElement:e.target).getBoundingClientRect();m=new c.default(f.left,f.bottom)}else m=new c.default(e.clientX,e.clientY);var h=r.observable(m.x+"px"),y=r.observable(m.y+"px"),_=t.alignment||a.Left|a.Top;d.default.isRightToLeft&&(_|=a.Right);var S=null;if(t.boundingElementClass){var x=b.findAncestor(e.target,t.boundingElementClass);S=new p.default(x.getBoundingClientRect())}var I=document.createElement("div");I.style.position="absolute";I.style.top="0px";I.style.left="0px";l=I;document.body.appendChild(I);v.setVirtualParent(I,u);o||(o=function(){if(l){r.removeNode(l);l=null}});var w={component:{name:"ms-contextual-menu",params:{items:t.items,left:h,top:y,alignment:r.observable(_),offset:r.observable(t.point||c.default.ORIGIN),launchEvent:e,target:e.target,bounds:S,hideIcons:t.shouldHideIcons,fromKeyboardEvent:0===e.pointerId,anchorElement:t.anchorElement,close:t.dismissOnClick?o:null,isOpen:t.isMenuOpen}}};g.isFeatureEnabled(g.UseReactContextualMenu)||(w[n.getInstance().getUniqueKeyForBindingHandler(s.default,"dismiss")]={close:o,dismissOnResize:!0,dismissOnScroll:!0,isOpen:t.isMenuOpen});r.applyBindingsToNode(I,w,i)}return l};t.prototype._onContextMenu=function(e){var i=this,n=r.utils.unwrapObservable(this.valueAccessor()),s=(n&&n.resources||u.getCurrentResourceScope(this.bindingContext)).consume(l.itemsSelection),a=function(){if(t._contextMenu){r.removeNode(t._contextMenu);t._contextMenu=null}};a();var d=e.target,c=r.dataFor(d),p=null,m=null;if(o.default.hasClass(d,"noContextMenu")||e.shiftKey&&e instanceof MouseEvent||!n)return!0;for(var f=n.anchorElement||b.findAncestor(d,n.rootElementClass);d!==f&&c;){!m&&c.item&&(m=c.item);if(m)break;if((p=d?d.getAttribute("data-selection-index"):null)&&(m=s.getItemByIndex(p)))break;c=(d=v.getParent(d))?r.dataFor(d):null}var h=!1;if(s&&c){var g=null===s.maximumSelectedCount||void 0===s.maximumSelectedCount||s.maximumSelectedCount>0;if(!m||!s.isItemSelected(m)&&g){if(s.selectedCount()>0){s.clear();h=!0}else m&&(c.isSelected||p)&&(h=!0);if(h)var y=s.selection.subscribe(function(){y.dispose();f&&i._openMenu(e,n,a)});if(m&&(c.isSelected||p)){s.toggleItemSelected(m);s.setItemFocus(m)}}else m&&s.maximumSelectedCount<=0&&s.setItemFocus(m)}if(n){f&&!h&&this._openMenu(e,n,a);e.preventDefault();e.stopPropagation();return!1}return!0};t.prototype._openMenu=function(e,i,r){i.engagementSource&&this.resources.consume(f.resourceKey).logData({name:"RightClick."+i.engagementSource+".Click"});t._contextMenu=t.createContextMenu(e,i,this.bindingContext,r)};return t}(m)});define("odsp-next/controls/emptyFolder/odb/EmptyFolder",["require","exports","./EmptyFolderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../EmptyFolder.html","../EmptyFolder.css"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-odb-empty-folder",template:e("../EmptyFolder.html"),viewModel:i})});define("odsp-next/controls/emptyFolder/odb/EmptyFolderViewModel",["require","exports","tslib","../EmptyFolderViewModel","@ms/odsp-datasources/lib/Permissions","../../../resources/ControlResourceKeys","../EmptyFolder.resx","../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/utilities/caml/CamlParsingBasic"],function(e,t,i,r,o,n,s,a,l){"use strict";return function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;if(i.resources.isExposed(a.listContext)){var r=i.resources.consume(a.listContext);i.isDocLib=r&&r.isDocLib}i.resources.isExposed(n.currentView)&&(i._currentView=i.resources.consume(n.currentView));i._pageContext=i.resources.consume(a.pageContext);i._isItemSetRendered=i.resources.consume(n.isItemSetRendered);var o=t.layoutIterationObservable;if(Boolean(o)){o(o.peek()+1);i._isItemSetRendered(!0)}return i}i.__extends(t,e);t.prototype.hasInsertPermission=function(){var e=this.resources.consume(n.currentItem)();return o.PermissionMask.hasItemPermission(e,o.PermissionMask.insertListItems)};t.prototype.emptyFolderSubText=function(){return this._pageContext.listId?s.strings.spListEmptyFolderSubText:e.prototype.emptyFolderSubText.call(this)};t.prototype.hasSmartFiltersApplied=function(){var e=!1;if(this._currentView){var t=this._currentView.peek();if(t&&t.isDirty()){var i=t.getDomParts();e=l.containSmartFilters(i)}}return e};return t}(r.default)});define("odsp-next/controls/emptyFolder/EmptyFolderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../dataSources/url/QueryType","../../dataSources/url/odb/UrlQueryKeys","@ms/odsp-utilities/lib/string/StringHelper","./EmptyFolder.resx","../../dataSources/url/PageType","../../utilities/features/Features"],function(e,t,i,r,o,n,s,a,l,u,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IMAGES_SUBPATH="/images/emptyfolder/empty_";var m='<i class="EmptyFolder-icon ms-Icon ms-Icon--Add" ></i>',f=function(r){function f(i){void 0===i&&(i={});var a=r.call(this,i)||this,l=i.isViewOnly,u=void 0!==l&&l;a._isViewOnly=u;a._actionMap=a.resources.consume(o.actionMap);a._urlDataSource=a.resources.consume(n.url);a._viewParams=a.resources.consume(o.viewParams);a._item=a.resources.consume(o.currentItem);a.resources.isExposed(s.userInfo)&&(a._userInfoProvider=a.resources.consume(s.userInfo));a._mediaBaseUrl=e.toUrl(a.resources.consume(n.settings).mediaBaseUrl+t.IMAGES_SUBPATH);a._currentPage=a._urlDataSource.getPageType();a._content=a.createPureComputed(a._computeContent);a.subTextPart2=a.createPureComputed(function(){return a._content().subTextPart2});a.subTextUrl=a.createPureComputed(function(){return a._content().subTextPart2Url});a.subText=a.createPureComputed(function(){return a._content().subText});a.subTextPostIcon=a.createPureComputed(function(){return a._content().subTextPostIcon});a.subTextMobile=a.createPureComputed(function(){return a._content().subTextMobile||a._content().subText});a.title=a.createPureComputed(function(){return a._content().title});a.url=a.createPureComputed(function(){return a._content().url});a.altText=a.createPureComputed(function(){return a._content().altText||""});a.isDocLib=!0;return a}i.__extends(f,r);f.prototype.navigateToSubTextUrl=function(){new(this.managed(this._actionMap.NavigationAction))({url:this.subTextUrl,target:"blank"}).execute({});return!1};f.prototype.hasInsertPermission=function(){return!this._isViewOnly};f.prototype.emptyFolderSubText=function(){return d.strings.emptyFolderSubText};f.prototype.hasSmartFiltersApplied=function(){return!1};f.prototype._computeContent=function(){var e,t=this._item(),i=t.queryType,r=this.hasInsertPermission();switch(i){case a.Recent:e={url:this._mediaBaseUrl+"recent.svg",title:d.strings.emptyRecentTitle,subText:d.strings.emptyRecentSubText};break;case a.RecycleBin:case a.SecondStageRecycleBin:e={url:this._mediaBaseUrl+"recycle.svg",title:d.strings.emptyRecycleBinTitle,subText:d.strings.emptyRecycleBinSubText};break;case a.Search:var o=this._currentPage===c.Photos,n=void 0;n=o?d.strings.emptyPhotosSearchSubText:this.isDocLib?d.strings.emptySearchSubTextV2Part1:d.strings.emptyListSearchSubText;e={url:this._mediaBaseUrl+"search.svg",title:d.strings.emptySearchTitle,subText:n,subTextPart2:o||!this.isDocLib?void 0:d.strings.emptySearchSubTextV2Part2,subTextPart2Url:o||!this.isDocLib?void 0:this._urlDataSource.getRecentQueryUrl()};break;case a.SharedWithMe:e={url:this._mediaBaseUrl+"shared.svg",title:d.strings.emptySharedTitle,subText:d.strings.emptySharedSubText};break;case a.DocsInCommon:e={url:this._mediaBaseUrl+"shared.svg",title:d.strings.emptyDocsInCommonTitle,subText:d.strings.emptyDocsInCommonSubText};break;case a.Subsites:e=this._getSearchContentOrDefault(d.strings.emptySubsitesTitle);break;case a.Apps:e=this._getSearchContentOrDefault(d.strings.emptyAppsTitle);break;case a.Popular:e=this._getSearchContentOrDefault(d.strings.emptyPopularTitle);break;case a.ExternallyShared:e=this._getSearchContentOrDefault(d.strings.emptyExternallySharedTitle);break;case a.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:for(var s=!1;t&&t.parent;){"Music"===t.specialFolderCanonicalName&&(s=!0);t=t.parent}if(s){e={url:this._mediaBaseUrl+"music.svg",title:d.strings.emptyMusicFolderTitle,subText:r&&d.strings.emptyMusicFolderSubText||"",subTextMobile:r&&u.format(d.strings.emptyMusicFolderMobileSubText,m)||""};if(this._userInfoProvider&&p.isFeatureEnabled(p.EmptyMusicFolderGrooveStrings)){var l=this._userInfoProvider.getMarket();l=l&&l.toLowerCase();if(this._isGrooveAvailable(l)){e.title=d.strings.emptyGrooveMusicFolderTitle;e.subText=r&&d.strings.emptyGrooveMusicFolderSubText||""}}break}if(this.hasSmartFiltersApplied()){e={url:this._mediaBaseUrl+"filter.svg",title:d.strings.emptyFilterResultTitle,subText:d.strings.emptyFilterResultSubText,altText:d.strings.emptyFilterResultAltText};break}e=this._item().isRootFolder&&!this.isDocLib?{url:this._mediaBaseUrl+"list.svg",title:d.strings.emptyListTitle,subText:d.strings.emptyListSubText,altText:d.strings.emptyListDefaultAltText}:{url:this._mediaBaseUrl+"folder.svg",title:d.strings.emptyFolderTitle,subText:r&&this.emptyFolderSubText()||"",subTextMobile:r&&u.format(d.strings.emptyFolderMobileSubText,m)}}e.altText||(e.altText=d.strings.emptyFolderDefaultAltText);return e};f.prototype._getSearchContentOrDefault=function(e){return this._viewParams()[l.default.queryParamKey]?{url:this._mediaBaseUrl+"search.svg",title:d.strings.emptySearchTitle,subText:""}:{title:e,url:"",subText:""}};f.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams();switch(this._urlDataSource.getPhotoType(t)){case 5:e={url:this._mediaBaseUrl+"album.svg",title:d.strings.emptyAlbumsListTitle,subText:d.strings.emptyAlbumsListSubText};break;case 1:e={url:this._mediaBaseUrl+"albumview.svg",title:d.strings.emptyAlbumsListTitle,subText:d.strings.emptyAlbumsListSubText};break;case 2:e={url:this._mediaBaseUrl+"tags.svg",title:d.strings.emptyPhotosTagsTitle,subText:u.format(d.strings.emptyPhotosTagsSubTextFormat,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>")};break;case 3:e={url:this._mediaBaseUrl+"photos.svg",title:d.strings.emptyAllPhotosTitle,subText:""};break;case 9:e={url:this._mediaBaseUrl+"onthisday.svg",title:d.strings.emptyOnThisDayTitle,subText:""};break;default:e={url:this._mediaBaseUrl+"photos.svg",title:d.strings.emptyAllPhotosTitle,subText:""}}return e};f.prototype._isGrooveAvailable=function(e){var t=["ar","au","at","be","br","ca","dk","fi","fr","de","ie","it","mx","nl","nz","no","pt","es","se","ch","gb","us"],i=e.split("-")[1]||e;return t.indexOf(i)>-1};return f}(r.default);t.default=f});define("odsp-next/controls/emptyFolder/EmptyFolder.html",[],function(){return'<div class=EmptyFolder>\x3c!--ko if: url--\x3e<div class=EmptyFolder-image><img id=emptyFolderImg data-bind="attr: { src: url, alt: altText }"></div>\x3c!--/ko--\x3e<div class=EmptyFolder-title data-bind="text: title"></div>\x3c!--ko if: subText || subTextMobile--\x3e<div class=EmptyFolder-subText><span class=EmptyFolder-pc data-bind="html: subText"></span> <span class=EmptyFolder-mobile data-bind="html: subTextMobile"></span>\x3c!--ko if: subTextPart2--\x3e<span class=EmptyFolder-subTextPart2><a class=EmptyFolder-subTextPart2Link data-bind="html: subTextPart2, click: navigateToSubTextUrl"></a></span>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/emptyFolder/EmptyFolder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.EmptyFolder{text-align:center}.EmptyFolder-image{padding-top:52px;height:208px;width:208px;margin:0 auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title{padding:16px 16px 0 16px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;max-width:400px;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';margin:0 auto}html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0 16px}.md .EmptyFolder-title,.sm .EmptyFolder-title{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.EmptyFolder-subText{padding:6px 16px 0 16px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;max-width:400px;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 auto}html[dir=rtl] .EmptyFolder-subText{padding:6px 16px 0 16px}.EmptyFolder-icon{display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}.EmptyFolder-subTextPart2Link{cursor:pointer}"}])});define("odsp-next/controls/appView/AppView",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AppViewViewModel","./AppView.html","./AppView.css","../overlays/Overlay"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-appView",template:e("./AppView.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/appView/AppViewViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","../../bindings/element/ElementBinding","../../utilities/features/Features","./AppView.resx","../../resources/ControlResourceKeys","../../resources/SPOResourceKeys","../loadingSpinner/LoadingSpinner","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/powerApps/PowerAppsStore"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i.addBindingHandlers({bindableHtml:s,element:a});i.resx=u.strings;i._actionMap=i.resources.consume(d.actionMap);i.progressSpinnerFlatTagName=m.default.tagName;i.loadingSpinnerTagName=p.tagName;i.isProcessing=i.resources.expose(c.appViewChangeInProgress,r.observable(!1));i.errorMessage=i.resources.expose(c.appViewErrorMessage,r.observable(""));i.appSyncErrorMessage=r.observable("");i._currentView=i.resources.consume(d.currentView);i._powerAppsStore=i.resources.consume(h.typeResourceKey);i.appViewTitle=i.createComputed(function(){return i._currentView().title});i.appViewAuthor=r.observable("");var o=i.resources.consume(c.listContext);i.userHasManagementRights=r.observable(!!(o&&o.permissions&&o.permissions.manageLists));i.userHasNoAccess=r.observable(!1);i.appViewExists=r.observable(!0);i.errorRemediationLinkText=r.observable("");i.onRemediationLinkClick=r.observable(null);i._appViewRuntimeUrl=r.observable("");var n=i.resources.consume(d.actionMap);i._deleteViewAction=new(i.managed(n.DeleteViewAction))({isProcessing:i.isProcessing});i._targetWindowName="openAppView"+Math.floor(12345*Math.random());i._launchAppViewAction=new(i.managed(n.NavigationAction))({url:i._appViewRuntimeUrl,target:i._targetWindowName});i._syncedView=r.observable(null);i._appViewInfo=r.observable(null);i._silentAppSync=r.observable(!0);i.isLoading=r.observable(!0);i._synchronizeAppViewAction=new(i.managed(n.SynchronizeAppViewAction))({view:i._syncedView,appViewInfo:i._appViewInfo,silentSync:i._silentAppSync,isProcessing:i.isLoading});var l=null,f=function(){if(134217728===i._currentView.peek().viewType&&i._currentView.peek().id!==l){i.initSyncAppViewSettings();i.errorMessage("");if(i._powerAppsStore.recentlyCreatedViews.indexOf(i._currentView.peek().id)>=0){i.isLoading(!1);i.updateAppViewDetails()}else i._synchronizeAppViewAction.execute(null).then(function(){i.updateAppViewDetails();i.handleSynchronizeAppViewResult();i.loadPowerApp(!0)});l=i._currentView.peek().id}};i.subscribe(i._currentView,f);f();var g=t.layoutIterationObservable;g&&g(g.peek()+1);return i}i.__extends(t,e);t.prototype.loadPowerApp=function(e,t){var i=this,r=this._syncedView(),o=function(){if(!i.errorMessage.peek()&&r&&r.visualizationInfo&&r.visualizationInfo.VisualizationAppInfo&&r.visualizationInfo.VisualizationAppInfo.Id){var o=r.visualizationInfo.VisualizationAppInfo.Id;i._appViewRuntimeUrl(h.getPowerAppRunTimeUrl(o));l.isFeatureEnabled(l.EmbeddedPowerApps)&&l.isFeatureEnabled(l.AuthZenJSTokenEndpoint)?i._launchEmbeddedPowerApp(r):e||i._launchAppViewAction.execute(t)}};if(r)o();else if(!e){window.open("",this._targetWindowName);this._synchronizeAppViewAction.execute(t).then(function(){i.updateAppViewDetails();i.handleSynchronizeAppViewResult();r=i._syncedView();o()})}};t.prototype.onLaunchButtonClick=function(e,t){this.loadPowerApp(!1,t)};t.prototype.onRemoveViewClick=function(e,t){var i=this;this._deleteViewAction.execute(t).then(function(e){e&&e.resultType!==f.ResultTypeEnum.Success&&i.errorMessage(i.resx.AppViewOperationFailureText)})};t.prototype.initSyncAppViewSettings=function(){this._syncedView(null);this._silentAppSync(!0);this._appViewInfo(null)};t.prototype.onRequestViewAccessClick=function(e,t){};t.prototype.handleSynchronizeAppViewResult=function(){if(!this._syncedView()){this.appViewExists(!1);this.errorMessage(o.format(this.resx.AppViewTwoSentences,this.resx.AppViewNotFoundMessage1,this.resx.AppViewNotFoundMessage2));this.errorRemediationLinkText(this.resx.AppViewRemoveLongActionText);this.onRemediationLinkClick(this.onRemoveViewClick)}if(!this.errorMessage.peek()&&this.userHasNoAccess()){this.errorMessage(o.format(this.resx.AppViewTwoSentences,this.resx.AppViewNoAccessMessage1,this.resx.AppViewNoAccessMessage2));this.errorRemediationLinkText(this.resx.AppViewRequestAccessActionText);this.onRemediationLinkClick(this.onRequestViewAccessClick)}};t.prototype.updateAppViewDetails=function(){var e=this._appViewInfo.peek();if(e){this.appSyncErrorMessage("");this.appViewExists(!0);e.author&&this.appViewAuthor(o.format(this.resx.AppViewAuthorLabel,e.author))}else this.appSyncErrorMessage(this.resx.AppViewSynchronizationFailureText)};t.prototype._launchEmbeddedPowerApp=function(e){var t="/providers/Microsoft.PowerApps/apps/"+e.visualizationInfo.VisualizationAppInfo.Id;if(this.powerAppParams&&this.powerAppParams.appId===t)this._powerAppsStore.showAppView(!0);else{this.powerAppParams={title:e.title,appId:t,appInfo:this._appViewInfo.peek().synchronizationDataObject,appRunTimeUrl:this._appViewRuntimeUrl.peek()};this._powerAppsStore.createAppView(this.powerAppParams)}};return t}(n.default);t.default=g});define("odsp-next/bindings/html/BindableHtmlBinding",["require","exports","tslib","../BaseBinding","knockout"],function(e,t,i,r,o){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;i.controlsDescendantBindings=!0;i.createComputed(i._computeRefreshChildElements);return i}i.__extends(t,e);t.prototype._computeRefreshChildElements=function(){var e=o.unwrap(this.valueAccessor());o.virtualElements.emptyNode(this.element);this.element.innerHTML=e;o.applyBindingsToDescendants(this.bindingContext,this.element)};return t}(r)});define("odsp-next/models/powerApps/PowerAppsStore",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){function r(){var e=t.call(this)||this;e._initialized=!1;e.recentlyCreatedViews=[];e.appView=e.createObservable(null);e.appForm=e.createObservable(null);e.showAppView=e.createObservable(!1);e.showAppForm=e.createObservable(!1);e.formData=e.createObservable(null);return e}i.__extends(r,t);r.prototype.createAppForm=function(e){var t=this;this.loadPowerAppJs(function(){t.appForm(e)})};r.prototype.setAndShowAppForm=function(e,t){this.formData({item:this.createObservable(e),type:this.createObservable(t)});this.showAppForm(!0)};r.prototype.createAppView=function(e){var t=this;this.loadPowerAppJs(function(){t.appView(e)})};r.prototype.loadPowerAppJs=function(t){var i=this;if(this._initialized)t&&t();else{requirejs.config({paths:{"power-app":"power-app"},shim:{"power-app":{exports:"WebPlayer"}}});e(["power-app"],function(e){i._initialized=!0;t&&t()})}};return r}(r.default);t.default=s;t.POWERAPPS_PROD_ENV_RUNTIME="https://web.powerapps.com";t.POWERAPPS_TEST_ENV_RUNTIME="https://tip1.web.powerapps.com";t.getPowerAppRunTimeUrl=function(e){return(n.isFeatureEnabled(n.PowerAppsAndAndProcessSimpleTestEnvironment)?t.POWERAPPS_TEST_ENV_RUNTIME:t.POWERAPPS_PROD_ENV_RUNTIME)+"/apps/"+e+"?source=sharepoint"};t.typeResourceKey=new o.ResourceKey({name:e("module").id,factory:new o.SimpleResourceFactory(s)})});define("odsp-next/controls/appView/AppView.html",[],function(){return'<div class=od-AppView><i class="ms-Icon ms-Icon--PowerApps od-AppView-icon"></i><div class="ms-font-xxl od-AppView-title" data-bind="text: appViewTitle"></div>\x3c!--ko if: isLoading--\x3e<div class="ms-font-m od-AppView-appSyncDetail od-ClientFormFields-loadingSpinner" data-bind="component: {name: loadingSpinnerTagName, params: {loadingText: resx.AppViewLoadingMessage}}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: isLoading() || appSyncErrorMessage()--\x3e<div class="ms-font-m od-AppView-appSyncDetail" data-bind="text: appViewAuthor"></div>\x3c!--/ko--\x3e\x3c!--ko if: appSyncErrorMessage()--\x3e<div class="ms-font-m od-AppView-appSyncDetail" data-bind="text: appSyncErrorMessage"></div>\x3c!--/ko--\x3e<div class="od-AppView-section od-AppView-mainButtonArea"><button class="od-Dialog-action od-Button od-Button--primary od-AppView-launchButton" data-bind="disable: errorMessage() || isLoading(), click: onLaunchButtonClick"><span data-bind="text: resx.LaunchButtonText" class=od-Button-label></span></button></div>\x3c!--ko if: appViewExists()--\x3e<div class=od-AppView-additionalActions>\x3c!--ko if: userHasManagementRights()--\x3e<div class=od-AppView-progressSpinnerContainer>\x3c!--ko if: isProcessing--\x3e<div class=od-appView-progressSpinner data-bind="component: { name: progressSpinnerFlatTagName }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: errorMessage()--\x3e<div class=od-AppView-appViewError><div class=od-AppView-errorIcon><i class="ms-Icon ms-Icon--ErrorBadge"></i></div><div class=od-AppView-errorMessageArea><div data-bind="text: errorMessage"></div><a href=javascript:; class=od-AppView-remediationLink data-bind="text: errorRemediationLinkText, event: { click: onRemediationLinkClick() }"></a></div></div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/appView/AppView.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-AppView{max-width:380px;margin:auto;padding-top:60px;text-align:center;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-AppView-icon{font-size:40px;color:#742774}.od-AppView-title{margin-top:10px}.od-AppView-appSyncDetail{margin-top:8px}.od-AppView>.od-ClientFormFields-loadingSpinner{padding:0}.od-AppView-additionalActions,.od-AppView-appViewError{padding-top:24px}.od-AppView-section{padding-top:20px}.od-AppView-progressSpinnerContainer{height:6px}.od-AppView-launchButton{outline:0}.od-AppView a,.od-AppView a:visited{cursor:pointer;text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-AppView a:hover,.od-AppView a:visited:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-AppView-errorIcon,.od-AppView-errorMessageArea{display:inline-block;vertical-align:top}.od-AppView-errorIcon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:21px}[dir=ltr] .od-AppView-errorIcon{padding-right:5px}[dir=rtl] .od-AppView-errorIcon{padding-left:5px}.od-AppView-errorMessageArea{padding-top:5px}.od-AppView-remediationLink{margin-top:10px}.od-AppView-loadingOverlay.ms-ModalOverlay{position:fixed;top:50px;z-index:600}.od-AppView-loadingText{position:fixed;cursor:pointer;top:40%;width:100%;z-index:600;text-align:center}[dir=ltr] .od-AppView-loadingText{left:0}[dir=rtl] .od-AppView-loadingText{right:0}.od-AppView-loadingText>span{font-size:30px}"}])});define("odsp-next/controls/error/Error",["require","exports","./ErrorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Error.html","./Error.css"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-error",template:e("./Error.html"),viewModel:i,synchronous:!0})});define("odsp-next/controls/error/ErrorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","../../dataSources/item/ItemDataSource.resx","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/string/StringHelper","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,r,o,n,s,a,l,u){"use strict";var d=n.strings,c="/images/error/error",p="accessremoved",m="2.svg";return function(t){function r(i){var r=t.call(this,i)||this,n=i.error;r._navigation=r.resources.consume(u.navigation);r._settingsDataSource=r.resources.consume(o.settings);r.errorTitle=n&&n.errorTitle||d.DefaultTitle;r.errorDetailedText=n&&n.errorDetailedText;r.errorHtml=n&&n.errorDetailedHtml;r.errorDetailedText||r.errorHtml||(r.errorDetailedText=d.DefaultSubText);var f=r.resources.consume(l.error).getAction();r.actionText=f.text;r.actionUrl=f.url;r.showAction=!f.hideButton;r.showErrorCode=n&&n.errorCode&&r.errorTitle===d.DefaultTitle;if(r.showErrorCode){s.default.log(n,"ServerError",n.errorCode);r.errorCodeText=a.format(d.errorCodeText,n.errorCode)}else r.errorCodeText="";n&&n.correlationId?r.correlationIdText=a.format(d.errorCorrelationIdText,n.correlationId):r.correlationIdText="";r._mediaBaseUrl=e.toUrl(r._settingsDataSource.mediaBaseUrl+c);if(n.errorCode===p){r.isAccessRemoved=!0;r.imageUrl=r._mediaBaseUrl+m}else{r.isAccessRemoved=!1;r.imageUrl=r._getRandomImage()}return r}i.__extends(r,t);r.prototype.onButtonClick=function(){this.showAction&&this._navigation.navigateTo(this.actionUrl);return!1};r.prototype._getRandomImage=function(){var e=Math.ceil(4*Math.random());return this._mediaBaseUrl+e+".svg"};return r}(r.default)});define("odsp-next/controls/error/Error.html",[],function(){return'<div class=od-Error><div class=od-Error-image><img data-bind="attr:{src: imageUrl}"></div><div class=od-Error-title data-bind="text: errorTitle"></div>\x3c!--ko if: errorDetailedText--\x3e<div class=od-Error-subText data-bind="text: errorDetailedText, css: { \'od-Error-subtext--accessremoved\': isAccessRemoved }"></div>\x3c!--/ko--\x3e\x3c!--ko if: errorHtml--\x3e<div class=od-Error-subText data-bind="html: errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if: showAction--\x3e<form class=od-Error-button data-bind="attr:{action: actionUrl}" method=get><button class=od-Button data-bind="click: onButtonClick" type=submit><span class=od-Button-label data-bind="text: actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code ms-font-s" data-bind="visible: correlationIdText, text: correlationIdText"></div><div class="od-Error-code ms-font-s" data-bind="visible: showErrorCode, text: errorCodeText"></div></div>'});define("odsp-next/controls/error/Error.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:208px;margin:0 auto}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:168px}.od-Error-title{padding:16px 16px 0 16px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;max-width:400px;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.od-Error-subText{padding:6px 16px 0 16px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;max-width:400px;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:';-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.od-Error-button{padding-top:16px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}'}])});define("odsp-next/controls/dragAndDrop/DropHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../providers/operator/UploadOperator.key","../../providers/moveCopy/MoveCopyProvider","../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../providers/item/ShortcutProvider","@ms/odsp-utilities/lib/uri/Uri","../../providers/engagement/Engagement","../../resources/ControlResourceKeys","../../pages/files/spo/itemSetProjections/PostUploadProjectionHelper","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemMetadataOperatorTypeResourceKey=new I.ResourceKey({name:e("module").id+".updateItemMetadataOperator",loader:new I.AliasResourceLoader(function(){return x.loadModuleExport({path:"../../providers/operator/UpdateItemMetadataOperator",require:e,getExport:function(e){return e.typeResourceKey}})})});var w=function(r){function d(e,t){var i=r.call(this,e,t)||this;i._moveCopyProvider=t.moveCopyProvider;i._dialogProvider=t.dialogProvider;i._urlDataSource=t.urlDataSource;i._shortcutProvider=t.shortcutProvider;i._currentItemSet=t.currentItemSet;i._engagement=t.engagement;i._postUploadProjectionHelper=t.postUploadProjectionHelper;i._uploadBlockAction=new(i.managed(t.actionMap.UploadBlockAction))({isDragAndDrop:!0});return i}i.__extends(d,r);d.prototype.processDrop=function(i,r,o,d){var p=this;void 0===o&&(o=!1);void 0===d&&(d=!1);if(!r||!r.isDropEnabled||r===i.item)return!1;if(i.metadata&&i.itemSet){var m=i.itemSet.content.peek().groupings;i.metadata.itemGroups=m&&m.length&&m[0].itemGroups}var v=this._engagement;if(0===i.type){v.logData({name:"DragAndDropEvent"});x.loadModule({require:e,path:"../../utilities/optimizely/ExperimentsCommon"}).then(function(e){(new(p.managed(e))).fireUploadEvents()});if(this._uploadBlockAction.isAvailable.peek()){this._uploadBlockAction.execute(null);return!1}var y=this._currentItemSet.peek();this.resources.consumeAsync(c.asyncTypeResourceKey).then(function(e){var t=new e({files:i.files,parentItem:r,itemSet:y,wasDragAndDropped:!0,type:i.uploadType,metadata:i.metadata,skipInvalidation:!!o});p.trackPromise(t.start());return t.wait()}).done(null,function(e){f.default.log(e)});return!0}if(1===i.type){if(Boolean(i.metadata)&&Boolean(i.metadata.group)){this._resolveSelection(i).then(function(e){var c=new u.Action({name:"DragChangeGroup",pageType:a[p._urlDataSource.getPageType()],queryType:l[p._urlDataSource.getQueryType()]}),m=[],v=i.metadata.group;o&&e.forEach(function(e){var t=h.deepCopy(e);if(!d){var i=g.deserializeQuery(t.key);i.group=v.groupingId;t.key=g.serializeQuery(i)}t.state.upload.status=1;t.properties[v.fieldSchema.Name]=v.groupingId;m.push(p.createObservable(t));e.state.removing=!0});p.resources.consumeAsync(t.updateItemMetadataOperatorTypeResourceKey).then(function(t){var n=new t({items:e,metadata:i.metadata,parentItem:r,skipInvalidation:o,onComplete:function(e){e?o&&p._postUploadProjectionHelper.updateItemSetPostUpload(i.itemSet,m,v):alert("failure updating metadata")}});p.trackPromise(n.start());return n.wait()}).done(void 0,function(e){return f.default.log(e)});var b={},y={count:e.length};if(1===e.length){b.fileType=n[e[0].type];b.extension=e[0].extension||""}c.end({resultType:s.ResultTypeEnum.Success,extraData:b,extraMetrics:y})}).done(null,function(e){return f.default.log(e)});return!0}if(i.itemSet.item.peek().key===r.key)return!1;this._resolveSelection(i).then(function(e){e=e.filter(function(e){return e!==r});var t=new u.Action({name:"DragMove",pageType:a[p._urlDataSource.getPageType()],queryType:l[p._urlDataSource.getQueryType()]});return p._moveCopyProvider.copyItems({items:e,parentKey:i.item.parentKey,targetId:r.id,targetKey:r.key,cid:p._urlDataSource.getOwnerId(),group:r.isGroup?1:0,isAsync:!1,isMove:!0}).then(function(){var i={},r={count:e.length};if(1===e.length){i.fileType=n[e[0].type];i.extension=e[0].extension||""}t.end({resultType:s.ResultTypeEnum.Success,extraData:i,extraMetrics:r})},function(){t.end({resultType:s.ResultTypeEnum.Failure})})}).done(null,function(e){return f.default.log(e)});return!0}if(3===i.type&&this._shortcutProvider){v.logData({name:"Link.DragAndDrop.Drop"});var _=i.links.split("\n");(_=_.filter(function(e){return"#"!==e.charAt(0)})).forEach(function(e){var t=new b.default(e).getHost()+".url";p._shortcutProvider.createShortcut(r.key,t,e)});return!0}};d.prototype._resolveSelection=function(e){return e.selection?e.selection.resolve().then(function(t){t&&0!==t.length||(t=[e.item]);return t}):o.default.wrap([e.item])};return d}(r.default);w.dependencies=i.__assign({},r.default.dependencies,{moveCopyProvider:p.resourceKey,dialogProvider:m.resourceKey,shortcutProvider:v.resourceKey.optional,urlDataSource:d.url,actionMap:_.actionMap,currentItemSet:_.currentItemSet,postUploadProjectionHelper:S.resourceKey,engagement:y.resourceKey});t.DropHelper=w;t.resourceKey=I.createDefaultResourceKey(e,w);t.default=w});define("odsp-next/providers/operator/UploadOperator.key",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.asyncTypeResourceKey=new r.ResourceKey({name:""+e("module").id,loader:new r.AliasResourceLoader(function(){return i.loadModuleExport({path:"./UploadOperator",require:e,getExport:function(e){return e.typeResourceKey}})})})});define("odsp-next/pages/files/spo/itemSetProjections/PostUploadProjectionHelper",["require","exports","../../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._itemProvider=t.itemProvider}e.prototype.updateItemSetPostUpload=function(e,t,i){if(e&&t&&t.length>0){var r=e.item.peek().key,o=this._itemProvider.computeProjectedItemSet(r+"&state=postUpload",e,{parentKey:r,itemSetProjections:{PostUpload:{uploadedItems:t,group:i}}},!0);o&&e.content({groupings:o.content.peek().groupings,items:o.content.peek().items})}};return e}();t.default=o;t.resourceKey=r.createDefaultResourceKey(e,o,{itemProvider:i.resourceKey})});define("odsp-next/controls/infoPane/InfoPane.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./InfoPane",require:e,getExport:function(e){return e.resourceKey.local}})})});t.default=t.resourceKey});define("odsp-next/dataSources/upload/UploadProcessorType",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.Html5file=0]="Html5file";e[e.Folder=1]="Folder"}(i||(i={}));return i});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint",["require","exports","./DragAndDropHintViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DragAndDropHint.html","./DragAndDropHint.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-drag-and-drop-hint",template:e("./DragAndDropHint.html"),viewModel:i.default});t.default=o});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHintViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../dataSources/upload/UploadProcessorType","../DragAndDrop.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/engagement/Engagement","../../../utilities/features/Features","@ms/odsp-utilities/lib/modules/Modules","../../../resources/UtilityResourceKeys","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f="DragAndDropRobot",h=function(t){function r(i){var r=t.call(this,i)||this;r._actionMap=r.resources.consume(c.actionMap);r._isItemSetRendered=r.resources.consume(c.isItemSetRendered);r._platformDetection=r.resources.consume(s.platformDetection);var l=r.resources.consume(p.settings);r._bundleLoader=r.resources.consume(m.bundleLoader);r._experimentHelper=r.resources.consume(d.experimentHelper.optional);var u=r.resources.consume(a.resourceKey),h=new(r.managed(r._actionMap.UploadAction))({uploadProcessorType:o.Html5file});r._isUploadAvailable=h.isAvailable();r._isFirstRunExperienceVisible=r.resources.consume(c.isFirstRunExperienceVisible);r.isGridView=i.isGridView;r.isRobotVisible=i.isRobotVisible;if(r.isRobotVisible){r.createBackgroundComputed(r._computeShowRobotAnimation);r.robotImageUrl=r.createPureComputed(r._computeRobotImageUrl)}r.showDropHint=r.createPureComputed(r._computeShowDropHint);r.dropSuggestionText=r.isRobotVisible?n.strings.DragAndDropHintEmptyRobotText:n.strings.DragAndDropHintText;r.fileImageUrl=e.toUrl(l.mediaBaseUrl+"/images/odrobot/dragfilegrid.svg");r.isAnimationApplicable=!1;r.isAnimationClassApplicable=r.createObservable(!1);r.isReady=r.createObservable(!1);r.createBackgroundComputed(function(){r.showDropHint()&&r.isRobotVisible&&u.logData({name:f+".Show",extraData:{isGridView:r.isGridView}})});return r}i.__extends(r,t);r.prototype._computeShowRobotAnimation=function(){var t=this,i=this._bundleLoader.getBundleInfo(1).isLoaded();this._bundleLoader.loadNow("odsp-next/utilities/dragAndDropRobot/DragAndDropAnimationHelper").then(function(){if(i){var r=t.resources.consume(m.dragAndDropAnimation);u.loadModule({require:e,path:"../../../utilities/optimizely/experiments/DragAndDropAnimation"}).then(function(e){if(r.getInitialized()||!t.isRobotVisible||t._isFirstRunExperienceVisible()){if(r.getInitialized()&&8249797602===r.getOptimizelyVariationId()()){t.isAnimationApplicable=!0;t.isReady(!0);t._setAnimationTimer()}}else t._experimentHelper.activateExperimentBehindFeature(l.DragAndDropRobotAnimation,e.ANIMATION_EXPERIMENT_ID).then(function(e){if(e){r.setOptimizelyVariationId(e);r.setIsInitialized(!0);r.setIntializeTime();if(8249797602===e){t.isAnimationApplicable=!0;t._setAnimationTimer()}}t.isReady(!0)})})}})};r.prototype._computeShowDropHint=function(){return this._isUploadAvailable&&!this._platformDetection.isMobile&&this._isItemSetRendered()&&this.isRobotVisible&&this.isReady()};r.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)};r.prototype._computeRobotImageUrl=function(){var t;if(this.isReady()){t=this.isGridView?"/images/odrobot/robottilev2":"/images/odrobot/robotlistv2";this.isAnimationApplicable?t+=".gif":t+=".svg";return"url('"+e.toUrl(this.resources.consume(p.settings).mediaBaseUrl+t)+"')"}return""};return r}(r.default);t.default=h});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.html",[],function(){return"\x3c!--ko if: showDropHint()--\x3e<div class=od-DragAndDropHint data-bind=\"css: { 'od-DragAndDropHint--grid': isGridView, 'ms-slideLeftIn40': isAnimationClassApplicable() && isGridView, 'ms-slideUpIn20': isAnimationClassApplicable() && !isGridView, 'is-animating': isReady() && (isAnimationApplicable && !isAnimationClassApplicable()) }\"><div class=od-DragAndDropHint-box data-bind=\"css: { 'od-DragAndDropHint-box--grid': isGridView, 'od-DragAndDropHint-box--robot': isRobotVisible }\">\x3c!--ko if: isGridView--\x3e<div class=od-DragAndDropHint-fileContainer><img class=od-DragAndDropHint-file data-bind=\"attr: { src: fileImageUrl }\"></div>\x3c!--/ko--\x3e<div class=od-DragAndDropHint-text data-bind=\"text: dropSuggestionText, css: { 'od-DragAndDropHint-text--grid': isGridView }\"></div></div>\x3c!--if: isRobotVisible()--\x3e<div class=od-DragAndDropHint-robot data-bind=\"style: { 'background-image': robotImageUrl }, css: { 'od-DragAndDropHint-robot--grid': isGridView, 'od-DragAndDropHint-robotAnimation': isReady() && isAnimationApplicable }\"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e"});define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-DragAndDropHint-box{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;position:absolute;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"}])});define("odsp-next/controls/listFooter/ListFooter",["require","exports","./ListFooterViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ListFooter.html","./ListFooter.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-list-footer",template:e("./ListFooter.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/listFooter/ListFooterViewModel",["require","exports","tslib","./ListFooter.resx","../../resources/ControlResourceKeys","../dragAndDrop/dragAndDropHint/DragAndDropHint","../../utilities/features/Features","../../providers/item/ItemProvider","../../models/itemSet/ItemSetMonitor","@ms/odsp-shared/lib/base/ViewModel","../../resources/ProviderResourceKeys"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){var i=e.call(this,t)||this;i._actionMap=i.resources.consume(o.actionMap);i._isItemSetRendered=i.resources.consume(o.isItemSetRendered);i._itemProvider=i.resources.consume(a.resourceKey);i._itemSetMonitor=i.resources.consume(l.resourceKey);i._recycleBinProvider=i.resources.consume(d.recycleBin.optional);i.dragAndDropHintTagName=n.default.tagName;i.recycleBinLink=r.strings.RecycleBinLink;i.recycleBinText=r.strings.RecycleBinText;i.isVisible=i.createPureComputed(i._computeShowListFooter);i._recycleBinItem=i.createPureComputed(i._computeRecycleBinItem);i._openRecycleBinAction=new(i.child(i._actionMap.DefaultClickAction))({sourceEngagement:"ListFooter.OpenRecycleBin.Click",item:i._recycleBinItem});i.showRecycleBinInFooter=i.createPureComputed(i._computeShowRecycleBinInFooter);i.dragAndDropHintComponent=t.dragAndDropHintComponent;return i}i.__extends(t,e);t.prototype.onRecycleBinClick=function(e,t){this._openRecycleBinAction.execute(t).done()};t.prototype._computeRecycleBinItem=function(){var e=this._itemSetMonitor.itemSet();e.content();return!e.isPlaceholder&&this._recycleBinProvider?this._recycleBinProvider.getRecycleBinItem(this._itemSetMonitor.item.peek()):null};t.prototype._computeShowListFooter=function(){var e=this._itemSetMonitor.itemSet();e.content();return this._isItemSetRendered()&&!e.isPlaceholder};t.prototype._computeShowRecycleBinInFooter=function(){return s.isFeatureEnabled(s.RecycleBinListFooter)&&this._openRecycleBinAction.isAvailable()};return t}(u.default);t.default=c});define("odsp-next/models/itemSet/ItemSetMonitor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t,i){var r=e.call(this,t,i)||this,n=i.itemSet;r.itemSet=n;r.item=r.createPureComputed(r._computeItem);r.item.equalityComparer=o.objectStrictEquality;r.isEmpty=r.createPureComputed(r._computeIsEmpty);r.hasItems=r.createPureComputed(r._computeHasItems);r.hasName=r.createPureComputed(r._computeHasName);r.hasParent=r.createPureComputed(r._computeHasParent);r.name=r.createPureComputed(r._computeName);r.isPlaceholder=r.createPureComputed(r._computeIsPlaceholder);return r}i.__extends(t,e);t.prototype._computeItem=function(){return this.itemSet().item()};t.prototype._computeHasItems=function(){return this.itemSet().content().items.length>0};t.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t};t.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)};t.prototype._computeHasParent=function(){return!!this.item().parent};t.prototype._computeName=function(){var e=this.item();return e.displayName||e.name};t.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder};return t}(r.default);a.dependencies=i.__assign({},r.default.dependencies,{itemSet:n.currentItemSet});t.ItemSetMonitor=a;t.resourceKey=s.createDefaultResourceKey(e,a);t.default=a});define("odsp-next/controls/listFooter/ListFooter.html",[],function(){return'\x3c!--ko if: isVisible()--\x3e<div class=od-ListFooter>\x3c!--ko if: !dragAndDropHintComponent--\x3e<div class=od-ListFooter-dragAndDropHint data-bind="component: { name: dragAndDropHintTagName, params: {} }"></div>\x3c!--/ko--\x3e\x3c!--ko if: !!dragAndDropHintComponent--\x3e\x3c!--ko with: dragAndDropHintComponent--\x3e<div class=od-ListFooter-dragAndDropHint data-bind="component: $data"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showRecycleBinInFooter()--\x3e<div class=od-ListFooter-recycleBin><span class=od-ListFooter-recycleBinText data-bind="text: recycleBinText"></span> <a href=; class=od-ListFooter-recycleBinLink data-bind="text: recycleBinLink, click: onRecycleBinClick"></a></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("odsp-next/controls/listFooter/ListFooter.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-ListFooter{text-align:center;margin-top:33px;margin-bottom:24px}.od-ListFooter-dragAndDropHint{margin-bottom:18px}.od-ListFooter-recycleBin{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.od-ListFooter-recycleBinText{color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-ListFooter-recycleBinLink{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}"}])});define("odsp-next/controls/ipeEditor/InPlaceEditor",["require","exports","./InPlaceEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../iframeLoader/IframeLoader","./InPlaceEditor.html","./InPlaceEditor.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-ipe-editor",template:e("./InPlaceEditor.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/ipeEditor/InPlaceEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/SPOResourceKeys","../../resources/ControlResourceKeys","../../dataSources/url/odb/UrlQueryKeys","../../resources/PagesResourceKeys","../../dataSources/url/QueryType"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._isIPELoading=r.observable(!1);var o=i.resources.consume(s.viewParams),d=i.resources.consume(n.inplaceEditorUrl),c=i.resources.consume(l.dataManager);i._modifiedInPageEditorUrl=i.createPureComputed(function(){var e=d(),t=o()[a.default.queryParamKey];t&&c.queryType()===u.Search&&(e+="-InplaceSearchQuery%3D"+encodeURIComponent(t));return e});i._inPageEditorClosing=i.resources.consume(n.inplaceEditorClosing);i.createComputed(function(){return i._isInIPEMode(d())});i.subscribe(i._inPageEditorClosing,i._ensureCloseInPageEditor);i._iframe=null;i.iframeLoaderParams={url:i._modifiedInPageEditorUrl,showLoadingLabel:!0,onload:i.iframeOnLoad.bind(i),isLoading:i._isIPELoading,isInFullPage:!0,loadingLabelHasMargins:!0};return i}i.__extends(t,e);t.prototype.iframeOnLoad=function(e){this._iframe=e.target;if(this._iframe){this._iframe.contentWindow&&this._isIPELoading(!1);var t=this._iframe.contentDocument;this._hideControl(t,"inplaceSearchDiv_WPQ1");this._hideControl(t,"groupHeaderControl");this._hideControl(t,"s4-ribbonrow");t&&t.getElementById("contentRow")&&(t.getElementById("contentRow").style.paddingTop="40px")}};t.prototype._hideControl=function(e,t){e&&e.getElementById(t)&&(e.getElementById(t).style.display="none")};t.prototype._isInIPEMode=function(e){var t=!1;if(e){this._isIPELoading(!0);t=!0;this._inPageEditorClosing(!1)}return t};t.prototype._ensureCloseInPageEditor=function(e){e&&this._iframe&&this._iframe.contentWindow&&this._iframe.contentWindow.postMessage("ExitGrid","*")};return t}(o.default);t.default=d});define("odsp-next/controls/iframeLoader/IframeLoader",["require","exports","./IframeLoaderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IframeLoader.html","./IframeLoader.css"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-iframe-loader",template:e("./IframeLoader.html"),viewModel:i.default,synchronous:!0})});define("odsp-next/controls/iframeLoader/IframeLoaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","./IframeLoader.resx","../../bindings/element/ElementBinding","../../utilities/iframe/IframeHelper"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var i=e.call(this)||this;i.loadingLabel=s.strings.IframeLoadingLabel;i._isIframeAvailable=!0;var r=t.url,u=t.title||"";i.url="string"==typeof r?o.observable(r):r;i.title="string"==typeof u?o.observable(u):u;i.isExcludeFromScreenReader=t.isExcludeFromScreenReader||!1;i.isLoading=t.isLoading?t.isLoading:o.observable(!0);i.loadingLabelHasMargins=t.loadingLabelHasMargins;i.progressSpinnerFlatTagName=n.default.tagName;i.showLoadingLabel=t.showLoadingLabel;i.iframeElement=t.iframeElement||o.observable(null);i.tabindex=i.isExcludeFromScreenReader?"-1":null;i.role=i.isExcludeFromScreenReader?"presentation":null;i.isVisible=i.createComputed(i._computeIsVisible);i.isTitleVisible=i.createComputed(i._computeIsTitleVisible);i.addBindingHandlers({element:a});i.iframeOnLoad=function(e,r){i._isIframeAvailable&&t.onload&&t.onload(r);i.isLoading(!1)};i.addDisposable({dispose:function(){l.disposeIframe(i.iframeElement(),function(){i._isIframeAvailable=!1})}});return i}i.__extends(t,e);t.prototype._computeIsVisible=function(){return Boolean(this.url())};t.prototype._computeIsTitleVisible=function(){return Boolean(this.title())};return t}(r.default);t.default=u});define("odsp-next/utilities/iframe/IframeHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disposeIframe=function(e,t){if(e){e.src="";t&&t()}}});define("odsp-next/controls/iframeLoader/IframeLoader.html",[],function(){return"<div class=ms-IframeLoader data-bind=\"css:{ 'ms-IframeLoader--visible': isVisible }\"><div class=ms-IframeLoader-title data-bind=\"css:{ 'ms-IframeLoader-title--visible': isTitleVisible }, text: title()\"></div><iframe class=ms-IframeLoader-iframe data-bind=\"attr: { src: url(), role: role, tabindex: tabindex }, event: { load: iframeOnLoad }, css: { 'ms-IframeLoader-iframe--visible': !isLoading() }, element: iframeElement\"></iframe>\x3c!--ko if: showLoadingLabel--\x3e<span class=ms-IframeLoader-loadingLabel data-bind=\"text: loadingLabel, css: { 'ms-IframeLoader-loadingLabel--visible': isLoading, 'ms-IFrameLoader-LoadingWithMargin': loadingLabelHasMargins }\"></span>\x3c!--/ko--\x3e<div class=ms-IframeLoader-progressContainer data-bind=\"css: { 'ms-IframeLoader-progressContainer--visible': isLoading }\"><div class=ms-IframeLoader-progress data-bind=\"component: { name: progressSpinnerFlatTagName }\"></div></div></div>"});define("odsp-next/controls/iframeLoader/IframeLoader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.ms-IframeLoader{display:none;width:100%;height:100%}.ms-IframeLoader-loadingLabel{padding-bottom:15px;margin:0 0 20px 0;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:none}.ms-IframeLoader-loadingLabel.od-Dialog-subText--s{font-size:12px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--m{font-size:14px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--l{font-size:17px}.ms-IFrameLoader-LoadingWithMargin.ms-IframeLoader-loadingLabel{margin:15px 15px 15px 30px}.ms-IframeLoader-title{font-size:17px;display:none}.ms-IframeLoader-iframe{width:100%;height:100%;border:none;display:none}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframe--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}"}])});define("odsp-next/controls/ipeEditor/InPlaceEditor.html",[],function(){return"<div class=od-InPlaceEditor data-bind=\"component: { name: 'ms-iframe-loader', params: iframeLoaderParams }\"></div>"});define("odsp-next/controls/ipeEditor/InPlaceEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-InPlaceEditor{position:absolute;width:100%;height:100%}"}])});define("odsp-next/controls/smartBannerV2/SmartBannerV2",["require","exports","./SmartBannerV2ViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SmartBannerV2.html","./SmartBannerV2.css"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-smart-bannerv2",template:e("./SmartBannerV2.html"),viewModel:i})});define("odsp-next/controls/smartBannerV2/SmartBannerV2ViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../bindings/dismiss/DismissBinding","@ms/odsp-shared/lib/base/ViewModel","../../models/store/ItemsStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../resources/DataSourceResourceKeys","./SmartBannerV2.resx","../../bindings/logClick/LogClickBinding","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v){"use strict";var b="https://app.adjust.com/xxf6jd_wkry4s_qxfx79",y=function(e){function t(t){var i=e.call(this,t)||this;i.addBindingHandlers({dismiss:n.default});i._platformDetection=i.resources.consume(v.platformDetection);i._navigation=i.resources.consume(g.navigation);var o=i._navigation.viewParams;i._isTestHookEnabled=!!o.mobileupsell;i.buttonText=d.strings.SmartBannerV2ButtonUseText;i.taglineText=d.strings.SmartBannerV2TaglineText;i.leadText=d.strings.SmartBannerV2LeadText;i.useSquareIcon=!1;if(i._platformDetection.isWinPhone){i.hideTagline=!0;i.taglineText="";i.leadText=d.strings.SmartBannerV2LeadTextWP;i.useSquareIcon=!0}else if(i._platformDetection.isAndroid)i.hideTagline=!1;else{i.buttonText=d.strings.SmartBannerV2ButtonText;i.hideTagline=!1}i._urlDataSource=i.resources.consume(u.url);i._dataStore=i.resources.consume(a.resourceKey);i._iosMobilePathDataSource=i.resources.isExposed(u.iosMobileAppPath)?i.resources.consume(u.iosMobileAppPath):null;i._isVisible=t.isVisible;i._updateIsVisibleBinding();i.isCloseVisible=r.observable(!0);i._storePath=b;return i}i.__extends(t,e);t.prototype.onCloseButtonClick=function(){this._dismiss()};t.prototype.onCloseClick=function(){this.isCloseVisible.peek()||this._dismiss()};t.prototype.onContentClick=function(){var e=this,t=Date.now(),i=h.format(c.ENGAGEMENT_NAME_FORMAT,m[this._urlDataSource.getPageType()],f[this._urlDataSource.getQueryType()],p[p.SmartBannerV2_Click]);o.Engagement.logData({name:i.toLowerCase()});if(this._platformDetection.isIOS)this._navigation.navigateTo(this._storePath);else{this.async.setTimeout(function(){Date.now()-t<750&&e._navigation.navigateTo(e._storePath)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};t.prototype._dismiss=function(){this._isVisible(!1);this._dataStore.setValue(t.STORAGE_KEY,Date.now(),l.default.local);var e=h.format(c.ENGAGEMENT_NAME_FORMAT,m[this._urlDataSource.getPageType()],f[this._urlDataSource.getQueryType()],p[p.SmartBannerV2_Close]);o.Engagement.logData({name:e.toLowerCase(),extraData:{action:c.BINDING_ACTION}})};t.prototype._updateIsVisibleBinding=function(){var e=!1;if(this._iosMobilePathDataSource){e=!0;if(!this._isTestHookEnabled){var i=this._dataStore.getValue(t.STORAGE_KEY,l.default.local);i&&i>this._getPromptWaitTimeMilli()&&(e=!1)}}e&&o.Engagement.logData({name:"SmartBannerV2_View",currentPage:m[this._urlDataSource.getPageType()],extraData:{queryType:f[this._urlDataSource.getQueryType()]}});this._isVisible(e)};t.prototype._getPromptWaitTimeMilli=function(){return Date.now()-864e5};return t}(s.default);y.STORAGE_KEY="oneDriveSmartBannerVisible";return y});define("odsp-next/bindings/logClick/LogClickBinding",["require","exports","knockout","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType"],function(e,t,i,r,o,n,s,a){"use strict";var l=function(){function e(){}e.init=function(t,l,u,d,c){var p,m,f,h=i.utils.unwrapObservable(l());if(h){p=h.logClickContext.contextKey;n[p]&&i.utils.registerEventHandler(t,e.BINDING_ACTION,function(){m=o.format(e.ENGAGEMENT_NAME_FORMAT,s[h.logClickContext.pageType],a[h.logClickContext.queryType],n[p]);f=r.Engagement.logData({name:m.toLowerCase(),extraData:{action:e.BINDING_ACTION}})});if(h.click){return i.bindingHandlers.click.init(t,function(){return h.click},u,d,c)}}};return e}();l.ENGAGEMENT_NAME_FORMAT="{0}_{1}_{2}";l.BINDING_ACTION="click";return l});define("odsp-next/bindings/logClick/ClickContextKeyEnum",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.SmartBannerV2_Close=0]="SmartBannerV2_Close";e[e.SmartBannerV2_Click=1]="SmartBannerV2_Click"}(i||(i={}));return i});define("odsp-next/controls/smartBannerV2/SmartBannerV2.html",[],function(){return'<div class=SmartBannerV2 data-bind="dismiss: onCloseClick">\x3c!--ko if: isCloseVisible--\x3e<button class=SmartBanner-close data-bind="click: onCloseButtonClick"><i class="ms-Icon ms-Icon--Cancel"></i></button>\x3c!--/ko--\x3e<div class=SmartBanner-content><div class=SmartBanner-icon data-bind="css: { \'SmartBanner-useSquareIcon\': useSquareIcon }"><span class="ms-Icon ms-Icon--OneDrive" role=img></span></div><div class=SmartBanner-text data-bind="css: { \'SmartBanner-noTagline\': hideTagline }"><div class=SmartBanner-lead data-bind="text: leadText"></div><div class=SmartBanner-tagline data-bind="text: taglineText, visible: !hideTagline"></div></div><div class=SmartBanner-button><button class="od-Button od-Button--primary" data-bind="click: onContentClick"><span class=od-Button-label data-bind="text: buttonText"></span></button></div><div class=ms-clearfix></div></div></div>'});define("odsp-next/controls/smartBannerV2/SmartBannerV2.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.SmartBannerV2{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:80px;overflow:hidden;cursor:pointer;border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";position:fixed;z-index:298;bottom:0;left:0;right:0;padding:10px;box-shadow:-7px 0 10px rgba(0,0,0,.22)}.SmartBannerV2 .SmartBanner-close{position:absolute;top:0;width:40px;text-align:center;line-height:40px;cursor:pointer;border:none;background-color:transparent;font-size:20px}[dir=ltr] .SmartBannerV2 .SmartBanner-close{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-close{left:0}.lg .SmartBannerV2 .SmartBanner-close,.xlg .SmartBannerV2 .SmartBanner-close,.xxlg .SmartBannerV2 .SmartBanner-close,.xxxlg .SmartBannerV2 .SmartBanner-close,.xxxxlg .SmartBannerV2 .SmartBanner-close{top:-5px;font-size:16px}[dir=ltr] .SmartBannerV2 .SmartBanner-content{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-content{left:0}.lg .SmartBannerV2 .SmartBanner-content,.xlg .SmartBannerV2 .SmartBanner-content,.xxlg .SmartBannerV2 .SmartBanner-content,.xxxlg .SmartBannerV2 .SmartBanner-content,.xxxxlg .SmartBannerV2 .SmartBanner-content{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button{padding-top:17px}.md .SmartBannerV2 .SmartBanner-content .SmartBanner-button,.sm .SmartBannerV2 .SmartBanner-content .SmartBanner-button{clear:both;padding-top:12px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:right}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:left}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";border-radius:5px;height:40px;width:40px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:right}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon.SmartBanner-useSquareIcon{border-radius:0}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:6px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:42px;margin:10px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{height:64px;width:64px}[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-left:10px}[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-right:10px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:right}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:14px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:17px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text.SmartBanner-noTagline .SmartBanner-lead{margin-top:7px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:12px;height:15px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:14px}"}])});define("odsp-next/controls/oneUp/OneUp.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./OneUp",require:e,getExport:function(e){return e.resourceKey.local}})})});t.default=t.resourceKey});define("odsp-next/controls/standaloneList/StandaloneList.html",[],function(){return"<div class=StandaloneList data-bind=\"interactionScope: { isActive: isActive }, css: { 'is-active': isActive, 'has-smart-banner': isSmartBannerVisible(), 'has-one-up': isOneUp, 'has-command-bar': !hideCommandBar, 'dropping': isDroppingTarget, 'printEnabled': printEnabled }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: onDragging, receiveDrop: onReceiveDrop }\">\x3c!--ko if: !hideCommandBar--\x3e<div class=StandaloneList-commandBar data-bind=\"component: { name: 'ms-command-bar', params: { commandSet: topLevelCommandSet, isMobile: false } }\"></div>\x3c!--/ko--\x3e<div class=StandaloneList-content data-bind=\"scrollContainer: isScrollable, css: { 'CustomList-content': isCustomList, 'od-StandaloneList-content--isScrollable': isScrollable, 'is-active': !inPageEditorUrl() }, contextMenu: contextMenuHelper, automation: 'content'\" role=presentation><div class=StandaloneList-innerContent role=presentation>\x3c!--ko if: isBannerApplicable--\x3e<div class=StandaloneList-smartBanner role=presentation data-bind=\"component: { name: smartBannerTagName, params: { isVisible: isSmartBannerVisible } }\"></div>\x3c!--/ko--\x3e\x3c!--ko if: isHeaderVisible--\x3e<div class=StandaloneList-header role=presentation>\x3c!--ko if: isTitleVisible--\x3e<h2 class=StandaloneList-title data-bind=\"text: title, automation: 'TitleSpan'\" aria-live=polite></h2>\x3c!--/ko--\x3e<div class=StandaloneList-breadcrumb data-bind=\"component: { name: 'ms-breadcrumb-bar', params: { item: item, getCrumbs: breadcrumbBuilder } }\"></div>\x3c!--ko if: !isEmptyView() && isViewCommandBarVisible()--\x3e<div class=StandaloneList-viewCommandBar data-bind=\"component: { name: 'ms-command-bar', params: { commandSet: viewCommandSet, isMobile: false } }\"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: subcomponent--\x3e<div class=StandaloneList-subcomponent data-bind=\"component: subcomponent\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: inPageEditorUrl()--\x3e\x3c!--ko component: {\r\n name: ipeEditorName,\r\n params: {}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isRetrievingData--\x3e<div class=StandaloneList-loadingSpinner data-bind=\"component: { name: loadingSpinnerTagName, params: {}}\"></div>\x3c!--/ko--\x3e\x3c!--ko if: !inPageEditorUrl() && !!layoutTypeComponent()--\x3e<div class=StandaloneList-listView role=application data-bind=\"attr: { 'aria-label': listRegionLabel }, component: { name: layoutTypeComponent, params: { itemSet: itemSet, requiredRange: requiredRange, itemsPerGroup: itemsPerGroup, requiredGroup: requiredGroup, isDefault: true, selectionModel: itemSelectionModel, contextMenuHelper: listViewContextMenuHelper, tooltip: listTooltip, layoutIterationObservable: layoutIteration, onLayoutRenderComplete: onLayoutRenderComplete, enableMarqueeSelection: true, responsiveToContainer: responsiveToContainer, error: error, footerItem: dragAndDropGridHintComponent } }\"></div>\x3c!--ko if: showSeeMore--\x3e<div class=od-StandaloneList-seeMoreContainer>\x3c!--ko if: renderSeeMoreAsLink--\x3e<a class=od-StandaloneList-seeMore data-bind=\"click: $component.onShowMoreButtonClick.bind($component), text: partialResultStatusString\" href=#></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: renderSeeMoreAsLink--\x3e<span class=od-StandaloneList-seeMore data-bind=\"text: partialResultStatusString\"></span>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: isEmptyView() && !isAppView() && !isDragAndDropRobotApplicable()--\x3e\x3c!--ko component: {\r\n name: emptyFolderTagName,\r\n params: {}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: isEmptyView() && !isDragAndDropRobotApplicable()--\x3e\x3c!--ko component: {\r\n name: listFooterTagName,\r\n params: {\r\n dragAndDropHintComponent: dragAndDropFooterHintComponent\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: loadBackgroundPowerApp()--\x3e\x3c!--ko component: {name: powerAppHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<ms-footer class=StandaloneList-footer></ms-footer></div></div>\x3c!--ko if: isInfoPaneExpanded() && !isOneUp()--\x3e\x3c!--ko component: { name: 'od-transclusion-content', params: infoPaneTransclusionContentParams }--\x3e<div data-bind=\"control: infoPaneControlParams, attr: { 'aria-label': infoPaneRegionLabel, role: infoPaneRole }\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isFiltersPaneVisible() && !isOneUp()--\x3e\x3c!--ko component: { name: 'od-transclusion-content', params: infoPaneTransclusionContentParams }--\x3e<div data-bind=\"component: filtersPaneComponent\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isOneUp--\x3e\x3c!--ko component: {\r\n name: 'od-one-up-overlay',\r\n params: {}\r\n }--\x3e\x3c!--ko control: oneUpControlParams--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/standaloneList/StandaloneList.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.StandaloneList{position:absolute;width:100%;height:100%}.StandaloneList:not(.has-smart-banner) .StandaloneList-smartBanner{display:none}.StandaloneList-loadingSpinner{position:absolute;top:0;left:0;right:0}.StandaloneList-content{overflow-x:hidden}.StandaloneList-content.od-StandaloneList-content--isScrollable{top:0;bottom:0;left:0;right:0;overflow-y:scroll;-webkit-overflow-scrolling:touch;position:absolute}.StandaloneList.has-command-bar .StandaloneList-content{top:40px}.StandaloneList-viewCommandBar{-ms-flex-item-align:end;align-self:flex-end;width:145px;margin-top:-3px}[dir=ltr] .StandaloneList-viewCommandBar{margin-left:auto}[dir=rtl] .StandaloneList-viewCommandBar{margin-right:auto}.xlg .StandaloneList-viewCommandBar,.xxlg .StandaloneList-viewCommandBar,.xxxlg .StandaloneList-viewCommandBar,.xxxxlg .StandaloneList-viewCommandBar{margin-top:-13px}.md .StandaloneList-viewCommandBar,.sm .StandaloneList-viewCommandBar{margin-top:-8px}.StandaloneList-viewCommandBar .CommandBar-sideArea{min-width:initial}.CustomList-content{overflow-x:auto}.StandaloneList-innerContent{position:relative;min-height:100%;padding-bottom:60px;box-sizing:border-box}.StandaloneList-header{box-sizing:border-box;padding-top:10px;padding-bottom:10px;display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap}.sm .StandaloneList-header .CommandBar-sideArea{min-width:initial}.xlg .StandaloneList-header,.xxlg .StandaloneList-header,.xxxlg .StandaloneList-header,.xxxxlg .StandaloneList-header{padding-top:23px;padding-bottom:0}.lg .StandaloneList-footer,.md .StandaloneList-footer,.sm .StandaloneList-footer{padding:10px 20px}.StandaloneList-footer{padding:0 30px;white-space:nowrap;overflow:hidden;position:absolute;left:0;right:0;bottom:0}.StandaloneList-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;cursor:default;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400}[dir=ltr] .StandaloneList-title{margin-right:15px}[dir=rtl] .StandaloneList-title{margin-left:15px}.lg .StandaloneList-title,.md .StandaloneList-title,.sm .StandaloneList-title{font-weight:300}.xlg .StandaloneList-title,.xxlg .StandaloneList-title,.xxxlg .StandaloneList-title,.xxxxlg .StandaloneList-title{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:28px;font-weight:400}.StandaloneList-breadcrumb{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.md .StandaloneList-breadcrumb,.sm .StandaloneList-breadcrumb{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.xlg .StandaloneList-breadcrumb,.xxlg .StandaloneList-breadcrumb,.xxxlg .StandaloneList-breadcrumb,.xxxxlg .StandaloneList-breadcrumb{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;margin-bottom:1px}.StandaloneList.dropping .StandaloneList-innerContent:before{display:block;content:\'\';position:absolute;width:100%;height:100%;box-shadow:inset 0 0 0 3px '},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:'}[dir=ltr] .StandaloneList-header,[dir=ltr] .StandaloneList-listView,[dir=ltr] .StandaloneList-subcomponent{padding-left:32px}[dir=rtl] .StandaloneList-header,[dir=rtl] .StandaloneList-listView,[dir=rtl] .StandaloneList-subcomponent{padding-right:32px}[dir=ltr] .StandaloneList-header,[dir=ltr] .StandaloneList-listView,[dir=ltr] .StandaloneList-subcomponent{padding-right:32px}[dir=rtl] .StandaloneList-header,[dir=rtl] .StandaloneList-listView,[dir=rtl] .StandaloneList-subcomponent{padding-left:32px}[dir=ltr] .xlg .StandaloneList-header,[dir=ltr] .xlg .StandaloneList-listView,[dir=ltr] .xlg .StandaloneList-subcomponent,[dir=ltr] .xxlg .StandaloneList-header,[dir=ltr] .xxlg .StandaloneList-listView,[dir=ltr] .xxlg .StandaloneList-subcomponent,[dir=ltr] .xxxlg .StandaloneList-header,[dir=ltr] .xxxlg .StandaloneList-listView,[dir=ltr] .xxxlg .StandaloneList-subcomponent,[dir=ltr] .xxxxlg .StandaloneList-header,[dir=ltr] .xxxxlg .StandaloneList-listView,[dir=ltr] .xxxxlg .StandaloneList-subcomponent{padding-left:32px}[dir=rtl] .xlg .StandaloneList-header,[dir=rtl] .xlg .StandaloneList-listView,[dir=rtl] .xlg .StandaloneList-subcomponent,[dir=rtl] .xxlg .StandaloneList-header,[dir=rtl] .xxlg .StandaloneList-listView,[dir=rtl] .xxlg .StandaloneList-subcomponent,[dir=rtl] .xxxlg .StandaloneList-header,[dir=rtl] .xxxlg .StandaloneList-listView,[dir=rtl] .xxxlg .StandaloneList-subcomponent,[dir=rtl] .xxxxlg .StandaloneList-header,[dir=rtl] .xxxxlg .StandaloneList-listView,[dir=rtl] .xxxxlg .StandaloneList-subcomponent{padding-right:32px}[dir=ltr] .xlg .StandaloneList-header,[dir=ltr] .xlg .StandaloneList-listView,[dir=ltr] .xlg .StandaloneList-subcomponent,[dir=ltr] .xxlg .StandaloneList-header,[dir=ltr] .xxlg .StandaloneList-listView,[dir=ltr] .xxlg .StandaloneList-subcomponent,[dir=ltr] .xxxlg .StandaloneList-header,[dir=ltr] .xxxlg .StandaloneList-listView,[dir=ltr] .xxxlg .StandaloneList-subcomponent,[dir=ltr] .xxxxlg .StandaloneList-header,[dir=ltr] .xxxxlg .StandaloneList-listView,[dir=ltr] .xxxxlg .StandaloneList-subcomponent{padding-right:32px}[dir=rtl] .xlg .StandaloneList-header,[dir=rtl] .xlg .StandaloneList-listView,[dir=rtl] .xlg .StandaloneList-subcomponent,[dir=rtl] .xxlg .StandaloneList-header,[dir=rtl] .xxlg .StandaloneList-listView,[dir=rtl] .xxlg .StandaloneList-subcomponent,[dir=rtl] .xxxlg .StandaloneList-header,[dir=rtl] .xxxlg .StandaloneList-listView,[dir=rtl] .xxxlg .StandaloneList-subcomponent,[dir=rtl] .xxxxlg .StandaloneList-header,[dir=rtl] .xxxxlg .StandaloneList-listView,[dir=rtl] .xxxxlg .StandaloneList-subcomponent{padding-left:32px}[dir=ltr] .md .StandaloneList-header,[dir=ltr] .md .StandaloneList-listView,[dir=ltr] .md .StandaloneList-subcomponent,[dir=ltr] .sm .StandaloneList-header,[dir=ltr] .sm .StandaloneList-listView,[dir=ltr] .sm .StandaloneList-subcomponent{padding-left:16px}[dir=rtl] .md .StandaloneList-header,[dir=rtl] .md .StandaloneList-listView,[dir=rtl] .md .StandaloneList-subcomponent,[dir=rtl] .sm .StandaloneList-header,[dir=rtl] .sm .StandaloneList-listView,[dir=rtl] .sm .StandaloneList-subcomponent{padding-right:16px}[dir=ltr] .md .StandaloneList-header,[dir=ltr] .md .StandaloneList-listView,[dir=ltr] .md .StandaloneList-subcomponent,[dir=ltr] .sm .StandaloneList-header,[dir=ltr] .sm .StandaloneList-listView,[dir=ltr] .sm .StandaloneList-subcomponent{padding-right:16px}[dir=rtl] .md .StandaloneList-header,[dir=rtl] .md .StandaloneList-listView,[dir=rtl] .md .StandaloneList-subcomponent,[dir=rtl] .sm .StandaloneList-header,[dir=rtl] .sm .StandaloneList-listView,[dir=rtl] .sm .StandaloneList-subcomponent{padding-left:16px}.StandaloneList-listView{padding-top:12px}.xlg .StandaloneList-listView,.xxlg .StandaloneList-listView,.xxxlg .StandaloneList-listView,.xxxxlg .StandaloneList-listView{padding-top:20px}.od-StandaloneList-seeMore{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400}[dir=ltr] .od-StandaloneList-seeMore{margin-left:77px}[dir=rtl] .od-StandaloneList-seeMore{margin-right:77px}@media print{.printEnabled .StandaloneList-content{overflow:visible!important}[dir=ltr] .printEnabled .StandaloneList-content{left:0!important}[dir=rtl] .printEnabled .StandaloneList-content{right:0!important}[dir=ltr] .printEnabled .StandaloneList-content{right:auto!important}[dir=rtl] .printEnabled .StandaloneList-content{left:auto!important}.printEnabled .StandaloneList-innerContent{margin-top:0}}'}])});define("odsp-next/controls/breadcrumbBar/BreadcrumbBar",["require","exports","./BreadcrumbBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./BreadcrumbBar.html","./BreadcrumbBar.css"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-breadcrumb-bar",template:e("./BreadcrumbBar.html"),viewModel:i,synchronous:!0})});define("odsp-next/controls/breadcrumbBar/BreadcrumbBarViewModel",["require","exports","tslib","knockout","../commands/CommandViewModel","../../bindings/dismiss/DismissBinding","../../bindings/dragAndDrop/DragAndDropBinding","../dragAndDrop/DropHelper","@ms/odsp-utilities/lib/math/Point","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/base/ViewModel","../../actions/NavigationAction","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/icons/Icon","../../bindings/keyboard/KeyboardBinding","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../leftPane/LeftPane.resx","./BreadcrumbBar.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;i._currentDroppingCrumb=null;i.addBindingHandlers({dismiss:n.default,dragAndDrop:s.default,keyboard:f});var o=t.iconClass,d=void 0===o?new m("More").getClass():o,c=t.canShowTooltipOverflow,v=void 0!==c&&c;i._urlDataSource=i.resources.consume(h.url);i._responsiveUI=i.resources.consume(u.resourceKey);i._navigation=i.resources.consume(p.navigation);i.overflowMenuAriaLabel=b.strings.overflowAriaLabel;i.iconClass=d;i._item=t.item;i._maxFoldersVisibleLgUp=t.maxFoldersVisibleLgUp;i._maxFoldersVisibleMdDown=t.maxFoldersVisibleMdDown;i.isDroppable=r.observable(!0);i.isDroppingTarget=r.observable(!1);i.isOverflowOpen=r.observable(!1);i.overflowMenuOffset=r.observable(new l.default(-24,24));i.ariaLabelForBreadCrumbBar=r.observable("");i._openActionItem=r.observable(null);i.overflowCrumbs=r.observableArray();i.mouseOverTrigger=i.createObservable(!1);i._isOverflowHovered=i.createObservable(!1);i._canShowTooltipOverflow=v;i._actionMap=i.resources.consume(g.actionMap);i._openAction=new(i.managed(i._actionMap.OpenAction))({item:i._openActionItem,openRelation:2});i.overflowDismissParams={isOpen:i.isOverflowOpen,isAutomatic:i._canShowTooltipOverflow,timeout:100};i._dropHelper=i.resources.consume(a.resourceKey);i.crumbs=i.createComputed(function(){return i._computeCrumbs(t.getCrumbs)});return i}i.__extends(t,e);t.prototype.dispose=function(){e.prototype.dispose.call(this);this.crumbs.dispose()};t.prototype.onOverflowMouseover=function(e,t){this._canShowTooltipOverflow&&this.isOverflowOpen(!0)};t.prototype.onMayReceiveDrop=function(e,t){var i=t?r.dataFor(t):null;if(i&&i.item&&i.showNextChevron){this.onRemoveDropLocation();this._currentDroppingCrumb=i;this._currentDroppingCrumb.isDroppingTarget(!0);return{targetName:i.item.name}}this.onRemoveDropLocation();return null};t.prototype.onReceiveDrop=function(e,t){var i=t?r.dataFor(t):null,o=this._dropHelper.processDrop(e,i.item);o&&this.onRemoveDropLocation();return o};t.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)};t.prototype.onEnter=function(e,t){t.stopPropagation()};t.prototype.onClick=function(e,t){if(e.onClick)e.onClick(e,t);else if(e.isOverflow)this._canShowTooltipOverflow?this.isOverflowOpen.peek()||this.isOverflowOpen(!0):this.isOverflowOpen(!this.isOverflowOpen());else if(e.item&&!e.isFiltered){this._openActionItem(e.item);this._openAction.execute(t)}else this._navigation.navigateTo(e.url);e&&this.ariaLabelForBreadCrumbBar(y.format(b.strings.breadCrumbNavigation,e.ariaLabel))};t.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var t,i=[],r=[],o=this._responsiveUI;t=o.compareSize(o.formFactorSize(),"Medium")<=0?void 0===this._maxFoldersVisibleMdDown?2:this._maxFoldersVisibleMdDown:void 0===this._maxFoldersVisibleLgUp?4:this._maxFoldersVisibleLgUp;var n=this._item(),s=[];n&&n.key&&(e?s=e(n):n.parent&&(s=this._getCrumbsForNonRoots(n)));for(var a=0;a<s.length;a++)i.length<t?i.unshift(s[a]):r.unshift(this._commandForCrumb(s[a]));r.length&&i.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1,ariaLabel:""});this.overflowCrumbs().forEach(function(e){e.dispose()});this.overflowCrumbs(r);i&&i.length>0?this.ariaLabelForBreadCrumbBar(y.format(b.strings.breadCrumbNavigation,i[i.length-1].ariaLabel)):n&&n.key&&this.ariaLabelForBreadCrumbBar(y.format(b.strings.breadCrumbNavigation,n.name));return i};t.prototype._getCrumbsForNonRoots=function(e){for(var t=[],i=!1,o=this._getAriaLabelsForBreadCrumbs(e);e;){var n=new(this.resources.injected(this._actionMap.OpenAction))({item:this.createObservable(e),openRelation:2}),s=n.isAvailable.peek();n.dispose();var a=i,l=!i;if(!s){a=!1;l=!0}if(e.isStub){a=!1;l=!0}var u={key:e.key,url:"#"+e.key,name:e.name||v.strings.Files,showNextChevron:i,isDroppingTarget:r.observable(!1),item:e,isOverflow:!1,isNavItem:a,isStaticItem:l,ariaLabel:o.pop()};t.push(u);i=!0;e=e.parent}return t};t.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],i=void 0;e;){if(i){i=y.format(b.strings.breadCrumbItem,i,e.name||v.strings.Files);t.push(i)}else{i=e.name||v.strings.Files;e.parent&&t.push(e.parent.name)}e=e.parent}return t};t.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(o))({text:e.name,action:new(this.managed(c))({url:e.url}),callback:function(){e.isNavItem&&t.onClick(e,null)}})};return t}(d.default)});define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.html",[],function(){return'<nav class=BreadcrumbBar data-bind="attr: { \'aria-label\': ariaLabelForBreadCrumbBar }"><ul class=BreadcrumbBar-list role=menu data-bind="foreach: crumbs, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"><li>\x3c!--ko if: isOverflow--\x3e<a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon" href=javascript:; aria-haspopup=true role=menuitem data-bind="click: $component.onClick.bind($component), dismiss: $component.overflowDismissParams, attr: { \'aria-expanded\': $component.isOverflowOpen(), \'aria-label\': $component.overflowMenuAriaLabel }, keyboard: { mappings: { \'Enter\': $component.onEnter.bind($component) } }, class: $component.iconClass, event: { mouseover: $component.onOverflowMouseover.bind($parent) }">\x3c!--ko if: $parent.isOverflowOpen()--\x3e<ms-contextual-menu params="items: $component.overflowCrumbs, isOpen: $component.isOverflowOpen, offset: $component.overflowMenuOffset, mouseOverTrigger: $component.mouseOverTrigger, target: $element.parentElement"></ms-contextual-menu>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if: isNavItem--\x3e<a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" role=menuitem data-bind="text: name, click: $component.onClick.bind($component), keyboard: { mappings: { \'Enter\': $component.onEnter.bind($component) } }, attr: { href: url, title: name }, css: { dropping: isDroppingTarget }"></a>\x3c!--/ko--\x3e\x3c!--ko if: isStaticItem--\x3e<span class=BreadcrumbBar-item data-bind="text: name, attr: { title: name }"></span>\x3c!--/ko--\x3e\x3c!--ko if: showNextChevron--\x3e<i class=BreadcrumbBar-item-chevron role=presentation></i>\x3c!--/ko--\x3e</li></ul></nav>'});define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".xlg .BreadcrumbBar,.xxlg .BreadcrumbBar,.xxxlg .BreadcrumbBar,.xxxxlg .BreadcrumbBar{margin-top:7px}.BreadcrumbBar-list{display:block;margin:0;padding:0;display:block;white-space:nowrap;overflow:hidden;font-size:0}[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;vertical-align:top;margin:0;padding:0;display:inline-block}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:16px;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";padding:8px 4px;cursor:pointer}.lg .BreadcrumbBar-overflow{padding:9px 4px}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow,.xxxxlg .BreadcrumbBar-overflow{font-size:18px;padding:8px 8px}.BreadcrumbBar-overflow:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" inset}.BreadcrumbBar-navItem:active{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}a.BreadcrumbBar-item{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:'}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;height:28px;line-height:32px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;padding-bottom:1px;line-height:28px}.sm .BreadcrumbBar-item{max-width:100px}.BreadcrumbBar-item.dropping{background:'},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.BreadcrumbBar-item-chevron{font-size:10px;display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';vertical-align:top;padding:0 2px;margin-top:11px}.lg .BreadcrumbBar-item-chevron{margin-top:13px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron,.xxxxlg .BreadcrumbBar-item-chevron{font-size:12px;margin-top:11px;padding:0 4px}.BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:\'\\e76c\'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:\'\\e76b\'}.od-ListItemFormRoot .BreadcrumbBar{margin-bottom:12px}.xlg .od-ListItemFormRoot .BreadcrumbBar,.xxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar{margin-top:0}.od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.lg .od-ListItemFormRoot .BreadcrumbBar-item{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400}.xlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar-item{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:28px;font-weight:400;line-height:1}'}])});define("odsp-next/controls/footer/Footer",["require","exports","./FooterViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Footer.html","./Footer.css"],function(e,t,i,r){"use strict";return r.registerComponent({tagName:"ms-footer",template:e("./Footer.html"),viewModel:i})});define("odsp-next/controls/footer/FooterViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,i,r,o,n,s){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;i.links=r.observableArray([]);i._dataSource=i.resources.consume(n.footer);if(i._dataSource){i.showConfidentialText=i._dataSource.showConfidentialText();i.showLanguageLink=i._dataSource.showLanguageLink()}i.createComputed(i._computeUpdateFooterLinks);return i}i.__extends(t,e);t.prototype._computeUpdateFooterLinks=function(){var e=this;if(this._dataSource){var t=this._dataSource.getFooterLinks().slice();if(this.showLanguageLink){var i=this.resources.consume(o.actionMap),r={text:this._dataSource.getLanguageText(),url:"#",onClick:function(t,r){(new(e.managed(i.LanguagePickerAction))).execute(r)},automationId:"lp"};t.push(r)}(n=this.links).splice.apply(n,[0,this.links.peek().length].concat(t))}var n};return t}(s.default)});define("odsp-next/controls/footer/Footer.html",[],function(){return'\x3c!--ko if: $data.links().length--\x3e<ul class=Footer>\x3c!--ko foreach: $data.links--\x3e<li data-bind="automation: $data.automationId">\x3c!--ko if: $data.url--\x3e\x3c!--ko if: $data.encodedText--\x3e<a class=Footer-item target=_blank data-bind="html: $data.encodedText, attr: { href: $data.url }, click: $data.onClick"></a>\x3c!--/ko--\x3e\x3c!--ko if: !$data.encodedText--\x3e<a class=Footer-item target=_blank data-bind="text: $data.text, attr: { href: $data.url }, click: $data.onClick"></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !$data.url--\x3e\x3c!--ko if: $data.encodedText--\x3e<span class="Footer-item is-disabled" data-bind="html: $data.encodedText"></span>\x3c!--/ko--\x3e\x3c!--ko if: !$data.encodedText--\x3e<span class="Footer-item is-disabled" data-bind="text: $data.text"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e\x3c!--ko if: $data.showConfidentialText--\x3e<li><span class="Footer-item Footer-msconf">Microsoft Confidential</span></li>\x3c!--/ko--\x3e</ul>\x3c!--/ko--\x3e'});define("odsp-next/controls/footer/Footer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".Footer{display:block;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:';margin:0;padding:0;padding-top:8px}.Footer li{list-style-type:none;margin:0;padding:5px 10px;display:inline}.Footer-item{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-decoration:none;white-space:nowrap;display:inline-block;height:32px}a.Footer-item:focus,a.Footer-item:hover{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.Footer-msconf{font-weight:700;color:#e81123}"}])});define("odsp-next/controls/overlays/oneUp/OneUpOverlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OneUpOverlayViewModel","./OneUpOverlay.html","./OneUpOverlay.css","../Overlay"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-one-up-overlay",template:e("./OneUpOverlay.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/overlays/oneUp/OneUpOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../Overlay"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i.overlayTagName=l.tagName;i.addBindingHandlers({host:o,interactionScope:n.default,preserveFocus:s.default,recoverFocus:a.default});var r=t.showUnauthBanner,u=void 0!==r&&r;i.showUnauthBanner=u;return i}i.__extends(t,e);return t}(r.default);t.default=u});define("odsp-next/controls/overlays/oneUp/OneUpOverlay.html",[],function(){return"\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500\r\n },\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-OneUpOverlay tabindex=-1 data-bind=\"interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: $host.isOpen }, css: { 'od-oneupOverlay--showUnauthBanner': showUnauthBanner }, host\"></div>\x3c!--/ko--\x3e"});define("odsp-next/controls/overlays/oneUp/OneUpOverlay.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OneUpOverlay{position:absolute;top:0;left:0;right:0;bottom:0}.od-oneupOverlay--showUnauthBanner{top:50px}.od-OverlayHost-overlay .od-OneUpOverlay{transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear;opacity:0;visibility:hidden;-ms-transform:none;transform:none}.od-OverlayHost-overlay.od-OverlayHost-overlay--initial .od-OneUpOverlay,.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-OneUpOverlay{transition-delay:0s,0s,0s;opacity:1;visibility:inherit}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-OneUpOverlay{-ms-transform:scale(.8,.8);transform:scale(.8,.8);opacity:0;visibility:hidden}"}])});define("odsp-next/utilities/list/odb/ListResources",["require","exports","tslib","knockout","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","../../../resources/UtilityResourceKeys","../../../resources/PagesResourceKeys","../../../resources/SPOResourceKeys","../../../resources/LoggingResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../providers/transclusion/TransclusionProvider","../../../providers/bundleLoader/BundleLoaderProvider","../../../providers/profile/ProfileProvider","../../../providers/instrumentation/InstrumentationProvider","../../../providers/moveCopy/MoveCopyProvider","../../../dataSources/url/odb/UrlDataSource","../../../dataSources/item/odb/ListItemsDataSource","../../../dataSources/settings/odb/SettingsDataSource","../../../dataSources/download/odb/DownloadDataSource","../../../dataSources/versionControl/odb/VersionControlDataSource","../../../dataSources/versionHistory/odb/VersionHistoryDataSource","../../../dataSources/policyTip/odb/PolicyTipDataSource","../../../dataSources/item/odb/ShortcutLinkDataSource","../../../dataSources/item/spo/MoveCopyDataSource","../../../dataSources/list/odb/ListDataSource","../../../dataSources/bundle/odb/BundleDataSource","../../../dataSources/microService/odb/MicroServiceDataSource","../../../dataSources/identity/odb/IdentityDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation","@ms/odsp-utilities/lib/resources/Resources","../../mobile/Mobile","../../sharepoint/SyncActiveXClient","../../logging/odb/RUMOneHelper","../../../models/store/ItemsStore","../../../models/selection/ItemSetSelectionModel","../../../actions/odb/ActionMap","../../../pages/files/spo/SortManager","../../../pages/files/spo/DataManager","../../../pages/files/spo/SPOFiles.resx","../../../models/selection/SelectionModelGroup"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k,P,L,R,F,A,M,E,U,B,O,N,V,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var K=function(){function e(){}e.exposeIfNeeded=function(e,t,i){return e.isExposed(t)?e.consume(t):e.expose(t,i())};e.exposeResources=function(t){var K=t.resourceScope,q=t.pageContext,z=t.viewId,G=t.itemResultSetOptions,j=t.disableAutomaticLayoutSwitch,W=void 0!==j&&j;e.exposeIfNeeded(K,o.bundle,function(){return new(K.injected(D.default))});e.exposeIfNeeded(K,n.bundleLoader,function(){return new(K.injected(m.default))});e.exposeIfNeeded(K,u.pageContext,function(){return q});e.exposeIfNeeded(K,E.resourceKey,function(){return new E.default});e.exposeIfNeeded(K,c.navigation,function(){return new L.default});e.exposeIfNeeded(K,o.settings,function(){return new y});e.exposeIfNeeded(K,u.pageContext,function(){return q});e.exposeIfNeeded(K,o.url,function(){return new(K.injected(v.default))});K.isExposed(o.shortcut)||K.exposeFactory(o.shortcut,new R.AliasResourceFactory(w.resourceKey));e.exposeIfNeeded(K,o.microService,function(){return new(K.injected(k.default))});var X=e.exposeIfNeeded(K,o.items,function(){return new(K.injected(b.default))({itemsStore:K.consume(E.resourceKey),pageContext:q,listRootFolderWebRelativeUrl:t.listRootFolderWebRelativeUrl,listFullUrl:t.listFullUrl,listId:t.listId,listShouldRenderFilesTitle:t.listShouldRenderFilesTitle})});e.exposeIfNeeded(K,u.listItems,function(){return X});e.exposeIfNeeded(K,o.download,function(){return new(K.injected(_.default))});e.exposeIfNeeded(K,o.versionControl,function(){return new(K.injected(S.default))});e.exposeIfNeeded(K,o.versionHistory,function(){return new(K.injected(x.default))});K.isExposed(o.policyTip)||K.exposeFactory(o.policyTip,new R.AliasResourceFactory(I.resourceKey));e.exposeIfNeeded(K,n.instrumentation,function(){return new(K.injected(h.default))});e.exposeIfNeeded(K,o.identity,function(){return new(K.injected(P))(q)});e.exposeIfNeeded(K,s.viewParams,function(){return r.observable({})});K.isExposed(n.infoPane)||K.exposeFactory(n.infoPane,p.factory);K.isExposed(n.overlay)||K.exposeFactory(n.overlay,p.factory);e.exposeIfNeeded(K,a.mobile,function(){return new F});e.exposeIfNeeded(K,o.copy,function(){return new(K.injected(C.default))(q)});e.exposeIfNeeded(K,n.profile,function(){return new(K.injected(f.default))});e.exposeIfNeeded(K,d.rumOneHelper,function(){return new(K.injected(M.default))("StandaloneList")});e.exposeIfNeeded(K,l.sortManager,function(){return new(K.injected(O))});e.exposeIfNeeded(K,l.base.leftNav.isLeftNavUserExpanded,function(){return r.observable(!1)});e.exposeIfNeeded(K,o.list,function(){return new(K.injected(T.default))(q)});var Q=e.exposeIfNeeded(K,l.dataManager,function(){return new(K.injected(N.default))({defaultViewId:z,itemResultSetOptions:G,disableAutomaticLayoutSwitch:W})});e.exposeIfNeeded(K,s.currentItem,function(){return Q.item});e.exposeIfNeeded(K,l.files.layoutType,function(){return Q.layoutType});e.exposeIfNeeded(K,s.currentItemSet,function(){return Q.itemSet});e.exposeIfNeeded(K,s.focusItem,function(){return Q.focusItem});e.exposeIfNeeded(K,s.currentView,function(){return Q.currentView});e.exposeIfNeeded(K,g.resourceKey,function(){return new(K.resolved(g.default))({})});e.exposeIfNeeded(K,s.canModifySchema,function(){return r.observable(!1)});e.exposeIfNeeded(K,s.currentSelectionModelGroup,function(){return new(K.injected(H.default))});var Z=t&&t.selectionOptions?i.__assign({},t.selectionOptions):{};Z.selectionModelGroup=K.consume(s.currentSelectionModelGroup);Z.enableSelectionResolution=!1;e.exposeIfNeeded(K,s.itemsSelection,function(){return new(K.injected(U))(Z)});e.exposeIfNeeded(K,l.base.infoPane.isInfoPaneExpanded,function(){return r.observable(!1)});e.exposeIfNeeded(K,s.actionMap,function(){return new B});e.exposeIfNeeded(K,l.files.resx,function(){return V.strings});e.exposeIfNeeded(K,s.canUserSelect,function(){return r.observable(!0)});e.exposeIfNeeded(K,a.syncActiveXClient,function(){return new(K.injected(A.default))})};return e}();t.default=K});define("odsp-next/providers/profile/ProfileProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../engagement/Engagement","../../resources/ProviderResourceKeys","../../utilities/features/Features","../../models/peopleCard/DisplayType"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._peopleToPrefetch={};i._debouncedPrefetch=i.async.debounce(function(){return i._prefetchPeopleCards()},50);return i}i.__extends(t,e);t.prototype.personRendered=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r&&!this._peopleToPrefetch[r]&&(this._peopleToPrefetch[r]=!0)}this._debouncedPrefetch()};t.prototype.getPeopleCardData=function(e){if(s.isFeatureEnabled(s.PeopleCardsOnLoki)&&!s.isFeatureEnabled(s.PeopleCardsReactComponent)){this.resources.consume(o.resourceKey).logData({name:"PeopleCard.DataLoad"});this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(n.peopleCard));this._peopleCardProvider.getPeopleCard(e,!1)}};t.prototype._prefetchPeopleCards=function(){if(s.isFeatureEnabled(s.PeopleCardsOnLoki)&&!s.isFeatureEnabled(s.PeopleCardsReactComponent)){this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(n.peopleCard));var e=Object.keys(this._peopleToPrefetch);e.length>0&&this._peopleCardProvider.prefetchPeopleCards(e,a.default.Page)}this._peopleToPrefetch={}};return t}(r.default);t.default=l});define("odsp-next/models/peopleCard/DisplayType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Page=0]="Page";e[e.Card=1]="Card"}(i=t.DisplayType||(t.DisplayType={}));t.default=i});define("odsp-next/dataSources/policyTip/odb/PolicyTipDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../url/odb/ApiUrlHelper","../../url/odb/ItemUrlHelper","../../../dataSources/base/odb/DataRequestor","../../../dataSources/url/odb/UrlQueryKeys","../../../resources/ControlResourceKeys","../../../models/item/ItemParentHelper"],function(e,t,i,r,o,n,s,a,l,u,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t,i){var r=e.call(this,t,i)||this;r._apiUrlHelper=i.apiUrlHelper;r._dataRequestor=r.scope.attach(new i.dataRequestorType({qosName:"PolicyTipDataSource"}));r._itemParentHelper=i.itemParentHelper;r._itemUrlHelper=i.itemUrlHelper;r._viewParams=i.viewParams;return r}i.__extends(t,e);t.prototype.getExternalSharingStatus=function(){return this._isPseudo()?o.default.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})};t.prototype.getPolicyTip=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);if(this._isPseudo())return o.default.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:2,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});var i=this._getParentListId(e),r=this._apiUrlHelper.build().webByItemUrl(t).method("Lists",i).method("GetItemById",e.properties.ID).segment("getdlppolicytip");return this._dataRequestor.getData({url:r.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return null;var i=t.MatchedConditionDescriptions,r=t.OverrideOptions,o=void 0===r?0:r,n=t.GeneralText,s=t.AppliedActionsText,a=Date.parse(t.LastProcessedTime);return{issueDescriptions:i&&i.results,overrideOption:Number(o),policyInfoUrl:t.ComplianceUrl,explanationText:n&&s?n+" "+s:n||s||"",lastScanned:isNaN(a)?void 0:new Date(a)}})};t.prototype.updatePolicy=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key);if(this._isPseudo())return o.default.wrap(0===e.action?2:1===e.action?3:0);var i=this._getParentListId(e.item),r=this._apiUrlHelper.build().webByItemUrl(t).method("Lists",i).method("GetItemById",e.item.properties.ID).segment("overridepolicytip");return this._dataRequestor.getData({url:r.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,i=t&&t.OverridePolicyTip;return"number"==typeof i?i:null})};t.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId};t.prototype._isPseudo=function(){return"1"===this._viewParams.peek()[u.default.pseudoPolicyTipKey]};return t}(r.default);t.default=p;t.resourceKey=n.createDefaultResourceKey(e,p,{apiUrlHelper:s.resourceKey,dataRequestorType:l.typeResourceKey,itemParentHelper:c.resourceKey,itemUrlHelper:a.resourceKey,viewParams:d.viewParams})});define("odsp-next/dataSources/item/spo/MoveCopyDataSource",["require","exports","tslib","../../../utilities/features/Features","../odb/MoveCopyDataSource"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getCapabilities=function(e){void 0===e&&(e=!1);this._capabilities||(this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!1,supportsMoveCopyFilterParams:!0,supportsCopyCrossSite:r.isFeatureEnabled(r.CopyCrossSiteFromTeamSite),supportsMoveCrossSite:r.isFeatureEnabled(r.MoveCrossSiteFromTeamSite),supportsThrottling:!0,supportsProgressCaching:r.isFeatureEnabled(r.MoveCopyFolderUsePRIME)||r.isFeatureEnabled(r.CopyCrossSiteSplitTech)});return this._capabilities};return t}(o.default);t.default=n});define("odsp-next/dataSources/item/odb/MoveCopyDataSource",["require","exports","tslib","../../base/odb/DataSource","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../ITaskProgress","@ms/odsp-utilities/lib/logging/events/Verbose.event"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this,t)||this;i._urlDataSource=i.resources.consume(o.url);return i}i.__extends(t,e);t.prototype.getCapabilities=function(e){void 0===e&&(e=!1);this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!1,supportsMoveCopyFilterParams:!0,supportsCopyCrossSite:e?n.isFeatureEnabled(n.CopyCrossSiteFromTeamSite):n.isFeatureEnabled(n.CopyCrossSiteFromODB),supportsMoveCrossSite:n.isFeatureEnabled(n.MoveCrossSiteFromTeamSite),supportsThrottling:!0,supportsProgressCaching:n.isFeatureEnabled(n.MoveCopyFolderUsePRIME)||n.isFeatureEnabled(n.CopyCrossSiteSplitTech)};return this._capabilities};t.prototype.copyItemsAsync=function(e){var t=this;return this.getData(function(){var e=t._pageContext.webAbsoluteUrl+"/_api/site/CreateCopyJob";return n.isFeatureEnabled(n.MoveCopyUsePRIMESplitJob)?e+"s":e},this._parseCopyResponse,"CopyAsyncPrime",function(){return t._getCopyItemsAsyncPostData(e)},"POST")};t.prototype.hasMatchingId=function(e,t){return t&&t.properties.ID&&t.properties.ID===e};t.prototype._parseCopyResponse=function(e){var t;try{t=JSON.parse(e)}catch(e){a.Verbose.logData({name:"MoveCopyDataSource._parseCopyResponse.InvalidJson",message:e})}var i,r=(i=n.isFeatureEnabled(n.MoveCopyUsePRIMESplitJob)?t&&t.d&&t.d.CreateCopyJobs&&t.d.CreateCopyJobs.results:[t&&t.d&&t.d.CreateCopyJob])&&i[0]&&i[0].JobId;return{id:r,jobInfo:{spData:i},progress:[{id:r,status:s.ITaskStatuses[s.ITaskStatuses.NotStarted]}]}};t.prototype._getCopyItemsAsyncPostData=function(e){var t=e.items,i={};i.exportObjectUris=[];for(var r=0,o=t;r<o.length;r++){var n=o[r];i.exportObjectUris.push(this._urlDataSource.getItemUrl(n.key))}i.destinationUri=this._urlDataSource.getItemUrl(e.targetKey);i.options={IgnoreVersionHistory:!0};return JSON.stringify(i)};return t}(r);t.default=l});define("odsp-next/dataSources/list/odb/ListDataSource",["require","exports","tslib","@ms/odsp-datasources/lib/models/view/View","../../base/odb/DataSource","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../url/odb/ApiUrlHelper","../../url/odb/ItemUrlHelper","../../url/odb/UrlQueryKeys","../../../models/list/ViewIdentifier","../../../utilities/features/Features","../../../utilities/list/ListFilterHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","ServerRelativeUrl","Title","ViewType","VisualizationInfo"].join(","),h=function(e){function t(t){var i=e.call(this,t)||this;i._apiUrlHelper=i.resources.consume(s.resourceKey);i._itemUrlHelper=i.resources.consume(a.resourceKey);return i}i.__extends(t,e);t.prototype.getView=function(e,t){var i=this;return this.getData(function(){return i._getViewApiUrl(e,t).oDataParameter("$select",f).toString()},function(e){var t=JSON.parse(e);return i._viewFromServerView(t.d,!0)},"GetView",null,"GET")};t.prototype.getViews=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(e).segment("Views").oDataParameter("$select",f).toString()},function(e){return JSON.parse(e).d.results.map(function(e){return i._viewFromServerView(e,!1,t)}).filter(function(e){return!!e})},"GetViews",null,"GET")};t.prototype.createView=function(e,t){var i,r=this,o=e.viewParams,n=o[l.default.useFiltersInViewXmlKey]?void 0:this._getFilterParams(o),s=!1,a=!1;return m.Qos.instrumentPromise({name:"ListDataSource.CreateView"},function(){return r._addView(e,t).then(function(e){if(!e)throw new Error("No view returned by /Views/Add");i=e;s=!0;if(n)return r._saveLegacyFilters(i,n,t)}).then(function(){a=!0;return n?r.getView({id:i.id},t):i}).then(null,function(e){s&&n&&!a&&r.deleteView(i.id,t);return e})},null,function(e){return p.default.isCanceled(e)?{resultType:m.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:m.ResultTypeEnum.Failure,resultCode:s?a?n?"SecondGetView":"Unknown":"SaveFilters":"CreateView",error:e}})};t.prototype.saveView=function(e,t){var i=this,r=e.sourceView,o=e.viewParams,n=e.updateViewXml,s=o[l.default.useFiltersInViewXmlKey]?void 0:this._getFilterParams(o),a=!1,u=!1;return m.Qos.instrumentPromise({name:"ListDataSource.SaveView"},function(){return i._setViewXml(e,t).then(function(){a=!0;if(s)return i._saveLegacyFilters(r,s,t)}).then(function(){u=!0;return n?i.getView({id:r.id},t):null}).then(function(e){n&&e&&(r.baseViewXml=e.baseViewXml)})},null,function(e){return p.default.isCanceled(e)?{resultType:m.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:m.ResultTypeEnum.Failure,resultCode:a?u?"UpdateView":"SaveAsNewView":"SetViewXml",error:e}})};t.prototype.deleteView=function(e,t){var i=this;return this.getData(function(){return i._getViewApiUrl({id:e},t).toString()},function(){},"DeleteView",null,"POST",{"X-HTTP-Method":"DELETE"})};t.prototype.modifyView=function(e,t){var i=this,r={__metadata:{type:"SP.View"},DefaultView:e.isDefault,Title:e.title};return this.getData(function(){return i._getViewApiUrl({id:e.id},t).toString()},function(e){return e},"ModifyView",function(){return JSON.stringify(r)},"PATCH",{"X-HTTP-Method":"PATCH"})};t.prototype.createMappedView=function(e,t,i){var r=this,o={appViewCreationInfo:{Title:e.title,AppId:e.appId,IsPrivate:e.isPrivate},visualizationTarget:t};return this.getData(function(){return r.getListApiUrl(i).segment("CreateMappedView").toString()},function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},"CreateMappedView",function(){return JSON.stringify(o)},"POST")};t.prototype.getMappedApp=function(e,t,i){var r=this;return this.getData(function(){return r.getListApiUrl(i).segment("GetMappedApp").oDataParameter("$expand","AppMappedViews").toString()},function(e){return r.appSynchronizationResultFromMappedApps(e,!0)},"GetMappedApp",function(){return JSON.stringify({appId:e,visualizationAppTarget:t})},"POST")};t.prototype.getMappedApps=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(t).segment("GetMappedApps").oDataParameter("$expand","AppMappedViews").toString()},function(e){return i.appSynchronizationResultFromMappedApps(e,!1)},"GetMappedApps",function(){return JSON.stringify({visualizationAppTarget:e})},"POST")};t.prototype.publishMappedView=function(e,t,i){var r=this;return this.getData(function(){return r.getListApiUrl(i).segment("PublishMappedView").toString()},function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},"PublishMappedView",function(){return JSON.stringify({appId:e,visualizationTarget:t})},"POST")};t.prototype.unpublishMappedView=function(e,t,i){var r=this;return this.getData(function(){return r.getListApiUrl(i).segment("UnpublishMappedView").toString()},function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},"UnpublishMappedView",function(){return JSON.stringify({appId:e,visualizationTarget:t})},"POST")};t.prototype.getFlowTemplates=function(e){var t=this;return this.getData(function(){return t.getListApiUrl(e).segment("SyncFlowTemplates").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowTemplates",null,"POST",null,null,null,!0)};t.prototype.getFlowInstances=function(e){var t=this;return this.getData(function(){return t.getListApiUrl(e).segment("SyncFlowInstances").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowInstances",null,"POST",null,null,null,!0)};t.prototype.getFlowCallbackUrl=function(e,t){var i=this;return this.getData(function(){return i.getListApiUrl(t).segment("SyncFlowCallbackUrl").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var i=JSON.parse(e);t.synchronizationDataObject=i.d;t.synchronizationStatus=i.d.SynchronizationStatus;return t},"GetFlowCallbackUrl",function(){return JSON.stringify({flowId:e})},"POST",null,null,null,!0)};t.prototype.modifyFieldProperties=function(e,t){var i=this,r=e.id,o={__metadata:{type:"SP.Field"},Title:e.displayName,SchemaXml:e.fieldDescription,PinnedToFiltersPane:e.pinnedToFiltersPane,ShowInFiltersPane:e.showInFiltersPane};return this.getData(function(){return i.getListApiUrl(t).method("Fields",r).toString()},function(e){return null},"ModifyFieldProperties",function(){return JSON.stringify(o)},"POST",{"X-HTTP-Method":"MERGE"})};t.prototype.appSynchronizationResultFromMappedApps=function(e,t){var i=this,r=JSON.parse(e),o=r&&r.d;if(!o)return null;var n=[];o.AppMappedViews&&o.AppMappedViews.results&&(n=o.AppMappedViews.results.map(function(e){return i._viewFromServerView(e)}));var s=null;try{s=JSON.parse(o.SynchronizationData);(t?s&&s.name&&s.properties:s&&s.value)||(s={id:null,name:null,properties:{createdBy:null,createdTime:null,displayName:null,isPrivate:!0,permissions:null}});for(var a=0,l=t?[s]:s.value;a<l.length;a++){var u=l[a].properties;u.isPrivate=!u.permissions||!u.permissions.some(function(e){return e.properties&&e.properties.principal&&"Tenant"===e.properties.principal.type})}}catch(e){}return{appMappedViews:n,synchronizationData:r.d.SynchronizationData,synchronizationDataObject:s,synchronizationStatus:r.d.SynchronizationStatus}};t.prototype.getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e,listUrl:e});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.getDataSourceName=function(){return"ListDataSource"};t.prototype._addView=function(e,t){var i=this,o=e.title,n=e.sourceView,s=e.viewParams,a=e.isPublic,l=this._combineViewParamsAndXml(n,s);l.prepareForSaving();return this.getData(function(){return i.getListApiUrl(t).segment("Views").segment("Add").toString()},function(e){var t=JSON.parse(e);return new r.default(t.d)},"AddView",function(){return JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:o,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:n.getEffectiveFieldNames()},Query:l.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:n.rowLimit}})})};t.prototype._combineViewParamsAndXml=function(e,t){var i=new r.default(e.getEffectiveViewXml());if(t){if(t[l.default.sortFieldKey]){var o={fieldName:t[l.default.sortFieldKey],isAscending:"false"!==t[l.default.isAscendingKey]};i.updateSort(o,{prepend:!0})}t[l.default.groupByKey]&&i.updateGroupBy({group1:{fieldName:t[l.default.groupByKey],isAscending:!0}})}return i};t.prototype._getFilterParams=function(e){for(var t={},i=!1,r=0,o=Object.keys(e||{});r<o.length;r++){var n=o[r];if(l.default.filterKeyRegex.test(n)){i=!0;t[n]=e[n]}}return i?t:void 0};t.prototype._saveLegacyFilters=function(e,t,i){var r=this;return this.getData(function(){return r.getListApiUrl(i).methodWithAliases("SaveAsNewView",{oldName:e.id,newName:e.title,privateView:!!e.isPersonal,uri:r._pageContext.webAbsoluteUrl+c.getInplviewHash(e.id,t)}).toString()},function(e){var t=JSON.parse(e);return t&&t.d&&t.d.SaveAsNewView},"SaveViewFilters")};t.prototype._setViewXml=function(e,t){var i=this,r=e.sourceView,o=e.viewParams,n=this._combineViewParamsAndXml(r,o);n.prepareForSaving();return r.isDirty()||n.isDirty()?this.getData(function(){return i._getViewApiUrl({id:r.id},t).method("SetViewXml").toString()},function(){return null},"UpdateView",function(){return JSON.stringify({viewXml:n.getEffectiveViewXml()})}):p.default.wrap()};t.prototype._getViewApiUrl=function(e,t){return u.isViewById(e)?this.getListApiUrl(t).method("Views",e.id):u.isViewByUrl(e)?this._apiUrlHelper.build().webByUrl({path:t,listUrl:t}).method("GetViewFromUrl",e.url):this.getListApiUrl(t).method("Views",e.title)};t.prototype._viewFromServerView=function(e,t,i){if(e.ViewType&&e.Id){var o=d.isFeatureEnabled(d.PowerApps)&&r.default.isAppView(e),s=e.Hidden&&!o,a=i===n.default.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!s&&!a){var l=new r.default(e);if(l.viewType)return l}}return null};return t}(o);t.default=h});define("odsp-next/models/list/ViewIdentifier",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isViewById=function(e){return e&&!!e.id};t.isViewByUrl=function(e){return e&&!!e.url};t.isViewByTitle=function(e){return e&&!!e.title}});define("odsp-next/utilities/list/ListFilterHelper",["require","exports","./ListUtilities.resx","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities"],function(e,t,i,r,o,n){"use strict";return function(){function e(){}e.getFilterList=function(e,t,r,o){return n.default.getFilterList(e,t,r,o,i.strings.EmptyFilterValue)};e.clearFilterInfo=function(t,i){i=i||0;for(var r=e.getFilterList(t),o=i;o<r.length;o++){var s=r[o];t=n.default.addFilterInfo(t,s.fieldName,null,!0)}return t};e.getInplviewHash=function(e,t){var i="#InplviewHash"+(e=o.default.normalizeLower(e||"",!1))+"=";t&&(i+=Object.keys(t).map(function(e){return r.default.encodeURIComponent((e+"="+t[e]).replace(/-/g,"--"))}).join("-"));return i};return e}()});define("odsp-next/dataSources/bundle/odb/BundleDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getBundles=function(){return e={},e[1]={path:"odsp-next/bundles/odb/DeferredControls",isLoaded:this.createObservable(!1)},e[2]={path:"odsp-next/bundles/odb/Notifications",isLoaded:this.createObservable(!1)},e[4]={path:"odsp-next/bundles/odb/PushChannel",isLoaded:this.createObservable(!1)},e;var e};return t}(r.default);t.default=o});define("odsp-next/dataSources/microService/odb/MicroServiceDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./ThumbnailHelper","./PdfConversionHelper","./FbxConversionHelper","../../../utilities/killSwitch/KillSwitch","./AuthCookieHelper","../../../resources/SPOResourceKeys"],function(e,t,i,r,o,n,s,a,l,u,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="{.mediaBaseUrl}/transform/zip?cs={.callerStack}",m={accessToken:".accessToken",callerStack:".callerStack",correlationId:".correlationId",mediaBaseUrl:".mediaBaseUrl",pushChannelBaseUrl:".pushChannelBaseUrl",driveAccessToken:".driveAccessToken",driveAccessTokenV21:".driveAccessTokenV21",driveUrl:".driveUrl",driveUrlV21:".driveUrlV21",pdfConversionUrl:".pdfConversionUrl",thumbnailUrl:".thumbnailUrl",videoManifestUrl:".videoManifestUrl",zipUrl:".zipUrl",officeBundleGenerate:".officeBundleGenerate",officeBundleGetFragment:".officeBundleGetFragment",resourceUrl:".spResourceUrl",fileType:".fileType",itemUrl:".spItemUrl",cTag:".ctag",hasBxf:".hasBxf",hasOfficePreview:".hasOfficePreview",hasPdf:".hasPdf",hasThumbnail:".hasThumbnail",hasVideoManifest:".hasVideoManifest"},f=[".accessToken",".callerStack",".correlationId",".mediaBaseUrl",".pushChannelBaseUrl",".driveAccessToken",".driveUrl",".driveAccessTokenV21",".driveUrlV21",".zipUrl",".pdfConversionUrl",".thumbnailUrl",".videoManifestUrl",".officeBundleGenerate",".officeBundleGetFragment"],h=[".callerStack",".correlationId",".mediaBaseUrl",".spResourceUrl"],g=[".fileType",".callerStack",".mediaBaseUrl",".spItemUrl",".driveAccessToken"],v=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._properties={};i._platform=i.resources.consume(n.platformDetection);i._cookieHelper=new(i.managed(d.default));i._pageContext=i.resources.consume(c.pageContext);i._authDataSignal=new r.default;i._thumbnailHelper=i.resources.consume(s.resourceKey);return i}i.__extends(t,e);t.prototype.setBaseInfo=function(e){this._properties[m.zipUrl]=p;for(var t=0,i=f;t<i.length;t++){var r=i[t];e.data[r]&&(this._properties[r]=e.data[r])}this._properties[m.mediaBaseUrl]=this._fixMediaBaseUrl(this._properties[m.mediaBaseUrl]);var o=!(this._platform.isSafari||this._platform.isIE&&this._platform.browserMajor<=9),n=this._authData=this._getCurrentAuthData(e.allowCookies&&o);n&&this._authDataSignal.complete(n);var s=this._properties[m.mediaBaseUrl];this._cookieHelper.checkCookies(s,n)};t.prototype.getVideoUrl=function(e){if("False"!==e.item[m.hasVideoManifest]||e.item[m.videoManifestUrl]){var t=this._generateUrlAndFallback(m.videoManifestUrl,e.item);if(t){var i=e.mediaServiceMetadata,r=i&&i.video,o=r&&r.manifestMetadata;t+="&manifestMetadata="+(o?encodeURIComponent(o):"");var n=e.item[m.cTag];n&&(t+="&cTag="+encodeURIComponent(n))}return t}};t.prototype.getThumbnail=function(e){if(("False"!==e.item[m.hasThumbnail]||e.item[m.thumbnailUrl])&&this._thumbnailHelper.canProvideThumbnail(e.fileExtension)){var t=this._generateUrlAndFallback(m.thumbnailUrl,e.item),i=e.allowCookieAuth,r=void 0===i||i,o=e.itemKey,n=e.fileExtension,s=e.mediaServiceMetadata;if(t&&r&&this._cookieHelper.canUseCookies()){t=t.replace(new RegExp("&access_token=[^&]*&prooftoken=[^&]*","g"),"");e.item[m.cTag]&&(t+="&ctag="+encodeURIComponent(e.item[m.cTag]));this._cookieHelper.trackItem({itemKey:o,thumbnailUrl:t,fileExtension:n,mediaServiceMetadata:s})}return t&&this._thumbnailHelper.getThumbnail({itemKey:o,fileExtension:n,baseUrl:t,mediaServiceMetadata:s})}};t.prototype.getDownloadAsZipUrl=function(e){var t=m.zipUrl,i=this._getNormalUrl(t,e);if(!i){e[m.zipUrl]=p;i=this._getFallbackUrl(t,e)}return i};t.prototype.getPdfConversionUrl=function(e,t){if("False"!==e.item[m.hasPdf]||e.item[m.pdfConversionUrl])return a.default.canProvidePdfUrl(e.fileExtension)||t?this._generateUrlAndFallback(m.pdfConversionUrl,e.item):void 0};t.prototype.getFbxConversionUrl=function(e){if("False"!==e.item[m.hasBxf]||e.item[m.thumbnailUrl]){if(l.default.canProvideFbxUrl(e.fileExtension)){var t=this._generateUrlAndFallback(m.thumbnailUrl,e.item);return t?t.replace("/transform/thumbnail","/transform/bxf"):""}return""}};t.prototype.getHtmlConversionUrl=function(e){var t=this._generateUrlAndFallback(m.thumbnailUrl,e.item);return t?t.replace("/transform/thumbnail","/transform/html"):""};t.prototype.getZipUrl=function(e){var t=this._generateUrlAndFallback(m.thumbnailUrl,e.item);return t?t.replace("/transform/thumbnail","/transform/zipmetadata"):""};t.prototype.getOfficeBundleGenerateUrl=function(e){if("False"!==e.item[m.hasOfficePreview]||e.item[m.officeBundleGenerate]){var t=this._generateUrlAndFallback(m.officeBundleGenerate,e.item),i=encodeURIComponent(e.item[m.cTag]);return t&&t.replace("Generate","")+"&minVersion={{minVersion}}&cTag="+i}};t.prototype.getOfficeBundleGetFragmentUrl=function(e){if("False"!==e.item[m.hasOfficePreview]||e.item[m.officeBundleGetFragment]){var t=this._generateUrlAndFallback(m.officeBundleGetFragment,e.item);return t&&t.replace("Get","")+"&fragment={0}"}};t.prototype.getitemUrlWithToken=function(e){return e.toLowerCase().indexOf("access_token")>0?e:e+(-1===e.indexOf("?")?"?":"&")+this._properties[m.driveAccessToken]};t.prototype.getPushChannelUrl=function(e){var t=this._properties[m.pushChannelBaseUrl];t&&e&&(t=t.replace("-push",".push"));return t};t.prototype.getAuthData=function(){return this._authDataSignal.getPromise()};t.prototype._generateUrlAndFallback=function(e,t){var i=this._getNormalUrl(e,t);i||(i=this._getFallbackUrl(e,t));return i};t.prototype._fixMediaBaseUrl=function(e){return"https://media.cloudapp.net"===e?"edog"===this._pageContext.env?"https://centralus1-mediad.svc.ms":"https://southcentralus1-mediab.svc.ms":e};t.prototype._getNormalUrl=function(e,t){var i=this._properties[e];if(i){for(var r=0,o=g;r<o.length;r++){var n=o[r],s=void 0;if(n===m.itemUrl||n===m.fileType){s=t[n];e!==m.zipUrl||n!==m.fileType||s||(s="zipfile")}else s=this._properties[n];if(!s)return;if(n===m.itemUrl){if(this._isUrlTooLong(s))return;s=encodeURIComponent(s)}i=i.replace("{"+n+"}",s)}return i}};t.prototype._getFallbackUrl=function(e,t){var i=t[e];if(i){for(var r=0,o=h;r<o.length;r++){var n=o[r],s=t[n];n===m.mediaBaseUrl&&(s=this._fixMediaBaseUrl(s));if(!s){if(n===m.correlationId){i=i.replace("&correlationId={.correlationId}","");continue}return}n===m.resourceUrl&&(s=encodeURIComponent(s));i=i.replace("{"+n+"}",s)}return i}};t.prototype._isUrlTooLong=function(e){if(u.default.isActivated("8E63EAD3-5190-47A1-9AA9-D0CCEC8D59CC","1/6/2017","Stop checking url length"))return!1;if(this._authData&&this._authData.supportsCookies)return!1;var t=e.indexOf("/",8);return e.substring(t).length>215};t.prototype._getCurrentAuthData=function(e){var t=this._getDriveAuthData(this._properties[m.driveAccessToken]),i=this._getDriveAuthData(this._properties[m.driveAccessTokenV21]);if(i&&t)return{authToken:t.authToken,proofToken:t.proofToken,tokenUrl:this._properties[m.driveUrl],authTokenV21:i.authToken,proofTokenV21:i.proofToken,tokenUrlV21:this._properties[m.driveUrlV21],timeReceived:new Date,supportsCookies:e}};t.prototype._getDriveAuthData=function(e){if(e){var t=/access_token=(.+)&prooftoken=(.+)/.exec(e);if(t&&3===t.length)return{authToken:t[1],proofToken:t[2]}}};return t}(o.default);t.default=v});define("odsp-next/dataSources/microService/odb/ThumbnailHelper",["require","exports","tslib","../../../utilities/features/Features","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../url/odb/ItemUrlHelper","../../url/odb/ApiUrlHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={".xls":!0,".xlsx":!0},d={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},c=function(){function e(e,t){void 0===e&&(e={});this._apiUrlHelper=t.apiUrlHelper;this._itemUrlHelper=t.itemUrlHelper}e.prototype.getImageUrl=function(e){var t;if(e.isCrossDomain){var i=this._apiUrlHelper.build().webByItemUrl(e);t=(i=(i=r.isFeatureEnabled(r.SupportPoundPercent)?i.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl}):i.method("GetFileByServerRelativeUrl",e.serverRelativeItemUrl)).segment("OpenBinaryStream")).toString()}else t=e.fullItemUrl;return t};return e}();c.dependencies={apiUrlHelper:a.resourceKey,itemUrlHelper:s.resourceKey};t.CrossDomainImageHelper=c;t.crossDomainImageHelperResourceKey=new l.ResourceKey({name:e("module").id+".crossDomainImageHelper",factory:new l.ResolvedResourceFactory(c)});var p=function(){function e(e,t){void 0===e&&(e={});this._itemUrlHelper=t.itemUrlHelper;this._crossDomainImageHelper=t.crossDomainImageHelper}e.prototype.getThumbnail=function(e){var t,r=this,o=e.fileExtension,n=void 0===o?"":o,s=e.itemKey,a=e.baseUrl,l=e.mediaServiceMetadata,u=l&&l.photo,d=l&&l.video;u?t={width:u.width,height:u.height}:d&&(t={width:d.frameWidth,height:d.frameHeight});var c={width:t&&t.width||0,height:t&&t.height||0};if(".gif"===n.toLowerCase()){var p=this._itemUrlHelper.getItemUrlParts(s),m=this._crossDomainImageHelper.getImageUrl(p),f=i.__assign({url:m},c);return i.__assign({},f,{getAligned:function(e,t){return f}})}if(a)return i.__assign({url:this._getUrl({baseUrl:a})},c,{getAligned:function(e,o){return i.__assign({url:r._getUrl({baseUrl:a,desiredSize:e,alignment:o,size:t})},c)}})};e.prototype.canProvideThumbnail=function(e){if(!e)return!1;"."===(e=e.toLowerCase())[0]&&(e=e.substring(1));return!u[e]&&(!!r.isFeatureEnabled(r.UseThumbnailService)||!!r.isFeatureEnabled(r.ExpandThumbnailSupport)&&(e&&!d[e]))};e.prototype._getUrl=function(e){var t=e.desiredSize,i=void 0===t?{width:1024,height:1024}:t,r=e.alignment,s=e.size,a=void 0===s?{width:"",height:""}:s,l={width:Math.ceil(i.width),height:Math.ceil(i.height),srcWidth:a.width,srcHeight:a.height};r&&(r.name===o.coverCenter.name?l.cropMode="fill":r.name===o.fitWidth.name+"-"+o.top.name&&(l.cropMode="dochead"));return e.baseUrl+"&"+n.serializeQuery(l)};return e}();p.dependencies={crossDomainImageHelper:t.crossDomainImageHelperResourceKey,itemUrlHelper:s.resourceKey};t.default=p;t.resourceKey=l.createDefaultResourceKey(e,p)});define("odsp-next/dataSources/microService/odb/PdfConversionHelper",["require","exports","../../../utilities/features/Features"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["msg","eml"],o=function(){function e(){}e.canProvidePdfUrl=function(e){if(!e)return!1;if(!i.isFeatureEnabled(i.UseWebPdfViewer))return!1;if(i.isFeatureEnabled(i.EnablePdfCoversionForAllTypes))return!0;"."===e[0]&&(e=e.substring(1));return r.indexOf(e.toLowerCase())>=0};return e}();t.default=o});define("odsp-next/dataSources/microService/odb/FbxConversionHelper",["require","exports","../../../utilities/features/Features"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["fbx","obj","3mf","stl","ply","cool"],o=function(){function e(){}e.canProvideFbxUrl=function(e){if(!e)return!1;if(!i.isFeatureEnabled(i.EnableOneUpFbxPreview))return!1;"."===e[0]&&(e=e.substring(1));return r.indexOf(e.toLowerCase())>=0};return e}();t.default=o});define("odsp-next/dataSources/microService/odb/AuthCookieHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../models/task/Task","./ThumbnailHelper","../../../utilities/graft/Graft","../../../utilities/images/ImagePromise","../../../utilities/auth/DomainAuthenticator","../../item/ItemTaskObserver"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._platform=i.resources.consume(a.platformDetection);i._thumbnailHelper=i.resources.consume(u.resourceKey);i._itemTaskObserverType=i.resources.consume(m.resourceKey);i._cookieState=0;i._haveCookies=new r.default;i._itemsWaitingForCookies=[];i._cookieAuthData={};p.default.registerCookieChecker({isApplicable:function(e){return!(e.indexOf("access_token")>0||e.indexOf(".svc.ms/transform/thumbnail")<0)},check:function(e){var t=new r.default;i._haveCookies.getPromise().done(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()}});return i}i.__extends(t,e);t.prototype.canUseCookies=function(){return!(!this._cookieAuthData.active&&1!==this._cookieState)};t.prototype.trackItem=function(e){this._cookieAuthData.active||this._itemsWaitingForCookies.push(i.__assign({},e))};t.prototype.checkCookies=function(e,t){if(-1!==this._cookieState&&t&&t.supportsCookies){this._cookieAuthData.mostRecent=t;if(1!==this._cookieState)if(this._cookieAuthData.active){if(this._cookieAuthData.active!==t){var i=(new Date).getTime()-this._cookieAuthData.active.timeReceived.getTime();if(i>432e5){this._haveCookies=new r.default;this._cookieAuthData.active=void 0}i>72e5&&this._updateCookies(e,t)}}else this._updateCookies(e,t)}};t.prototype._updateCookies=function(e,t){var i=this,r=0===this._cookieState;this._cookieState=1;this._makeImageRequest(e,t,r).then(function(){i._cookieAuthData.active=t;i._cookieState=2;i._itemsWaitingForCookies.length=0;i._haveCookies.complete(!0)},function(){i._cookieState=-1;i._updateThumbnailUrls(t);i._haveCookies.error(!1)})};t.prototype._makeCorsRequest=function(e,t){var i,r=this;e+="/Auth/SetCookies?provider=spo";if(this._platform.isIE&&this._platform.browserMajor<=10){e+="&access_token="+t.authToken;e+="&prooftoken="+t.proofToken}else i={spo_access_token:t.authToken,spo_prooftoken:t.proofToken};return this.sendCorsRequest(e,i).then(function(t){if(!t.isOldCookiePresent)return r.sendCorsRequest(e,i).then(function(e){if(!e.isOldCookiePresent)return o.default.wrapError("Cookie request succeeded, but the cookies are not actually being set")})})};t.prototype.sendCorsRequest=function(e,t){return n.default.start({withCredentials:!0,url:e,headers:t,method:"POST"}).then(function(e){var t;try{t=JSON.parse(e.responseText)}catch(e){}return t||o.default.wrapError("Expected response object but received nothing")})};t.prototype._makeImageRequest=function(e,t,i){e+="/Auth/SetCookiesImg?provider=spo";e+="&access_token="+t.authToken;e+="&prooftoken="+t.proofToken;return c.request(e).then(function(){if(i)return c.request(e+"&throwOnMissingCookies=true")})};t.prototype._updateThumbnailUrls=function(e){var t=this;if(this._itemsWaitingForCookies.length){var i=new this._itemTaskObserverType;i.update(this._itemsWaitingForCookies.map(function(i){var r=i.itemKey,o=i.thumbnailUrl+"&access_token="+e.authToken+"&prooftoken="+e.proofToken,n=t._thumbnailHelper.getThumbnail({baseUrl:o,itemKey:r,fileExtension:i.fileExtension,mediaServiceMetadata:i.mediaServiceMetadata});return new l.default(r).succeed({item:{key:r,thumbnail:d.replace(n)}})}));this._itemsWaitingForCookies.length=0;i.flush()}};return t}(s.default);t.default=f});define("@ms/odsp-utilities/lib/xhr/XHRPromise",["require","exports","./XHR","../async/Promise"],function(e,t,i,r){"use strict";var o=function(){function e(){}e.start=function(e){var t=new i.default(e);return new r.default(function(e,i){t.start(e,i)},function(){t.abort(!0)})};e.startAndPostProcess=function(e,t){var o=new i.default(e);return new r.default(function(e,i){o.start(function(i,r){e(t(i,r))},i)},function(){o.abort(!0)})};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("@ms/odsp-utilities/lib/xhr/XHR",["require","exports","../async/Async","../logging/ErrorHelper","../object/ObjectUtil"],function(e,t,i,r,o){"use strict";var n=function(){function e(t){this._async=new i.default(this);var r=t.url,o=t.requestTimeoutInMS,n=void 0===o?e.DEFAULT_TIMEOUT_MS:o,s=t.json,a=t.headers,l=void 0===a?{}:a,u=t.withCredentials,d=void 0!==u&&u,c=t.needsCors,p=void 0!==c&&c,m=t.onProgress,f=t.onUploadProgress,h=t.method,g=void 0===h?s?"POST":"GET":h;this._url=r;this._requestTimeoutInMS=n;this._postData=s;this._headers=l;this._method=g;this._withCredentials=d;this._needsCors=p;this._progressCallback=m;this._uploadProgressCallback=f}e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)};e.prototype.start=function(e,t){var i=this;this._successCallback=e;this._failureCallback=t;var n=this,s=n._method,a=n._headers;try{this._request=this._getRequest();var l=this,u=l._progressCallback,d=l._uploadProgressCallback,c=l._request;u&&(c.onprogress=function(e){try{u(e)}catch(e){r.default.logError(e)}});d&&(c.upload.onprogress=function(e){try{d(e)}catch(e){r.default.logError(e)}});this._async.setTimeout(function(){i._completed||i._timeoutCallback()},this._requestTimeoutInMS);c.onreadystatechange=function(){if(!i._completed){var e=4;try{e=c.DONE||4}catch(e){}c.readyState===e&&i._requestEndCallback()}};c.open(s,this._url,!0);"withCredentials"in c&&(c.withCredentials=this._withCredentials);for(var p in a)c.setRequestHeader(p,a[p]);c.send(this._postData)}catch(e){r.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:o.safeSerialize(a),method:s});this._abortRequest();this._callFailureCallback(this._request,-1,!1)}};e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};e.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,-2,!0)}};e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){r.default.log(e)}};e.prototype._callFailureCallback=function(e,t,i){try{this._failureCallback&&this._failureCallback(e,t,i)}catch(e){r.default.log(e)}};e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1;r.default.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}};return e}();n.DEFAULT_TIMEOUT_MS=3e4;Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("odsp-next/models/selection/ItemSetSelectionModel",["require","exports","tslib","./BaseSelectionModel","../../providers/item/ItemProvider","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","knockout","./SelectionResolver","../item/ItemParentHelper"],function(e,t,i,r,o,n,s,a,l,u,d,c){"use strict";function p(e,t){var i=t&&t.peek&&t.peek();return i&&i.properties&&(e?i.properties.uniqueId:i.properties.ID)||i&&i.key||null}function m(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}var f=1e3;return function(e){function t(t){void 0===t&&(t={});var i=this,r={getItemKey:m};u.utils.extend(r,t||{});i=e.call(this,r)||this;var n=t.itemSet,a=void 0===n?i.resources.consume(s.currentItemSet):n,l=t.indexResolver,p=t.enableSelectionResolution,h=void 0===p||p;i.itemSet=a;i.itemProvider=i.resources.consume(o.resourceKey);i._maxItemsPerRange=t.maxItemsPerRange||f;i._enableSelectionResolution=h;i._itemParentHelper=i.resources.consume(c.resourceKey);i._currentItems=i.createPureComputed(i.computeCurrentItems);i._itemKey=i.createPureComputed(i._computeItemKey);i.createComputed(function(){i._onItemSetChanged(i._currentItems())});i.createComputed(i._computeResetSelectionOnKeyChange);l&&(i._selectionResolver=new(i.managed(d.default))({itemSet:i.itemSet,indexResolver:l}));return i}i.__extends(t,e);t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return n.default.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var i=[],r=this.getItems(),o=0;o<r.length;o++)(this.isIndexSelected(o)||!r[o]&&this.isAllSelected.peek())&&i.push(o);return this._selectionResolver.resolveSelection(i).then(function(){return e._unwrapSelection(e.selection.peek())})}var s={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new a.default,getItemPromises:[]};this.validateResolvedSelection(s);return s.signal.getPromise()}return n.default.wrap(this._unwrapSelection(this.selection.peek(),!0))};t.prototype.validateResolvedSelection=function(e){if(++e.resolveAttempt>4)e.signal.error({resultType:l.ResultTypeEnum.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();e.getItemPromises=[];e.missingRanges=t;e.pendingCount=t.length;if(0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var i=0;i<5;i++)this.resolveNextRange(e)}};t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var i=e.missingRanges.pop(),r=u.utils.extend({},e.itemSet.context);r.avoidSeamSnapping=!0;r.startIndex=i.start;r.endIndex=i.end;r.pageSize=i.end-i.start+1;e.getItemPromises.push(this.itemProvider.getItem(r).then(function(){--e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(i){t.cancelResolve(e,i)}))}};t.prototype.cancelResolve=function(e,t){for(var i=0;i<e.getItemPromises.length;i++)e.getItemPromises[i].cancel();t?e.signal.error(t):e.signal.cancel()};t.prototype.getMissingRanges=function(){var e=[],t=-1,i=-1,r=this.getMissingIndicies();if(r.length){t=r[0];i=r[r.length-1];for(;t>-1;){var o=Math.min(i,t+f-1),n={start:t,end:o};e.push(n);t=o===i?-1:o+1}}return e};t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]};t.prototype._onItemSetChanged=function(e){var t=this.itemSet.peek(),i=t&&t.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t.item.peek(),"list"));i&&i.list?this.getItemKey=p.bind(void 0,i.list.isDocumentLibrary):this.getItemKey=m;this.setItems(e,!1)};t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey();this.clear(!0)};t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var i=[],r=0,o=e;r<o.length;r++){var n=o[r],s=this.peekUnwrapObservable(n);!s&&t||i.push(s)}return i};t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key};return t}(r.default)});define("odsp-next/models/selection/BaseSelectionModel",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,i,r,o){"use strict";function n(e){return!0}Object.defineProperty(t,"__esModule",{value:!0});var s=100,a=function(e){function t(i){var r=e.call(this,i)||this;r._focusIsUserInput=!1;r.mode=i.mode||0;r.maximumSelectedCount=i.maximumSelectedCount;r.getItemKey=i.getItemKey;r._canSelectItem=i.canSelectItem||n;r._selectionModelGroup=i.selectionModelGroup;r._allSelectables={};r._items=[];r.selectedCount=r.createObservable();r.selection=r.observables.createArray().extend({rateLimit:{timeout:s,method:"notifyWhenChangesStop"}});r.isAllSelected=r.createObservable(!1).extend({rateLimit:{timeout:s,method:"notifyWhenChangesStop"}});r.focusedItem=r.createObservable();r.focusedItem.equalityComparer=o.objectStrictEquality;r.isActive=r.createObservable(!0);r.clear(!0);r._clearFocusIsUserInput=r.async.throttle(r._clearFocusIsUserInput,0,{trailing:!0});r._selectionModelId=""+ ++t._nextSelectionModelId;r._selectionModelGroup&&r._selectionModelGroup.registerSelectionModel(r,r._selectionModelId);return r}i.__extends(t,e);t.prototype.dispose=function(){e.prototype.dispose.call(this);this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId);this._allSelectables=null};t.prototype.clear=function(e){this._isSelectedDefaultState=!1;this._keysExempt={};this._exemptCount=0;if(e){this._focusIndex=-1;this._anchorIndex=-1;this._anchorKey=null;this._focusIsUserInput=!1;this.focusedItem(null)}this.selection.removeAll();this.isAllSelected(!1);this._updateAllSelectables();this._updateSelectedCount()};t.prototype.setItems=function(e,t){this._items=e;this._selectableItems=this._items;t&&this.clear(!0);this._onItemsChanged(!0)};t.prototype.setAllFocusableItems=function(e){this._items=e;this._focusIndex=-1;this._onItemsChanged(!1)};t.prototype.getItems=function(){return this._items};t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)};t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),i=!!this._keysExempt[t];return this._canSelectItem(e)&&(this._isSelectedDefaultState&&!i||!this._isSelectedDefaultState&&i)};t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var i=0,r=e;i<r.length;i++){var o=r[i],n=this._keyToIndex[o];if(n>=0){var s=this._items[n];this._keysExempt[o]=s;t.push(s)}}this._exemptCount=t.length;this._isSelectedDefaultState=!1;(a=this.selection).splice.apply(a,[0,this.selection.peek().length].concat(t));this._updateIsAllSelected();this._updateSelectedCount();this._updateAllSelectables();this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId);var a};t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)};t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null};t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)};t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)};t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)};t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))};t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])};t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var i=t.preventAnchor,r=void 0!==i&&i,o=t.isFocusInput,n=void 0===o||o,s=this.focusedItem.peek(),a=this.getItemKey(e),l=this._keyToIndex[a];this._focusIsUserInput=n;if(e!==s){u=this.getItemKey(s);this._updateSelectable(u,{focusState:0,isFocused:!1})}if(l>=0){var u=this.getItemKey(e);this._focusIndex=l;this.focusedItem(e||null);u&&this._updateSelectable(u,{focusState:n?2:1,isFocused:!0})}else this.focusedItem(null);if(!r){this._anchorIndex=l||-1;this._anchorKey=a}this._clearFocusIsUserInput()};t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={});this.setItemFocus(this._items[e],t)};t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),i=this.getItemKey(t),r=this._allSelectables[i];if(r&&r.length)for(var o=0;o<r.length;o++){var n=r[o];if(n.onInvoke)return n.onInvoke(e)}return!0};t.prototype.setIsActive=function(e){this.isActive(e)};t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,i=this.getItemKey(e);if(i){var r=this._keyToIndex[i],o=Math.min(t.length-1,Math.max(0,this._anchorIndex)),n=Math.max(r,o);if(t.length&&n>=0){for(var s=Math.min(r,o);s<=n;s++)this._setItemSelectedCore(t[s],!0,!1);this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}}}};t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])};t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this._isSelectedDefaultState=!0;(e=this.selection).splice.apply(e,[0,this.selection.peek().length].concat(this._selectableItems));this._keysExempt={};this._exemptCount=0;this._updateIsAllSelected();this._updateAllSelectables();this._updateSelectedCount();this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId);var e}};t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()};t.prototype.registerSelectable=function(e,t){var i=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");var r;r="string"==typeof e?e:this.getItemKey(e);this._allSelectables[r]||(this._allSelectables[r]=[]);this._allSelectables[r].push(t);var o=this._items[this._keyToIndex[r]],n=this.focusedItem.peek()===o,s=n?this._focusIsUserInput?2:1:0,a=this.isItemSelected(o);this._updateSelectable(r,{focusState:s,isFocused:n,isSelected:a});return{dispose:function(){if(i._allSelectables&&i._allSelectables[r]){var e=i._allSelectables[r];if(1===e.length)delete i._allSelectables[r];else{var o=e.indexOf(t);o>=0&&e.splice(o,1)}}}}};t.prototype.getFocusIndex=function(){return this._focusIndex};t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,i=0;t&&i<t.length;i++){var r=t[i];this.isItemSelected(r)&&!this.getItemKey(r)&&e.push(i)}return e};t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup};t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)};t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null};t.prototype._setItemSelectedCore=function(e,t,i){var r=this,o=this.getItemKey(e);if(o&&o in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return r.canSelectItem(e)}))return;1===this.mode&&t&&this.clear();this._keysExempt[o]?delete this._keysExempt[o]:this._keysExempt[o]=e;t?this.selection.push(e):this.selection.remove(e);this._updateSelectable(o,{isSelected:this.isItemSelected(e)});this._exemptCount+=t?1:-1;this._updateIsAllSelected();this._updateSelectedCount();this._selectionModelGroup&&t&&i&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this._isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)};t.prototype._updateSelectable=function(e,t){var i=this._allSelectables[e];if(i)for(var r=0,o=i;r<o.length;r++){var n=o[r];for(var s in t){var a=t[s],l=n[s];this.isObservable(l)&&l(a)}}};t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var i=e._items[e._keyToIndex[t]];i&&e._canSelectItem(i)&&e._updateSelectable(t,{isSelected:e.isItemSelected(i)})}})};t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={};e&&(this._selectableItemsMap={});var i=this._items,r=[],o=this.getItemKey(this.focusedItem.peek()),n=this._anchorKey;if(i){for(var s=this,a=0;a<i.length;a++)!function(a){var l=i[a],u=s.observables.ignore(function(){return t.getItemKey(l)});if(u){s._keyToIndex[u]=a;e&&(s._selectableItemsMap[u]=!0);o&&o===u&&(s._focusIndex=a);n&&n===u&&(s._anchorIndex=a)}s.isItemSelected(l)&&r.push(l)}(a);this._focusIndex=i.length?Math.min(i.length-1,this._focusIndex):-1;this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1});(l=this.selection).splice.apply(l,[0,this.selection.peek().length].concat(r));this._updateIsAllSelected();this._updateSelectedCount()}var l};t.prototype._updateSelectedCount=function(){var e=this._isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)};t.prototype._clearFocusIsUserInput=function(){this._focusIsUserInput=!1};return t}(r.default);a._nextSelectionModelId=1;t.default=a});define("odsp-next/models/selection/SelectionResolver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this,t)||this,r=t.itemSet,o=void 0===r?i.resources.consume(n.currentItemSet):r,s=t.indexResolver;i._itemSet=o;i._indexResolver=s;return i}i.__extends(t,e);t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):o.default.wrap()};t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)};t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)};t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,i=[],r=0,o=e;r<o.length;r++){var n=o[r],s=t[n];this._isItemResolved(s)||i.push(n)}return i};return t}(r.default);t.default=s});define("odsp-next/pages/files/spo/SortManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,i,r,o){"use strict";return function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._navigation=i.resources.consume(o.navigation);return i}i.__extends(t,e);t.prototype.updateSort=function(e,t){var i=this._navigation,r=(o={},o.sortField=e,o.isAscending=t,o);i.updateViewParams(r);var o};return t}(r.default)});define("odsp-next/pages/files/spo/DataManager",["require","exports","tslib","knockout","./SPOFiles.resx","@ms/odsp-shared/lib/base/BaseModel","../../../controls/leftPane/LeftPane.resx","../../../controls/list/layouts/LayoutType","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../dataSources/url/odb/UrlQueryKeys","@ms/odsp-datasources/lib/Permissions","../../../models/item/OneDriveItem","../../../models/item/ItemParentHelper","../../../models/itemSet/ItemSet","../../../models/store/ItemsStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../../providers/item/ItemProvider","../../../providers/list/ListProvider","../../../providers/suiteNav/SuiteNavProvider.key","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/LoggingResourceKeys","../../../resources/ModelResourceKeys","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/ModuleLoader","../../../utilities/browser/ResponsiveUI","../../../utilities/features/Features","@ms/odsp-utilities/lib/guid/Guid","../../../utilities/list/ListFilterHelper","@ms/odsp-datasources/lib/utilities/list/ListFilterUtilities","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/utilities/logging/events/ListViewRendered.event","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","../../../utilities/wrs/WrsHelper.key","../../../utilities/killSwitch/KillSwitch","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-datasources/lib/utilities/caml/CamlSerialization"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k,P,L,R,F,A,M,E,U,B,O,N,V,H,K,q,z,G,j,W){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var X=function(t){function n(e){void 0===e&&(e={});var i=t.call(this,e)||this;i._layoutTypeSaved=null;i._inNewFolderDataFetch=!1;i._firstDataFetchComplete=!1;i._pltLogComplete=!1;i._viewParamsCurrent=null;i._resetLayoutOnDataFetch=!1;i._autoExecuteRequested=!1;i._listViewMounted=!1;i._navigatingFromOtherApp=!!window.__onePageContext;var o=e.defaultViewId,n=e.itemResultSetOptions,s=e.disableAutomaticLayoutSwitch,l=void 0!==s&&s;i._itemResultSetOptions=n;i._defaultViewId=A.default.normalizeLower(o);i._disableAutomaticLayoutSwitch=l;i._resetPartialResultRequestCount=r.observable(!1);i._viewParams=i.resources.consume(S.viewParams);i._responsiveUI=i.resources.consume(R.resourceKey);i._isLeftNavUserExpanded=i.resources.consume(C.base.leftNav.isLeftNavUserExpanded);i._navigation=i.resources.consume(k.navigation);i._dataStore=i.resources.consume(g.resourceKey);i._rumOneHelper=i.resources.consume(I.rumOneHelper);i._onePageNavigationDataFetch=r.observable(!1);var u=i.resources.consume(D.onePageContext.optional);u&&(u.onePageNavigationDataFetch=i._onePageNavigationDataFetch);i._pageContext=i.resources.consume(D.pageContext);i._listContext=i.resources.consume(D.listContext);i._itemParentHelper=i.resources.consume(f.resourceKey);i._currentHashtag=i.resources.isExposed(D.currentHashtag)?i.resources.consume(D.currentHashtag):"";i._currentHashtag&&(i._queryTypeOverride=d.Hashtag);i._loaderProvider=i.resources.consume(T.bundleLoader);i._isPageLoaded=!1;i._currentItemKey=i.createPureComputed(i._computeCurrentItemKey,{deferEvaluation:!0});var c=new m,v=new h;v.item=r.observable(c);i.item=i.resources.expose(S.currentItem,v.item);i.item.equalityComparer=O.objectStrictEquality;i.itemSet=i.resources.expose(S.currentItemSet,r.observable(v));i.itemSet.equalityComparer=O.objectStrictEquality;i._children=r.observableArray([]);i.isEmptyView=r.observable(!1);i.isGroupThrottled=i.resources.isExposed(S.groupThrottle)?i.resources.consume(S.groupThrottle):r.observable(!1);i.showErrorPage=r.observable(!1);i.isRetrievingData=r.observable(!0);i.error=r.observable(null);i.createComputed(function(){(r=i._children).splice.apply(r,[0,i._children.peek().length].concat(i.itemSet().content().items));var e=i.itemSet().content().groupings,t=e&&e.length>0&&e[0].itemGroups&&e[0].isAllCollapsed();i.isEmptyView(!i.showErrorPage()&&!i.itemSet().isPlaceholder&&0===i._children().length&&!t);var r});i.createComputed(function(){i.item(i.itemSet().item())});i.currentView=r.observable(null);i.resources.expose(S.currentView,i.currentView);i._setUpContextualLayoutTypes();i._itemProvider=i.resources.consume(b.resourceKey);i._listProvider=i.resources.consume(y.resourceKey);i._urlDataSource=i.resources.consume(x.url);i.queryType=i.createComputed(i._computeQueryType,{deferEvaluation:!0});i.requiredRange=r.observable({start:0,end:0}).extend({throttle:500});i.itemsPerGroup=i.resources.isExposed(D.itemsPerGroup)?i.resources.consume(D.itemsPerGroup):r.observable(-1);i.requiredGroup=r.observable(null);i.expandAll=r.observable(!1);i.layoutType=r.observable(i.getDefaultLayoutForView());i.supportsNestedGroups=i.createPureComputed(function(){if(Number(i._pageContext.webTemplate)===q.default.mySite)return!1;var e=i.layoutType();return F.isFeatureEnabled(F.UseReactDetailsList)&&(e===a.CustomList||e===a.Details)});i.canModifySchema=i.createPureComputed(i._computeCanModifySchema);i.title=i.createComputed(i._computeTitle,{deferEvaluation:!0});i.focusItem=r.observable();i.isOneUp=i.createComputed(i._computeIsOneUp);i.createBackgroundComputed(i._computeSetDocumentTitle);G.default.isActivated("F9A2C8CB-C058-4E12-B344-297A3352155B","2/28/2017","potential EUPL benefit without deferEvaluation")?i._getItemContext=i.createComputed(i._computeGetItemContext,{deferEvaluation:!0}):i._getItemContext=i.createComputed(i._computeGetItemContext);i._getItemContext.equalityComparer=N.deepCompare;i.createComputed(i._computeItemSet).extend({throttle:1});i.resources.isExposed(x.identity)&&(i._userIsAnonymous=i.resources.consume(x.identity).getIdentity().type===p.IdentityType.anonymous);i._preloadWACComplete=!1;i.platform=i.resources.consume(K.platformDetection);i._filterCrumbOnClick=i._filterCrumbOnClick.bind(i);return i}i.__extends(n,t);n.prototype.setLayoutIteration=function(e){var t=this;this._layoutIteration=e;this._layoutIteration.subscribe(function(e){t._handlePageLoad()},this)};n.prototype.onLayoutRenderComplete=function(){this._handlePageLoad()};n.prototype.updateSort=function(e,t){};n.prototype.getCrumbs=function(e){for(var t=this._viewParams(),i=[],o=!1,n=B.serializeQuery(t),a=this._listContext&&this._listContext.rawListSchema?this._listContext.rawListSchema.Field:null,l=M.getFilterList(n,a),u=l&&l.length>0,d=this._getAriaLabelsForFilteredListBreadCrumbs(l),m=l.length-1;m>=0;m--){var f=l[m],h=this._tryFormat(f.values,f.type),g={key:e.key,url:"#"+M.clearFilterInfo(n,m+1),name:h,showNextChevron:o,isDroppingTarget:r.observable(!1),isOverflow:!1,isNavItem:o,isStaticItem:!o,ariaLabel:d.pop(),onClick:this._filterCrumbOnClick};i.push(g);o=!0}d=this._getAriaLabelsForBreadCrumbs(e);if(e.parent||u)for(;e&&(!this._userIsAnonymous||p.PermissionMask.hasItemPermission(e,p.PermissionMask.openItems));){var v=o,b=!o;if(e.isStub){v=!1;b=!0}var y=e,_="#"+e.key;t[c.default.useFiltersInViewXmlKey]&&(_+="&"+c.default.useFiltersInViewXmlKey+"=1");if(!Boolean(e.parent)&&u){y=null;var S=B.deserializeQuery(n);delete S[c.default.idParamKey];_="#"+M.clearFilterInfo(B.serializeQuery(S))}var x={key:e.key,url:_,name:e.name||s.strings.Files,showNextChevron:o,isDroppingTarget:r.observable(!1),item:y,isOverflow:!1,isNavItem:v,isStaticItem:b,isFiltered:u,ariaLabel:d.pop(),onClick:u?this._filterCrumbOnClick.bind(this):void 0};i.push(x);o=!0;e=e.parent}return i};n.prototype.getDefaultLayoutForView=function(){var e=this.item.peek(),t=this._getRootItem(e),i=t&&t.list,r=this._urlDataSource.getKeyParams(e.key),o=this._urlDataSource.getQueryType(r);e&&e.displayType===d.Photos&&(o=d.Photos);if(o===d.Discover||o===d.Hashtag)return a.DocumentCardsGrid;if(o===d.Subsites)return a.SitesGrid;var n=this._responsiveUI;if(this._contextualLayoutTypes[o])return this._contextualLayoutTypes[o];if(n.compareSize(n.formFactorSize(),"Medium")<=0||e&&(e.queryType===d.Recent||e.displayType===d.Photos))return a.Grid;if(i){if(i.templateType===l.default.pictureLibrary)return a.Grid;if(i.templateType===l.default.mySiteDocumentLibrary)return a.Details;if(i.isDocumentLibrary)return a.CustomList}return a.Details};n.prototype.getMorePartialResult=function(){if(1===this.itemSet.peek().content.peek().partialResultStatus){U.Engagement.logData({name:"LargeList.GetMorePartialResult"});this._resetPartialResultRequestCount(!0)}};n.prototype.cacheLayoutContext=function(){var e=this.item.peek(),t=this._urlDataSource.getKeyParams(e.key);if(!this._inNewFolderDataFetch&&e&&!e.isPlaceholder){var i=this._urlDataSource.getQueryType(t);e&&e.displayType===d.Photos&&(i=d.Photos);this._contextualLayoutTypes[i]=this.layoutType.peek();this._dataStore.setValue(this._getLayoutLocalStorageKey(),this._contextualLayoutTypes,v.default.local)}};n.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],i=void 0;e;){if(i){i=V.format(o.strings.breadCrumbItem,i,e.name||s.strings.Files);t.push(i)}else{i=e.name||s.strings.Files;var r=e.parent?e.parent.name:s.strings.Files;t.push(r)}e=e.parent}return t};n.prototype._getAriaLabelsForFilteredListBreadCrumbs=function(e){for(var t=[],i=void 0,r=e.length-1;r>=0;r--){var n=e[r],s=this._tryFormat(n.values,n.type);i=i?V.format(o.strings.breadCrumbItem,i,s):s;t.push(i)}return t};n.prototype._handlePageLoad=function(e){if(this._firstDataFetchComplete)if(this._pltLogComplete)(this.itemSet().content().items&&this.itemSet().content().items.length>0||0===this.itemSet().content().items.length&&e)&&this.async.setTimeout(function(){H.ListViewRendered.logData()},0);else{this._rumOneHelper.mark("pageLoadComplete before setTimeout");this.async.setTimeout(this._pageLoadComplete,0)}else this._listViewMounted=!0};n.prototype._tryFormat=function(e,t){return E.default.formatBreadcrumbFilterValues(e,t,{booleanFalse:o.strings.booleanFalse,booleanTrue:o.strings.booleanTrue})};n.prototype._preloadWACResources=function(){var e=this.resources.consume(x.url),t=document.createElement("iframe"),i=e.getWACResourcesPreloadUrl();t.style.visibility="hidden";t.style.position="absolute";t.style.top=t.style.left=t.style.height=t.style.width="0";t.name="wachiddenframe";t.src=i;document.body.appendChild(t)};n.prototype._computeItemSet=function(){var e=this;this._pltLogComplete||this._rumOneHelper.mark(this._firstDataFetchComplete?"DataManager.GetItem.Start":"DataManager.FirstDataFetch.GetItem.Start");this._resetLayoutOnDataFetch&&this.isRetrievingData(!0);var t=N.deepCopy(this._getItemContext()),i=this._itemProvider.getItemSync(t),o=i.item.peek().key;this.itemSet(i);var n,s=this.queryType(),a=this._itemProvider,l=this._viewParams.peek(),u=this._urlDataSource.getFocusItemKey(l);if(!G.default.isActivated("F48345E5-09D5-443E-A900-2D1F155CDF8A","4/17/2017","Dedicated single item request for OneUp")&&u&&i.isPlaceholder)n=this._itemProvider.getItem({parentKey:u,ignoreChildren:!0});else{s===d.Search||s===d.SharedWithMe?this._previousItemKey!==o&&a.invalidateItem(o):s===d.Hashtag&&(t.hashtag=this._currentHashtag);n=a.getItem(t)}this._previousItemKey=o;this._getItemPromise=n;this.showErrorPage(!1);this.error(null);this._setLayoutType();var p=!!l[c.default.newTargetListUrlKey]&&l[c.default.newTargetListUrlKey]!==this._pageContext.listUrl;if(p){var m=this.resources.consume(_.resourceKey.optional);m&&m.clearCachedPromise();this._onePageNavigationDataFetch(!0)}this.trackPromise(n.then(function(i){if(n===e._getItemPromise){e._getItemPromise=null;e.isRetrievingData(!1);var o=e._listContext.viewResult;if(p){e._listProvider.views([]);e._listProvider.fields([]);e._onePageNavigationDataFetch(!1);e._setUpContextualLayoutTypes()}o&&t.baseViewId&&t.baseViewId!==A.default.Empty&&o.id!==t.baseViewId&&(o=null);var a=e.currentView.peek();if(o)e._listProvider.registerView(o);else if(t.baseViewId&&t.baseViewId!==A.default.Empty){var u=e._listProvider.views.peek();o=r.utils.arrayFirst(u,function(e){return e.id===t.baseViewId})}e.currentView(o);if(o&&2048===o.viewType&&(!a||a.id!==o.id)){var m=e.resources.consume(S.actionMap);(new(e.managed(m.EditAction))).execute(null)}e._pltLogComplete||e._rumOneHelper.mark(e._firstDataFetchComplete?"DataManager.GetItem.End":"DataManager.FirstDataFetch.GetItem.End");e._resetPartialResultRequestCount.peek()&&1!==i.content.peek().partialResultStatus&&e._resetPartialResultRequestCount(!1);if(i.item&&e._inNewFolderDataFetch){e._inNewFolderDataFetch=!1;e._resetLayoutOnDataFetch=!1;e._firstDataFetchComplete=!0;var f=!i.content||!i.content.peek().items||0===i.content.peek().items.length;(e._listViewMounted||p)&&f&&e._handlePageLoad(!0);if(!e._autoExecuteRequested&&s===d.Files){var h=l[c.default.policyTipKey]||l[c.default.policyTipKey.toLowerCase()],g=l[c.default.sharingKey]||l[c.default.sharingKey.toLowerCase()];if(h){e._autoExecuteRequested=!0;e._showAutoExecuteAction(0,h,i)}else if(g){e._autoExecuteRequested=!0;e._showAutoExecuteAction(1,g,i)}}e._pltLogComplete||e._rumOneHelper.mark("DataManager.Before_setLayoutType");e._setLayoutType();if(i.item.peek().error){e.error(i.item.peek().error.data);e.showErrorPage(!0)}}}},function(t){e.isRetrievingData(!1);if(-2!==t.errorCode&&-3!==t.errorCode||!e.handleClassicExperienceRendering){if(!P.default.isCanceled(t)){e.error(t);e.showErrorPage(!0);e.events.raise("pageLoadComplete")}}else e.handleClassicExperienceRendering(t)}))};n.prototype._setUpContextualLayoutTypes=function(){var e=this._dataStore.getValue(this._getLayoutLocalStorageKey(),v.default.local);this._contextualLayoutTypes=i.__assign((t={version:2},t[d.Files]="",t[d.Recent]="",t[d.SharedWithMe]="",t[d.Photos]="",t[d.Discover]="",t),e&&2===e.version?e:{});var t};n.prototype._computeGetItemContext=function(){var e,t=this.requiredRange(),i=this.expandAll(),r=!i&&this.requiredGroup(),o=r?r.startIndex:t.start,n=r?r.startIndex+r.count:t.end,s=this.supportsNestedGroups.peek(),a=this.itemsPerGroup.peek(),l=this._viewParams(),u=l[c.default.isAscendingKey];"false"===u?e=!1:"true"===u&&(e=!0);var p,m,f=l[c.default.viewIdKey],h=this.currentView(),g=this.isGroupThrottled();if(h)if(f&&f!==h.id)p=f;else{p=h.id;h.isDirty()&&(m=h.getEffectiveViewXml())}else p=f||this._defaultViewId;var v,b=this._currentItemKey(),y=this._urlDataSource.getKeyParams(b),_=this._urlDataSource.isCurrentQuery(d.Files,y)||this._urlDataSource.isCurrentQuery(d.Search,y),S=this._urlDataSource.getFocusItemKey(l);S&&this.itemSet.peek().isPlaceholder&&(v=S);var x={parentKey:b,sortField:l[c.default.sortFieldKey],isAscending:e,startIndex:o,endIndex:n,startKey:v,query:this._urlDataSource.getQueryParamValue(y),queryType:this._urlDataSource.getQueryType(y),groupingType:0,isTokenBasedApi:!0,baseViewId:p,viewXml:m,groupBy:l[c.default.groupByKey],group:r,mergeGroupings:!0,avoidSeamSnapping:!0,resultSetOptions:this._itemResultSetOptions,supportsNestedGroups:s,itemsPerGroup:a,expandGroup:i||!!r,hashtag:this._currentHashtag,noIndexBasedDataFetch:_,newTargetListUrl:l[c.default.newTargetListUrlKey],groupReplace:g,viewPath:l[c.default.viewPathKey]};for(var I in l)if(0===I.indexOf("Filter")){x.filters||(x.filters={});x.filters[I]=l[I]}if(l[c.default.useFiltersInViewXmlKey]&&x.filters){if(!x.viewXml){var w=M.getFilterList(B.serializeQuery(l),void 0,!0,!0);x.additionalFiltersXml=W.filtersToCaml(w)}x.ignoreFilterParams=!0}var C=this._itemProvider.getItemSync(x);x.revision=C.item().revision||0;x.needSchema=g||C.isExpired||!C.schema()||!C.schema().length;if(this.resources.isExposed(D.contentTypes)){var T=this.resources.consume(D.contentTypes).peek();x.needContentTypes=T.length<1}if(l[c.default.newTargetListUrlKey]&&l[c.default.newTargetListUrlKey]!==this._pageContext.listUrl||F.isFeatureEnabled(F.FasterOnePage)&&this._navigatingFromOtherApp){this._navigatingFromOtherApp=!1;x.needUpdatePageContext=!0;x.needSchema=!0;x.needContentTypes=!0;l[c.default.viewIdKey]||(x.baseViewId=A.default.Empty);x.viewXml=void 0;x.skipCache=!0;x.updateContextBasedOnResult=function(e,t){e.baseViewId===A.default.Empty&&t.viewId&&t.viewId!==A.default.Empty&&(e.baseViewId=t.viewId)}}var k=this._shouldResetContext(this._getItemContext&&this._getItemContext.peek(),x);if(C.isExpired||k){x.startIndex=0;x.endIndex=0;this.requiredRange({start:0,end:0});x.itemsPerGroup=-1;this.itemsPerGroup(-1)}F.isFeatureEnabled(F.RenderLargeListPartialResult)&&(this._resetPartialResultRequestCount()&&1===C.content().partialResultStatus?x.partialResultRequestCount=0:x.partialResultRequestCount=C.content().partialResultRequestCount);return x};n.prototype._shouldResetContext=function(e,t){var i=!1;e&&t&&(i=this._itemProvider.getItemSetKey(e)!==this._itemProvider.getItemSetKey(t));return i};n.prototype._isSameFolderOrViewQuery=function(e,t){return!!(t&&Number(t[c.default.queryTypeParamKey])===d.Search||this._disableAutomaticLayoutSwitch)||!(!e||!t||t[c.default.idParamKey]!==e[c.default.idParamKey]||t[c.default.queryTypeParamKey]!==e[c.default.queryTypeParamKey])};n.prototype._handleLayoutUpdates=function(){var e=this._viewParams.peek();this._layoutTypeSaved=this._isSameFolderOrViewQuery(this._viewParamsCurrent,e)?this.layoutType.peek():null;this._layoutTypeSaved!==a.Grid&&this._layoutTypeSaved!==a.Details&&(this._layoutTypeSaved=null);this._viewParamsCurrent=N.deepCopy(this._viewParams.peek());this._resetLayoutOnDataFetch=!0;this._inNewFolderDataFetch=!0};n.prototype._computeQueryType=function(){this._handleLayoutUpdates();this._isLeftNavUserExpanded(!1);this.layoutType(this.getDefaultLayoutForView());var e=this._urlDataSource.getKeyParams(this._currentItemKey());return this._urlDataSource.getQueryType(e)};n.prototype._computeTitle=function(){var e=this.currentView(),t=this.item();return this._getItemName(e,t)};n.prototype._computeSetDocumentTitle=function(){var e=this.currentView(),t=r.utils.unwrapObservable(this.focusItem()),i=this.item(),o=t||i;document.title=this._getDocumentTitle(e,o)};n.prototype._getItemName=function(e,t){var i=this._urlDataSource.getKeyParams(t&&t.key);if(this._urlDataSource.getQueryType(i)===d.Hashtag)return"";var r=t?t.name:"";if(Number(this._pageContext.webTemplate)!==q.default.mySite)if(e&&134217728===e.viewType)r=e.title;else if(!r){var o=this._getRootItem(t);r=o&&o.name}return r};n.prototype._getDocumentTitle=function(e,t){var i=this._getItemName(e,t),r=this._pageContext,n="";if(Number(r.webTemplate)!==q.default.mySite){n+=r.webTitle;i&&(n+=" - "+i);e&&e.title&&(n+=" - "+e.title)}else n=i?V.format(o.strings.pageTitleFormat,i):o.strings.pageTitleDefault;return n};n.prototype._setLayoutType=function(){var e=this._layoutTypeSaved;this._layoutTypeSaved=null;e||(e=this.getDefaultLayoutForView());this.layoutType(e)};n.prototype._getLayoutLocalStorageKey=function(){var e=this._pageContext,t="SPO.Files.FilesQueryType."+e.webAbsoluteUrl;e.listId&&(t+="."+e.listId);return t};n.prototype._computeIsOneUp=function(){var e=this,t=this._viewParams(),i=this._urlDataSource.getFocusItemKey(t),o=this._children();if(i){if(o){var n=r.utils.arrayFirst(o,function(t){var r=e.peekUnwrapObservable(t);return r&&e._urlDataSource.areKeysEqual(r.key,i)})||this._itemProvider.getItemSync({parentKey:i}).item;this.focusItem(n)}}else this.focusItem(null);return!!i&&!this.error()};n.prototype._showAutoExecuteAction=function(t,i,r){var o,n=this,s=r.content.peek().items.filter(function(e){return e.peek().properties.ID===i});1===t&&U.Engagement.logData({name:"Sharing.AutoExecute"});if(s[0]){0===t&&U.Engagement.logData({name:"PolicyTip.LaunchFromEmail.ItemInView"});o={item:s[0]}}else{0===t&&U.Engagement.logData({name:"PolicyTip.LaunchFromEmail.ItemOutsideView"});o={itemKey:i}}var a=function(){var e=n._viewParams.peek();0===t?delete e[c.default.policyTipKey]:1===t&&delete e[c.default.sharingKey];n._navigation.updateViewParams(e,{ignoreHistory:!0})},l="";l=0===t?"../../../actions/PolicyTipAction":F.isFeatureEnabled(F.SharingDialogRedux)?"../../../actions/ShareByLinkAction":"odsp-next/actions/share/odb/ShareAction";L.loadModule({require:e,path:l}).then(function(e){new(n.resources.injected(e))(o).execute(null).done(a,a)})};n.prototype._pageLoadComplete=function(){var t=this;if(!this._pltLogComplete){var i=j.default.now();this._pltLogComplete=!0;var r=this.queryType(),o=this.focusItem.peek()?u[u.OneUp]:u[u.Files]+"-"+(d[r]||"Default");this._loaderProvider.pageLoaded(o);this._rumOneHelper.logRUMOneForListView(i);(F.isFeatureEnabled(F.EnablePowerPointWrsPreview)||F.isFeatureEnabled(F.EnableWordWrsPreview))&&this.resources.consumeAsync(z.resourceKey).then(function(e){e.prefetch()});L.loadModule({require:e,path:"@ms/odsp-utilities/lib/logging/odb/Beacon"}).then(function(e){e.addToLoggingManager()});this.events.raise("pageLoadComplete");this._doDeferredWork();if(!G.default.isActivated("6f73bc31-2293-43f5-acfd-9cf73613bc8f","4/26/2017","disable wac preload")&&!this.platform.isMobile&&!this._preloadWACComplete){this._preloadWACComplete=!0;this.async.setTimeout(function(){t._preloadWACResources()},5e3)}}};n.prototype._doDeferredWork=function(){var t=this;L.loadModule({require:e,path:"./itemSetProjections/PostUploadProjection"}).then(function(e){var i=new(t.resources.injected(e));t._itemProvider.registerProjection(i.key,i)});this.resources.isExposed(w.smartFiltersStore)&&L.loadModule({require:e,path:"odsp-next/providers/smartFilters/SmartFiltersProvider"}).then(function(e){t.resources.expose(T.smartFilters,new(t.resources.injected(e)))})};n.prototype._computeCurrentItemKey=function(){var e=this._viewParams(),t=this._urlDataSource.getCurrentItemKey(e),i=this._urlDataSource.getKeyParams(t);void 0!==this._queryTypeOverride&&r.utils.extend(i,(o={},o[c.default.queryTypeParamKey]=this._queryTypeOverride,o));return this._urlDataSource.getKey(i);var o};n.prototype._computeCanModifySchema=function(){var e=this.currentView(),t=this.item(),i=this._getRootItem(t,!0),r=i&&i.list.permissions;return e&&r&&(r.manageLists||r.managePersonalViews)};n.prototype._getRootItem=function(e,t){var i=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list");return t?this.unwrapObservable(i):this.peekUnwrapObservable(i)};n.prototype._filterCrumbOnClick=function(t,i){var r=this,o=B.deserializeQuery(t.url&&"#"===t.url[0]?t.url.substr(1):t.url),n=this.currentView?this.currentView.peek():void 0;o[c.default.useFiltersInViewXmlKey]&&n&&n.isDirty()?L.loadModule({require:e,path:"@ms/odsp-datasources/lib/models/view/ViewHelpers"}).then(function(e){for(var i={},o=0,s=M.getFilterList(t.url,void 0,!0,!0);o<s.length;o++){var a=s[o];i[a.fieldName]=a}var l=e.getAllSmartFilters(n);if(l)for(var u=0,d=l;u<d.length;u++){var c=d[u];i[c.fieldName]||e.removeFilter(n,c.fieldName)}r._navigation.navigateTo(t.url)}):this._navigation.navigateTo(t.url)};return n}(n.default);t.DataManager=X;t.default=X});define("odsp-next/providers/list/ListProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/url/odb/ItemUrlHelper","../../models/item/ItemParentHelper","@ms/odsp-datasources/lib/interfaces/list/FieldType","@ms/odsp-utilities/lib/modules/Modules","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){function o(e,i){var r=t.call(this,e,i)||this;r._dataSource=i.listDataSource;r._currentView=i.currentView;r._currentItem=i.currentItem;r._itemUrlHelper=i.itemUrlHelper;r._itemParentHelper=i.itemParentHelper;r._pageContext=i.pageContext;r.fields=r.observables.createArray([]);r.views=r.observables.createArray([]);r._deletedViewIds=[];return r}i.__extends(o,t);o.prototype.getView=function(e){var t=this;return this._dataSource.getView(e,this._getListUrl()).then(function(e){t.registerView(e);return e})};o.prototype.getFields=function(e){var t=this;return e?this._getListDataSourceExtension().then(function(e){return e.getFields(t._getListUrl()).then(function(e){t.fields(e);return e})}):p.default.wrap(this.fields.peek())};o.prototype.getCurrentListUrl=function(e){var t=e?this._currentItem():this._currentItem.peek(),i=t&&this._itemUrlHelper.getItemUrlParts(t.key);return i&&i.fullListUrl};o.prototype.registerView=function(e){if(-1===this._deletedViewIds.indexOf(e.id)){for(var t=this.views.peek(),i=!1,r=0;r<t.length;r++){var o=t[r];if(e===o){i=!0;break}if(o.id===e.id){t.splice(r,1);break}}i||this._insertViewSorted(e)}};o.prototype.getViews=function(e){var t=this;if(e){var i=this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem.peek(),"list"),o=this.peekUnwrapObservable(i),n=o&&o.list.templateType;return this._dataSource.getViews(this._getListUrl(),n).then(function(e){var i=t._currentView.peek();if(i){var o=r.utils.arrayFirst(e,function(e){return e.id===i.id});if(o){i.title=o.title;i.isDefault=o.isDefault;i.isDirty()||(i.baseViewXml=o.baseViewXml);t._currentView.valueHasMutated();r.utils.arrayRemoveItem(e,o);e.push(i)}}e.sort(function(e,t){return e.compareTo(t)});t.views(e);return e})}return p.default.wrap(this.views.peek())};o.prototype.createView=function(e){var t=this;return this._dataSource.createView(e,this._getListUrl()).then(function(e){t._insertViewSorted(e);return e})};o.prototype.saveView=function(e){return this._dataSource.saveView(e,this._getListUrl())};o.prototype.deleteView=function(e){var t=this;return this._dataSource.deleteView(e,this._getListUrl()).then(function(){t._deletedViewIds.push(e);t.views.remove(function(t){return t.id===e})})};o.prototype.modifyView=function(e){var t=this;return this._dataSource.modifyView(e,this._getListUrl()).then(function(){for(var i,r,o=t.views.peek(),n=0;n<o.length;n++)if(o[n].id===e.id){i=o[n];r=n;break}if(i){if("boolean"==typeof e.isDefault){if(e.isDefault)for(var s=0,a=o;s<a.length;s++){var l=a[s];if(l.isDefault){l.isDefault=!1;break}}i.isDefault=e.isDefault;t.views.valueHasMutated()}if("string"==typeof e.title&&i.title!==e.title){i.title=e.title;o.splice(r,1);t._insertViewSorted(i)}}})};o.prototype.createMappedView=function(e,t){var i=this;return this._dataSource.createMappedView(e,t,this._getListUrl()).then(function(e){i._insertViewSorted(e);return e})};o.prototype.getMappedApp=function(e,t){return this._dataSource.getMappedApp(e,t,this._getListUrl())};o.prototype.getMappedApps=function(e){return this._dataSource.getMappedApps(e,this._getListUrl())};o.prototype.publishMappedView=function(e,t,i){var r=this;return this._dataSource.publishMappedView(t,i,this._getListUrl()).then(function(t){r.views.remove(function(t){return t.id===e});r._insertViewSorted(t);return t})};o.prototype.unpublishMappedView=function(e,t,i){var r=this;return this._dataSource.unpublishMappedView(t,i,this._getListUrl()).then(function(t){r.views.remove(function(t){return t.id===e});r._insertViewSorted(t);return t})};o.prototype.createField=function(e,t){var i=this,r=this._getFieldCreationSchema(e,t);return this._getListDataSourceExtension().then(function(e){return e.createField(r,i._getListUrl())})};o.prototype.modifyFieldProperties=function(e){return this._dataSource.modifyFieldProperties(e,this._getListUrl())};o.prototype._getListUrl=function(){var e=this.getCurrentListUrl();if(!e)throw new Error("List URL is not known");return e};o.prototype._insertViewSorted=function(e){for(var t=this.views.peek(),i=!1,r=0;r<t.length;r++)if(e.compareTo(t[r])<1){this.views.splice(r,0,e);i=!0;break}i||this.views.push(e)};o.prototype._getListDataSourceExtension=function(){var t=this,i=l.loadModule({require:e,path:"@ms/odsp-datasources/lib/List"}).then(function(e){return new(t.managed(e))(t._pageContext)});this._getListDataSourceExtension=function(){return i};return i};o.prototype._getFieldCreationSchema=function(e,t){var i={Type:t,DisplayName:e,Title:e};if(t===a.default.User||t===a.default.UserMulti){i.UserSelectionMode="1";i.UserSelectionScope=0}else t===a.default.DateTime&&(i.Format="DateOnly");t===a.default.UserMulti&&(i.Mult=!0);return i};return o}(o.default);f.dependencies=i.__assign({},o.default.dependencies,{listDataSource:d.list,pageContext:c.pageContext,currentView:u.currentView,currentItem:u.currentItem,itemUrlHelper:n.resourceKey,itemParentHelper:s.resourceKey});t.default=f;t.resourceKey=m.createDefaultResourceKey(e,f)});define("@ms/odsp-datasources/lib/interfaces/list/FieldType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Text=0]="Text";e[e.Note=1]="Note";e[e.Number=2]="Number";e[e.Boolean=3]="Boolean";e[e.Choice=4]="Choice";e[e.MultiChoice=5]="MultiChoice";e[e.DateTime=6]="DateTime";e[e.URL=7]="URL";e[e.User=8]="User";e[e.UserMulti=9]="UserMulti"}(i=t.FieldType||(t.FieldType={}));t.default=i});define("odsp-next/utilities/wrs/WrsHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/AsyncResources"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createDefaultAliasResourceKey(e,"./WrsHelper")});define("@ms/odsp-datasources/lib/utilities/caml/CamlSerialization",["require","exports","./CamlConstants","./CamlUtilities","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,i,r,o){"use strict";function n(e){return e.map(function(e){return"string"==typeof e?e:s(e)})}function s(e){var t=e&&"IsNotNull"!==e.operator,o=e&&e.values&&e.values.length;if(!e||t&&!o)return"";var n=e.operator||"In",s=e.type&&e.type.toLowerCase();"In"===n&&(1===e.values.length||"datetime"===s||"multichoice"===s||("lookup"===s||"computed"===s)&&i.CamlConstants.dateRegex.test(e.values[0])||e.values.some(function(e){return""===e}))&&(n="Eq");var c;if("In"===n)c="<In>"+l(e)+"<Values>"+e.values.map(function(t){return u(t,e)}).join("")+"</Values></In>";else if("IsNotNull"===n)c=a(void 0,e);else{var p=e.values.map(function(t){return a(t,e,n)});c=r.combineFilters(p,"Or")}if(e.id){var m=d(i.CamlAttributes.id,e.id),f=c.indexOf(">");c=c.slice(0,f)+m+c.slice(f)}return c}function a(e,t,i){if("Membership"===(i=i||t.operator))return'<Membership Type="'+e+'">'+(r=l({fieldName:t.fieldName}))+"</Membership>";var r=l(t);return"IsNotNull"===i?"<IsNotNull>"+r+"</IsNotNull>":""===e?"<IsNull>"+r+"</IsNull>":"<"+i+">"+r+u(e,t)+"</"+i+">"}function l(e){return e?"<FieldRef"+d(i.CamlAttributes.name,e.fieldName)+c(i.CamlAttributes.ascending,e.isAscending)+c(i.CamlAttributes.lookupId,e.lookupId)+"/>":""}function u(e,t){var n,s=t.type||"";if("datetime"===s.toLowerCase()&&r.isTodayString(e)){var a=r.getTodayOffset(e);n=a?'<Today OffsetDays="'+a+'"/>':"<Today/>"}else n=o.default.encodeText(e);return"<Value"+d(i.CamlAttributes.type,s)+">"+n+"</Value>"}function d(e,t){return t?" "+e+'="'+o.default.encodeText(t)+'"':""}function c(e,t){return"boolean"==typeof t?" "+e+'="'+String(t).toUpperCase()+'"':""}Object.defineProperty(t,"__esModule",{value:!0});t.filtersToCaml=function(e,t){void 0===t&&(t="And");return r.combineFilters(n(e),t)};t.filtersToCamlStrings=n;t.filterToCaml=s});define("odsp-next/models/selection/SelectionModelGroup",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){var t=e.call(this,{})||this;t._store=r.observable({});t._store.extend({notify:"always"});t.currentSelection=t.createPureComputed(t._computeCurrentSelection);return t}i.__extends(t,e);t.prototype.registerSelectionModel=function(e,t){var i=this._store.peek();if(i[t])throw"Duplicate selectionModelId: "+t;i[t]=e;this._store(i)};t.prototype.unregisterSelectionModel=function(e){var t=this._store.peek();if(t[e]){delete t[e];this._store(t);return!0}return!1};t.prototype.clearOtherSelectionModels=function(e){var t=this._store.peek();for(var i in t)i!==e&&t[i].clear()};t.prototype._computeCurrentSelection=function(){var e=this._store();for(var t in e)if(e[t].selectedCount()>0)return e[t];return null};return t}(o.default);t.default=n});define("odsp-next/providers/spotlight/SpotlightProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","./SpotlightResultEnum","./SpotlightConstants"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this,t)||this;i._itemSet=t.itemSet;i._urlDataSource=i.resources.consume(n.url);i._itemsStore=t.itemsStore;i._spotlightDataSource=t.spotlightDataSource;i._cacheUpdatesObservable=i._spotlightDataSource.getCacheUpdatesObservable();i._spotlightItems=r.observable([]);i._spotlightChangedTextObservable=r.observable("");i._spotlightChangedTextObservable.extend({notify:"always"});i._currentView=t.currentView;i.createComputed(i._updateSpotlightItemsOnItemSetChange);return i}i.__extends(t,e);t.prototype.editSpotlight=function(e){var t=this;this._preemptSpotlightChange(e);return this._spotlightDataSource.editSpotlight(e).then(function(i){return t._handleEditSpotlightResult(e,i)},function(i){var r={resultEnum:s.default.UnknownServerResult,order:null};return t._handleEditSpotlightResult(e,r)})};t.prototype.getSpotlightItems=function(){return this._spotlightItems};t.prototype.getSpotlightChangedTextObservable=function(){return this._spotlightChangedTextObservable};t.prototype._updateSpotlightItemInfo=function(e,t){var i=[];if(e.viewId){if(t.length>0){var r={};r[e.item.properties.ID]=e.item.key;for(var o=this._spotlightItems.peek(),n=null,s=0;s<o.length;s++){var a=o[s].peek();r[a.properties.ID]||(r[a.properties.ID]=a.key)}for(s=0;s<t.length;s++)r[t[s]]&&(n=this._itemsStore.getItem(r[t[s]]))&&i.push(n)}this._spotlightDataSource.cacheSpotlightItems(this._itemSet.peek().item,e.viewId,i)}};t.prototype._handleEditSpotlightResult=function(e,t){var i=!1;if(t.order){this._updateSpotlightItemInfo(e,t.order);i=!0}else this._updateSpotlightItemsOnItemSetChange();var r=t.resultEnum;return r!==s.default.Success||i?r:s.default.UnknownServerResult};t.prototype._updateSpotlightItemsOnItemSetChange=function(){this._cacheUpdatesObservable();var e=this._currentView(),t=this._itemSet().item().key;if(e){var i=this._spotlightDataSource.getSpotlightItems(t,e.id),r=this._spotlightItems.peek();if(i)if(r){if(i.length!==r.length)this._spotlightItems(i);else for(var o=0;o<i.length;o++)if(i[o].peek().key!==r[o].peek().key){this._spotlightItems(i);return}}else this._spotlightItems(i);else r&&!r.length||this._spotlightItems([])}};t.prototype._preemptSpotlightChange=function(e){if(e.item.parent){var t=this._itemsStore.getItem(e.item.parent.key);if(t){var i=[],r=this._spotlightDataSource.getSpotlightItems(t.peek().key,e.viewId)||[],o=e.item.properties.ID,n=!1,s=e.isAdd?this._itemsStore.getItem(e.item.key):null,l=s&&e.afterItem?e.afterItem.key:null;if(s&&!l){i.push(s);n=!0}for(var u=0;u<r.length;u++){r[u].peek().properties.ID!==o&&i.push(r[u]);if(s&&!n&&r[u].peek().key===l){i.push(s);n=!0}}s&&!n&&i.unshift(s);i.length<=a.MaxSpotlightItems&&this._spotlightDataSource.cacheSpotlightItems(t,e.viewId,i)}}};return t}(o.default);t.default=l});define("odsp-next/providers/spotlight/SpotlightResultEnum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Success=0]="Success";e[e.FolderDoesNotExist=1]="FolderDoesNotExist";e[e.ItemDoesNotExist=2]="ItemDoesNotExist";e[e.TooManyItems=3]="TooManyItems";e[e.ItemNotInSpotlight=4]="ItemNotInSpotlight";e[e.InvalidArgument=5]="InvalidArgument";e[e.ServerError=6]="ServerError";e[e.InvalidServerJSON=7]="InvalidServerJSON";e[e.UnknownServerResult=8]="UnknownServerResult"}(i||(i={}));t.default=i});define("odsp-next/providers/spotlight/SpotlightConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MaxSpotlightItems=3});define("odsp-next/controls/spotlightHost/SpotlightHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SpotlightHostViewModel","./SpotlightHost.html","./SpotlightHost.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-spotlight-host",template:e("./SpotlightHost.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/spotlightHost/SpotlightHostViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./SpotlightCell","../../resources/ProviderResourceKeys","../../models/selection/ItemSetSelectionModel","@ms/odsp-utilities/lib/modules/Modules","../../bindings/contextMenu/ContextMenuHelper","../../bindings/contextMenu/ContextMenuBinding","../../resources/PagesResourceKeys","../../resources/ControlResourceKeys","../../bindings/keyboard/KeyboardBinding","./SpotlightHost.resx","../../models/itemSet/ItemSet","../../models/itemSet/ItemSetContent","../../bindings/clientRect/ClientRectBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=312,_=192,S=function(t){function o(e){var i=t.call(this,e)||this;i._boundingElementClass=e.boundingElementClass;i._topLevelCommandSetObservable=e.topLevelCommandSet;i.addBindingHandlers({contextMenu:d,keyboard:m,clientRect:v.default});i.size=r.observable({width:0,height:0});var o=i.resources.consume(s.spotlight);i._spotlightItems=o.getSpotlightItems();i._spotlightItemSet=new h;i._spotlightItemSet.item=i.resources.consume(p.currentItem);i._selectionModel=new(i.resources.injected(a))({itemSet:r.observable(i._spotlightItemSet),selectionModelGroup:i.resources.consume(p.currentSelectionModelGroup)});i.resources.expose(p.itemsSelection,i._selectionModel);i.isVisible=i.createPureComputed(function(){return i._spotlightItems().length>0});i.cellSize=r.observable({width:y,height:_});i.spotlightContextMenuHelper=r.observable(new u({items:[],rootElementClass:"",engagementSource:"Spotlight"}));i.spotlightHostContainerLabel=f.strings.spotlightAriaLabel;var n=i.resources.consume(c.dataManager);i.spotlightCells=r.observable([]);i.createComputed(i._computeSpotlightCells);i.events.on(n,"pageLoadComplete",function(){i._initializeDeferredComponents()});i.createComputed(i._computeUpdateItemSet);i.spotlightChangedText=r.observable("");i._providerSpotlightChangedText=o.getSpotlightChangedTextObservable();i.createComputed(i._computeSpotlightChangedText);return i}i.__extends(o,t);o.prototype.onKeyLeft=function(e,t){var i=this._selectionModel.getFocusIndex();if(this._spotlightItems.peek().length){i>0&&this._handleSelectionEvent(0,t);i-1>0&&this._handleSelectionEvent(i-1,t)}return!1};o.prototype.onKeyRight=function(e,t){var i=this._selectionModel.getFocusIndex(),r=this._spotlightItems.peek().length;if(r){i<0&&this._handleSelectionEvent(0,t);i+1<r&&this._handleSelectionEvent(i+1,t)}return!1};o.prototype.trapKeyPress=function(){return!1};o.prototype.onKeyOpenItem=function(){var e=this._selectionModel.getFocusIndex();if(this._spotlightItems.peek().length&&e>=0){var t=this.resources.consume(p.actionMap);new(this.managed(t.OpenAction))({}).execute(null)}};o.prototype._handleSelectionEvent=function(e,t){var i=!!t.shiftKey;if(e>=0){this._selectionModel.clear();if(i){this._selectionModel.selectToIndex(e);this._selectionModel.setIndexFocus(e,{preventAnchor:!0})}else{this._selectionModel.setIndexSelected(e,!0);this._selectionModel.setIndexFocus(e)}}};o.prototype._computeUpdateItemSet=function(){var e=this._spotlightItems(),t=new g;(i=t.items).push.apply(i,e);this._spotlightItemSet.content(t);var i};o.prototype._initializeDeferredComponents=function(){var t=this,i=this.resources.consume(b.platformDetection);l.loadModule({path:"../../pages/files/splist/commandSets/TopLevelCommandSet",require:e}).then(function(e){t._topLevelSpotlightCommands=new(t.managed(e))({sourceNameEngagement:".SpotlightTopMenu",isForCommandBar:!0,isForSpotlight:!0});t.createComputed(t._computeUpdateTopCommandBar);if(!i.isMobile){var r,o=new(t.managed(e))({sourceNameEngagement:".SpotlightItem",isForContextMenu:!0,isForSpotlight:!0});t.createComputed(function(){r&&r.dispose();r=new u({items:o.commands(),rootElementClass:"SpotlightHost-container",boundingElementClass:t._boundingElementClass,engagementSource:"SpotlightItem",shouldHideIcons:!0});t.spotlightContextMenuHelper(r)})}})};o.prototype._computeUpdateTopCommandBar=function(){this._selectionModel.selectedCount()&&this._topLevelCommandSetObservable(this._topLevelSpotlightCommands)};o.prototype._computeSpotlightCells=function(){for(var e=this._spotlightItemSet.content().items,t=[],i=0;i<e.length;i++)t[i]={name:n.default.tagName,params:{item:e[i],cellSize:this.cellSize,engagementSource:"SpotlightTile"}};this.spotlightCells(t)};o.prototype._computeSpotlightChangedText=function(){var e=this,t=this._providerSpotlightChangedText();if(t&&t.length){this.spotlightChangedText(t);this.async.setTimeout(function(){e.spotlightChangedText("")},100)}};return o}(o.default);t.default=S});define("odsp-next/controls/spotlightHost/SpotlightCell",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SpotlightCellViewModel","./SpotlightCell.html","./SpotlightCell.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-spotlight-cell",template:e("./SpotlightCell.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/spotlightHost/SpotlightCellViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../itemTile/ItemTile"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var i=e.call(this,t)||this;i.tileTagName=o.tagName;i.params=t;return i}i.__extends(t,e);return t}(r.default);t.default=n});define("odsp-next/controls/itemTile/ItemTile",["require","exports","./ItemTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemTileDiscoverCard.html","./ItemTile.html","./ItemTileFolder.html","./ItemTileFile.html","./ItemTilePhoto.html","./ItemTilePhotoBurst.html","./ItemTilePhotoBurstItem.html","./ItemTileTag.html","./ItemTileVideo.html","./ItemTile.css","../folderCoverTile/FolderCoverTile","../fileTypeIcon/FileTypeIcon"],function(e,t,i,r){"use strict";var o=r.registerComponent({tagName:"ms-item-tile",template:e("./ItemTile.html"),viewModel:i.default,synchronous:!0});r.registerTemplate(i.TEMPLATE_TAGS.folder,e("./ItemTileFolder.html"));r.registerTemplate(i.TEMPLATE_TAGS.file,e("./ItemTileFile.html"));r.registerTemplate(i.TEMPLATE_TAGS.photo,e("./ItemTilePhoto.html"));r.registerTemplate(i.TEMPLATE_TAGS.photoBurst,e("./ItemTilePhotoBurst.html"));r.registerTemplate(i.TEMPLATE_TAGS.photoBurstItem,e("./ItemTilePhotoBurstItem.html"));r.registerTemplate(i.TEMPLATE_TAGS.tag,e("./ItemTileTag.html"));r.registerTemplate(i.TEMPLATE_TAGS.video,e("./ItemTileVideo.html"));r.registerTemplate(i.TEMPLATE_TAGS.discover,e("./ItemTileDiscoverCard.html"));return o});define("odsp-next/controls/itemTile/ItemTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../models/item/ItemType","@ms/odsp-shared/lib/base/Rotation","../../resources/ControlResourceKeys","../dragAndDrop/DropHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/list/SharingTypeHelper","../../resources/DataSourceResourceKeys","../../resources/SPOResourceKeys","../../resources/UtilityResourceKeys","@ms/odsp-utilities/lib/string/DriveSpaceHelper","../../dataSources/url/QueryType","../../resources/ProviderResourceKeys","../../bindings/focus/DelayedHasFocusBinding","../../bindings/dragAndDrop/DragAndDropBinding","../../utilities/features/Features","../../controls/image/frame/ImageFrame","../newBadge/NewBadge","../../utilities/list/ListViewRenderHelper","./ItemTile.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/dom/Dom","../../utilities/selection/SelectionHelper","../../bindings/teachingBubble/TeachingBubbleBinding","../../models/engagement/Engagement"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P,L=x.strings,R="ItemTile",F=b.isFeatureEnabled(b.BurstPhotoUI),A=b.isFeatureEnabled(b.EnableNeutralFolderColors);t.itemTileEngagementPart=new k.EngagementPart("ItemTile",3);t.TEMPLATE_TAGS={folder:"ms-item-tile-folder",file:"ms-item-tile-file",photo:"ms-item-tile-photo",photoBurst:"ms-item-tile-photoBurst",photoBurstItem:"ms-item-tile-photoBurstItem",tag:"ms-item-tile-tag",video:"ms-item-tile-video",discover:"ms-item-tile-discover"};var M=function(r){function x(e){var i=r.call(this,e)||this;i.imageFrameTagName=y.default.tagName;i.newBadgeTagName=_.default.tagName;i.addBindingHandlers({delayedHasFocus:g.default,dragAndDrop:v.default});var o=e.item,n=e.customTemplateName,u=void 0===n?"":n,m=e.group,f=e.cellSize,S=void 0===f?i.createObservable({width:100,height:100}):f,x=e.engagementSource,I=void 0===x?R:x,C=e.isInteractable,P=void 0===C||C;i._selectionHelper=i.resources.consume(T.resourceKey);i.resources.expose(k.engagementSourceResourceKey,i.resources.consume(k.engagementSourceResourceKey).withPart(t.itemTileEngagementPart));i._urlDataSource=i.resources.consume(d.url);i._displayImageTileNames=!!i.resources.isExposed(s.displayImageTileNames)&&i.resources.consume(s.displayImageTileNames);i.parentItem=i.resources.consume(s.currentItem);i.item=i.resources.expose(s.currentItem,i.wrapObservable(o));i._instrumentationProvider=i.resources.consume(h.instrumentation);i._platform=i.resources.consume(w.platformDetection);i._mobile=i.resources.consume(p.mobile);var L=i.resources.isExposed(c.currentHashtag)?i.resources.consume(c.currentHashtag):"",F=i.resources.consume(s.actionMap);i._customTemplateName=u;i._group=m;i.selectionModel=i.resources.consume(s.itemsSelection);i.draggable=P;i.isInteractable=P;i.isDroppingTarget=i.createObservable(!1);i.isReceivingDrop=i.createObservable(!1);i.isSelected=i.createObservable(!1);i.focusState=i.createObservable(0);i.isFocused=i.createPureComputed(function(){return!!i.focusState()});i.ignoreClickTime=i.createObservable(0);i.thumbnailError=i.createObservable();i.isThumbnailLoaded=i.createObservable(!1);i.pulseTarget=i.createObservable();i._folderChildCount=i.createObservable("");i.showPerson=i.createObservable(!1);i.imageRect=S;i.imageRect.equalityComparer=l.deepCompare;i.thumbnail=i.createPureComputed(i._computeThumbnail);i.thumbnail.equalityComparer=l.deepCompare;i._hasThumbnailError=i.createPureComputed(i._computeHasThumbnailError);i.hasThumbnail=i.createPureComputed(i._computeHasThumbnail);i.templateName=i.createPureComputed(i._computeTemplateName);L&&(I="Hashtag.DiscoverPanel");i._action=new(i.child(F.DefaultClickAction))({item:i.item,userInvokedItem:!0,sourceEngagement:I+".Click"});i.isInvokable=i.createPureComputed(i._computeIsInvokable);i.rotation=i.createPureComputed(i._computeRotation);i.linkUrl=i.createPureComputed(i._computeLinkUrl);i.subText=i.createPureComputed(i._computeSubText);i.childCount=i.createComputed(i._computeChildCount);i.tagCount=i.createPureComputed(i._computeTagCount);i.longTagTooltip=i.createPureComputed(i._computeLongTagTooltip);i.isShared=i.createPureComputed(i._computeIsShared);i.isBundle=i.createPureComputed(i._computeIsBundle);i._subTextIconType=i.createPureComputed(i._computeSubTextIconType);i.subTextIconUrl=i.createPureComputed(i._computeSubTextIconUrl);i.subTextIconClass=i.createPureComputed(i._computeSubTextIconClass);i.isSubTextVisible=i.createPureComputed(i._computeIsSubTextVisible);i.isSelectable=i.createPureComputed(i._computeIsSelectable);i.dateText=i.createPureComputed(i._computeDateText);i.isDateVisible=i.createPureComputed(i._computeIsDateVisible);i.showTagCount=b.isFeatureEnabled(b.ShowTagCountInPhotos);i.newBadgeParams={desiredSize:i.createObservable("Small")};i.isCheckVisible=i.createPureComputed(function(){return i._platform.isMobile&&(i._mobile.showItemCheck()||i.selectionModel.selection().length>0)});i._dropHelper=i.resources.consume(a.resourceKey);i.iconSize=i.createPureComputed(i._computeIconSize);i.desiredSize=i.createPureComputed(i._computeDesiredIconSize);i.isDroppable=i.createPureComputed(i._computeIsDroppable);i.tabindex=i.createPureComputed(function(){return i.selectionModel.focusedItem()===i.item?0:-1});i.burstPhotoText=i.createPureComputed(i.computeBurstPhotoText);i.isNamePlateVisible=i.createPureComputed(i._computeIsNamePlateVisible);i.colorName=i.createPureComputed(i._computeColorName);i.hasImageStack=i.createPureComputed(i._computeHasImageStack);var A=i.resources.consume(h.uploadTeachingBubble.optional);if(A){i.addBindingHandlers({teachingBubble:D.default});i.teachingBubbleOptions=A.getTeachingBubbleForKey(i.item.peek().key)}i.itemAutomationId=i.createPureComputed(function(){var e=i.item();if(e)return e.displayName});i.createBackgroundComputed(function(){i.isReceivingDrop()&&i.isReceivingDrop(!1)}).extend({rateLimit:{timeout:1450,method:"notifyWhenChangesStop"}});i.createBackgroundComputed(function(){var e=i.item();e&&!e.isPlaceholder&&i._instrumentationProvider.userSeeItem(e)});i.createBackgroundComputed(function(){i._updateSelectionSubscription(i.item)});return i}i.__extends(x,r);x.prototype.dispose=function(){this._updateSelectionSubscription(null);r.prototype.dispose.call(this)};x.prototype.onItemCheckClick=function(e,t){t.shiftKey?this.selectionModel.selectToItem(this.item):this.selectionModel.toggleItemSelected(this.item);this.selectionModel.setItemFocus(this.item,{preventAnchor:!!t.shiftKey});t.preventDefault();t.stopPropagation();return!1};x.prototype.onClick=function(e,t){var i=this.ignoreClickTime(),r=(new Date).getTime();if(i&&r-i<=50){t.stopPropagation();t.preventDefault();return!1}if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){this.onInvoke(t);t.stopPropagation();t.preventDefault();return!1}return!0};x.prototype.onMouseDown=function(e,t){if(!this.isInteractable||2===t.button)return!0;var i=!!C.findAncestor(t.target,"ItemTile-rowCheck"),r=this.selectionModel.isItemSelected(this.item);if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){r||i||this.selectionModel.clear();i||this.selectionModel.setItemSelected(this.item,!0)}};x.prototype.onInvoke=function(e){if(!!!C.findAncestor(e.target,"ItemTile-rowCheck")&&this._action.isAvailable.peek()){this._action.execute(e).done();e.stopPropagation();e.preventDefault();return!1}};x.prototype.getRowAriaLabel=function(){return S.getRowAriaLabel(this.item())};x.prototype.getDragData=function(){var e=this,t=this.item.peek(),i=null,r=this.selectionModel;t.isDraggable&&r.isItemSelected(this.item)&&(i={type:1,item:t,itemSet:r.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:r.selectedCount.peek(),resources:r.resources}});return i};x.prototype.onMayReceiveDrop=function(e){var t=this.item&&this.item.peek&&this.item.peek();return t&&t.isDropEnabled&&e.item!==t&&(1===e.type||0===e.type)?{targetName:t.name}:null};x.prototype.onReceiveDrop=function(e){var t=this._dropHelper.processDrop(e,this.item.peek());t&&this.isReceivingDrop(!0);return t};x.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1);this.pulseTarget().enablePulsing(!0)};x.prototype.getItem=function(){return this.item};x.prototype.isTag=function(){return!!this.item().tagInfo};x.prototype.isFolder=function(){var e=this.item();return e.type===o.Folder&&!e.isAlbum};x.prototype.isFile=function(){return this.item().type!==o.Folder&&!this.isMedia()};x.prototype.isDiscoverCard=function(){var e=this.item();return e.queryType===f.Discover||e.queryType===f.Hashtag};x.prototype.isMedia=function(){return!!this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames};x.prototype.isAlbum=function(){return this.item().isAlbum};x.prototype.isVideo=function(){return!!this.item().video&&this.hasThumbnail()&&!this._displayImageTileNames};x.prototype.isBadPhoto=function(e){var t=e||this.item();return F&&t.photo&&t.photo.quality&&t.photo.quality.isBad};x.prototype.computeBurstPhotoText=function(){var e=this.item();if(F&&e.photoBurstItem){var t=e.photoBurstItem.photoBurstId.slice(0,5),i=-1;e&&e.photoBurst&&e.photoBurst.items&&(i=e.photoBurst.items.length);return e.photoBurstItem.isWinner?t+" w ("+i+")":t+" i ("+i+")"}return""};x.prototype.hasNewBadge=function(){var e=this.item();return!(!e.properties.newTag||!e.properties.autoAlbumTag)};x.prototype._computeSubTextIconType=function(){var e=this.item();return this.isBadPhoto(e)?6:e.isViolation||e.policyTip&&e.policyTip>=2?4:e.properties.CheckedOutUserId?2:1===e.policyTip?3:this.isVideo()?5:this.isShared()?1:0};x.prototype._computeHasImageStack=function(){return this.templateName()===t.TEMPLATE_TAGS.folder};x.prototype._computeSubTextIconUrl=function(){if(2!==this._subTextIconType())return"";void 0===P&&(P=this.resources.consume(d.settings).mediaBaseUrl);return void 0!==P?e.toUrl(P+"/images/overlays/checkoutoverlaygrid.svg"):""};x.prototype._computeDateText=function(){var e=this.item();return e.isAlbum?e.dateCreated:""};x.prototype._computeIsDateVisible=function(){var e=this.dateText();return!(!e||!e.length)};x.prototype._computeIsNamePlateVisible=function(){var e=this.item();if(this.isMedia()){var t=this.isBadPhoto(e),i=this.burstPhotoText();return e.isViolation||t||""!==i}return!0};x.prototype._computeSubTextIconClass=function(){switch(this._subTextIconType()){case 1:return"ms-Icon  ItemTile-sharingIcon ItemTile-subTextIcon ms-Icon--People";case 2:return"ms-Icon  ItemTile-subTextImageShort";case 4:return"ms-Icon  ItemTile-blockIcon ItemTile-subTextIcon ms-Icon--DRM";case 3:return"ms-Icon   ItemTile-subTextIcon ms-Icon--IncidentTriangle";case 5:return"ms-Icon  ItemTile-playButton ms-Icon--Play";case 6:return"ms-Icon   ItemTile-badPhotoIcon ms-Icon--IncidentTriangle";default:return""}};x.prototype._computeTemplateName=function(){var e=this.item();return this._customTemplateName?this._customTemplateName:e.tagInfo?t.TEMPLATE_TAGS.tag:e.type===o.Folder?t.TEMPLATE_TAGS.folder:e.photoBurst&&this.hasThumbnail()&&!this._displayImageTileNames?t.TEMPLATE_TAGS.photo:e.photo&&this.hasThumbnail()&&!this._displayImageTileNames?t.TEMPLATE_TAGS.photo:e.video&&this.hasThumbnail()&&!this._displayImageTileNames?t.TEMPLATE_TAGS.video:e.queryType===f.Discover?t.TEMPLATE_TAGS.discover:t.TEMPLATE_TAGS.file};x.prototype._computeIsSelectable=function(){var e=this.item();return this.isInteractable&&this.selectionModel.canSelectItem(this.item)&&!e.tagInfo};x.prototype._computeThumbnail=function(){var e=this.item();return(e.orientedThumbnail||e).thumbnail};x.prototype._computeRotation=function(){var e=this.item().orientedThumbnail;return e?e.rotation:n.none};x.prototype._computeIconSize=function(){return this.hasThumbnail()?32:96};x.prototype._computeDesiredIconSize=function(){var e=.77*(this.imageRect().height-48);return this.hasThumbnail()?32:Math.min(96,Math.ceil(e))};x.prototype._computeIsSubTextVisible=function(){var e=this.item(),t=this.parentItem?this.parentItem():null;return e.type!==o.Folder||t&&(t.queryType===f.SharedWithMe||t.queryType===f.Discover)};x.prototype._computeLinkUrl=function(){var e=this.item(),t=this.resources.consume(s.currentItemSet);return this._urlDataSource.getDefaultClickUrl(e,{preferCurrentView:!0,itemSet:t()})};x.prototype._computeSubText=function(){var e="",t=this.item(),i=this.resources.consume(s.currentItemSet);switch(i?i().sortField:"name"){case"size":e=m.default.getDisplayString(t.size,{ignoreZero:!0});break;case"dateTaken":e=t.dateTaken;break;case"dateModified":e=t.dateModified;break;default:e=t.defaultSubText||""}t.queryType===f.Discover&&(e=this._getTidBit(t));return e};x.prototype._getTidBit=function(e){if(e.viewersCount>5){this.showPerson(!1);return L.popular}if(e.editorName&&e.editorsCount&&e.editorsCount>1){this.showPerson(!0);return I.format(L.modifiedByPersonAndOthers,e.editorName,e.editorsCount-1)}if(e.viewersCount>2){this.showPerson(!1);return L.popular}if(e.editorName){this.showPerson(!0);return I.format(L.modifiedBy,e.editorName)}this.showPerson(!1);return L.relevant};x.prototype._computeChildCount=function(){var e=this,t=this.item(),i="",r=this.resources.consume(d.url).getQueryType();if(t.type===o.Folder&&(t.queryType!==f.SharedWithMe||!t.isRootFolder)&&(!this._urlDataSource.isRecycleBin(t.queryType)||void 0!==t.childCount||t.folder&&t.folder.totalCount>0))if(void 0!==t.childCount)i=String(t.childCount);else if(r===f.Files){var n=this.resources.consume(h.folderItemCount.optional);n&&n.getFolderItemCountInfo(t).then(function(i){if(Boolean(i)){t.childCount=i.itemCount;e._folderChildCount(String(t.childCount))}},function(e){})}this._folderChildCount(i);return this._folderChildCount()};x.prototype._computeHasThumbnailError=function(){var e=this._hasThumbnailError.peek();e||(e=!!this.thumbnailError());return e};x.prototype._computeTagCount=function(){var e=this.item();return e.tagInfo&&e.folder?String(e.folder.childCount):""};x.prototype._computeLongTagTooltip=function(){var e=this.item();return e.tagInfo&&e.name&&e.name.length>50?e.name:""};x.prototype._computeIsShared=function(){var e=this.item().sharingType;return u.showSubTextSharingIcon(e)};x.prototype._computeIsBundle=function(){return this.item().isBundle};x.prototype._computeIsDroppable=function(){return this.item().isDropEnabled&&this.isInteractable};x.prototype._computeIsInvokable=function(){return this._action.isAvailable()};x.prototype._updateSelectionSubscription=function(e){var t=this;if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&this.isInteractable&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{isSelected:this.isSelected,isFocused:this.createObservable(!1),focusState:this.focusState,onInvoke:function(e){return t.onInvoke(e)}}))};x.prototype._computeHasThumbnail=function(){return!!this.thumbnail()&&(this.isThumbnailLoaded()||!this._hasThumbnailError())};x.prototype._computeColorName=function(){return A?"":"oneDrive"};return x}(r.default);t.default=M});define("odsp-next/bindings/focus/DelayedHasFocusBinding",["require","exports","tslib","../BaseBinding","../scrollContainer/ScrollContainerBinding"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=30,s=function(e){function t(t){var i,r,o=e.call(this,t)||this,s=o.valueAccessor();r=(i=o.isObservable(s)?{hasFocus:s}:s).focusState?i.focusState:i.hasFocus?o.createComputed({read:function(){return i.hasFocus()?2:0},write:function(e){return i.hasFocus(!!e)},pure:!0}):o.createObservable(0);o._focusState=r;o._asyncUpdateFocus=o.async.debounce(o._updateFocus,n);o.events.on(o.element,"focus",o._onFocus);o.events.on(o.element,"blur",o._onBlur);o.subscribe(o._focusState,o._onFocusStateChanged);o._startUpdateFocus();return o}i.__extends(t,e);t.prototype._onFocus=function(){this._focusState(2);this._startUpdateFocus()};t.prototype._onBlur=function(){this._focusState(0);this._startUpdateFocus()};t.prototype._onFocusStateChanged=function(){this._startUpdateFocus()};t.prototype._startUpdateFocus=function(){this._focusAttempts=0;this._updateFocus()};t.prototype._updateFocus=function(){var e=this._focusState.peek();if(e){this._focusAttempts++;var t=o.getScrollContainer(this.element),i=void 0,r=void 0;t&&(i=t.scrollTop,r=t.scrollLeft);this.element.focus();if(t&&1===e){t.scrollTop!==i&&(t.scrollTop=i);t.scrollLeft!==r&&(t.scrollLeft=r)}!this._checkIfFocused()&&this._focusAttempts<3&&this._asyncUpdateFocus()}else this.element.blur()};t.prototype._checkIfFocused=function(){var e,t=this.element.ownerDocument;try{e=t.activeElement}catch(i){e=t.body}return e===this.element};return t}(r);t.default=s});define("odsp-next/controls/image/frame/ImageFrame",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageFrameViewModel","./ImageFrame.html","./ImageFrame.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-image-frame",template:e("./ImageFrame.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/image/frame/ImageFrameViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/images/ThumbnailCache","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-utilities/lib/object/ObjectUtil","../ImageEqualityComparer","../stack/ImageStack"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAYOUT_THROTTLE_MS=300;var c=function(e){function t(t,i){void 0===t&&(t={});void 0===i&&(i={});var r=e.call(this,t,i)||this;r.imageStackTagName=d.default.tagName;var n=t.image,c=t.rotation,p=void 0===c?o.none:c,m=t.alignment,f=t.desiredSize,h=t.isLoaded,g=t.isCurrent,v=t.error,b=t.coverage,y=void 0===b?{minimum:1,maximum:1}:b,_=t.scale,S=t.fadeIn,x=t.allowLoading,I=t.position,w=i.thumbnailCache,C=void 0===w?r.resources.consume(s.resourceKey):w,T=i.outputExtenders,D=void 0===T?{deferred:!0}:T;r._thumbnailCache=C;r._image=r.wrapObservable(n);r._rotation=r.wrapObservable(p);r._alignment=a.createAlignment(m);r._desiredSize=r.wrapObservable(f);r._isLoaded=h;r._coverage=r.wrapObservable(y);r._loadedImage=r.createObservable();r._effectiveDesiredSize=r.createPureComputed(r._computeEffectiveDesiredSize);r._effectiveDesiredSize.equalityComparer=l.deepCompare;r._idealSize=r.createPureComputed(r._computeIdealSize);r._idealSize.equalityComparer=l.deepCompare;r._idealImage=r.createPureComputed(r._computeIdealImage);r._idealImage.equalityComparer=u.compareImages;r._fallbackImage=r.createPureComputed(r._computeFallbackImage);r._fallbackImage.equalityComparer=u.compareImages;r._cachedImage=r.createPureComputed(r._computeCachedImage);r._cachedImage.equalityComparer=u.compareImages;r._currentImage=r.createPureComputed(r._computeCurrentImage);r._currentImage.equalityComparer=u.compareImages;r._isCurrent=r.createPureComputed(r._computeIsCurrent);r.imageStackParams={image:r._currentImage,rotation:r._rotation,desiredSize:r._desiredSize,loadedImage:r._loadedImage,isLoaded:r._isLoaded,error:v,scale:_,alignment:r._alignment,fadeIn:S,allowLoading:x,position:I};g&&r.createBackgroundComputed(function(){return g(r._isCurrent())}).extend(D);return r}i.__extends(t,e);t.prototype._computeIsCurrent=function(){return u.compareImages(this._loadedImage(),this._idealImage())};t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),i=this._cachedImage(),r=this._fallbackImage();return e?u.compareImages(e,t)?this._currentImage.peek():t:i||r||t};t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),i=window.devicePixelRatio||1;t&&(e={width:t.width*i,height:t.height*i});return e};t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var i=t.width,r=t.height,o=this._effectiveDesiredSize();if(o&&o.width&&o.height){if(i&&r){var n=this._alignment.getTransform(t,o);e={width:n.scale*t.width,height:n.scale*t.height}}}else e={width:i,height:r}}return e};t.prototype._computeIdealImage=function(){var e,t=this._image(),i=this._idealSize();t&&(i?(e=this._getDerivedImage(t,i))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,i,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t);return e};t.prototype._computeFallbackImage=function(){var e,t=this._image(),i=this._idealSize();if(i&&t&&t.width){var r={coverage:this._coverage()}.coverage,o=(void 0===r?{}:r).fallback,n=void 0===o?0:o;if(n){var s={width:i.width*n,height:i.height*n};(e=this._getDerivedImage(t,s))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,s,!1)}}return e};t.prototype._computeCachedImage=function(){var e,t=this._image(),i=this._idealSize();if(i&&t&&t.width){var r=this._thumbnailCache.getCoveragePercent(t,i),o={coverage:this._coverage()}.coverage,n=void 0===o?{}:o,s=n.minimum,a=void 0===s?1:s,l=n.maximum,u=a*r,d=(void 0===l?1:l)*r;e=this._thumbnailCache.retrieve(t,d,u)}return e};t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:n.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}};return t}(r.default);t.default=c});define("odsp-next/controls/image/ImageEqualityComparer",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.compareImages=function(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}});define("odsp-next/controls/image/stack/ImageStack",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageStackViewModel","./ImageStack.html","./ImageStack.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-image-stack",template:e("./ImageStack.html"),viewModel:r.default,synchronous:!0});t.default=o});define("odsp-next/controls/image/stack/ImageStackViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/BaseModel","../ImageEqualityComparer","@ms/odsp-utilities/lib/object/ObjectUtil","../tile/ImageTile","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this,t)||this,r=t.hasAnimated,o=t.fadeIn,n=t.image,s=t.referenceImage,a=t.referenceRotation;i._fadeIn=o;i._image=n;i._referenceImage=s;i._referenceRotation=a;i.isLoaded=i.createObservable(!1);i._hasAnimated=i._getHasAnimated();i.rotation=i.createPureComputed(i._computeRotation);i.createBackgroundComputed(function(){return r(i._hasAnimated())});return i}i.__extends(t,e);t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var i;if(e.isLoaded.peek())(i=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50);else{e.isLoaded();i=!1}return i})};t.prototype._computeRotation=function(){var e=this.rotation.peek();(n.compareImages(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation());return e};return t}(o.default);t.AnimationTracker=l;var u=function(e){function t(t,i){void 0===i&&(i={});var r=e.call(this,t,i)||this;r.imageTileTagName=a.default.tagName;var o=t.image,u=t.rotation,d=t.desiredSize,c=t.scale,p=void 0===c?1:c,m=t.fadeIn,f=void 0===m||m,h=t.allowLoading,g=void 0===h||h,v=t.isLoaded,b=t.isCurrent,y=t.alignment,_=t.position,S=t.loadedImage,x=t.error,I=i.outputExtenders,w=void 0===I?{deferred:!0}:I,C=i.AnimationTracker,T=void 0===C?l:C;r._animationTrackerType=T;r._image=r.wrapObservable(o);r._rotation=r.wrapObservable(u);r._desiredSize=d;r._scale=p;r.fadeIn=r.wrapObservable(f);r._allowLoading=r.wrapObservable(g);r._alignment=y;r._tileDefinitions=r.createPureComputed(r._computeTileDefinitions);r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=s.deepCompare;r._loadedImage=r.createPureComputed(r._computeLoadedImage);r._loadedImage.equalityComparer=n.compareImages;r._error=r.createPureComputed(r._computeError);r._error.equalityComparer=s.deepCompare;r.tiles=r._getTiles();_&&r.createBackgroundComputed(function(){return _(r._position())}).extend(w);S&&r.createBackgroundComputed(function(){return S(r._loadedImage())}).extend(w);v&&r.createBackgroundComputed(function(){return v(!!r._loadedImage())}).extend(w);b&&r.createBackgroundComputed(function(){return b(n.compareImages(r._loadedImage(),r._image()))}).extend(w);x&&r.createBackgroundComputed(function(){return x(r._error())}).extend(w);return r}i.__extends(t,e);t.prototype._computeError=function(){for(var e,t=this.tiles(),i=t.length-1;i>=0;i--){var r=t[i],o=r.isLoaded,n=r.error;if(o())break;if(n()){e=n();break}}return e};t.prototype._computePosition=function(){for(var e,t=this.tiles(),i=t.length-1;i>=0;i--){var r=t[i],o=r.isLoaded,n=r.position;if(o()){e=n();break}}return e};t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),i=t.length-1;i>=0;i--){var r=t[i],o=r.isLoaded,n=r.image;if(o()){e=this.unwrapObservable(n);break}}return e};t.prototype._computeTileDefinitions=function(){var e=this._image(),t={tileDefinitions:this._tileDefinitions.peek()}.tileDefinitions,i=void 0===t?[]:t;if(e){if(this._allowLoading()){var r=void 0,o=void 0,s=void 0,a=i[i.length-1];if(a){r=n.compareImages(a.image,e);o=a.hasAnimated.peek();s=!!a.error.peek()}else{r=!1;o=!1}if(r)o?i=[a]:a.hasAnimated();else{if(!a||o||s){a={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)};i=i.concat([a])}a.hasAnimated();a.error()}}}else i=[];return i};t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),i=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var i=t.image,r=t.error,o=t.hasAnimated,n=new(e.managed(e._animationTrackerType))({hasAnimated:o,image:i,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:i,rotation:n.rotation,isLoaded:n.isLoaded,error:r,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable()},dispose:function(){n.dispose()}}}}));this.createBackgroundComputed(function(){t.splice.apply(t,[0,t.peek().length].concat(e._tileDefinitions()))});return i};return t}(r.default);t.default=u});define("odsp-next/controls/image/stack/ImageStack.html",[],function(){return"<span class=od-ImageStack data-bind=\"css: { 'od-ImageStack--fade': fadeIn }, template: { foreach: tiles }\"><span class=od-ImageStack-tile data-bind=\"css: { 'od-ImageStack-tile--isLoaded': $data.isLoaded, }, component: { name: $component.imageTileTagName, params: $data }\"></span></span>"});define("odsp-next/controls/image/stack/ImageStack.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"}])});define("odsp-next/controls/image/frame/ImageFrame.html",[],function(){return'<span class=od-ImageFrame data-bind="component: { name: $component.imageStackTagName, params: $component.imageStackParams }"></span>'});define("odsp-next/controls/image/frame/ImageFrame.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"}])});define("odsp-next/controls/newBadge/NewBadge",["require","exports","./NewBadgeViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./NewBadge.html","./NewBadge.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-new-badge",template:e("./NewBadge.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/newBadge/NewBadgeViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../controls/commands/Commands.resx"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var i=e.call(this,t)||this;i.newItemText=o.strings.Create.toUpperCase();i._size=t.desiredSize;return i}i.__extends(t,e);return t}(r.default);t.default=n});define("odsp-next/controls/newBadge/NewBadge.html",[],function(){return'<div class=od-newBadge><span class="od-newBadge-icon ms-Icon ms-Icon--Glimmer"></span> <span class=od-newBadge-text data-bind="text: newItemText"></span></div>'});define("odsp-next/controls/newBadge/NewBadge.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-newBadge{font-size:11px;font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif}.od-newBadge .od-newBadge-icon{-ms-transform:translate(0,-.6em);transform:translate(0,-.6em)}[dir=ltr] .od-newBadge .od-newBadge-icon{margin-right:-.46em}[dir=rtl] .od-newBadge .od-newBadge-icon{margin-left:-.46em}html[dir=rtl] .od-newBadge .od-newBadge-icon{-ms-transform:translate(0,-.6em) scale(-1,1);transform:translate(0,-.6em) scale(-1,1)}'}])});define("odsp-next/utilities/list/ListViewRenderHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRowAriaLabel=function(e){var t=null;if(Boolean(e.properties.nameFieldAriaLabel)){t=e.properties.nameFieldAriaLabel;Boolean(e.properties.modifiedFieldAriaLabel)&&(t+=", "+e.properties.modifiedFieldAriaLabel)}return t}});define("odsp-next/controls/itemTile/ItemTileDiscoverCard.html",[],function(){return'<div class=ItemTile-discoverFileContainer>\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: \'cover\',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=ItemTile-fileIconContainer><div class=ItemTile-fileIcon data-bind="css: { \'ItemTile-fileIcon--thumbnail\': hasThumbnail(), \'ItemTile-fileIcon--noThumbnail\': !hasThumbnail() }, component: { name: \'ms-file-type-icon\', params: { iconName: item().iconName, iconSize: iconSize(), desiredSize: desiredSize() } }"></div></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().displayName"></div><div class=ItemTile-subText><div class=ItemTile-entity-container><img class=ItemTile-entity data-bind="attr:{src: item().editorProfilePicUrl}, visible: showPerson()"><div class=ItemTile-entity data-bind="visible: !showPerson()"><i class="Icon-main ms-Icon" data-bind="css: { \'ms-Icon--Chart\' : item().viewersCount > 1, \'ms-Icon--FavoriteStarFill\': !item().viewersCount }"></i></div></div><div class=ItemTile-longText data-bind="text: subText"></div><div class="ItemTile-viewerCount ItemTile-entity-container" data-bind="visible: !showPerson() && !!item().viewersCount"><i class="ms-Icon ms-Icon--View"></i> <span data-bind="text: item().viewersCount"></span></div></div></div></div>'});define("odsp-next/controls/itemTile/ItemTile.html",[],function(){return"<div class=ItemTile data-bind=\"delayedHasFocus: { focusState: focusState }, class: (colorName() ? 'od-ItemTile--color-' + colorName() : ''), css: { 'is-tag': isTag(), 'is-folder': isFolder(), 'is-file': isFile(), 'is-media': isMedia(), 'is-receivingDrop': isReceivingDrop, 'is-dropping': isDroppingTarget, 'is-checkVisible': isCheckVisible, 'can-select': isSelectable, 'has-thumbnail': hasThumbnail, 'is-selected': isSelectable() && isSelected(), 'is-focused': isInteractable && isFocused(), 'od-ItemTile--isAlbum': isAlbum(), 'od-ItemTile--isVideo': isVideo(), 'od-ItemTile--noDate': !isDateVisible(), 'od-ItemTile--isInteractable': isInteractable, 'od-ItemTile--isInvokable': isInvokable, 'od-ItemTile--hasImageStack': hasImageStack, 'od-ItemTile--isDiscover': isDiscoverCard() }, attr: { tabindex: tabindex, 'aria-label': getRowAriaLabel() }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }, automation: itemAutomationId, teachingBubble: teachingBubbleOptions\"><a tabindex=-1 data-bind=\"event: { click: onClick, mousedown: onMouseDown }, attr: { 'href': linkUrl, 'title': longTagTooltip }, automation: 'link'\"><div class=ItemTile-content data-bind=\"template: templateName\"></div><div class=ItemTile-selector><div class=ItemTile-frame data-bind=\"attr: { title: item().tooltipText }\"></div><ms-item-check class=ItemTile-rowCheck data-bind=\"automation: 'select-link', event: { click: onItemCheckClick }\"></ms-item-check></div></a></div>"});define("odsp-next/controls/itemTile/ItemTileFolder.html",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, imageRect: imageRect, pulseTarget: pulseTarget } }"></div><div class=ItemTile-dragDropIcon></div><div class=ItemTile-namePlate><div class=ItemTile-folderBeak></div><div class=ItemTile-folderBeakHighlight></div>\x3c!--ko if: !isSubTextVisible() && isShared() && !isAlbum()--\x3e<i class="ItemTile-sharingIcon ms-Icon ms-Icon--People"></i>\x3c!--/ko--\x3e\x3c!--ko if: hasNewBadge()--\x3e<div class=ItemTile-newBadge>\x3c!--ko component: { name: newBadgeTagName, params: newBadgeParams }--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=ItemTile-name data-bind="text: item().name"></div><div class=ItemTile-childCount data-bind="text: childCount"></div><div class=ItemTile-date data-bind="text: dateText"></div><div class=ItemTile-subText data-bind="if: isSubTextVisible() && !isAlbum()"><i class=ms-Icon data-bind="css: { \'ItemTile-sharingIcon ms-Icon--People\': isShared() && !isBundle(), \'ms-Icon--AppIconDefault\': isBundle() }"></i> <span data-bind="text: subText"></span></div></div>'});define("odsp-next/controls/itemTile/ItemTileFile.html",[],function(){return"<div class=ItemTile-fileContainer>\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: ['fitWidth', 'top'],\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=ItemTile-fileIconContainer><div class=ItemTile-fileIcon data-bind=\"css: { 'ItemTile-fileIcon--thumbnail': hasThumbnail(), 'ItemTile-fileIcon--noThumbnail': !hasThumbnail() }, component: { name: 'ms-file-type-icon', params: { iconName: item().iconName, extension: item().extension, iconSize: iconSize(), desiredSize: desiredSize() } }\"></div></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind=\"text: item().displayName\"></div><div class=ItemTile-subText><img class=ItemTile-subTextImage data-bind=\"attr: { src: subTextIconUrl }, visible: subTextIconUrl\"> <i data-bind=\"css: subTextIconClass, visible: !subTextIconUrl()\"></i> <span data-bind=\"text: subText\"></span></div></div></div>"});define("odsp-next/controls/itemTile/ItemTilePhoto.html",[],function(){return'\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n rotation: rotation,\r\n desiredSize: imageRect,\r\n alignment: \'cover\',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isNamePlateVisible--\x3e<div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().displayName"></div><div class=ItemTile-subText><span data-bind="visible: !!burstPhotoText(), text: burstPhotoText()"></span> <img class=ItemTile-subTextImage data-bind="attr: { src: subTextIconUrl }, visible: subTextIconUrl"> <i data-bind="css: subTextIconClass, visible: !subTextIconUrl()"></i></div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/itemTile/ItemTilePhotoBurst.html",[],function(){return"\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n rotation: rotation,\r\n desiredSize: imageRect,\r\n alignment: 'cover',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/itemTile/ItemTilePhotoBurstItem.html",[],function(){return"<div data-bind=\"css: { 'ItemTile-photoBurstWinner': item().photoBurstItem && item().photoBurstItem.isWinner }, if: hasThumbnail\">\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n rotation: rotation,\r\n desiredSize: imageRect,\r\n alignment: 'cover',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/itemTile/ItemTileTag.html",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, thumbnail: thumbnail, imageRect: imageRect, pulseTarget: pulseTarget } }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"></div><div class=ItemTile-nameCover><div class="ItemTile-tagText ms-fontWeight-regular"><div class=ItemTile-name data-bind="text: item().name"></div>\x3c!--ko if: showTagCount && tagCount() > 0--\x3e<div class=ItemTile-tagCount data-bind="text: tagCount"></div>\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/itemTile/ItemTileVideo.html",[],function(){return"\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: 'cover',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<span class=ItemTile-playButton><i data-bind=\"css: subTextIconClass\"></i></span>"});define("odsp-next/controls/itemTile/ItemTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'@charset "UTF-8";@keyframes fadeAndScale{0%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0;animation-timing-function:ease-out}25%{transform:translate(-50%,-50%) scale(1,1);opacity:1}75%{transform:translate(-50%,-50%) scale(1,1);opacity:1;animation-timing-function:ease-in}100%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0}}.ItemTile{position:absolute;left:0;right:0;top:0;bottom:0;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden}@media screen and (-ms-high-contrast:active){.ItemTile{border:1px solid '},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile{border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.ItemTile:focus{outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile:focus{outline:0}}.od--isNonMobile .ItemTile{transition:transform .1s linear}.od--isNonMobile .ItemTile:active{-ms-transform:scale(.96);transform:scale(.96)}.ItemTile-entity-container{display:inline}.ItemTile-entity{border-radius:50%;overflow:hidden;height:34px;width:34px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";vertical-align:top;max-width:20%}html[dir=ltr] .ItemTile-entity{float:left}html[dir=rtl] .ItemTile-entity{float:right}.ItemTile-longText{margin-left:10px;max-width:60%;display:-ms-inline-flexbox;display:inline-flex;white-space:pre-wrap}.ItemTile-image{position:absolute;top:0;left:0;right:0;bottom:0}.ItemTile-dragDropIcon{position:absolute;top:8px;right:2px;bottom:0;left:2px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";opacity:0;-ms-transform:translateY(100%);transform:translateY(100%)}.ItemTile-folderOverlay{position:absolute;display:inline-block;top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:92px;height:92px}.ItemTile-photo{position:absolute;top:0;left:0;bottom:0;right:0}.ItemTile.is-file,.ItemTile.is-media{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ItemTile.is-file .od-ImageStack-tile,.ItemTile.is-folder .od-ImageStack-tile,.ItemTile.is-media .od-ImageStack-tile{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ItemTile.is-file .ItemTile-discoverFileContainer,.ItemTile.is-file .ItemTile-fileContainer{border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:'}@media screen and (-ms-high-contrast:active){.ItemTile.is-file .ItemTile-discoverFileContainer,.ItemTile.is-file .ItemTile-fileContainer{border:0}}.ItemTile.is-file .od-ImageStack-tile img{box-shadow:0 0 8px 0 rgba(0,0,0,.06)}.ItemTile.is-media .od-ImageFrame::after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.ItemTile-fileContainer{background-color:'},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-discoverFileContainer{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-fileIconContainer{position:absolute;top:0;bottom:50px;left:0;right:0}.ItemTile.od-ItemTile--isDiscover .ItemTile-fileIconContainer{position:absolute;top:0;bottom:70px;left:0;right:0}.ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{margin:0;top:auto;bottom:0;padding:4px}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:auto}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:auto}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:0}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:0}.ItemTile-fileIcon{text-align:center}.ItemTile-fileIcon--thumbnail{position:absolute;top:50%;left:0;right:0;margin:-48px}.ItemTile-fileIcon--noThumbnail{position:relative;text-align:center;margin-top:14px}.ItemTile-rowCheck{display:none;position:absolute;top:0;width:100%;height:100%;opacity:0}[dir=ltr] .ItemTile-rowCheck{right:0}[dir=rtl] .ItemTile-rowCheck{left:0}.od-ItemTile--isInvokable .ItemTile-rowCheck{width:40px;height:40px}.is-checkVisible .ItemTile-rowCheck{opacity:1}.ItemTile.is-folder .ItemTile-rowCheck{top:6px}[dir=ltr] .ItemTile.is-folder .ItemTile-rowCheck{right:-1px}[dir=rtl] .ItemTile.is-folder .ItemTile-rowCheck{left:-1px}.ItemTile.is-folder.is-dropping .ItemTile-rowCheck,.ItemTile.is-folder.is-receivingDrop .ItemTile-rowCheck{opacity:0}.can-select .ItemTile-rowCheck{display:block}.od--isNonMobile .ItemTile.can-select:hover,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover{opacity:1}.ItemTile.is-selected .ItemTile-rowCheck,.od--isNonMobile .ItemTile:hover .ItemTile-rowCheck{opacity:1}.od-ItemTile-selector{display:none}.od-ItemTile--isInteractable .od-ItemTile-selector{display:block}.ItemTile-frame{position:absolute;display:none;left:2px;top:2px;right:2px;bottom:2px;box-shadow:0 0 0 2px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile-frame{outline:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile-frame{outline:2px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-ItemTile--hasImageStack .ItemTile-frame{top:8px}@media screen and (-ms-high-contrast:active){.od-ItemTile--hasImageStack .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-tag .ItemTile-frame{top:2px}.od--isNonMobile .ItemTile.can-select:hover .ItemTile-frame,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:"}.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{display:block;border:1px solid rgba(255,255,255,.2);box-shadow:0 0 0 2px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{-ms-transform:translateY(0);transform:translateY(0);animation-duration:167ms;animation-name:ms-fadeIn;animation-fill-mode:both}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:42px;color:'},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ItemTile .ItemCheck{position:absolute;top:8px}[dir=ltr] .ItemTile .ItemCheck{right:8px}[dir=rtl] .ItemTile .ItemCheck{left:8px}.ItemTile-namePlate{position:absolute;bottom:0;left:0;right:0;min-height:20px;padding:4px 8px 8px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";white-space:nowrap;text-overflow:ellipsis}.ItemTile.is-file .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:35px}.ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate{opacity:1;border-top:1px solid rgba(255,255,255,.2);max-height:74px}.ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";height:34px;width:34px;padding-top:5px;font-size:23px}[dir=ltr] .ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{padding-left:5px}[dir=rtl] .ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{padding-right:5px}.ItemTile.is-media .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:17px}.ItemTile.is-folder .ItemTile-namePlate{background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid rgba(255,255,255,.2);transition:transform 367ms cubic-bezier(.1,.9,.2,1)}.ItemTile.is-folder .ItemTile-namePlate::before{content:'';position:absolute;width:32%;height:16px;border-top:1px solid rgba(255,255,255,.2);top:-16px;background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';overflow:hidden}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{padding-left:1px}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{padding-right:1px}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{right:0}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{left:0}.ItemTile.is-folder.is-dropping .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{-ms-transform:translateY(0);transform:translateY(0);opacity:1;animation-duration:.1s;animation-name:ms-fadeOut;animation-fill-mode:both;animation-delay:1.25s}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:28px;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:';top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:42px;color:#107c10;top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}.ItemTile-nameCover{background-color:rgba(0,0,0,.25);position:absolute;font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif;text-shadow:0 0 8px #000;top:0;width:100%;height:100%}[dir=ltr] .ItemTile-nameCover{left:0}[dir=rtl] .ItemTile-nameCover{right:0}.ItemTile-tagText{position:relative;text-align:center;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);padding:0 8px}.ItemTile-folderBeak,.ItemTile-folderBeakHighlight{position:absolute;top:-16px;overflow:hidden}[dir=ltr] .ItemTile-folderBeak,[dir=ltr] .ItemTile-folderBeakHighlight{right:32%}[dir=rtl] .ItemTile-folderBeak,[dir=rtl] .ItemTile-folderBeakHighlight{left:32%}.ItemTile-folderBeak::before{content:'';position:absolute;top:1px;width:20px;height:30px;background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';-ms-transform-origin:top left;transform-origin:top left;-ms-transform:rotate(40deg);transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeak::before{right:-19px}[dir=rtl] .ItemTile-folderBeak::before{left:-19px}.ItemTile-folderBeak{width:18px;height:18px}.ItemTile-folderBeakHighlight{width:16px;height:16px}.ItemTile-folderBeakHighlight::before{content:\'\';position:absolute;top:0;width:1px;height:30px;background-color:rgba(255,255,255,.2);-ms-transform-origin:top left;transform-origin:top left;-ms-transform:rotate(40deg);transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeakHighlight::before{right:0}[dir=rtl] .ItemTile-folderBeakHighlight::before{left:0}html[dir=rtl] .ItemTile-folderBeak::before,html[dir=rtl] .ItemTile-folderBeakHighlight::before{-ms-transform-origin:top right;transform-origin:top right;-ms-transform:rotate(-40deg);transform:rotate(-40deg)}.ItemTile-childCount,.ItemTile-name,.ItemTile-subText{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ItemTile-name{font-size:15px;line-height:20px}.ItemTile.is-tag .ItemTile-name{max-height:4.1em;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;white-space:normal;text-overflow:normal;word-wrap:break-word;line-height:23px;padding-bottom:4px}.ItemTile-tagCount{font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;line-height:10px;opacity:.85}.ItemTile-sharingIcon{font-size:15px}.ItemTile.is-folder .ItemTile-sharingIcon{line-height:20px}html[dir=ltr] .ItemTile.is-folder .ItemTile-sharingIcon{float:right}html[dir=rtl] .ItemTile.is-folder .ItemTile-sharingIcon{float:left}.ItemTile.is-folder .ItemTile-subText .ItemTile-sharingIcon{float:inherit!important;line-height:1}.ItemTile-childCount{position:absolute;top:-14px;padding:0 3px;font-size:11px}[dir=ltr] .ItemTile-childCount{left:68%}[dir=rtl] .ItemTile-childCount{right:68%}.ItemTile.ItemTile.od-ItemTile--isDiscover .ItemTile-subText{padding-top:3px;opacity:1}.ItemTile.is-file .ItemTile-subText{font-size:11px;color:'},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.ItemTile.is-folder .ItemTile-subText{font-size:11px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.7}.ItemTile-subTextImage{width:14px;height:14px}[dir=ltr] .ItemTile-subTextImage{margin-right:4px}[dir=rtl] .ItemTile-subTextImage{margin-left:4px}.ItemTile-subTextImageShort{width:12px;height:12px}[dir=ltr] .ItemTile-subTextImageShort{margin-right:4px}[dir=rtl] .ItemTile-subTextImageShort{margin-left:4px}.ItemTile-subTextIcon{font-size:14px;position:relative;top:2px}[dir=ltr] .ItemTile-subTextIcon{margin-right:4px}[dir=rtl] .ItemTile-subTextIcon{margin-left:4px}.ItemTile-subTextIcon.ms-Icon.ms-Icon--IncidentTriangle{color:#d83b01}.ItemTile-blockIcon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeak,.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeakHighlight{display:none}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{font-size:12px;position:absolute;bottom:24px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate{height:80px;background:linear-gradient(0deg,rgba(0,0,0,.58),transparent);color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";left:2px;right:2px}.ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{top:auto;bottom:10px;padding:0;font-size:10px;color:rgba(255,255,255,.8)}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{left:10px;right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-frame{top:8px}.ItemTile.od-ItemTile--isAlbum .ItemTile-rowCheck{top:6px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,.ItemTile.od-ItemTile--isAlbum .ItemTile-subText{position:absolute;bottom:10px}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{right:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{left:10px}.ItemTile-newBadge{position:absolute;top:35px}[dir=ltr] .ItemTile-newBadge{left:1px}[dir=rtl] .ItemTile-newBadge{right:1px}.ItemTile-newBadge .od-newBadge{position:relative}[dir=ltr] .ItemTile-newBadge .od-newBadge{left:10px}[dir=rtl] .ItemTile-newBadge .od-newBadge{right:10px}.od-ItemTile--isVideo .ItemTile-fileIconContainer{bottom:0}.od-ItemTile--isVideo .ItemTile-namePlate{display:none}.ItemTile-playButton{position:absolute;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:8px;font-size:1.3em}[dir=ltr] .ItemTile-playButton{left:4px}[dir=rtl] .ItemTile-playButton{right:4px}html[dir=ltr] .ItemTile-viewerCount{float:right}html[dir=rtl] .ItemTile-viewerCount{float:left}.od-ItemTile-card{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ItemTile-date{display:none}.od-ItemTile--color-oneDrive.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate:before{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-ItemTile--color-oneDrive .ItemTile-folderBeak:before{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}"}])});define("odsp-next/controls/folderCoverTile/FolderCoverTile",["require","exports","./FolderCoverTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderCoverTile.html","./FolderCoverTile.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-folder-cover-tile",template:e("./FolderCoverTile.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/folderCoverTile/FolderCoverTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","../image/frame/ImageFrame","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,u=function(t){function r(e){var i=t.call(this,e)||this;i.thumbnailTagName=n.default.tagName;var r=i.observables,s=i.resources;l||(l=s.consume(a.platformDetection).isRetinaSupported?"64_2x":"64");i._mediaBaseUrl=s.consume(o.settings).mediaBaseUrl;i.imageRect=e.imageRect;i._item=e.item;i._lastThumbnails=-1;i._thumbnailIndex=-1;i._isPulsingEnabled=!0;i.pulseRecords=r.createArray();r.compute(i._computeRecords);var u=e.pulseTarget;u&&u(i);return i}i.__extends(r,t);r.prototype.canPulse=function(){var e=this._item();return!!(e&&e.folder&&e.folder.covers&&e.folder.covers.length>1)};r.prototype.enablePulsing=function(e){this._isPulsingEnabled=e};r.prototype.pulse=function(){if(this.canPulse()&&this._isPulsingEnabled){this._pushNextRecord();this.pulseRecords.shift();this._updatePulseClasses()}};r.prototype.getThumbnailParams=function(e){return{image:e.thumbnail,desiredSize:this.imageRect,alignment:s.AlignmentType.cover}};r.prototype._computeRecords=function(){var e=this._item();if(e){var t=e.key||"",i=e.folder&&e.folder.covers?e.folder.covers.length:-1;if(t!==this._lastKey||i!==this._lastThumbnails){this._lastKey=t;this._lastThumbnails=i;this.pulseRecords.removeAll();this._thumbnailIndex=-1;0===(e.folder&&e.folder.totalCount)?this._pushFolderRecord(!0):this._initializeRecord();this._updatePulseClasses()}}};r.prototype._pushFolderRecord=function(e){var t=this.observables;this.pulseRecords.push({className:t.create("od-FolderCoverTile-empty"),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create(""),isEmpty:e,thumbnail:t.create(null)})};r.prototype._initializeRecord=function(){var e;for(e=0;e<3;e++)this._pushFolderRecord(!1);for(e=0;e<2;e++)this._pushNextRecord()};r.prototype._pushNextRecord=function(){var e=this._getNextThumbnail(),t=this.observables;this.pulseRecords.push({className:t.create(),thumbnail:t.create(e),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create("")})};r.prototype._updatePulseClasses=function(){for(var e=this.pulseRecords(),t=0;t<e.length;t++){var i=e[t],r=e.length-t-1;i.isEmpty||i.className("od-FolderCoverTile-item"+r);i.isThumbnailVisible(!(!i.thumbnail()||!(i.isThumbnailVisible()||r<2)));var o=this.unwrapObservable(this._item),n=!o.tagInfo&&!i.isThumbnailVisible()&&(1===r||o.isAlbum||o.isDocSet);i.isWatermarkVisible(n);i.watermarkUrl(n?this._getFolderWatermarkUrl():null)}};r.prototype._getFolderWatermarkUrl=function(){var t=this._item(),i="genericfolder";t.isAlbum&&(i="photofolder");switch(t.isSpecialFolder&&t.specialFolderCanonicalName){case"Music":i="musicfolder";break;case"Documents":i="documentfolder";break;case"Photos":i="photofolder"}t.isDocSet&&(i="docset");return e.toUrl(this._mediaBaseUrl+"/images/watermarks/"+l+"/"+i+".png")};r.prototype._getNextThumbnail=function(){var e=this._item(),t=e&&e.folder&&e.folder.covers,i=t&&t.length;if(i)return t[this._thumbnailIndex=(this._thumbnailIndex+1)%i]};return r}(r.default);t.default=u});define("odsp-next/controls/folderCoverTile/FolderCoverTile.html",[],function(){return'<div class=od-FolderCoverTile data-bind="foreach: pulseRecords"><div data-bind="attr: { \'class\': className }">\x3c!--ko if: isThumbnailVisible--\x3e<div class=od-FolderCoverTile-image data-bind="component: { name: $component.thumbnailTagName, params: $component.getThumbnailParams($data) }"></div>\x3c!--/ko--\x3e\x3c!--ko if: isWatermarkVisible--\x3e<img class=od-FolderCoverTile-watermark data-bind="attr: { src: watermarkUrl }">\x3c!--/ko--\x3e</div></div>'});define("odsp-next/controls/folderCoverTile/FolderCoverTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FolderCoverTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.od-FolderCoverTile-image{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0;transition:opacity .6s linear .6s;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderCoverTile-watermark{position:absolute;left:50%;top:38%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);max-width:64px;max-height:64px}.od-FolderCoverTile-item0 .od-FolderCoverTile-image,.od-FolderCoverTile-item1 .od-FolderCoverTile-image{opacity:1}.od-FolderCoverTile>div{position:absolute;bottom:0}.od-FolderCoverTile-empty{left:2px;right:2px;top:8px;box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderCoverTile-item0{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";-ms-transform:translateY(100%);transform:translateY(100%)}.od-FolderCoverTile-item1{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";transition:transform .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2,.od-FolderCoverTile-item3{transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2{left:5px;right:5px;top:5px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderCoverTile-item3,.od-FolderCoverTile-item4{left:8px;right:8px;top:2px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderCoverTile-item4{opacity:0}.is-tag .od-FolderCoverTile-item1,.is-tag .od-FolderCoverTile-item2,.is-tag .od-FolderCoverTile-item3{box-shadow:none}.is-tag .od-FolderCoverTile-item1{left:0;right:0;top:0}.is-tag .od-FolderCoverTile-item2{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}"}])});define("odsp-next/controls/fileTypeIcon/FileTypeIcon",["require","exports","./FileTypeIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FileTypeIcon.html","./FileTypeIcon.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={tagName:"ms-file-type-icon",template:e("./FileTypeIcon.html"),viewModel:i.default,synchronous:!0};r.registerComponent(o);t.default=o});define("odsp-next/controls/fileTypeIcon/FileTypeIconViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./OverlayType","../../utilities/icons/IconHelper","../../providers/fileHandler/FileHandlerProvider"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=16,l=function(t){function r(i){var r=t.call(this,i)||this,l=i.iconName,u=i.extension,d=i.desiredSize||a,c=i.iconFieldAriaLabel;r.hoverText=i.hoverText;r.onClick=i.onClick;var p=r,m=p.observables,f=p.resources,h=m.create(""),g=m.create(c);if(i.iconUrl)h(i.iconUrl);else if(l){var v=i.iconSize||d,b=n.getIconUrl(f,l,v);h(b);if(u){var y=f.consume(s.resourceKey.optional);y&&m.backgroundCompute(function(){h(y.getFileTypeIconUrl(u)||b);g(y.getFileTypeName(u)||c)})}}r.size=(h.peek()?d:0)+"px";r.iconUrl=h;r.iconFieldAriaLabel=g;r.overlayUrl=i.overlayType?e.toUrl("@ms/odsp-media/lib/images/overlays/"+o[i.overlayType].toLowerCase()+"overlay.svg"):"";return r}i.__extends(r,t);return r}(r.default);t.default=l});define("odsp-next/controls/fileTypeIcon/OverlayType",["require","exports"],function(e,t){"use strict";var i;!function(e){e[e.none=0]="none";e[e.checkOut=1]="checkOut";e[e.notify=2]="notify";e[e.block=3]="block"}(i||(i={}));return i});define("odsp-next/utilities/icons/IconHelper",["require","exports","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/icons/FileTypeIconMap","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,i,r,o){"use strict";function n(t,i,n){void 0===s&&(s=t.consume(o.platformDetection).isRetinaSupported);s=s&&n<=48;var a=r.default[i]&&r.default[i].iconType||"png";return e.toUrl("@ms/odsp-media/lib/images/filetypes/"+n+(s?"_2x":"")+"/"+i+"."+a)}Object.defineProperty(t,"__esModule",{value:!0});var s;t.getIconUrl=n;t.getIconUrlFromExtension=function(e,t,r){return n(e,i.getIconNameFromExtension(t),r)}});define("odsp-next/controls/fileTypeIcon/FileTypeIcon.html",[],function(){return'<span class=FileTypeIcon data-bind="attr: { title: hoverText }, click: onClick, css: { \'FileTypeIcon--clickable\': !!onClick }" tabindex=-1><img class=FileTypeIcon-icon data-bind="attr: { src: iconUrl, alt: iconFieldAriaLabel }, style: { width: size, height: size, \'font-size\': size }">\x3c!--ko if: overlayUrl--\x3e<img class=FileTypeIcon-overlay data-bind="attr: { src: overlayUrl }">\x3c!--/ko--\x3e</span>'});define("odsp-next/controls/fileTypeIcon/FileTypeIcon.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".FileTypeIcon{position:relative;display:inline-block}.FileTypeIcon--clickable{cursor:pointer}.FileTypeIcon-icon{display:inline-block;vertical-align:middle;position:relative}.FileTypeIcon-icon::before{display:block}.FileTypeIcon-overlay{display:block;border:0;position:relative;left:9px;bottom:9px;height:9px;width:9px}"}])});define("odsp-next/controls/spotlightHost/SpotlightCell.html",[],function(){return'<div class=od-Spotlight-cell role=option data-bind="component: { name: tileTagName, params: { item: params.item, cellSize: params.cellSize, key: params.item().key, isInteractable: true, engagementSource: params.engagementSource } }"></div>'});define("odsp-next/controls/spotlightHost/SpotlightCell.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Spotlight-cell{width:100%;height:100%}"}])});define("odsp-next/controls/spotlightHost/SpotlightHost.html",[],function(){return"\x3c!--ko if: isVisible--\x3e<div class=SpotlightHost-container role=listbox tabindex=0 data-bind=\"attr: { 'aria-label': spotlightHostContainerLabel }, contextMenu: spotlightContextMenuHelper, keyboard: { allowButtonEvents: true, useRtlMappings: true, mappings: { 'Left': onKeyLeft, 'ShiftLeft': onKeyLeft, 'Right': onKeyRight, 'ShiftRight': onKeyRight, 'Down': onKeyRight, 'Up': onKeyLeft, 'Space': trapKeyPress, 'Enter': onKeyOpenItem }, }, clientRect: { size: size, allowHiddenSizeUpdates: true }\">\x3c!--ko foreach: spotlightCells--\x3e<div class=SpotlightHost-cell data-bind=\"component: { name: name, params: params }, style: { width: $parent.cellSize().width + 'px', height: $parent.cellSize().height + 'px' }, css: { 'SpotlightHost-cell-margin': $index() !== 0 }\"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<span class=ms-accessible role=status aria-live=polite data-bind=\"text: spotlightChangedText\"></span>"});define("odsp-next/controls/spotlightHost/SpotlightHost.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".SpotlightHost-container{display:block;white-space:nowrap;margin-top:20px}.SpotlightHost-container:focus{outline:0}.SpotlightHost-cell{display:inline-block;position:relative}[dir=ltr] .SpotlightHost-cell-margin{margin-left:8px}[dir=rtl] .SpotlightHost-cell-margin{margin-right:8px}[dir=ltr] .md .SpotlightHost-cell-margin,[dir=ltr] .sm .SpotlightHost-cell-margin{margin-left:4px}[dir=rtl] .md .SpotlightHost-cell-margin,[dir=rtl] .sm .SpotlightHost-cell-margin{margin-right:4px}"}])});define("odsp-next/dataSources/spotlight/spo/SpotlightDataSource",["require","exports","tslib","knockout","../../base/odb/DataSource","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/encoding/UriEncoding","../../../providers/spotlight/SpotlightResultEnum","../../../resources/SPOResourceKeys","../../../models/store/ItemsStore","../../../models/itemSet/ItemSet"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){var i=e.call(this,t)||this;i._listContext=i.resources.consume(l.listContext);i._cacheUpdatesObservable=r.observable(0);i._itemsStore=i.resources.consume(u.resourceKey);return i}i.__extends(t,e);t._getResultEnum=function(e){switch(e){case 0:return a.default.Success;case 1:return a.default.FolderDoesNotExist;case 2:return a.default.ItemDoesNotExist;case 3:return a.default.TooManyItems;case 4:return a.default.ItemNotInSpotlight;case 5:return a.default.InvalidArgument;case 6:return a.default.ServerError;default:return a.default.UnknownServerResult}};t.prototype.cacheSpotlightItems=function(e,t,i){var r=this._getCacheKey(e.peek().key,t),o=this._itemsStore.getItemSet(r);if(o)o.content.peek().items=i;else{(o=new d(r)).item=e;o.content.peek().items=i;this._itemsStore.setItemSet(r,o)}this._cacheUpdatesObservable(this._cacheUpdatesObservable.peek()+1)};t.prototype.getSpotlightItems=function(e,t){var i=this._getCacheKey(e,t),r=this._itemsStore.getItemSet(i);return r?r.content.peek().items:null};t.prototype.shouldFetchSpotlight=function(e,t,i){if(!t)return!0;if(i.requestToken)return!1;var r=this._getCacheKey(e,t),o=this._itemsStore.getItemSet(r);return!o||o.isExpired};t.prototype.editSpotlight=function(e){var t=this;return this.getData(function(){return t._getEditSpotlightUrl(e)},function(e){return t._parseSpotlighResult(e)},e.qosLabel,function(){return""},"POST",null).then(function(e){return e},function(e){return n.default.wrapError(e.message.value)})};t.prototype.getCacheUpdatesObservable=function(){return this._cacheUpdatesObservable};t.prototype.getDataSourceName=function(){return"SpotlightDataSource"};t.prototype._getEditSpotlightUrl=function(e){var t=[];t=[s.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl),"/"];var i=this._listContext.listUrl,r=e.viewId,o=e.item.properties.ID,n=e.folder.id;t.push("_api/web/GetList(strUrl=@list)/GetView(viewGuid=@view)");if(e.isAdd){var a=e.afterItem?parseInt(e.afterItem.properties.ID,10):-1;isNaN(a)&&(a=-1);t.push("/AddToSpotlight(itemId=@itemId,folderPath=@folderPath,afterItemId=@afterItemId)?@itemId=");t.push(o);t.push("&@folderPath='");t.push(s.default.encodeRestUriStringToken(n));t.push("'&@afterItemId=");t.push(a)}else{t.push("/RemoveFromSpotlight(itemId=@itemId,folderPath=@folderPath)?@itemId=");t.push(o);t.push("&@folderPath='");t.push(s.default.encodeRestUriStringToken(n));t.push("'")}t.push("&@list='");t.push(s.default.encodeRestUriStringToken(i));t.push("'&@view='");t.push(r);t.push("'");return t.join("")};t.prototype._getCacheKey=function(e,t){return"parentKey="+e.toLowerCase()+"&viewId="+t.toLowerCase()+"&spotlight=true"};t.prototype._parseSpotlighResult=function(e){try{var i=JSON.parse(e);if(i.d){var r=i.d.Order?i.d.Order.results:null,o=i.d.ResultCode;return{resultEnum:t._getResultEnum(o),order:r}}return{resultEnum:a.default.UnknownServerResult,order:null}}catch(e){return{resultEnum:a.default.InvalidServerJSON,order:null}}};return t}(o);t.default=c});define("odsp-next/GroupsAddOn",["require","exports","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-datasources/lib/interfaces/groups/SourceType","./utilities/groups/GroupsResourcesLoader","./pages/files/spo/routes/StandaloneListRoute","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}e.prototype.addGroupsFeatures=function(e){var t=this;e.scenarioName="GroupsV2";var i=e.getPageSettings,r=e.initializeScenario;e.initializeScenario=function(e){t._appResources=e;r(e);t._synchronousInitialize(e,i().suiteNavParams)};e.getPageSettings=function(){var e=i();t._configurePageSettings(e);return e}};e.prototype._synchronousInitialize=function(e,t){var i=this;this._deferredResourcesPromise=o.GroupsResourcesLoader.loadAndInitGroupsResources(e.resourceScope,t).then(function(e){i._deferredInitialize(e);return e})};e.prototype._deferredInitialize=function(e){var t=this,o=e.groupsProvider;if(o.group.source!==r.SourceType.None)this._onGroupsBasicPropertiesLoaded(o.group);else{var n=new i.default(this);n.on(o.group,"source",function(e){if(e!==r.SourceType.None){t._onGroupsBasicPropertiesLoaded(o.group);n.dispose()}})}};e.prototype._onGroupsBasicPropertiesLoaded=function(e){this._insertSharedWithUsLink(e)};e.prototype._configurePageSettings=function(e){e.route=new n.default({id:"List"});this._leftNavDataSourcePromise=e.leftNavSettings.leftNavDataSourcePromise};e.prototype._insertSharedWithUsLink=function(e){this._isGroupDefaultDocumentLibrary(e)&&this._leftNavDataSourcePromise.done(function(t){t.setSharedWithUsFlag(!0);t.addSharedWithUsNode(e.filesUrl)})};e.prototype._isGroupDefaultDocumentLibrary=function(e){var t=new s.default(e.filesUrl),i=new s.default(window.location.href),r=t.getDecodedStringForDisplay(),o=i.getDecodedStringForDisplay();return o&&r&&-1!==o.toUpperCase().indexOf(r.toUpperCase())};return e}();t.GroupsAddOn=a;t.default=a});define("@ms/odsp-datasources/lib/interfaces/groups/SourceType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Cache=0]="Cache";e[e.Server=1]="Server";e[e.None=2]="None"}(i=t.SourceType||(t.SourceType={}));t.default=i});define("odsp-next/utilities/groups/GroupsResourcesLoader",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-datasources/lib/interfaces/ISpPageContext","../../resources/SPOResourceKeys","../../resources/ModelResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function t(){}t.shouldAddGroupsFeatures=function(e){return n.isGroupWebContext(e)};t.loadAndInitGroupsResources=function(e,i){var o=e.consume(s.pageContext),n=e.expose(a.dataStore,new r.default("GroupsNext")),l=t._loadGroupsDeferredModules().then(function(r){var s=t._initializeModules(r,e,o,n,i);t._exposeLateResources(s,e);return s});t._exposeGroupsDeferredResourcePromises(l,e);return l};t._exposeGroupsDeferredResourcePromises=function(e,t){var i=e.then(function(e){return e.groupsProvider});t.expose(l.groupsAsync,i)};t._loadGroupsDeferredModules=function(){return i.default.all({groupsProviderModule:o.loadModule({require:e,path:"@ms/odsp-datasources/lib/providers/groups/GroupsProvider"})})};t._initializeModules=function(e,t,i,r,o){return{groupsProvider:new(t.injected(e.groupsProviderModule))({groupId:i.groupId,pageContext:i,dataStore:r})}};t._exposeLateResources=function(e,t){t.expose(l.groups,e.groupsProvider)};return t}();t.GroupsResourcesLoader=u;t.default=u});define("odsp-next/providers/error/ErrorProvider",["require","exports","tslib","../../dataSources/item/ItemDataSource.resx","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getAction=function(e){if(this.resources.isExposed(o.error))return this.resources.consume(o.error).getAction(e);var t=this.resources.consume(o.url);return{text:r.strings.DefaultActionText,url:t.getRootUrl()}};return t}(n.default);t.default=s});define("odsp-next/dataSources/error/splist/ErrorDataSource",["require","exports","tslib","../../item/ItemDataSource.resx","../../../resources/SPOResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getAction=function(e){if(this.resources.isExposed(o.listContext)){var t=this.resources.consume(o.listContext),i=t.listUrl?t.listUrl:t.folderPath;if(i)return{text:r.strings.SPListDefaultErrorActionText,url:i}}return{text:null,url:null,hideButton:!0}};return t}(n.default);t.default=s});define("odsp-next/dataSources/rating/RatingDataSource",["require","exports","tslib","../base/odb/DataSource","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.setRating=function(e){var t=this._setRatingUrl(e),i={};return this.getData(function(){return t},function(e){return parseFloat(e.substring(18,21))},"SetRating",function(){return JSON.stringify(i)},"POST")};t.prototype.getDataSourceName=function(){return"RatingDataSource"};t.prototype._setRatingUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_api/Microsoft.Office.Server.ReputationModel.Reputation.SetRating(listID=@listID,itemID=@itemID,rating="+e.rating+")?@listID='"+o.default.encodeRestUriStringToken(e.listId)+"'&@itemID="+e.itemId};return t}(r);t.RatingDataSource=n;t.default=n});define("odsp-next/providers/rating/RatingProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/SPOResourceKeys"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var i=e.call(this,t)||this;i._ratingDataSource=i.resources.consume(n.rating);i._listContext=i.resources.consume(s.listContext);return i}i.__extends(t,e);t.prototype.setRating=function(e){e.listId=this._listContext.listId;return this._ratingDataSource.setRating(e).then(function(e){return r.default.wrap(e)})};return t}(o.default);t.default=a});define("odsp-next/dataSources/publish/odb/PublishDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../url/odb/ItemUrlHelper","../../url/odb/ApiUrlHelper","../../base/odb/DataRequestor","../../../utilities/features/Features"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._dataRequestor=new(i.child(s.typeResourceKey))({qosName:"PublishDataSource"});i._itemUrlHelper=i.resources.consume(o.resourceKey);i._apiUrlHelper=i.resources.consume(n.resourceKey);return i}i.__extends(t,e);t.prototype.unPublishItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),i=this._apiUrlHelper.build().webByItemUrl(t);i=(i=a.isFeatureEnabled(a.SupportPoundPercent)?i.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl}):i.method("GetFileByServerRelativeUrl",t.serverRelativeItemUrl)).segment("UnPublish");return this._dataRequestor.getData({url:i.toString(),qosName:"UnPublishItem"})};t.prototype.publishItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),i=this._apiUrlHelper.build().webByItemUrl(t);i=(i=a.isFeatureEnabled(a.SupportPoundPercent)?i.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl}):i.method("GetFileByServerRelativeUrl",t.serverRelativeItemUrl)).method("Publish",e.comments);return this._dataRequestor.getData({url:i.toString(),qosName:"PublishItem"})};return t}(r.default);t.default=l});define("odsp-next/providers/publish/PublishProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../operation/OperationProvider","../../models/operation/OperationType","../../models/operation/OperationState","../../models/store/ItemsStore","../item/ItemProvider"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(t){var i=e.call(this,t)||this;i._itemProvider=i.resources.consume(u.resourceKey);i._store=i.resources.consume(l.resourceKey);i._operationProvider=i.resources.consume(n.resourceKey);return i}i.__extends(t,e);t.prototype.unPublishItem=function(e){var t,i=this,r=this.resources.consume(o.publish),n=e.item,l=this._store.getItem(e.parentKey),u=this._operationProvider.register({name:n.name,type:s.unPublishItem,payloads:{unPublishItem:{parent:l.peek(),item:n}},iconName:n.iconName});u.progress.maximum(1);u.progress.current(0);t=r.unPublishItem(e);u.state(a.started);return t.then(function(t){i._itemProvider.invalidateItem(e.parentKey);u.progress.current(1);u.state(a.completed);return t},function(){u.state(a.failed)})};t.prototype.publishItem=function(e){var t,i=this,r=this.resources.consume(o.publish),n=e.item,l=this._store.getItem(e.parentKey),u=this._operationProvider.register({name:n.name,type:s.publishItem,payloads:{publishItem:{parent:l.peek(),item:n}},iconName:n.iconName});u.progress.maximum(1);u.progress.current(0);t=r.publishItem(e);u.state(a.started);return t.then(function(t){i._itemProvider.invalidateItem(e.parentKey);u.progress.current(1);u.state(a.completed);return t},function(){u.state(a.failed)})};return t}(r.default);t.default=d});define("odsp-next/dataSources/leftNav/splist/LeftNavDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../dataSources/url/QueryType","../../../utilities/icons/Icon","@ms/odsp-datasources/lib/interfaces/ISpPageContext","knockout","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","../../../actions/odb/BackToClassicAction","./SPListLeftNavResx.resx","../../../controls/leftPane/LeftPane.resx","../../../controls/leftNav/LeftNav.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/uri/Uri","../../../utilities/features/Features","@ms/odsp-datasources/lib/Permissions","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-datasources/lib/dataSources/site/SiteDataSource","@ms/odsp-datasources/lib/ViewNav","../../../resources/ControlResourceKeys"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x="RenderNodes.LeftNav",I=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._editNavFeatureEnabled=g.isFeatureEnabled(g.SPListEditNav);i._pageContext=i.resources.consume(u.pageContext);i._backToClassicUrl=t.disableBackToClassic?null:t.backToClassicUrl||i.createObservable("");i._notificationLinks=a.observableArray([]);i._subsitesUrls=[];i._qosEvent=new f.Qos({name:x});i._urlDataSource=i.resources.consume(l.url);i._identity=i.resources.consume(l.identity).getIdentity();i._isReadOnly=i.createObservable(!1);i._hasSharedWithUsLink=!1;i._clientNode_base_key=-1;i._linkGroupsInitialized=!1;i._linkGroups=a.observableArray([]);i.useReactLeftNav=g.isFeatureEnabled(g.UseReactLeftNav);i.isEditable=i.createObservable(v.PermissionMask.hasIdentityPermission(i._identity,v.PermissionMask.manageLists));if(i._editNavFeatureEnabled&&i.isEditable()){i._siteDataSource=new y.default(i._pageContext);i._siteDataSource.getReadOnlyState().then(function(e){i.isEditable=i.createObservable(!e)})}i.navSettingsUrl=i._urlDataSource.getAreaNavigationSettingsUrl();i._pageContext.viewOnlyExperienceEnabled||i._pageContext.blockDownloadsExperienceEnabled||!i._backToClassicUrl||i._notificationLinks.push({text:c.strings.SwitchBack,url:"#",action:new(i.managed(d))({resources:i.resources,url:i._backToClassicUrl,cookieName:"splnu"}),isActive:i.createComputed(function(){return!1}),isFocused:a.observable(!1),engagementName:"BackToClassic",renderAs:6,altText:c.strings.SwitchBackAriaLabel});return i}i.__extends(t,e);t.prototype.getNotificationLinks=function(){return this._notificationLinks};t.prototype.isPersonalOneDrive=function(){return Number(this._pageContext.webTemplate)===b.default.mySite};t.prototype.getLinkGroups=function(e){var t=this;this._urlDataSource=this.resources.consume(l.url);if(this.useReactLeftNav){if(!this._linkGroupsInitialized){this._linkGroups([{text:this._pageContext.webTitle,url:this._pageContext.webAbsoluteUrl,isExpanded:a.observable(!0),isActive:this.createComputed(function(){e();return t._urlDataSource.isCurrentQuery(o.Files)}),isFocused:a.observable(!1),links:null,nodes:this._getLeftNavNodes(1),automationId:"LeftNav-WebTitleGrouping",linkGroupHeaderIsLink:a.observable(!0),hideGroupHeader:!0},{text:"TopLinks",url:"",isExpanded:a.observable(!0),isActive:this.createComputed(function(){e();return t._urlDataSource.isCurrentQuery(o.Files)}),isFocused:a.observable(!1),links:null,nodes:this._getLeftNavNodes(2),automationId:"LeftNav-TopLinksGrouping",linkGroupHeaderIsLink:a.observable(!1),hideGroupHeader:!0}]);this._linkGroupsInitialized=!0}return this._linkGroups}throw new Error("SPList LeftNavDatasource is not using ReactLeftNav.")};t.prototype.setSharedWithUsFlag=function(e){this._hasSharedWithUsLink=e};t.prototype.addSharedWithUsNode=function(e){var t=this;if(this._hasSharedWithUsLink){if(!this._linkGroupsInitialized){var i=this.resources.consume(S.viewParams);this.getLinkGroups(i)}this._linkGroups().some(function(i){if("LeftNav-WebTitleGrouping"===i.automationId){var r=!1;i.nodes().some(function(o,n){return r=t.addSharedWithUsHelper(i,e,o.url,n)})}return!1})}};t.prototype.addSharedWithUsHelper=function(e,t,i,r){var o=!1,n=new h.default(t).getPath();if(-1!==i.indexOf(n)){var s={name:p.strings.SharedWithUs,key:this._getClientNodeKey(),url:"#view=3",engagementName:"SharedWithUs",altText:m.strings.sharedWithUsAlt};e.nodes.splice(r+1,0,s);o=!0}return o};t.prototype._getLeftNavNodes=function(e){var t=this._pageContext.navigationInfo;return t&&t.quickLaunch&&t.quickLaunch.length>0&&1===e?a.observableArray(this._injectReactNavLinks(t.quickLaunch,!0)):t&&t.topNav&&t.topNav.length>0&&2===e?a.observableArray(this._injectReactNavLinks(t.topNav,!1)):a.observableArray([])};t.prototype._getClientNodeKey=function(){return(this._clientNode_base_key--).toString()};t.prototype._injectReactNavLinks=function(e,t){var i=this._pageContext,r=s.getSafeWebServerRelativeUrl(i),o=[];if(e&&e.length>0)for(var a=0;a<e.length;a++){var l=e[a];t&&1031===l.Id&&Number(i.webTemplate)===b.default.group&&i.groupId&&!i.groupHasHomepage&&(l.Url=r+"/_layouts/15/groupstatus.aspx?target=home");var u=1033===l.Id,d=2003===l.Id&&!t,c=1026===l.Id;(t||-1===this._subsitesUrls.indexOf(l.Url))&&(u||d||this._addLink(o,l.Title,l.Url,l.Id.toString(),null,"","","",l.IsDocLib));if(l.Children&&!u){for(var h=[],g=0,v=l.Children;g<v.length;g++){var y=v[g];c&&this._subsitesUrls.push(y.Url);this._addLink(h,y.Title,y.Url,y.Id.toString(),null,"","","",y.IsDocLib)}h.length>0&&(o[o.length-1].links=h)}}if(o.length>0){t&&this._addLink(o,p.strings.RecycleBin,r+"/_layouts/15/RecycleBin.aspx",this._getClientNodeKey(),null,"RecycleBin","RecycleBin",m.strings.recycleBinAlt,!1);if(!this._editNavFeatureEnabled&&this.isEditable()){var _=t?this._urlDataSource.getQuickLaunchSettingsUrl():this._urlDataSource.getTopNavSettingsUrl();this._addLink(o,p.strings.EditLink,_,this._getClientNodeKey(),new n("Edit").getClass(),"EditLeftNav","EditLeftNav",p.strings.EditLink,!1)}}this._qosEvent.end({resultCode:"Success",resultType:f.ResultTypeEnum.Success});return o};t.prototype._addLink=function(e,t,i,r,o,n,s,a,l){e.push({name:t,url:i,key:r,isDeleted:!1,isExpanded:!0,isCalloutVisible:!1,isContextMenuVisible:!1,position:0,iconClassName:o||"",engagementName:n,automationId:s,altText:a,isDocLib:l,target:_.ViewNavDataSource.isRelativeUrl(i)?"":"_blank"})};return t}(r.default);t.default=I});define("odsp-next/actions/odb/BackToClassicAction",["require","exports","tslib","cookies","../../base/BaseAction","../../dataSources/url/odb/UrlQueryKeys","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../dataSources/url/odb/ItemUrlHelper","../../utilities/path/Path","../../utilities/features/Features"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;i.name="BackToclassic";i._params=t;i._viewParams=i.resources.consume(s.viewParams);i._itemUrlHelper=i.resources.consume(c.resourceKey);return i}i.__extends(t,e);t.prototype.onExecute=function(e,t){var i=this,o=this._params.url,s=this.peekUnwrapObservable(o),c=this._viewParams.peek();if(!s){var f=c[n.default.listUrlKey],h=this._itemUrlHelper.getUrlParts({path:f,listUrl:f});s=h.fullItemUrl}if(s){m.isFeatureEnabled(m.SupportPoundPercent)&&(s=p.canonicalizeDecodedUrl(s));var g=c[n.default.idParamKey];if(g){s+=-1===s.indexOf("?")?"?":"&";var v=u.default.encodeURIComponent(g);s+=n.default.rootFolderParamKey+"="+v}this.async.setTimeout(function(){i._params.cookieName&&r.set(i._params.cookieName,"0");i.resources.consume(d.navigation).navigateTo(s)},0);return a.default.wrap({resultType:l.ResultTypeEnum.Success})}return a.default.wrap({resultType:l.ResultTypeEnum.Failure})};return t}(o.default)});define("@ms/odsp-datasources/lib/dataSources/site/SiteDataSource",["require","exports","tslib","../base/CachedDataSource","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(i){return e.call(this,i,t._dataSourceName+"("+(i?i.siteId:"")+")")||this}i.__extends(t,e);t.prototype.getDataSourceName=function(){return t._dataSourceName};t.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return-2===t?this.getDataUtilizingCache({getUrl:function(){return o.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Site/ReadOnly"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):n.default.wrap(-1!==t)};t.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?-2:null===this._pageContext.readOnlyState?-1:this._pageContext.readOnlyState};t.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingCache({getUrl:function(){return o.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Site?$select=StatusBarLink,StatusBarText"},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var i=t.d.StatusBarLink,r=void 0,o=void 0;if(i){var n=i.split("|");r=n[0];var a=1===n.length?n[0]:n[1];if(0===a.lastIndexOf("http",0)){var l=new s.default(a);o=encodeURI(l.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:r,StatusBarLinkTarget:o}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})};return t}(r.default);a._dataSourceName="SiteDataSource";t.SiteDataSource=a;t.default=a});define("@ms/odsp-datasources/lib/dataSources/base/CachedDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","./DataSource","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=3e5,l="odsp-ds-",u=function(e){function t(t,i,r){void 0===r&&(r={});var o=e.call(this,t)||this;o._cacheTimeoutTime=r.cacheTimeoutTime||a;o._id=i;o._version=t?t.siteClientTag+"_"+t.userDisplayName:"";var u=r.cacheIdPrefix||l;o._store=new n.default(u,s.default.session);o._initSessionCache();return o}i.__extends(t,e);t.prototype.getDataUtilizingCache=function(e){var t=this,i=e.getUrl,o=e.parseResponse,n=e.qosName,s=e.getAdditionalPostData,a=e.method,l=void 0===a?"POST":a,u=e.additionalHeaders,d=e.contentType,c=e.maxRetries,p=e.noRedirect,m=e.crossSiteCollectionCall,f=e.cacheRequestKey,h=e.useStale,g=void 0!==h&&h,v=e.bypassCache,b=void 0!==v&&v,y=e.onlyCache,_=void 0!==y&&y;f=f||this.getRequestKey(i(),l,s);var S=this._cache,x=S[f];if(_)return x?r.default.wrap(x._value):r.default.wrap(void 0);var I=x&&this._isCacheExpired(x);return b||!x||I&&!g?this.getData(i,o,n,s,l,u,d,c,p,m).then(function(e){S[f]={_fetched:(new Date).valueOf(),_value:e};t._updateSessionCache();return e}):r.default.wrap(x._value)};t.prototype.getRequestKey=function(e,t,i){var r=[];r.push(e);r.push(t);i&&r.push(i());return r.join(",")};Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});t.prototype.flushCache=function(e){delete this._cache[e];this._updateSessionCache()};t.prototype._initSessionCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearSessionCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};t.prototype._updateSessionCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};t.prototype._clearSessionCache=function(){this._cache={};this._updateSessionCache()};t.prototype._isCacheExpired=function(e){var t=(new Date).valueOf()-this._cacheTimeoutTime;return e._fetched<=t};return t}(o.default);t.CachedDataSource=u;t.default=u});define("@ms/odsp-datasources/lib/ViewNav",["require","exports","./dataSources/editNav/ViewNavDataSource"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("@ms/odsp-datasources/lib/dataSources/editNav/ViewNavDataSource",["require","exports","tslib","../base/DataSource"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,i,r){var o=e.call(this,t)||this;o._mapProviderName=r;o._pagesTitle=i;return o}i.__extends(t,e);t.isRelativeUrl=function(e){if(!e)return!1;var t=e.toLowerCase();return!(/^ftp:\/\//.test(t)||/^http:\/\//.test(t)||/^https:\/\//.test(t)||/^file:\/\//.test(t))};t.prototype.getMenuState=function(e){var t,i=this;t=e?"?menuNodeKey=&providerName'"+e+"'":void 0!==this._mapProviderName?"?menuNodeKey=&mapProviderName='"+this._mapProviderName+"'":"";return this.getData(function(){return i._pageContext.webAbsoluteUrl+"/_api/navigation/MenuState"+t},function(e){var t=JSON.parse(e);return i._transformToNavLinkGroups(t)},"getMenuState",void 0,"GET",{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},"application/json; odata.metadata=minimal",1)};t.prototype._transformToNavLinkGroups=function(e){if(e&&e.Nodes&&0!==e.Nodes.length){var t=[],i={links:[]};i.links=this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix);t.push(i);return t}};t.prototype._getLinksFromNodes=function(e,i){var r=this;return e.filter(function(e){return"1033"!==e.Key&&-1===e.Key.indexOf("SPNavigationNodeId=1033")&&!e.IsDeleted&&!e.IsHidden}).map(function(e){return{name:e.Title,url:r._getUrl(e,!1,i),key:e.Key,ariaLabel:e.Title,isExpanded:!0,target:t.isRelativeUrl(r._getUrl(e,!1,i))?"":"_blank",links:e.Nodes&&e.Nodes.length?e.Nodes.filter(function(e){return!e.IsDeleted&&!e.IsHidden}).map(function(o){return{name:o.Title,url:r._getUrl(o,!0,i,e.FriendlyUrlSegment),key:o.Key,ariaLabel:o.Title,isExpanded:!0,target:t.isRelativeUrl(r._getUrl(o,!0,i,e.FriendlyUrlSegment))?"":"_blank",links:o.Nodes&&o.Nodes.length?o.Nodes.filter(function(e){return!e.IsDeleted&&!e.IsHidden}).map(function(e){return{name:e.Title,url:r._getUrl(e,!0,i,o.FriendlyUrlSegment),key:e.Key,ariaLabel:e.Title,isExpanded:!0,target:t.isRelativeUrl(r._getUrl(e,!0,i,o.FriendlyUrlSegment))?"":"_blank"}}):void 0}}):void 0}})};t.prototype._getUrl=function(e,t,i,r){if(e.SimpleUrl)return e.SimpleUrl;var o;1==e.NodeType&&e.FriendlyUrlSegment&&(o=(o=t?i+(r?"/"+r:"")+"/"+e.FriendlyUrlSegment:i+e.FriendlyUrlSegment).replace("//","/"));return o};return t}(r.default);t.ViewNavDataSource=o;t.default=o});define("odsp-next/dataSources/leftNav/splist/LeftNavSettingsBuilder",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.buildLeftNavSettings=function(e){return{leftNavDataSourcePromise:i.default.wrap(e)}};return e}();t.LeftNavSettingsBuilder=r;t.default=r});define("odsp-next/dataSources/like/LikeDataSource",["require","exports","tslib","../base/odb/DataSource","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.setLike=function(e){var t=this._setLikeUrl(e),i={};return this.getData(function(){return t},function(e){return parseFloat(e.substring(18,21))},"SetLike",function(){return JSON.stringify(i)},"POST")};t.prototype.getDataSourceName=function(){return"LikeDataSource"};t.prototype._setLikeUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@listID,itemID=@itemID,like="+e.like+")?@listID='"+o.default.encodeRestUriStringToken(e.listId)+"'&@itemID="+e.itemId};return t}(r);t.LikeDataSource=n;t.default=n});define("odsp-next/providers/like/LikeProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/SPOResourceKeys"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var i=e.call(this,t)||this;i._likeDataSource=i.resources.consume(n.like);i._listContext=i.resources.consume(s.listContext);return i}i.__extends(t,e);t.prototype.setLike=function(e){e.listId=this._listContext.listId;return this._likeDataSource.setLike(e).then(function(e){return r.default.wrap(e)})};return t}(o.default);t.default=a});define("odsp-next/dataSources/language/odb/LanguageDataSource",["require","exports","tslib","../LanguageDataSource","../../../resources/SPOResourceKeys"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var i=e.call(this,t)||this;i._pageContext=i.resources.consume(o.pageContext);return i}i.__extends(t,e);t.prototype.getCurrentLanguageCode=function(){return this._pageContext.currentUICultureName};t.prototype.getLanguages=function(){return null};t.prototype.saveLanguage=function(e,t){return null};return t}(r.default);t.default=n});define("odsp-next/dataSources/language/LanguageDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){return e.call(this,t)||this}i.__extends(t,e);t.prototype.getCurrentLanguage=function(){return r.default.language};return t}(o.default);t.default=n});define("odsp-next/dataSources/encoding/odb/EncodingDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.getEncoding=function(){return null};return e}();t.default=i});define("odsp-next/providers/encoding/EncodingProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../models/language/FileEncodings"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var i=e.call(this,t)||this;i._languageDataSource=i.resources.consume(o.language);i._encodingDataSource=i.resources.consume(o.encoding);return i}i.__extends(t,e);t.prototype.getEncoding=function(){var e=this._encodingDataSource.getEncoding();if(!e){var t=this._languageDataSource.getCurrentLanguageCode();t=t.toLocaleLowerCase();e=n.default.encodingMap[t]}e||(e=n.default.defaultEncoding);return e};return t}(r.default);t.default=s});define("odsp-next/models/language/FileEncodings",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){}}();i.defaultEncoding="windows-1252";i.encodingMap={af:"windows-1252","af-za":"windows-1252",ar:"windows-1256","ar-sa":"windows-1256","az-latn-az":"windows-1254",be:"windows-1251","be-by":"windows-1251",bg:"windows-1251","bg-bg":"windows-1251","bs-latn-ba":"windows-1250",ca:"windows-1252","ca-es":"windows-1252","ca-es-valencia":"windows-1252",cs:"windows-1250","cs-cz":"windows-1250","cy-gb":"windows-1252",da:"windows-1252","da-dk":"windows-1252",de:"windows-1252","de-at":"windows-1252","de-ch":"windows-1252","de-de":"windows-1252",el:"windows-1253","el-gr":"windows-1253",en:"windows-1252","en-au":"windows-1252","en-ca":"windows-1252","en-gb":"windows-1252","en-ie":"windows-1252","en-in":"windows-1252","en-my":"windows-1252","en-nz":"windows-1252","en-ph":"windows-1252","en-sg":"windows-1252","en-us":"windows-1252","en-za":"windows-1252",es:"windows-1252","es-ar":"windows-1252","es-cl":"windows-1252","es-co":"windows-1252","es-cr":"windows-1252","es-es":"windows-1252","es-mx":"windows-1252","es-pe":"windows-1252","es-us":"windows-1252","es-ve":"windows-1252",et:"windows-1257","et-ee":"windows-1257",eu:"windows-1252","eu-es":"windows-1252",fa:"windows-1256","fa-ir":"windows-1256",fi:"windows-1252","fi-fi":"windows-1252","fil-ph":"windows-1252",fr:"windows-1252","fr-be":"windows-1252","fr-ca":"windows-1252","fr-ch":"windows-1252","fr-fr":"windows-1252","ga-ie":"windows-1252","gd-gb":"windows-1252",gl:"windows-1252","gl-es":"windows-1252","ha-latn-ng":"windows-1252",he:"windows-1255","he-il":"windows-1255",hr:"windows-1250","hr-hr":"windows-1250",hu:"windows-1250","hu-hu":"windows-1250",id:"windows-1252","id-id":"windows-1252","ig-ng":"windows-1252",is:"windows-1252","is-is":"windows-1252",it:"windows-1252","it-it":"windows-1252","iu-latn-ca":"windows-1252",ja:"Shift_JIS","ja-ja":"Shift_JIS","ja-jp":"Shift_JIS","ku-arab":"windows-1256","ku-arab-iq":"windows-1256",ky:"windows-1251","ky-kg":"windows-1251","lb-lu":"windows-1252",lt:"windows-1257","lt-lt":"windows-1257",lv:"windows-1257","lv-lv":"windows-1257",mk:"windows-1251","mk-mk":"windows-1251",mn:"windows-1251","mn-mn":"windows-1251",ms:"windows-1252","ms-my":"windows-1252","nb-no":"windows-1252",nl:"windows-1252","nl-be":"windows-1252","nl-nl":"windows-1252","nn-no":"windows-1252","nso-za":"windows-1252","pa-arab":"windows-1256","pa-arab-pk":"windows-1256",pl:"windows-1250","pl-pl":"windows-1250","prs-af":"windows-1256","pt-br":"windows-1252","pt-pt":"windows-1252","qut-gt":"windows-1252","quz-pe":"windows-1252",ro:"windows-1250","ro-ro":"windows-1250",ru:"windows-1251","ru-ru":"windows-1251",rw:"windows-1252","rw-rw":"windows-1252","sd-arab":"windows-1256","sd-arab-pk":"windows-1256",sk:"windows-1250","sk-sk":"windows-1250",sl:"windows-1250","sl-si":"windows-1250",sq:"windows-1250","sq-al":"windows-1250","sr-cyrl-ba":"windows-1251","sr-cyrl-cs":"windows-1251","sr-cyrl-rs":"windows-1251","sr-latn":"windows-1250","sr-latn-rs":"windows-1250",sv:"windows-1252","sv-se":"windows-1252",sw:"windows-1252","sw-ke":"windows-1252","tg-cyrl":"windows-1251","tg-cyrl-tj":"windows-1251",th:"windows-874","th-th":"windows-874","tk-tm":"windows-1250","tn-za":"windows-1252",tr:"windows-1254","tr-tr":"windows-1254",tt:"windows-1251","tt-ru":"windows-1251","ug-cn":"windows-1256",uk:"windows-1251","uk-ua":"windows-1251",ur:"windows-1256","ur-pk":"windows-1256","uz-latn-uz":"windows-1254",vi:"windows-1258","vi-vn":"windows-1258",wo:"windows-1252","wo-sn":"windows-1252","xh-za":"windows-1252","yo-ng":"windows-1252","zu-za":"windows-1252"};t.default=i});define("odsp-next/dataSources/footer/spList/SPListFooterDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","knockout","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../search/SearchShared.resx"],function(e,t,i,r,o,n,s,a,l){"use strict";return function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._eventGroup=new n.default(i);i._footerLinks=o.observable([]);i._searchFooterLinkId="upscopeSearchLink";return i}i.__extends(t,e);t.prototype.showLanguageLink=function(){return!1};t.prototype.showConfidentialText=function(){return!1};t.prototype.getLanguageText=function(){return""};t.prototype.getFooterLinks=function(){this.async.setTimeout(function(){var e=document.getElementById(this._searchFooterLinkId);e&&this._eventGroup.on(e,"click",a.Engagement.logData.bind(this,{name:"Expand.Search.Click"}))}.bind(this),100);return this._footerLinks()};t.prototype.setSearchFooterLink=function(e){if(e){var t=l.strings.ExpandSearchFooterLink,i=this._searchFooterLinkId,r=s.format(l.strings.ExpandSearchFooterText,'<a id="'+i+'" title="'+t+'" href="'+e+'" target="_blank">'+t+"</a>");this._searchFooterLink=[{encodedText:r}];this._footerLinks(this._searchFooterLink)}else this._footerLinks([])};return t}(r.default)});define("odsp-next/dataSources/search/odb/SearchCenterDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/base/odb/DataSource","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;t._urlCached=!1;t._searchCenterUrl=null;return t}i.__extends(t,e);t.prototype.getSearchCenterUrl=function(){var e=this,t=!1;return new r.default(function(i,r){e._urlCached?i(e._searchCenterUrl):e.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/search/searchCenterUrl"},function(e){var t=null;e&&(t=JSON.parse(e).d.searchcenterurl);return t},"GetSearchCenterUrl").done(function(r){if(!t){e._searchCenterUrl=r;e._urlCached=!0;i(e._searchCenterUrl)}},function(e){r(e)})},function(){t=!0})};t.prototype.getSearchCenterResultsUrl=function(e){return this.getSearchCenterUrl().then(function(t){return t?t+"/results.aspx?"+n.serializeQuery({k:e}):r.default.wrapError(new Error("Cannot upscope search. Caller must use the upscopeAvailable property of the returned ISearchData to determine if calling upscopeSearch is acceptable."))})};t.prototype.getDataSourceName=function(){return"SearchCenterDataSource"};return t}(o);t.default=s});define("odsp-next/dataSources/firstRunExperience/spo/FirstRunExperienceDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","../../base/odb/DataRequestor","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../../controls/firstRunExperience/FirstRunExperience.resx","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f="sharePointLibrariesFirstRun",h="sharePointListsFirstRun";t.FILTERSPANE_FLAG="sharePointFiltersPaneFirstRun";t.firstRunExperienceDataStoreResourceKey=new m.ResourceKey({name:e("module").id+".firstRunExperienceDataStore",factory:{dependencies:{},create:function(){return{instance:new l.default("FirstRunExperience",u.default.local)}}}});var g=function(r){function s(t,i){var o=r.call(this,t,i)||this;o._dataRequestor=new i.dataRequestorType({qosName:"FirstRunExperienceDataSource"});o._dataStore=i.dataStore;o._pageContext=i.pageContext;var n,s=e.toUrl("@ms/odsp-media/lib");switch(o._scenario=t.scenario){case 1:o._flagName=f;n=o._getPagesForLibraries(s);break;case 2:o._flagName=h;n=o._getPagesForLists(s)}o._pages=n;o.isReady=o.createObservable(!0);return o}i.__extends(s,r);s.prototype.getFirstRunFlag=function(){var e=this._dataStore,i=this._flagName,r=e.getValue(i);return void 0!==r?o.default.wrap(r):this._dataRequestor.getData({url:this._getQueryUrl(),qosName:"GetFirstRunFlag",method:"GET"}).then(function(r){if(r&&r.d){var o=r.d[t.FILTERSPANE_FLAG];void 0!==o&&e.setValue(t.FILTERSPANE_FLAG,!!o);var n=r.d[i];if(void 0!==n){e.setValue(i,!!n);return n}}return!0})};s.prototype.setFirstRunFlag=function(e){var t=this._flagName;this._dataStore.setValue(t,e);var i=(r={},r[t]=e,r);return this._dataRequestor.getData({url:this._getUpdateUrl(),qosName:"SetFirstRunFlag",additionalPostData:JSON.stringify(i),additionalHeaders:{"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},contentType:"application/json; odata=minimalmetadata",parseResponse:function(e){return e}});var r};s.prototype.getLaterButtonText=function(){return d.strings.laterButtonText};s.prototype.getFirstRunPages=function(){return this._pages};s.prototype.getShouldDismissOnLater=function(){return!0};s.prototype.getOptimizelyVariationId=function(){return 0};s.prototype.setOptimizelyVariationId=function(e){};s.prototype.timeoutGetUpgradeOptions=function(){};s.prototype._getQueryUrl=function(){return this._getUpdateUrl()+"?$select="+this._flagName+","+t.FILTERSPANE_FLAG};s.prototype._getUpdateUrl=function(){var e=this._pageContext;return a.default.escapeUrlForCallback(e.webAbsoluteUrl)+"/_api/SP.Directory.DirectorySession/User(principalName='"+a.default.escapeUrlForCallback(e.userLoginName)+"')"};s.prototype._getPagesForLibraries=function(e){var t=this._pageContext,i=t.currentLanguage,r=t.currentUICultureName,o=e+"/images/spfirstrun/libraries",s="https://support.office.com/"+r+"/client/results?Shownav=true&lcid="+i+"&ns=SPOSTANDARD&version=16&omkt="+r+"&ver=16&mode=Touch&helpId=WSSEndUser_DocLibFRELearnMore",a='<a href="'+p.default.encodeText(s)+'" target="_blank">';return[{welcomeText:d.strings.welcomeText,imageUrl:o+"01.svg",imageAltText:d.strings.firstPageTitle,title:d.strings.firstPageTitle,textHtml:n.format(d.strings.firstPageText,a,"</a>")},{imageUrl:o+"02.svg",imageAltText:d.strings.secondPageTitle,title:d.strings.secondPageTitle,textHtml:d.strings.secondPageText},{imageUrl:o+"03.svg",imageAltText:d.strings.thirdPageTitle,title:d.strings.thirdPageTitle,textHtml:d.strings.thirdPageText},{imageUrl:o+"04.svg",imageAltText:d.strings.fourthPageTitle,title:d.strings.fourthPageTitle,textHtml:d.strings.fourthPageText},{imageUrl:o+"05.svg",imageAltText:d.strings.fifthPageTitle,title:d.strings.fifthPageTitle,textHtml:d.strings.fifthPageText}]};s.prototype._getPagesForLists=function(e){var t=e+"/images/spfirstrun/lists";return[{welcomeText:d.strings.listsWelcomeText,imageUrl:t+"01.svg",imageAltText:d.strings.listsFirstPageTitle,title:d.strings.listsFirstPageTitle,textHtml:d.strings.listsFirstPageText},{imageUrl:t+"02.svg",imageAltText:d.strings.listsSecondPageTitle,title:d.strings.listsSecondPageTitle,textHtml:d.strings.listsSecondPageText},{imageUrl:t+"03.svg",imageAltText:d.strings.listsThirdPageTitle,title:d.strings.listsThirdPageTitle,textHtml:d.strings.listsThirdPageText},{imageUrl:t+"04.svg",imageAltText:d.strings.listsFourthPageTitle,title:d.strings.listsFourthPageTitle,textHtml:d.strings.listsFourthPageText},{imageUrl:t+"05.svg",imageAltText:d.strings.listsFifthPageTitle,title:d.strings.listsFifthPageTitle,textHtml:d.strings.listsFifthPageText}]};return s}(r.default);g.dependencies=i.__assign({},r.default.dependencies,{dataRequestorType:s.typeResourceKey,pageContext:c.pageContext,dataStore:t.firstRunExperienceDataStoreResourceKey});t.default=g});define("odsp-next/providers/firstRunExperience/FirstRunExperienceProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;i._dataSource=i.resources.consume(o.firstRunExperience);i.isReady=i.createComputed(function(){return i._dataSource.isReady()});i.resources.isExposed(n.userInfo)&&(i._userInfoProvider=i.resources.consume(n.userInfo));return i}i.__extends(t,e);t.prototype.getFirstRunFlag=function(){return this._dataSource.getFirstRunFlag()};t.prototype.setFirstRunFlag=function(e){return this._dataSource.setFirstRunFlag(e)};t.prototype.getLaterButtonText=function(){return this._dataSource.getLaterButtonText()};t.prototype.getFirstRunPages=function(){return this._dataSource.getFirstRunPages()};t.prototype.getViewCount=function(){return this._userInfoProvider?this._userInfoProvider.getFirstRunExperienceViewCount():null};t.prototype.incrementViewCount=function(){return this._userInfoProvider?this._userInfoProvider.updateFirstRunExperienceData(!1,!0):null};t.prototype.getShouldDismissOnLater=function(){return this._dataSource.getShouldDismissOnLater()};t.prototype.getOptimizelyVariationId=function(){return this._dataSource.getOptimizelyVariationId()};t.prototype.setOptimizelyVariationId=function(e){this._dataSource.setOptimizelyVariationId(e)};t.prototype.timeoutGetUpgradeOptions=function(){this._dataSource.timeoutGetUpgradeOptions()};t.prototype.getPositioningPageType=function(){return this._dataSource.getPositioningPageType&&this._dataSource.getPositioningPageType()};t.prototype.getIsStandardPositioningReady=function(){return this._dataSource.getIsStandardPositioningReady&&this._dataSource.getIsStandardPositioningReady()};return t}(r.default);t.FirstRunExperienceProvider=s;t.default=s});define("odsp-next/dataSources/videoItem/odb/VideoItemDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odb/DataRequestor","../../../controls/video/VideoPlaybackType","../../../utilities/features/Features","@ms/odsp-utilities/lib/async/Promise","../../../models/item/UrlType","../../../resources/DataSourceResourceKeys","../../url/odb/ItemUrlHelper","../../../controls/video/VideoErrorType","../../../resources/SPOResourceKeys"],function(e,t,i,r,o,n,s,a,l,u,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(){var t=e.call(this)||this;t._pageContext=t.resources.consume(p.pageContext);t._itemDataSource=t.resources.consume(u.items);t._dataRequestor=new(t.child(o.typeResourceKey))({});t._itemUrlHelper=t.resources.consume(d.resourceKey);return t}i.__extends(t,e);t.prototype.isStreamingSupported=function(e){var t=!!(e&&e.urls&&e.urls[l.video]);return s.isFeatureEnabled(s.EnableDashlingVideo)&&t};t.prototype.isHlsPlaybackSupported=function(){return s.isFeatureEnabled(s.EnableHlsPretranscode)};t.prototype.getErrorType=function(e){return c.default.unknown};t.prototype.getDownloadUrl=function(e,t){if(this.isStreamingSupported(e)){var i=e.urls[l.video],r=this._getFormat(t);if(i&&r){i+="&part=index&format="+r;s.isFeatureEnabled(s.EnableVideoSCFCaching)&&(i+="&useScf=True");if(t===n.default.htmlDashling)i+="&pretranscode=0&transcodeahead=0";else if(t===n.default.flashDash){i+="&pretranscode=0";i+="&.ism/manifest(format=mpd-time-csf)"}return a.default.wrap(i)}}var o=this._pageContext.isSPO;if(!(void 0===o||o))return a.default.wrap(e.openUrl);var u;u=!this._itemUrlHelper.getItemUrlParts(e.key).isCrossDomain&&t===n.default.htmlMp4;return this._itemDataSource.getDownloadUrl(e,{downloadType:u?1:2}).then(function(e){return e})};t.prototype._getFormat=function(e){return e===n.default.htmlDashling||e===n.default.flashDash?"dash":e===n.default.htmlHls?"hls":void 0};return t}(r.default);t.default=m});define("odsp-next/providers/peopleCard/PeopleCardProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,i,r,o,n){"use strict";return function(e){function t(t){void 0===t&&(t={});return e.call(this,t)||this}i.__extends(t,e);t.prototype.prefetchPeopleCards=function(e,t){this._getPeopleCardDataSource().then(function(i){i.prefetchPeopleCards(e,t)})};t.prototype.getPeopleCard=function(e,t){return this._getPeopleCardDataSource().then(function(i){return i.getPeopleCard(e,t)})};t.prototype.getOrgChart=function(e){return this._getPeopleCardDataSource().then(function(t){return t.getOrgChart(e)})};t.prototype.getDocuments=function(e,t){return this._getPeopleCardDataSource().then(function(i){return i.getDocuments(e,t)})};t.prototype.prefetchDocuments=function(e,t){this._getPeopleCardDataSource().then(function(i){i.prefetchDocuments(e,t)})};t.prototype._getPeopleCardDataSource=function(){var e=this;return this._peopleCardDataSource?r.default.as(this._peopleCardDataSource):this.resources.consume(n.peopleCardFactory)().then(function(t){e._peopleCardDataSource=t;return t})};return t}(o.default)});define("odsp-next/dataSources/flow/spo/FlowDataSource",["require","exports","tslib","../../../models/flow/FlowHelpers","./FlowConfiguration","./test/FlowConfiguration","./FlowComponents","../../../models/item/ItemParentHelper","../../../dataSources/url/odb/ItemUrlHelper","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/features/Features","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/async/Promise","../../base/odb/DataSource","../../../resources/DataSourceResourceKeys"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(b={},b[1]="spolists",b[2]="spolibraries",b[8]="spomanualtrigger",b[4]="spoautomatictrigger",b),g=[1,2,8,4],v=function(t){function m(e){var i=t.call(this,e)||this;i._flowConfigurationPromiseMap={};i._flowInstancePrefetchPromiseMap={};i._listDataSource=i.resources.consume(f.list);i._itemParentHelper=i.resources.consume(a.resourceKey);i._itemUrlHelper=i.resources.consume(l.resourceKey);i._effectiveConfiguration=d.isFeatureEnabled(d.PowerAppsAndAndProcessSimpleTestEnvironment)?n:o;i.rebaseComponentImages();return i}i.__extends(m,t);m.prototype.getFlowConfiguration=function(e,t){var i=this,r=this.getFolderPath(t);this._flowConfigurationPromiseMap[r]||(this._flowConfigurationPromiseMap[r]=new p.default(function(o,n){i._listDataSource.getFlowTemplates(r).done(function(r){var n;0===r.synchronizationStatus&&(n=JSON.parse(r.synchronizationDataObject.SynchronizationData));o(n?i.getFlowTemplatesFromFlowData(n,t,e):[])},function(e){o([])})}));return this._flowConfigurationPromiseMap[r].then(function(t){return i.getFlowConfigurationFromTemplates(t,e)})};m.prototype.getFlowInstances=function(e,t,i){var r=this.getListFullUrl(i);if(t){var o=e+r;this._flowInstancePrefetchPromiseMap[o]||(this._flowInstancePrefetchPromiseMap[o]=this.getFlowInstancesInternal(e,r));return this._flowInstancePrefetchPromiseMap[o]}return this.getFlowInstancesInternal(e,r)};m.prototype.getFlowCallbackUrl=function(e,t){var i=this,r=this.getListFullUrl(t);return new p.default(function(t,o){i._listDataSource.getFlowCallbackUrl(e,r).done(function(e){var i=null;0===e.synchronizationStatus&&(i=JSON.parse(e.synchronizationDataObject.SynchronizationData));t(i&&"OK"===i.httpStatusCode&&i.response&&i.response.value?i.response.value:null)},function(e){t(null)})})};m.prototype.getListFullUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullListUrl};m.prototype.getListId=function(e){return this._itemParentHelper.getFacetedAncestorOrSelf(e,"list").peek().list.id};m.prototype.getFolderPath=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).serverRelativeItemUrl};m.prototype.getFlowInstancesInternal=function(e,t){var i=this;return new p.default(function(r,o){i._listDataSource.getFlowInstances(t).done(function(t){if(0===t.synchronizationStatus){var o=[];try{var n=JSON.parse(t.synchronizationDataObject.SynchronizationData);n&&n.value&&(o=n.value.filter(function(e){return"Started"===e.properties.state}).filter(function(t){return!!i.getTriggerComponent(t,e)}).map(function(e){return{id:e.name,displayName:e.properties.displayName,trigger:i.getFlowTrigger(e)}}))}catch(e){}r(o)}},function(e){r([])})})};m.prototype.getFlowConfigurationFromTemplates=function(e,t){e&&e.length&&(e=e.filter(function(e){for(var i=0,r=g;i<r.length;i++){var o=r[i];if(t&o&&e.categoryNames.indexOf(h[o])<0)return!1}return!0}));return{templates:e,userFlowsUrl:this._effectiveConfiguration.userFlowsUrl,moreTemplatesUrl:this._effectiveConfiguration.moreTemplatesUrl}};m.prototype.getFlowTemplatesFromFlowData=function(e,t,i){var r=this,o=[];if(e){var n=e.value.sort(function(e,t){return e&&t?r.getDisplayPriority(e)-r.getDisplayPriority(t):Number(!t)-Number(!e)}),s=this.getListId(t),a=this.getFolderPath(t);o=n.map(function(e){var t=r.getTriggerComponent(e),i=r.getActionComponent(e),o=r.normalizeCategoryNames(e.properties.categoryNames),n=!!o&&-1!==o.indexOf(h[4])&&-1!==o.indexOf(h[2]);if(t&&i)return{templateId:e.name,description:e.properties.displayName,triggerComponent:t,actionComponent:i,navigationUrl:r.getNavigationUrl(e,s,n?a:null),categoryNames:o}}).filter(function(e){return!!e})}return o};m.prototype.normalizeCategoryNames=function(e){return e?e.map(function(e){return e&&e.toLowerCase()}):[]};m.prototype.rebaseComponentImages=function(){for(var t in s){var i=s[t];i.imageSourceFileName=e.toUrl("@ms/odsp-media/lib/images/processsimple/"+i.imageSourceFileName)}};m.prototype.getDisplayPriority=function(e){var t=Number.MAX_VALUE;if(e&&e.properties&&e.properties.metadata&&e.properties.metadata.SPOListsPriority){t=parseInt(e.properties.metadata.SPOListsPriority,10);isNaN(t)&&(t=Number.MAX_VALUE)}return t};m.prototype.getTriggerComponent=function(e,t){void 0===t&&(t="");var i,o=this.getFlowTrigger(e);if(o){if(t&&o.type!==t)return null;if("ApiConnection"===o.type){var n=o.api.name;i=this.getConnectionReferenceProperties(e,n)}else r.isRequestTrigger(o)&&(i=s.sharePoint)}return i};m.prototype.getActionComponent=function(e){var t=null,i=e.properties.definitionSummary.actions;if(e.properties.definitionSummary.triggers.some(r.isRequestTrigger))for(var o=0,n=i;o<n.length;o++){var a=n[o];if(r.isNonSharePointAction(a))return this.getConnectionReferenceProperties(e,a.api.name)}else{if(1===i.length)return this.getConnectionReferenceProperties(e,i[0].api.name);for(var l=0,u=i;l<u.length;l++)if((a=u[l]).api&&-1!==(t=this.getConnectionReferenceProperties(e,a.api.name)).imageSourceFileName.indexOf("sharepointonline.png"))return t}return t||s.customAction};m.prototype.getConnectionReferenceProperties=function(e,t){var i,r="",o="",n="";for(var s in e.properties.connectionReferences){var a=e.properties.connectionReferences[s];if(s===t||a.api&&a.api.name===t){i=a;break}}if(i){var l=i.api&&i.api.properties?i.api.properties:i;r=l.displayName;o=l.iconUri;n=l.metadata?l.metadata.brandColor:l.brandColor}return{serviceName:r,imageSourceFileName:o,imageContainerStyle:{"background-color":n}}};m.prototype.getFlowTrigger=function(e){var t=e.properties.definitionSummary.triggers;return t.length>0?t[t.length-1]:null};m.prototype.getNavigationUrl=function(e,t,i){var r="";if(e.name){r=u.format(this._effectiveConfiguration.flowUrlTemplate,e.name,encodeURIComponent(this._pageContext.webAbsoluteUrl),c.default.normalizeLower(t));i&&(r+="&parameters.sharepoint.folderPath="+encodeURIComponent(i.replace(this._pageContext.webServerRelativeUrl,"")))}return r};return m}(m);t.default=v;var b});define("odsp-next/models/flow/FlowHelpers",["require","exports"],function(e,t){"use strict";function i(e){return e&&e.type===n&&e.kind===o&&e.api&&e.api.name===s}Object.defineProperty(t,"__esModule",{value:!0});var r="Http",o="ApiConnection",n="Request",s="shared_sharepointonline";t.isRequestTrigger=function(e){return e&&e.type===n&&e.kind===r||i(e)};t.isHybridRequestTrigger=i;t.isNonSharePointAction=function(e){return e.api&&e.api.name!==s}});define("odsp-next/dataSources/flow/spo/FlowConfiguration",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.templates=[];t.userFlowsUrl="https://flow.microsoft.com/manage/flows?utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.moreTemplatesUrl="https://flow.microsoft.com/search?q=sharepoint&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.flowUrlTemplate="https://flow.microsoft.com/galleries/public/templates/{0}/?parameters.sharepoint.site={1}&parameters.sharepoint.list={2}&ExpandConnectionWizard=true&environment=&utm_source=0766EADB51FC40678EF404BEDB2F7F39&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration"});define("odsp-next/dataSources/flow/spo/test/FlowConfiguration",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.templates=[];t.userFlowsUrl="https://tip1.flow.microsoft.com/manage/flows?utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.moreTemplatesUrl="https://tip1.flow.microsoft.com/search?q=sharepoint&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.flowUrlTemplate="https://tip1.flow.microsoft.com/galleries/public/templates/{0}/?parameters.sharepoint.site={1}&parameters.sharepoint.list={2}&ExpandConnectionWizard=true&environment=&utm_source=17FEC2C8DF8A44D79CE51B0286370706&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration"});define("odsp-next/dataSources/flow/spo/FlowComponents",["require","exports","./FlowTemplate.resx"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharePoint={serviceName:"SharePoint",imageSourceFileName:"sharepoint.png",imageContainerStyle:{"background-color":"#1B75BC"}};t.office365={serviceName:"Office 365",imageSourceFileName:"office365.png",imageContainerStyle:{"background-color":"#EB3C00"}};t.salesforce={serviceName:"Salesforce",imageSourceFileName:"salesforce.png",imageContainerStyle:{"background-color":"#1EB8EB"}};t.sql={serviceName:"SQL",imageSourceFileName:"sqlserver.png",imageContainerStyle:{"background-color":"#BA141A"}};t.customAction={serviceName:i.strings.SharePointCustomActionComponentName,imageSourceFileName:"gear.svg",imageContainerStyle:{"background-color":"#333333",padding:"16px 0"}};t.mailChimp={serviceName:"MailChimp",imageSourceFileName:"mailchimp.png",imageContainerStyle:{"background-color":"#249AB9",padding:"12px 0"}};t.dynamics={serviceName:"Dynamics CRM",imageSourceFileName:"dynamics.svg",imageContainerStyle:{"background-color":"#002050",padding:"16px 0"}};t.manualTrigger={serviceName:i.strings.ManualFlowTriggerComponentName,imageSourceFileName:"manual.svg",imageContainerStyle:{color:"#FFF","background-color":"#0077FF",padding:"6px 0"}}});define("odsp-next/dataSources/itemCommand/odb/ItemCommandDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/command/ItemCommand","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/command/WebItemCommandKeys"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.getCommand=function(e,t){var i,r;switch(t){case n.restoreItem:r=this._isRestoreEnabled(e);break;case s.upload:r=!0}r&&(i=new o.default);return i};t.prototype._isRestoreEnabled=function(e){return!!e.recycleBinProperties.itemState};return t}(r.default);t.default=a});define("odsp-next/models/item/command/ItemCommand",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t}}();t.default=i});define("odsp-next/models/item/command/FileSystemItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolder=new i.default("createFolder");t.rename=new i.default("rename");t.moveFrom=new i.default("moveFrom");t.copyFrom=new i.default("copyFrom");t.moveTo=new i.default("moveTo");t.copyTo=new i.default("copyTo");t.deleteItem=new i.default("deleteItem");t.restoreItem=new i.default("restoreItem");t.deleteAllItems=new i.default("deleteAllItems");t.restoreAllItems=new i.default("restoreAllItems");t.createText=new i.default("createText");t.changeExpiration=new i.default("changeExpiration")});define("odsp-next/models/item/command/ItemCommandKey",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};return e}();i._lastId=0;t.default=i});define("odsp-next/models/item/command/WebItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.upload=new i.default("upload");t.download=new i.default("download")});define("odsp-next/models/store/SmartFiltersStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this,"SmartFiltersStore")||this;t._filterSectionInfoStoreKeys=[];return t}i.__extends(t,e);t.prototype.setFilterSectionInfos=function(e){var t=this._getStoreKey(e.parentKey,e.viewId,e.viewParams);-1===this._filterSectionInfoStoreKeys.indexOf(t)&&this._filterSectionInfoStoreKeys.push(t);this.setValue(t,e)};t.prototype.getFilterSectionInfos=function(e,t,i){return this.getValue(this._getStoreKey(e,t,i))};t.prototype.updateFilterSectionInfos=function(e,t,i,r){var o=!1,n=this._getStoreKey(e,t,i),s=this.getValue(n);if(s&&s.sectionInfos){for(var a=0;a<s.sectionInfos.length;a++){var l=r[s.sectionInfos[a].fieldName];if(l){s.sectionInfos[a]=l;o=!0}}this.setValue(n,s)}return o};t.prototype.setMetadataNavigationSettings=function(e,t){var i="metadatanavsettings="+e;this.setValue(i,t)};t.prototype.getMetadataNavigationSettings=function(e){var t="metadatanavsettings="+e;return this.getValue(t)};t.prototype.invalidate=function(e){for(var t=0,i=this._filterSectionInfoStoreKeys;t<i.length;t++){var r=i[t],o=this.getValue(r);o&&o.parentKey&&o.parentKey===e&&this.remove(r)}};t.prototype.invalidateAll=function(){for(var e=0,t=this._filterSectionInfoStoreKeys;e<t.length;e++){var i=t[e];this.remove(i)}};t.prototype._getStoreKey=function(e,t,i){return e+t};return t}(r.default);t.default=o});define("odsp-next/dataSources/pushChannel/spo/PushChannelDataSource.key",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return i.loadModuleExport({require:e,path:"./PushChannelDataSource",getExport:function(e){return e.resourceKey}})})})});define("odsp-next/providers/pushChannel/PushChannelProvider.key",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return i.loadModuleExport({require:e,path:"./PushChannelProvider",getExport:function(e){return e.resourceKey}})})})});define("odsp-next/providers/customAction/CustomActionProvider",["require","exports","tslib","@ms/odsp-utilities/lib/component/Component","../../resources/DataSourceResourceKeys"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,i){return e.call(this,t,i)||this}i.__extends(t,e);t.prototype.getCustomActionData=function(){var e=this.resources.consumeAsync(o.customAction).then(function(e){return e.getCustomActionData()});this.getCustomActionData=function(){return e};return e};t.prototype.isGroup=function(e){return"children"in e};return t}(r.default);t.default=n});define("odsp-next/dataSources/web/odb/WebDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:""+e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./WebDataSource",require:e,getExport:function(e){return e.resourceKey}})})})});define("odsp-next/controls/siteHeader/SiteHeaderKnockoutHost",["require","exports","knockout","./SiteHeaderKnockoutHostViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SiteHeaderKnockoutHost.html"],function(e,t,i,r,o){"use strict";var n=o.registerComponent({tagName:"ms-siteHeaderKOHost",template:e("./SiteHeaderKnockoutHost.html"),viewModel:r.default,synchronous:!0});i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);return n});define("odsp-next/controls/siteHeader/SiteHeaderKnockoutHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./SiteHeaderLoaderBinding"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){var t=e.call(this)||this;t.props={};t.addBindingHandlers({react:o.default});t.props.hostViewModel=t;return t}i.__extends(t,e);return t}(r.default);t.default=n});define("odsp-next/controls/siteHeader/SiteHeaderLoaderBinding",["require","exports","tslib","../../bindings/BaseBinding","react","react-dom","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){function r(i){var r=t.call(this,i)||this;s.loadModule({require:e,path:"./SiteHeaderContainer"}).then(function(e){n.render(o.createElement(e,r.valueAccessor().props),r.element)});return r}i.__extends(r,t);r.prototype.dispose=function(){n.unmountComponentAtNode(this.element)};return r}(r);t.default=a});define("odsp-next/controls/siteHeader/SiteHeaderKnockoutHost.html",[],function(){return'<div data-bind="react: { props: props }"></div>'});define("odsp-next/controls/list/CustomList",["require","exports","./react/detailsList/ReactDetailsList","knockout","./layouts/LayoutType","../reactHost/ReactHost"],function(e,t,i,r,o,n){"use strict";var s=n.createComponent(o.CustomList,i.default,{isFixedLayout:!0,columnActionModeAllowChevron:!0});r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s);return s});define("odsp-next/controls/list/react/detailsList/ReactDetailsList",["require","exports","tslib","react","office-ui-fabric-react/lib/Fabric","office-ui-fabric-react/lib/utilities/selection/index","office-ui-fabric-react/lib/MarqueeSelection","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/DetailsList","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Utilities","../ReactBaseList","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","./ReactDetailsList.resx","@ms/odsp-utilities/lib/performance/PerformanceCollection","./fields/CustomFormatterRenderer","../../../../resources/ProviderResourceKeys","../../../../resources/ControlResourceKeys","../../interfaces/ColumnFieldType","./fields/FieldMap","@ms/odsp-utilities/lib/logging/ABExperiment","../../../../utilities/killSwitch/KillSwitch","@ms/odsp-utilities/lib/modules/Modules","../../../../utilities/features/Features","@ms/odsp-utilities/lib/guid/Guid","../../../../providers/teachingBubble/TeachingBubbleHelper.key","./ReactDetailsList.css"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(t){function c(e){var i=t.call(this,e)||this;i.state={items:[],groups:null,columns:[],setKey:null,teachingBubbleProps:null};i._detailsRowType=i._createDetailsRowType();i._canShowTeachingBubble=i.observables.create(!1);i.resources.consumeAsync(C.asyncKey).done(function(e){i.observables.backgroundCompute(function(){i._canShowTeachingBubble(e.canShowTeachingBubbles());i.async.setTimeout(i._computeEmptyListTeachingBubbleVisibility,500)})});f.default.mark("EUPL.ReactDetailsList.constructor");return i}i.__extends(c,t);c.prototype.render=function(){f.default.mark("EUPL.ReactDetailsList.render");var t=this.props,a=t.isFixedLayout,u=t.tooltip,c=this.state,h=c.items,g=c.groups,b=c.columns,y=c.setKey,_=c.isAllCollapsed,S=c.selectionMode,I=c.teachingBubbleProps,w={getGroupItemLimit:this._getGroupItemLimit,isAllGroupsCollapsed:_,onToggleCollapseAll:this._onToggleCollapseAll,headerProps:{isGroupLoading:this._isGroupLoading,loadingText:m.strings.LoadingText,onGroupHeaderClick:this._onShowAll,onToggleCollapse:this._onToggleCollapse,isCollapsedGroupSelectVisible:!1},footerProps:{onToggleSummarize:this._onShowAll,showAllLinkText:m.strings.ShowAll},onRenderHeader:this._onRenderGroupHeaderFooter,onRenderFooter:this._onRenderGroupHeaderFooter},C={load:function(t){return x.loadModuleExport({path:t,require:e,getExport:function(e){return e.TeachingBubble}})},parse:void 0},T=I?{modulePath:"office-ui-fabric-react/lib/TeachingBubble",moduleLoader:C,waitPLT:!0,props:I}:null;this.resources.consume(v.isItemSetRendered)(!0);return r.createElement(s.MarqueeSelection,{isEnabled:S===n.SelectionMode.multiple,selection:this.selection,onShouldStartSelection:this._onShouldStartMarquee},r.createElement(o.Fabric,{className:d.css("od-DetailsList",{"is-mobile":this._isMobileView,"od--isVisible":this._isDot3ExperimentOn(),"is-check-visible":S!==n.SelectionMode.none})},r.createElement(l.DetailsList,{ref:"list",selection:this.selection,selectionMode:S,setKey:y,items:h,initialFocusedIndex:0,groups:g,groupProps:w,columns:b,layoutMode:a?l.DetailsListLayoutMode.fixedColumns:l.DetailsListLayoutMode.justified,constrainMode:l.ConstrainMode.unconstrained,onRenderRow:this._onRenderRow,onRenderMissingItem:this._onRenderMissingItem,onRowDidMount:this._onRowDidMount,onRowWillUnmount:this._onRowWillUnmount,onItemInvoked:this.onItemInvoked,rowElementEventMap:this.rowElementEventMap,dragDropEvents:this._dragDropEvents,getKey:this._getKey,ariaLabelForListHeader:m.strings.columnsHeaderAriaLabel,ariaLabelForSelectionColumn:m.strings.selectionColumnHeaderAriaLabel,ariaLabelForSelectAllCheckbox:m.strings.toggleSelectAllAriaLabel,isHeaderVisible:!this._isMobileView,checkboxVisibility:this._isMobileView?l.CheckboxVisibility.always:l.CheckboxVisibility.onHover,onActiveItemChanged:this._onActiveItemChanged,getRowAriaLabel:this._getAriaLabel,ariaLabel:u}),T&&r.createElement(p.ReactDeferredComponent,i.__assign({},T))))};c.prototype._isDot3ExperimentOn=function(){return!S.default.isActivated("93799f5c-4dbd-494f-acfd-7c538337c196","12/09/2016","Dot3Experiment")&&new _.ABExperiment({name:"Dot3ShowTo10",startDate:"12/09/2016",segmentPopulation:.1}).IsExperimentOn()};c.prototype._onShouldStartMarquee=function(e){for(var t=e.target,i=!0;t;){var r=t.getAttribute("data-selection-index");if(null!==r){i=!this.selection.isIndexSelected(Number(r));break}(t=t.parentElement)===document.body&&(t=null)}return i};c.prototype._updateItem=function(e,t){var i=this.state.items,r=-1;if(i[e]&&t.key===i[e].key)r=e;else for(var o=0;o<i.length;o++)if(i[o].key===t.key){r=o;break}if(r>=0&&t!==i[r]){i[r]=t;this.refs.list.forceUpdate()}};c.prototype._onRowDidMount=function(e,t){var i=this,r=this.state.items,o=e?e.key:r[t].key;this._keyToSubscriptionHash[o]=this._keyToObservableHash[o].extend({rateLimit:100}).subscribe(function(e){i._updateItem(t,e)})};c.prototype._onRowWillUnmount=function(e,t){var i=this.state.items,r=e?e.key:i[t].key,o=this._keyToSubscriptionHash[r];if(o){o.dispose();delete this._keyToSubscriptionHash[r]}};c.prototype._onTeachingBubbleDismiss=function(){this.setState({teachingBubbleProps:null})};c.prototype._dismissTeachingBubbleEvents=function(){if(this._addColumnButtonElement&&this.state.teachingBubbleProps){this.events.on(this._addColumnButtonElement,"click",this._onTeachingBubbleDismiss);this.events.on(window,"resize",this._onTeachingBubbleDismiss,!0);this.events.on(window,"scroll",this._onTeachingBubbleDismiss,!0)}};c.prototype._computeEmptyListTeachingBubbleVisibility=function(){if(this.observables.peekUnwrap(this._canShowTeachingBubble)){var e,t=this.state,i=t.items,r=t.columns,o=this.props.itemSet().item().isRootFolder;3===r.length&&"Title"===r[0].key&&"_calloutInvoker"===r[1].key&&"__newColumnHeaderCommand"===r[2].key&&(e=!0);this._addColumnButtonElement=document.querySelector("button[data-item-key='__newColumnHeaderCommand']");if(this._addColumnButtonElement&&o&&0===i.length&&e){var n={calloutProps:{directionalHint:u.DirectionalHint.bottomCenter},targetElement:this._addColumnButtonElement,onDismiss:this._onTeachingBubbleDismiss,hasCloseIcon:!0,children:m.strings.addColumnTeachingBubble};this.setState({teachingBubbleProps:n})}this._dismissTeachingBubbleEvents()}};c.prototype._onRenderRow=function(e,t){var i=this._detailsRowType,o=this.state.enableDeferredBehaviors;return r.createElement(i,{onRender:t,rowProps:e,enableDeferredBehaviors:o})};c.prototype._createDetailsRowType=function(){var e=this,t=this.resources.consume(g.instrumentation.optional),o=this.async.debounce(function(){e.setState(function(e){return{items:e.items.slice()}})},10,{leading:!1}),n=function(r){function n(e){var t=r.call(this,e)||this;t._scope=new a.default;t.state={isAvailable:!0};return t}i.__extends(n,r);n.prototype.componentWillMount=function(){this.props.enableDeferredBehaviors&&this._setupDefaultClickAction()};n.prototype.componentDidMount=function(){if(this.props.enableDeferredBehaviors){this._recordItemRender();this._subscribeToItem()}};n.prototype.componentWillReceiveProps=function(e){e.enableDeferredBehaviors&&!this.props.enableDeferredBehaviors&&this._setupDefaultClickAction();this._defaultClickAction&&e.rowProps.item!==this.props.rowProps.item&&this._defaultClickAction.update(e.rowProps.item)};n.prototype.componentWillUpdate=function(e,t){t.isAvailable!==this.state.isAvailable&&o()};n.prototype.componentDidUpdate=function(e){if(!e.enableDeferredBehaviors&&this.props.enableDeferredBehaviors){this._recordItemRender();this._subscribeToItem()}};n.prototype.componentWillUnmount=function(){this._scope.dispose()};n.prototype.render=function(){var e=this.props,t=e.onRender,r=e.rowProps;return t(i.__assign({},r,{"data-automationid":r.item.name,onRenderItemColumn:this._onRenderColumn}))};n.prototype._setupDefaultClickAction=function(){var t=this._defaultClickAction=this._scope.attach(e.setupDefaultClickAction(this.props.rowProps.item));this.setState({isAvailable:t.isAvailable.peek()})};n.prototype._recordItemRender=function(){var e=this.props.rowProps.item;t&&e&&!e.isPlaceholder&&t.userSeeItem(e)};n.prototype._subscribeToItem=function(){var e=this;this._scope.attach(this._defaultClickAction.isAvailable.subscribe(function(t){e.setState({isAvailable:t})}))};n.prototype._onRenderColumn=function(t,i,r){var o=this.state.isAvailable,n=r.data,s=!!I.isFeatureEnabled(I.CustomFormatter);if(n){var a=n.clientSideComponentId&&n.clientSideComponentId!==w.default.Empty.toString()&&n.clientSideColumnAdapter&&n.clientSideColumnAdapter.fieldCustomizerLoaded;return(s&&n.customFormatter?h.customFormatterRenderer:n.customFields?y.fieldMap.Custom:a?y.fieldMap.ClientSideCustom:y.fieldMap[b[n.fieldType]||"Text"])(t,i,n,{onItemInvoked:o?e.onItemInvoked:void 0,isDisabled:!o&&!e.selection.canSelectItem(t),itemSet:e.props.itemSet.peek(),resources:e.resources})}return[]};return n}(r.Component);i.__decorate([d.autobind],n.prototype,"_onRenderColumn",null);return n};return c}(c.default);i.__decorate([d.autobind],T.prototype,"_onShouldStartMarquee",null);i.__decorate([d.autobind],T.prototype,"_updateItem",null);i.__decorate([d.autobind],T.prototype,"_onRowDidMount",null);i.__decorate([d.autobind],T.prototype,"_onRowWillUnmount",null);i.__decorate([d.autobind],T.prototype,"_onTeachingBubbleDismiss",null);i.__decorate([d.autobind],T.prototype,"_onRenderRow",null);t.ReactDetailsList=T;t.default=T});define("office-ui-fabric-react/lib/Fabric",["require","exports","./components/Fabric/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Fabric/index",["require","exports","./Fabric"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Fabric/Fabric",["require","exports","tslib","react","../../Utilities","./Fabric.styles"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=[o.KeyCodes.up,o.KeyCodes.down,o.KeyCodes.left,o.KeyCodes.right,o.KeyCodes.home,o.KeyCodes.end,o.KeyCodes.tab,o.KeyCodes.pageUp,o.KeyCodes.pageDown],a=!1;"object"==typeof document&&document.documentElement&&!document.documentElement.getAttribute("dir")&&document.documentElement.setAttribute("dir","ltr");var l=function(e){function t(){var t=e.call(this)||this;t.state={isFocusVisible:a};return t}i.__extends(t,e);t.prototype.componentDidMount=function(){this._events.on(document.body,"mousedown",this._onMouseDown,!0);this._events.on(document.body,"keydown",this._onKeyDown,!0)};t.prototype.render=function(){var e=this.state.isFocusVisible,t=n.getStyles(this.props.theme),s=o.css("ms-Fabric",t.root,this.props.className,e&&"is-focusVisible"),a=o.getNativeProps(this.props,o.divProperties);return r.createElement("div",i.__assign({},a,{className:s,ref:this._resolveRef("_root")}))};t.prototype._onMouseDown=function(){if(this.state.isFocusVisible){this.setState({isFocusVisible:!1});a=!1}};t.prototype._onKeyDown=function(e){if(!this.state.isFocusVisible&&s.indexOf(e.which)>-1){this.setState({isFocusVisible:!0});a=!0}};return t}(o.BaseComponent);l=i.__decorate([o.customizable(["theme"])],l);t.Fabric=l});define("office-ui-fabric-react/lib/Utilities",["require","exports","@uifabric/utilities/lib/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Fabric/Fabric.styles",["require","exports","../../Utilities","../../Styling"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={fontFamily:"inherit"};t.getStyles=i.memoizeFunction(function(e){return{root:r.mergeStyles([e.fonts.medium,{color:e.palette.neutralPrimary,"& button":o,"& input":o}])}})});define("office-ui-fabric-react/lib/Styling",["require","exports","@uifabric/styling/lib/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("@uifabric/styling/lib/index",["require","exports","./glamorExports","./classNames/index","./styles/index","./utilities/index"],function(e,t,i,r,o,n){"use strict";function s(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});s(i);s(r);s(o);s(n)});define("@uifabric/styling/lib/classNames/index",["require","exports","./AnimationClassNames","./FontClassNames","./IconClassNames","./ColorClassNames"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnimationClassNames=i.AnimationClassNames;t.FontClassNames=r.FontClassNames;t.IconClassNames=o.IconClassNames;t.ColorClassNames=n.ColorClassNames});define("@uifabric/styling/lib/classNames/AnimationClassNames",["require","exports","../utilities/index","../styles/index"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnimationClassNames=i.buildClassMap(r.AnimationStyles)});define("@uifabric/styling/lib/utilities/index",["require","exports","./mergeStyles","./mergeStyleSets","./buildClassMap"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mergeStyles=i.mergeStyles;t.mergeStyleSets=r.mergeStyleSets;t.buildClassMap=o.buildClassMap});define("@uifabric/styling/lib/utilities/mergeStyles",["require","exports","glamor","@uifabric/utilities/lib/index"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mergeStyles=function(){function e(t){for(var i=0,r=t;i<r.length;i++){var o=r[i];o&&("string"==typeof o?n.push(o):Array.isArray(o)?e(o):s.push(o))}}for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var n=[],s=[];e(t);var a=null;s.length&&r.FabricPerformance.measure("glamor.css",function(){a=i.css.apply(void 0,s)});if(n.length){a&&n.push(a.toString());return n.join(" ")}return a}});define("@uifabric/styling/lib/utilities/mergeStyleSets",["require","exports","./mergeStyles"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mergeStyleSets=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r={},o={};e.forEach(function(e){return e&&Object.keys(e).forEach(function(t){o[t]||(o[t]=[]);o[t].push(e[t])})});Object.keys(o).forEach(function(e){r[e]=i.mergeStyles(o[e])});return r}});define("@uifabric/styling/lib/utilities/buildClassMap",["require","exports","./mergeStyles"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.buildClassMap=function(e){var t={};for(var r in e)!function(r){if(e.hasOwnProperty(r)){var o;Object.defineProperty(t,r,{get:function(){void 0===o&&(o=i.mergeStyles(e[r]).toString());return o},enumerable:!0,configurable:!0})}}(r);return t}});define("@uifabric/styling/lib/styles/index",["require","exports","./AnimationStyles","./DefaultPalette","./DefaultFontStyles","./IconCodes","./getFocusStyle","./theme"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnimationStyles=i.AnimationStyles;t.DefaultPalette=r.DefaultPalette;t.DefaultFontStyles=o.DefaultFontStyles;t.FontSizes=o.FontSizes;t.FontWeights=o.FontWeights;t.IconCodes=n.IconCodes;t.getFocusStyle=s.getFocusStyle;t.getTheme=a.getTheme;t.loadTheme=a.loadTheme;t.createTheme=a.createTheme});define("@uifabric/styling/lib/styles/AnimationStyles",["require","exports","../glamorExports"],function(e,t,i){"use strict";function r(e,t,i){return{animationName:e,animationDuration:t,animationTimingFunction:i,animationFillMode:"both"}}function o(e){return i.keyframes({from:{transform:"translate3d("+e+"px,0,0)"},to:{transform:"translate3d(0,0,0)"}})}function n(e){return i.keyframes({from:{transform:"translate3d(0,"+e+"px,0)"},to:{transform:"translate3d(0,0,0)"}})}function s(e){return i.keyframes({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d("+e+"px,0,0)"}})}function a(e){return i.keyframes({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,"+e+"px,0)"}})}Object.defineProperty(t,"__esModule",{value:!0});var l="cubic-bezier(.1,.9,.2,1)",u="cubic-bezier(.1,.25,.75,.9)",d=i.keyframes({from:{opacity:0},to:{opacity:1}}),c=i.keyframes({from:{opacity:1},to:{opacity:0}}),p=o(-10),m=o(-20),f=o(-40),h=o(-400),g=o(10),v=o(20),b=o(40),y=o(400),_=n(10),S=n(20),x=n(-10),I=n(-20),w=s(10),C=s(20),T=s(40),D=s(400),k=s(-10),P=s(-20),L=s(-40),R=s(-400),F=a(-10),A=a(-20),M=a(10),E=a(20),U=i.keyframes({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),B=i.keyframes({from:{transform:"scale3d(1,1,1)"},top:{transform:"scale3d(.98,.98,1)"}}),O=i.keyframes({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),N=i.keyframes({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),V=i.keyframes({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),H=i.keyframes({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}});t.AnimationStyles={slideRightIn10:r(d+","+p,"0.367s",l),slideRightIn20:r(d+","+m,"0.367s",l),slideRightIn40:r(d+","+f,"0.367s",l),slideRightIn400:r(d+","+h,"0.367s",l),slideLeftIn10:r(d+","+g,"0.367s",l),slideLeftIn20:r(d+","+v,"0.367s",l),slideLeftIn40:r(d+","+b,"0.367s",l),slideLeftIn400:r(d+","+y,"0.367s",l),slideUpIn10:r(d+","+_,"0.367s",l),slideUpIn20:r(d+","+S,"0.367s",l),slideDownIn10:r(d+","+x,"0.367s",l),slideDownIn20:r(d+","+I,"0.367s",l),slideRightOut10:r(c+","+w,"0.367s",l),slideRightOut20:r(c+","+C,"0.367s",l),slideRightOut40:r(c+","+T,"0.367s",l),slideRightOut400:r(c+","+D,"0.367s",l),slideLeftOut10:r(c+","+k,"0.367s",l),slideLeftOut20:r(c+","+P,"0.367s",l),slideLeftOut40:r(c+","+L,"0.367s",l),slideLeftOut400:r(c+","+R,"0.367s",l),slideUpOut10:r(c+","+F,"0.367s",l),slideUpOut20:r(c+","+A,"0.367s",l),slideDownOut10:r(c+","+M,"0.367s",l),slideDownOut20:r(c+","+E,"0.367s",l),scaleUpIn100:r(d+","+U,"0.367s",l),scaleDownIn100:r(d+","+O,"0.367s",l),scaleUpOut103:r(c+","+N,"0.167s",u),scaleDownOut98:r(c+","+B,"0.167s",u),fadeIn100:r(d,"0.167s",u),fadeIn200:r(d,"0.267s",u),fadeIn400:r(d,"0.367s",u),fadeIn500:r(d,"0.467s",u),fadeOut100:r(c,"0.167s",u),fadeOut200:r(c,"0.267s",u),fadeOut400:r(c,"0.367s",u),fadeOut500:r(c,"0.467s",u),rotate90deg:r(V,"0.1s",u),rotateN90deg:r(H,"0.1s",u)}});define("@uifabric/styling/lib/styles/IconCodes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IconCodes={aadLogo:"",accept:"",accessLogo:"",accounts:"",add:"",addEvent:"",addFavorite:"",addFavoriteFill:"",addFriend:"",addGroup:"",addOnlineMeeting:"",addPhone:"",addTo:"",admin:"",adminALogo:"",adminCLogo:"",adminDLogo:"",adminELogo:"",adminLLogo:"",adminMLogo:"",adminOLogo:"",adminPLogo:"",adminSLogo:"",adminYLogo:"",airTickets:"",airplane:"",alarmClock:"",album:"",albumRemove:"",alchemyLogo:"",alignCenter:"",alignLeft:"",alignRight:"",androidLogo:"",annotation:"",appForOfficeLogo:"",appIconDefault:"",arrivals:"",arrowDownRight8:"",arrowDownRightMirrored8:"",arrowUpRight8:"",arrowUpRightMirrored8:"",articles:"",ascending:"",assetLibrary:"",asterisk:"",atpLogo:"",attach:"",australianRules:"",autoEnhanceOff:"",autoEnhanceOn:"",autoRacing:"",awayStatus:"",azureLogo:"",back:"",backToWindow:"",badge:"",balloons:"",barChart4:"",barChartHorizontal:"",baseball:"",bidiLtr:"",bidiRtl:"",bingLogo:"",blockContact:"",blocked2:"",blocked:"",blowingSnow:"",boards:"",bold:"",bookingsLogo:"",bookmarks:"",bookmarksMirrored:"",boxLogo:"",branchFork:"",breadcrumb:"",brightness:"",broom:"",bufferTimeAfter:"",bufferTimeBefore:"",bufferTimeBoth:"",bulletedList:"",bulletedListMirrored:"",busSolid:"",cafe:"",cake:"",calculatorAddition:"",calculatorSubtract:"",calendar:"",calendarAgenda:"",calendarDay:"",calendarMirrored:"",calendarReply:"",calendarWeek:"",calendarWorkWeek:"",caloriesAdd:"",camera:"",cancel:"",car:"",caretBottomLeftSolid8:"",caretBottomRightSolid8:"",caretDown8:"",caretDownSolid8:"",caretHollow:"",caretHollowMirrored:"",caretLeft8:"",caretLeftSolid8:"",caretRight8:"",caretRightSolid8:"",caretSolid:"",caretSolidMirrored:"",caretTopLeftSolid8:"",caretTopRightSolid8:"",caretUp8:"",caretUpSolid8:"",cat:"",cellPhone:"",certificate:"",chart:"",chat:"",chatInviteFriend:"",checkList:"",checkMark:"",checkbox:"",checkboxComposite:"",checkboxIndeterminate:"",chevronDown:"",chevronDownMed:"",chevronDownSmall:"",chevronLeft:"",chevronLeftMed:"",chevronLeftSmall:"",chevronRight:"",chevronRightMed:"",chevronRightSmall:"",chevronUp:"",chevronUpMed:"",chevronUpSmall:"",chromeBack:"",chromeBackMirrored:"",chromeClose:"",chromeMinimize:"",circleFill:"",circleHalfFull:"",circlePlus:"",circleRing:"",classNotebookLogo:"",classroomLogo:"",clear:"",clearFilter:"",clearFormatting:"",clearNight:"",clock:"",closePane:"",closePaneMirrored:"",closedCaption:"",cloudAdd:"",cloudDownload:"",cloudUpload:"",cloudWeather:"",cloudy:"",cocktails:"",code:"",coffee:"",collabsDbLogo:"",collapseMenu:"",collegeFootball:"",collegeHoops:"",color:"",combine:"",compassNW:"",completed:"",completedSolid:"",contact:"",contactCard:"",contactInfo:"",container:"",contrast:"",copy:"",cotton:"",cricket:"",css:"",customList:"",customListMirrored:"",cycling:"",dataConnectionLibrary:"",dateTime2:"",dateTime:"",dateTimeMirrored:"",decreaseIndentLegacy:"",delveAnalytics:"",delveAnalyticsLogo:"",delveLogo:"",descending:"",design:"",developerTools:"",devices3:"",devices4:"",dialpad:"",dictionary:"",dietPlanNotebook:"",disableUpdates:"",dislike:"",docLibrary:"",dockLeft:"",dockLeftMirrored:"",dockRight:"",docsLogo:"",document:"",documentReply:"",documentSearch:"",documentSet:"",documentation:"",door:"",doubleBookmark:"",doubleChevronDown12:"",doubleChevronDown:"",doubleChevronLeft12:"",doubleChevronLeft:"",doubleChevronLeftMed:"",doubleChevronLeftMedMirrored:"",doubleChevronRight12:"",doubleChevronRight:"",doubleChevronUp12:"",doubleChevronUp:"",down:"",download:"",drm:"",drop:"",dropboxLogo:"",dropdown:"",duststorm:"",dynamicSmbLogo:"",dynamics365Logo:"",eatDrink:"",edgeLogo:"",edit:"",editMail:"",editMirrored:"",editNote:"",editPhoto:"",editStyle:"",embed:"",emi:"",emoji2:"",emoji:"",emojiDisappointed:"",emojiNeutral:"",emptyRecycleBin:"",equalizer:"",eraseTool:"",error:"",errorBadge:"",event:"",eventInfo:"",excelDocument:"",excelLogo:"",exchangeLogo:"",expandMenu:"",fabricAssetLibrary:"",fabricDataConnectionLibrary:"",fabricDocLibrary:"",fabricFolder:"",fabricFolderFill:"",fabricFolderSearch:"",fabricFormLibrary:"",fabricFormLibraryMirrored:"",fabricMovetoFolder:"",fabricNewFolder:"",fabricOpenFolderHorizontal:"",fabricPictureLibrary:"",fabricPublicFolder:"",fabricReportLibrary:"",fabricReportLibraryMirrored:"",fabricSyncFolder:"",fabricUnsyncFolder:"",facebookLogo:"",family:"",fangBody:"",favoriteList:"",favoriteStar:"",favoriteStarFill:"",fax:"",ferry:"",ferrySolid:"",filter:"",filters:"",financial:"",fingerprint:"",flag:"",flickDown:"",flickLeft:"",flickRight:"",flickUp:"",flow:"",fog:"",folder:"",folderFill:"",folderHorizontal:"",folderOpen:"",folderSearch:"",font:"",fontColor:"",fontDecrease:"",fontIncrease:"",fontSize:"",formLibrary:"",formLibraryMirrored:"",forward:"",forwardEvent:"",freezing:"",frigid:"",fullCircleMask:"",fullScreen:"",generate:"",giftCard:"",giftbox:"",glasses:"",glimmer:"",globalNavButton:"",globe:"",globeFavorite:"",golf:"",googleDriveLogo:"",gotoToday:"",gripperTool:"",group:"",groupedAscending:"",groupedDescending:"",groupedList:"",hailDay:"",hailNight:"",handwriting:"",header1:"",header2:"",header3:"",header4:"",headset:"",health:"",heart:"",heartFill:"",help:"",helpMirrored:"",hide2:"",hide:"",history:"",home:"",homeSolid:"",hospital:"",hotel:"",iOsAppStoreLogo:"",important:"",inboxCheck:"",incidentTriangle:"",increaseIndentLegacy:"",info2:"",info:"",insertTextBox:"",internetSharing:"",issueTracking:"",issueTrackingMirrored:"",italic:"",joinOnlineMeeting:"",js:"",label:"",landscapeOrientation:"",laptopSelected:"",largeGrid:"",library:"",lifesaver:"",lifesaverLock:"",light:"",lightbulb:"",lightningBolt:"",like:"",link:"",list:"",listMirrored:"",location:"",locationCircle:"",locationDot:"",locationFill:"",lock:"",lowerBrightness:"",lyncLogo:"",mail:"",mailAlert:"",mailCheck:"",mailFill:"",mailForward:"",mailForwardMirrored:"",mailLowImportance:"",mailPause:"",mailRepeat:"",mailReply:"",mailReplyAll:"",mailReplyAllMirrored:"",mailReplyMirrored:"",mapDirections:"",mapPin:"",market:"",marketDown:"",megaphone:"",memo:"",merge:"",message:"",messageFill:"",microphone:"",microsoftStaffhubLogo:"",miniLink:"",mobileSelected:"",money:"",more:"",moreSports:"",move:"",moveToFolder:"",msnLogo:"",multiSelect:"",multiSelectMirrored:"",musicInCollection:"",musicInCollectionFill:"",musicNote:"",nav2DMapView:"",newFolder:"",news:"",noteForward:"",notePinned:"",noteReply:"",numberField:"",numberedList:"",officeAssistantLogo:"",officeFormLogo:"",officeLogo:"",officeStoreLogo:"",officeVideoLogo:"",offlineOneDriveParachute:"",offlineOneDriveParachuteDisabled:"",oneDrive:"",oneDriveAdd:"",oneNoteEduLogo:"",oneNoteLogo:"",openFile:"",openFolderHorizontal:"",openInNewWindow:"",openPane:"",openPaneMirrored:"",org:"",outOfOffice:"",outlookLogo:"",page:"",pageAdd:"",pageCheckedOut:"",pageCheckedin:"",pageLeft:"",pageRight:"",pageSolid:"",panoIndicator:"",paratureLogo:"",partlyCloudyDay:"",partlyCloudyNight:"",partyLeader:"",pause:"",paymentCard:"",pc1:"",pdf:"",pencilReply:"",people:"",peopleAdd:"",peopleAlert:"",peopleBlock:"",peoplePause:"",peopleRepeat:"",permissions:"",phone:"",photo2:"",photo2Add:"",photo2Remove:"",photoCollection:"",picture:"",pictureLibrary:"",pieDouble:"",pill:"",pin:"",pinned:"",pinnedFill:"",planner:"",play:"",playerSettings:"",poi:"",postUpdate:"",powerApps2Logo:"",powerApps:"",powerAppsLogo:"",powerBiLogo:"",powerPointDocument:"",powerPointLogo:"",precipitation:"",presenceChickletVideo:"",preview:"",previewLink:"",print:"",printfaxPrinterFile:"",proFootball:"",proHockey:"",product:"",projectLogo:"",protectedDocument:"",publicCalendar:"",publicContactCard:"",publicEmail:"",publicFolder:"",puzzle:"",questionnaire:"",questionnaireMirrored:"",quickNote:"",radioBtnOn:"",radioBullet:"",rain:"",rainShowersDay:"",rainShowersNight:"",rainSnow:"",read:"",readingMode:"",receiptCheck:"",receiptForward:"",receiptReply:"",recent:"",recurringEvent:"",recurringTask:"",recycleBin:"",redEye:"",redo:"",refresh:"",reminderGroup:"",remove:"",removeEvent:"",removeFilter:"",removeLink:"",removeOccurrence:"",rename:"",reopenPages:"",repair:"",reply:"",replyAll:"",replyAllAlt:"",replyAllMirrored:"",replyAlt:"",replyMirrored:"",reportLibrary:"",reportLibraryMirrored:"",returnToSession:"",revToggleKey:"",ribbon:"",rightDoubleQuote:"",ringer:"",room:"",rotate:"",rugby:"",running:"",sad:"",save:"",saveAs:"",search:"",section:"",sections:"",securityGroup:"",send:"",sendMirrored:"",setAction:"",settings:"",share:"",shareiOs:"",sharepointLogo:"",shield:"",shop:"",shoppingCart:"",showResults:"",showResultsMirrored:"",sidePanel:"",singleBookmark:"",sipMove:"",skypeCheck:"",skypeCircleCheck:"",skypeCircleClock:"",skypeCircleMinus:"",skypeClock:"",skypeLogo:"",skypeMessage:"",skypeMinus:"",sliderThumb:"",snow:"",snowShowerDay:"",snowShowerNight:"",soccer:"",socialListeningLogo:"",sort:"",sortDown:"",sortLines:"",sortUp:"",speakers:"",speedHigh:"",split:"",squalls:"",stackIndicator:"",starburst:"",statusErrorFull:"",statusTriangle:"",stockDown:"",stockUp:"",stopwatch:"",storeLogo:"",storeLogoMed:"",strikethrough:"",subscribe:"",subscript:"",suitcase:"",sunAdd:"",sunQuestionMark:"",sunny:"",superscript:"",swayLogo:"",switcher:"",switcherStartEnd:"",sync:"",syncFolder:"",syncToPc:"",system:"",tab:"",table:"",tablet:"",tabletSelected:"",tag:"",taskManager:"",taskManagerMirrored:"",teamwork:"",temporaryUser:"",tennis:"",textBox:"",textField:"",thumbnailView:"",thumbnailViewMirrored:"",thunderstorms:"",ticket:"",tiles2:"",tiles:"",timeline:"",timer:"",toggleBorder:"",toggleFilled:"",toggleThumb:"",touch:"",touchPointer:"",train:"",trainSolid:"",transferCall:"",trash:"",triangleDown12:"",triangleLeft12:"",triangleRight12:"",triangleSolidDown12:"",triangleSolidLeft12:"",triangleSolidRight12:"",triangleSolidUp12:"",triangleUp12:"",trophy:"",turnRight:"",tvMonitor:"",tvMonitorSelected:"",underline:"",undo:"",unfavorite:"",unknownCall:"",unlock:"",unpin:"",unsubscribe:"",unsyncFolder:"",up:"",upload:"",video:"",videoSolid:"",view:"",viewAll2:"",viewAll:"",visioLogo:"",voicemailForward:"",voicemailReply:"",volume0:"",volume1:"",volume2:"",volume3:"",volumeDisabled:"",waffle:"",warning:"",website:"",weights:"",windDirection:"",windowsLogo:"",wipePhone:"",wordDocument:"",wordLogo:"",work:"",workFlow:"",worldClock:"",yammerLogo:"",zoom:"",zoomIn:"",zoomOut:""}});define("@uifabric/styling/lib/styles/getFocusStyle",["require","exports","../utilities/index","../glamorExports"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFocusStyle=function(e,t,o,n){void 0===t&&(t="0");void 0===o&&(o=e.palette.neutralSecondary);void 0===n&&(n="relative");return i.mergeStyles({outline:"transparent",position:n},r.parent(".ms-Fabric.is-focusVisible",{":focus:after":{content:'""',position:"absolute",left:t,top:t,bottom:t,right:t,border:"1px solid "+o}}))}});define("@uifabric/styling/lib/classNames/FontClassNames",["require","exports","../utilities/index","../styles/index"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FontClassNames=i.buildClassMap(r.DefaultFontStyles)});define("@uifabric/styling/lib/classNames/IconClassNames",["require","exports","../styles/index","../utilities/index"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IconClassNames={};for(var o in i.IconCodes)!function(e){var o;Object.defineProperty(t.IconClassNames,e,{get:function(){void 0===o&&(o=r.mergeStyles(i.DefaultFontStyles.icon,{":before":{content:'"'+i.IconCodes[e]+'"'}}).toString());return o},enumerable:!0,configurable:!0})}(o)});define("@uifabric/styling/lib/classNames/ColorClassNames",["require","exports","../utilities/index","../styles/DefaultPalette","../styles/index"],function(e,t,i,r,o){"use strict";function n(e,t,r,n,s){Object.defineProperty(e,t+r,{get:function(){var e=(r={},r[s]=o.getTheme().palette[t],r);return i.mergeStyles(n?{":hover":e}:e).toString();var r},enumerable:!0,configurable:!0})}Object.defineProperty(t,"__esModule",{value:!0});t.ColorClassNames={};for(var s in r.DefaultPalette)if(r.DefaultPalette.hasOwnProperty(s)){n(t.ColorClassNames,s,"",!1,"color");n(t.ColorClassNames,s,"Hover",!0,"color");n(t.ColorClassNames,s,"Background",!1,"background");n(t.ColorClassNames,s,"BackgroundHover",!0,"background");n(t.ColorClassNames,s,"Border",!1,"borderColor");n(t.ColorClassNames,s,"BorderHover",!0,"borderColor")}});define("office-ui-fabric-react/lib/utilities/selection/index",["require","exports","./interfaces","./Selection","./SelectionLayout","./SelectionZone"],function(e,t,i,r,o,n){"use strict";function s(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});s(i);s(r);s(o);s(n)});define("office-ui-fabric-react/lib/utilities/selection/interfaces",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CHANGE="change";!function(e){e[e.none=0]="none";e[e.single=1]="single";e[e.multiple=2]="multiple"}(t.SelectionMode||(t.SelectionMode={}));!function(e){e[e.horizontal=0]="horizontal";e[e.vertical=1]="vertical"}(t.SelectionDirection||(t.SelectionDirection={}))});define("office-ui-fabric-react/lib/utilities/selection/Selection",["require","exports","./interfaces","../../Utilities"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){void 0===e&&(e={});var t=e.onSelectionChanged,i=e.getKey,r=e.canSelectItem,o=void 0===r?function(e){return!0}:r;this.getKey=i||function(e,t){return e?e.key:String(t)};this._changeEventSuppressionCount=0;this._exemptedCount=0;this._anchoredIndex=0;this._unselectableCount=0;this.setItems([],!0);this._onSelectionChanged=t;this.canSelectItem=o}e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1;if(0===this._changeEventSuppressionCount&&this._hasChanged){this._hasChanged=!1;t||this._change()}};e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var i={},r={},o=!1;this.setChangeEvents(!1);this._unselectableCount=0;for(var n=0;n<e.length;n++){(u=e[n])&&(i[this.getKey(u,n)]=n);r[n]=u&&!this.canSelectItem(u);r[n]&&this._unselectableCount++}t&&this.setAllSelected(!1);var s={};for(var a in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(a)){var l=Number(a),u=this._items[l],d=u?this.getKey(u,Number(l)):void 0,c=d?i[d]:l;if(void 0===c){this.setAllSelected(!1);break}s[c]=!0;o=o||c!==l}this._exemptedIndices=s;this._keyToIndexMap=i;this._unselectableIndices=r;this._items=e||[];o&&this._change();this.setChangeEvents(!0)};e.prototype.getItems=function(){return this._items};e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];for(var e=0;e<this._items.length;e++)this.isIndexSelected(e)&&this._selectedItems.push(this._items[e])}return this._selectedItems};e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount};e.prototype.isRangeSelected=function(e,t){for(var i=e+t,r=e;r<i;r++)if(!this.isIndexSelected(r))return!1;return!0};e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0};e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)};e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])};e.prototype.setAllSelected=function(e){if((this._items?this._items.length-this._unselectableCount:0)>0&&(this._exemptedCount>0||e!==this._isAllSelected)){this._exemptedIndices={};this._exemptedCount=0;this._isAllSelected=e;this._updateCount()}};e.prototype.setKeySelected=function(e,t,i){var r=this._keyToIndexMap[e];r>=0&&this.setIndexSelected(r,t,i)};e.prototype.setIndexSelected=function(e,t,i){if(!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){var r=this._exemptedIndices[e],o=!1;if(!this._unselectableIndices[e]){if(r&&(t&&this._isAllSelected||!t&&!this._isAllSelected)){o=!0;delete this._exemptedIndices[e];this._exemptedCount--}if(!r&&(t&&!this._isAllSelected||!t&&this._isAllSelected)){o=!0;this._exemptedIndices[e]=!0;this._exemptedCount++}i&&(this._anchoredIndex=e)}o&&this._updateCount()}};e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)};e.prototype.selectToIndex=function(e,t){var i=this._anchoredIndex||0,r=Math.min(e,i),o=Math.max(e,i);this.setChangeEvents(!1);t&&this.setAllSelected(!1);for(;r<=o;r++)this.setIndexSelected(r,!0,!1);this.setChangeEvents(!0)};e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())};e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)};e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)};e.prototype.toggleRangeSelected=function(e,t){var i=this.isRangeSelected(e,t),r=e+t;this.setChangeEvents(!1);for(var o=e;o<r;o++)this.setIndexSelected(o,!i,!1);this.setChangeEvents(!0)};e.prototype._updateCount=function(){this.count=this.getSelectedCount();this._change()};e.prototype._change=function(){if(0===this._changeEventSuppressionCount){this._selectedItems=null;r.EventGroup.raise(this,i.SELECTION_CHANGE);this._onSelectionChanged&&this._onSelectionChanged()}else this._hasChanged=!0};return e}();t.Selection=o});define("office-ui-fabric-react/lib/utilities/selection/SelectionLayout",["require","exports","./interfaces"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._direction=e}e.prototype.getItemIndexAbove=function(e,t){return this._direction===i.SelectionDirection.vertical?Math.max(0,e-1):e};e.prototype.getItemIndexBelow=function(e,t){return this._direction===i.SelectionDirection.vertical?Math.min(t.length-1,e+1):e};e.prototype.getItemIndexLeft=function(e,t){return this._direction===i.SelectionDirection.vertical?e:Math.max(0,e-1)};e.prototype.getItemIndexRight=function(e,t){return this._direction===i.SelectionDirection.vertical?e:Math.min(t.length-1,e+1)};return e}();t.SelectionLayout=r});define("office-ui-fabric-react/lib/utilities/selection/SelectionZone",["require","exports","tslib","react","../../Utilities","./SelectionLayout","./interfaces"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.componentDidMount=function(){var e=o.getWindow(this.refs.root),t=o.findScrollableParent(this.refs.root);this._events.on(e,"keydown keyup",this._updateModifiers);this._events.on(t,"click",this._tryClearOnEmptyClick)};t.prototype.render=function(){return r.createElement("div",i.__assign({className:"ms-SelectionZone",ref:"root",onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu},{onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus}),this.props.children)};t.prototype.ignoreNextFocus=function(){this._shouldHandleFocus=!1};t.prototype._onMouseDownCapture=function(e){document.activeElement===e.target||o.elementContains(document.activeElement,e.target)||this.ignoreNextFocus()};t.prototype._onFocus=function(e){var t=e.target,i=this.props,r=i.selection,o=i.selectionMode,n=this._isCtrlPressed||this._isMetaPressed;if(this._shouldHandleFocus&&o!==s.SelectionMode.none){var a=this._hasAttribute(t,"data-selection-toggle"),l=this._findItemRoot(t);if(!a&&l){var u=this._getItemIndex(l);n?r.setIndexSelected(u,r.isIndexSelected(u),!0):this._onItemSurfaceClick(e,u)}}this._shouldHandleFocus=!1};t.prototype._onMouseDown=function(e){this._updateModifiers(e);for(var t=e.target,i=this._findItemRoot(t);t!==this.refs.root&&!this._hasAttribute(t,"data-selection-all-toggle");){if(i){if(this._hasAttribute(t,"data-selection-toggle"))break;if(this._hasAttribute(t,"data-selection-invoke")){this._onInvokeMouseDown(e,this._getItemIndex(i));break}if(t===i)break}t=o.getParent(t)}};t.prototype._onClick=function(e){this._updateModifiers(e);var t=e.target,i=this._findItemRoot(t);if(!this._isSelectionDisabled(t))for(;t!==this.refs.root;){if(this._hasAttribute(t,"data-selection-all-toggle")){this._onToggleAllClick(e);break}if(i){var r=this._getItemIndex(i);if(this._hasAttribute(t,"data-selection-toggle")){this._isShiftPressed?this._onItemSurfaceClick(e,r):this._onToggleClick(e,r);break}if(this._hasAttribute(t,"data-selection-invoke")){this._onInvokeClick(e,r);break}if(t===i){this._onItemSurfaceClick(e,r);break}}t=o.getParent(t)}};t.prototype._onContextMenu=function(e){var t=e.target,i=this.props,r=i.onItemContextMenu,o=i.selection;if(r){var n=this._findItemRoot(t);if(n){var s=this._getItemIndex(n);r(o.getItems()[s],s,e.nativeEvent);e.preventDefault()}}};t.prototype._isSelectionDisabled=function(e){for(;e!==this.refs.root;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=o.getParent(e)}return!1};t.prototype._onDoubleClick=function(e){var t=e.target;if(!this._isSelectionDisabled(t)){var i=this.props,r=i.selectionMode,n=i.onItemInvoked,a=this._findItemRoot(t);if(a&&n&&r!==s.SelectionMode.none&&!this._isInputElement(t)){for(var l=this._getItemIndex(a);t!==this.refs.root&&!this._hasAttribute(t,"data-selection-toggle")&&!this._hasAttribute(t,"data-selection-invoke");){if(t===a){this._onInvokeClick(e,l);break}t=o.getParent(t)}t=o.getParent(t)}}};t.prototype._onKeyDown=function(e){this._updateModifiers(e);var t=e.target;if(!this._isSelectionDisabled(t)){var i=this.props,r=i.selection,n=i.selectionMode,a=e.which===o.KeyCodes.a&&(this._isCtrlPressed||this._isMetaPressed),l=e.which===o.KeyCodes.escape;if(this._isInputElement(t))this._shouldHandleFocus=!0;else if(!a||n!==s.SelectionMode.multiple||r.isAllSelected())if(l&&r.getSelectedCount()>0){r.setAllSelected(!1);e.stopPropagation();e.preventDefault()}else{var u=this._findItemRoot(t);if(u)for(var d=this._getItemIndex(u);t!==this.refs.root&&!this._hasAttribute(t,"data-selection-toggle");){if(!(e.which!==o.KeyCodes.enter&&e.which!==o.KeyCodes.space||"BUTTON"!==t.tagName&&"A"!==t.tagName&&"INPUT"!==t.tagName))return!1;if(t===u){if(e.which===o.KeyCodes.enter){this._onInvokeClick(e,d);e.preventDefault();return}if(e.which===o.KeyCodes.space){this._onToggleClick(e,d);e.preventDefault();return}break}t=o.getParent(t)}this._shouldHandleFocus=!0}else{r.setAllSelected(!0);e.stopPropagation();e.preventDefault()}}};t.prototype._onToggleAllClick=function(e){var t=this.props,i=t.selection;if(t.selectionMode===s.SelectionMode.multiple){i.toggleAllSelected();e.stopPropagation();e.preventDefault()}};t.prototype._onToggleClick=function(e,t){var i=this.props,r=i.selection,o=i.selectionMode;if(o===s.SelectionMode.multiple)r.toggleIndexSelected(t);else{if(o!==s.SelectionMode.single)return;var n=r.isIndexSelected(t);r.setChangeEvents(!1);r.setAllSelected(!1);r.setIndexSelected(t,!n,!0);r.setChangeEvents(!0)}e.stopPropagation()};t.prototype._onInvokeClick=function(e,t){var i=this.props,r=i.selection,o=i.onItemInvoked;if(o){o(r.getItems()[t],t,e.nativeEvent);e.preventDefault();e.stopPropagation()}};t.prototype._onItemSurfaceClick=function(e,t){var i=this.props,r=i.selection,o=i.selectionMode,n=this._isCtrlPressed||this._isMetaPressed;o===s.SelectionMode.multiple?this._isShiftPressed?r.selectToIndex(t,!n):n?r.toggleIndexSelected(t):this._clearAndSelectIndex(t):o===s.SelectionMode.single&&this._clearAndSelectIndex(t)};t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)};t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)};t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;if(!(1===t.getSelectedCount()&&t.isIndexSelected(e))){t.setChangeEvents(!1);t.setAllSelected(!1);t.setIndexSelected(e,!0,!0);t.setChangeEvents(!0)}};t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey;this._isCtrlPressed=e.ctrlKey;this._isMetaPressed=e.metaKey};t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this.refs.root;){var i=e.getAttribute("data-selection-index"),r=Number(i);if(null!==i&&r>=0&&r<t.getItems().length)break;e=o.getParent(e)}if(e!==this.refs.root)return e};t.prototype._getItemIndex=function(e){return Number(e.getAttribute("data-selection-index"))};t.prototype._hasAttribute=function(e,t){for(var i=!1;!i&&e!==this.refs.root;){i="true"===e.getAttribute(t);e=o.getParent(e)}return i};t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName};t.prototype._isNonHandledClick=function(e){var t=o.getDocument();if(t&&e)for(;e&&e!==t.documentElement;){if(o.isElementTabbable(e))return!1;e=o.getParent(e)}return!0};return t}(o.BaseComponent);a.defaultProps={layout:new n.SelectionLayout(s.SelectionDirection.vertical),isMultiSelectEnabled:!0,isSelectedOnFocus:!0,selectionMode:s.SelectionMode.multiple};i.__decorate([o.autobind],a.prototype,"ignoreNextFocus",null);i.__decorate([o.autobind],a.prototype,"_onMouseDownCapture",null);i.__decorate([o.autobind],a.prototype,"_onFocus",null);i.__decorate([o.autobind],a.prototype,"_onMouseDown",null);i.__decorate([o.autobind],a.prototype,"_onClick",null);i.__decorate([o.autobind],a.prototype,"_onContextMenu",null);i.__decorate([o.autobind],a.prototype,"_onDoubleClick",null);i.__decorate([o.autobind],a.prototype,"_onKeyDown",null);t.SelectionZone=a});define("office-ui-fabric-react/lib/MarqueeSelection",["require","exports","./components/MarqueeSelection/MarqueeSelection","./utilities/selection/index"],function(e,t,i,r){"use strict";function o(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});o(i);o(r)});define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection",["require","exports","tslib","react","../../Utilities","./MarqueeSelection.scss"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n,a=function(e){function t(t){var i=e.call(this,t)||this;i.state={dragRect:void 0};return i}i.__extends(t,e);t.prototype.componentDidMount=function(){this._scrollableParent=o.findScrollableParent(this.refs.root);this._scrollableSurface=this._scrollableParent===window?document.body:this._scrollableParent;this._events.on(this.props.isDraggingConstrainedToRoot?this.refs.root:this._scrollableSurface,"mousedown",this._onMouseDown)};t.prototype.componentWillUnmount=function(){this._autoScroll&&this._autoScroll.dispose()};t.prototype.render=function(){var e=this.props,t=e.rootProps,n=e.children,a=this.state.dragRect;return r.createElement("div",i.__assign({},t,{className:o.css("ms-MarqueeSelection",s.root,t.className),ref:"root"}),n,a&&r.createElement("div",{className:o.css("ms-MarqueeSelection-dragMask",s.dragMask)}),a&&r.createElement("div",{className:o.css("ms-MarqueeSelection-box",s.box),style:a},r.createElement("div",{className:o.css("ms-MarqueeSelection-boxFill",s.boxFill)})))};t.prototype._isMouseEventOnScrollbar=function(e){var t=e.target,i=t.offsetWidth-t.clientWidth;if(i){var r=t.getBoundingClientRect();if(o.getRTL()){if(e.clientX<r.left+i)return!0}else if(e.clientX>r.left+t.clientWidth)return!0;if(e.clientY>r.top+t.clientHeight)return!0}return!1};t.prototype._onMouseDown=function(e){var t=this.props,i=t.isEnabled,r=t.onShouldStartSelection;if(!this._isMouseEventOnScrollbar(e)&&i&&!this._isDragStartInSelection(e)&&(!r||r(e))&&this._scrollableSurface&&0===e.button){this._selectedIndicies={};this._events.on(window,"mousemove",this._onMouseMove);this._events.on(this._scrollableParent,"scroll",this._onMouseMove);this._events.on(window,"click",this._onMouseUp,!0);this._autoScroll=new o.AutoScroll(this.refs.root);this._scrollTop=this._scrollableSurface.scrollTop;this._rootRect=this.refs.root.getBoundingClientRect()}};t.prototype._getRootRect=function(){return{left:this._rootRect.left,top:this._rootRect.top+(this._scrollTop-this._scrollableSurface.scrollTop),width:this._rootRect.width,height:this._rootRect.height}};t.prototype._onMouseMove=function(e){void 0!==e.clientX&&(this._lastMouseEvent=e);var t=this._getRootRect(),i={x:e.clientX-t.left,y:e.clientY-t.top};this._dragOrigin||(this._dragOrigin=i);if(void 0!==e.buttons&&0===e.buttons)this._onMouseUp(e);else if(this.state.dragRect||o.getDistanceBetweenPoints(this._dragOrigin,i)>5){var r=this.props.isDraggingConstrainedToRoot?{x:Math.max(0,Math.min(t.width,this._lastMouseEvent.clientX-t.left)),y:Math.max(0,Math.min(t.height,this._lastMouseEvent.clientY-t.top))}:{x:this._lastMouseEvent.clientX-t.left,y:this._lastMouseEvent.clientY-t.top},n={left:Math.min(this._dragOrigin.x,r.x),top:Math.min(this._dragOrigin.y,r.y),width:Math.abs(r.x-this._dragOrigin.x),height:Math.abs(r.y-this._dragOrigin.y)};this.setState({dragRect:n});this._evaluateSelection(n)}e.stopPropagation();e.preventDefault();return!1};t.prototype._onMouseUp=function(e){this._events.off(window);this._events.off(this._scrollableParent,"scroll");this._autoScroll.dispose();this._autoScroll=this._dragOrigin=this._lastMouseEvent=this._selectedIndicies=this._itemRectCache=void 0;if(this.state.dragRect){this.setState({dragRect:void 0});e.preventDefault();e.stopPropagation()}};t.prototype._isPointInRectangle=function(e,t){return e.top<t.y&&e.bottom>t.y&&e.left<t.x&&e.right>t.x};t.prototype._isDragStartInSelection=function(e){var t=this.props.selection;if(t&&0===t.getSelectedCount())return!1;for(var i=this.refs.root.querySelectorAll("[data-selection-index]"),r=0;r<i.length;r++){var o=i[r],n=Number(o.getAttribute("data-selection-index"));if(t.isIndexSelected(n)){var s=o.getBoundingClientRect();if(this._isPointInRectangle(s,{x:e.x,y:e.y}))return!0}}return!1};t.prototype._evaluateSelection=function(e){if(e){var t=this.props.selection,i=this._getRootRect(),r=this.refs.root.querySelectorAll("[data-selection-index]");this._itemRectCache||(this._itemRectCache={});t.setChangeEvents(!1);t.setAllSelected(!1);for(var o=0;o<r.length;o++){var n=r[o],s=n.getAttribute("data-selection-index"),a=this._itemRectCache[s];a||(a={left:(a=n.getBoundingClientRect()).left-i.left,top:a.top-i.top,width:a.width,height:a.height,right:a.left-i.left+a.width,bottom:a.top-i.top+a.height}).width>0&&a.height>0&&(this._itemRectCache[s]=a);a.top<e.top+e.height&&a.bottom>e.top&&a.left<e.left+e.width&&a.right>e.left?this._selectedIndicies[s]=!0:delete this._selectedIndicies[s]}for(var s in this._selectedIndicies)this._selectedIndicies.hasOwnProperty(s)&&t.setIndexSelected(Number(s),!0,!1);t.setChangeEvents(!0)}};return t}(o.BaseComponent);a.defaultProps={rootTagName:"div",rootProps:{},isEnabled:!0};i.__decorate([o.autobind],a.prototype,"_onMouseDown",null);t.MarqueeSelection=a});define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_0672d8b4",dragMask:"dragMask_0672d8b4",box:"box_0672d8b4",boxFill:"boxFill_0672d8b4"};i.loadStyles([{rawString:".root_0672d8b4{position:relative;cursor:default}.dragMask_0672d8b4{position:absolute;background:rgba(255,0,0,0);left:0;top:0;right:0;bottom:0}.box_0672d8b4{position:absolute;box-sizing:border-box;border:1px solid "},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";pointer-events:none}.boxFill_0672d8b4{position:absolute;box-sizing:border-box;background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";opacity:.1;left:0;top:0;right:0;bottom:0}"}]);return o});define("office-ui-fabric-react/lib/DetailsList",["require","exports","./components/DetailsList/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/DetailsList/index",["require","exports","../../utilities/selection/index","./DetailsList","./DetailsList.Props","./DetailsRow","./DetailsRowCheck"],function(e,t,i,r,o,n,s){"use strict";function a(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});a(i);a(r);a(o);a(n);a(s)});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList",["require","exports","tslib","react","./DetailsList.scss","../../Utilities","../DetailsList/DetailsList.Props","../DetailsList/DetailsHeader","../DetailsList/DetailsRow","../../FocusZone","../../utilities/selection/index","../../utilities/dragdrop/DragDropHelper","../../GroupedList","../../List","../../utilities/decorators/withViewport"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f){"use strict";function h(e,t,i,r,o,n,a){var l=[];if(e&&e.length){var u=e[0];for(var d in u)if(u.hasOwnProperty(d)){l.push({key:d,name:d,fieldName:d,minWidth:b,maxWidth:300,isCollapsable:!!l.length,isMultiline:void 0!==a&&a,isSorted:r===d,isSortedDescending:!!o,isRowHeader:!1,columnActionsMode:s.ColumnActionsMode.clickable,isResizable:t,onColumnClick:i,isGrouped:n===d});!1}}return l}function g(e){return e.which===n.getRTLSafeKeyCode(n.KeyCodes.right)}Object.defineProperty(t,"__esModule",{value:!0});var v=o,b=100,y=function(e){function t(t){var i=e.call(this,t)||this;i._activeRows={};i._columnOverrides={};i._onColumnIsSizingChanged=i._onColumnIsSizingChanged.bind(i);i._onColumnResized=i._onColumnResized.bind(i);i._onColumnAutoResized=i._onColumnAutoResized.bind(i);i._onRowDidMount=i._onRowDidMount.bind(i);i._onRowWillUnmount=i._onRowWillUnmount.bind(i);i._onToggleCollapse=i._onToggleCollapse.bind(i);i._onActiveRowChanged=i._onActiveRowChanged.bind(i);i._onHeaderKeyDown=i._onHeaderKeyDown.bind(i);i._onContentKeyDown=i._onContentKeyDown.bind(i);i._onRenderCell=i._onRenderCell.bind(i);i._onGroupExpandStateChanged=i._onGroupExpandStateChanged.bind(i);i.state={lastWidth:0,adjustedColumns:i._getAdjustedColumns(t),layoutMode:t.layoutMode,isSizing:!1,isDropping:!1,isCollapsed:t.groupProps&&t.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:t.groupProps&&!t.groupProps.isAllGroupsCollapsed};i._selection=t.selection||new d.Selection({onSelectionChanged:null,getKey:t.getKey});i._selection.setItems(t.items,!1);i._dragDropHelper=t.dragDropEvents?new c.DragDropHelper({selection:i._selection,minimumPixelsForDrag:t.minimumPixelsForDrag}):null;i._initialFocusedIndex=t.initialFocusedIndex;return i}i.__extends(t,e);t.prototype.componentWillUnmount=function(){this._dragDropHelper&&this._dragDropHelper.dispose()};t.prototype.componentDidUpdate=function(e,t){if(void 0!==this._initialFocusedIndex){var i=this._activeRows[this._initialFocusedIndex];i&&this._setFocusToRowIfPending(i)}this.props.onDidUpdate&&this.props.onDidUpdate(this)};t.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.checkboxVisibility,r=t.items,o=t.setKey,n=t.selectionMode,s=t.columns,a=t.viewport,l=this.state.layoutMode,u=e.setKey!==o||void 0===e.setKey,d=!1;if(e.layoutMode!==this.props.layoutMode){l=e.layoutMode;this.setState({layoutMode:l});d=!0}u&&(this._initialFocusedIndex=e.initialFocusedIndex);e.items!==r&&this._selection.setItems(e.items,u);e.checkboxVisibility===i&&e.columns===s&&e.viewport.width===a.width||(d=!0);this._adjustColumns(e,!0,l);e.selectionMode!==n&&(d=!0);d&&this._forceListUpdates()};t.prototype.render=function(){var e=this,t=this.props,o=t.ariaLabelForListHeader,l=t.ariaLabelForSelectAllCheckbox,c=t.ariaLabelForSelectionColumn,f=t.className,h=t.checkboxVisibility,b=t.constrainMode,y=t.dragDropEvents,_=t.groups,S=t.groupProps,x=t.items,I=t.isHeaderVisible,w=t.onItemInvoked,C=t.onItemContextMenu,T=t.onColumnHeaderClick,D=t.onColumnHeaderContextMenu,k=t.selectionMode,P=t.selectionPreservedOnEmptyClick,L=t.ariaLabel,R=t.ariaLabelForGrid,F=t.rowElementEventMap,A=t.shouldApplyApplicationRole,M=void 0!==A&&A,E=t.getKey,U=this.state,B=U.adjustedColumns,O=U.isCollapsed,N=U.layoutMode,V=U.isSizing,H=U.isSomeGroupExpanded,K=this,q=K._selection,z=K._dragDropHelper,G=this._getGroupNestingDepth(),j={renderedWindowsAhead:V?0:2,renderedWindowsBehind:V?0:2,getKey:E},W=a.SelectAllVisibility.none;k===d.SelectionMode.single&&(W=a.SelectAllVisibility.hidden);if(k===d.SelectionMode.multiple){var X=S&&S.headerProps&&S.headerProps.isCollapsedGroupSelectVisible;void 0===X&&(X=!0);W=X||!_||H?a.SelectAllVisibility.visible:a.SelectAllVisibility.hidden}h===s.CheckboxVisibility.hidden&&(W=a.SelectAllVisibility.none);var Q=this.props.onRenderDetailsHeader,Z=void 0===Q?this._onRenderDetailsHeader:Q;return r.createElement("div",i.__assign({ref:this._resolveRef("_root"),className:n.css("ms-DetailsList",v.root,f,(J={"is-fixed":N===s.DetailsListLayoutMode.fixedColumns},J["is-horizontalConstrained "+v.rootIsHorizontalConstrained]=b===s.ConstrainMode.horizontalConstrained,J)),"data-automationid":"DetailsList","data-is-scrollable":"false","aria-label":L},M?{role:"application"}:{}),r.createElement("div",{role:"grid","aria-label":R,"aria-rowcount":(I?1:0)+(x?x.length:0),"aria-colcount":(W!==a.SelectAllVisibility.none?1:0)+(B?B.length:0),"aria-readonly":"true"},r.createElement("div",{onKeyDown:this._onHeaderKeyDown,role:"presentation"},I&&Z({componentRef:this._resolveRef("_header"),selectionMode:k,layoutMode:N,selection:q,columns:B,onColumnClick:T,onColumnContextMenu:D,onColumnResized:this._onColumnResized,onColumnIsSizingChanged:this._onColumnIsSizingChanged,onColumnAutoResized:this._onColumnAutoResized,groupNestingDepth:G,isAllCollapsed:O,onToggleCollapseAll:this._onToggleCollapse,ariaLabel:o,ariaLabelForSelectAllCheckbox:l,ariaLabelForSelectionColumn:c,selectAllVisibility:W},this._onRenderDetailsHeader)),r.createElement("div",{onKeyDown:this._onContentKeyDown,role:"presentation"},r.createElement(u.FocusZone,{ref:this._resolveRef("_focusZone"),className:v.focusZone,direction:u.FocusZoneDirection.vertical,isInnerZoneKeystroke:g,onActiveElementChanged:this._onActiveRowChanged},r.createElement(d.SelectionZone,{ref:this._resolveRef("_selectionZone"),selection:q,selectionPreservedOnEmptyClick:P,selectionMode:k,onItemInvoked:w,onItemContextMenu:C},_?r.createElement(p.GroupedList,{ref:this._resolveRef("_groupedList"),groups:_,groupProps:S,items:x,onRenderCell:this._onRenderCell,selection:q,selectionMode:k,dragDropEvents:y,dragDropHelper:z,eventsToRegister:F,listProps:j,onGroupExpandStateChanged:this._onGroupExpandStateChanged}):r.createElement(m.List,i.__assign({ref:this._resolveRef("_list"),role:"presentation",items:x,onRenderCell:function(t,i){return e._onRenderCell(0,t,i)}},j)))))));var J};t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this);this._forceListUpdates()};t.prototype._onRenderRow=function(e,t){return r.createElement(l.DetailsRow,i.__assign({},e))};t.prototype._onRenderDetailsHeader=function(e,t){return r.createElement(a.DetailsHeader,i.__assign({},e))};t.prototype._onRenderCell=function(e,t,i){var r=this.props,o=r.dragDropEvents,n=r.rowElementEventMap,s=r.onRenderMissingItem,a=r.onRenderItemColumn,l=r.onRenderRow,u=void 0===l?this._onRenderRow:l,d=r.selectionMode,c=r.viewport,p=r.checkboxVisibility,m=r.getRowAriaLabel,f=r.checkButtonAriaLabel,h=this._selection,g=this._dragDropHelper,v=this.state.adjustedColumns;if(!t){s&&s(i);return null}return u({item:t,itemIndex:i,columns:v,groupNestingDepth:e,selectionMode:d,selection:h,onDidMount:this._onRowDidMount,onWillUnmount:this._onRowWillUnmount,onRenderItemColumn:a,eventsToRegister:n,dragDropEvents:o,dragDropHelper:g,viewport:c,checkboxVisibility:p,getRowAriaLabel:m,checkButtonAriaLabel:f},this._onRenderRow)};t.prototype._onGroupExpandStateChanged=function(e){this.setState({isSomeGroupExpanded:e})};t.prototype._onColumnIsSizingChanged=function(e,t){this.setState({isSizing:t})};t.prototype._onHeaderKeyDown=function(e){if(e.which===n.KeyCodes.down&&this._focusZone&&this._focusZone.focus()){e.preventDefault();e.stopPropagation()}};t.prototype._onContentKeyDown=function(e){if(e.which===n.KeyCodes.up&&this._header&&this._header.focus()){e.preventDefault();e.stopPropagation()}};t.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.props.groups;t&&t.length>0;){e++;t=t[0].children}return e};t.prototype._onRowDidMount=function(e){var t=this.props.onRowDidMount,i=e.props.itemIndex;this._activeRows[i]=e;this._setFocusToRowIfPending(e);t&&t(e.props.item,i)};t.prototype._setFocusToRowIfPending=function(e){var t=e.props.itemIndex;if(void 0!==this._initialFocusedIndex&&t===this._initialFocusedIndex){this._selectionZone&&this._selectionZone.ignoreNextFocus();this._async.setTimeout(function(){e.focus()},0);delete this._initialFocusedIndex}};t.prototype._onRowWillUnmount=function(e){var t=this.props.onRowWillUnmount,i=e.props.itemIndex;delete this._activeRows[i];this._events.off(e.refs.root);t&&t(e.props.item,i)};t.prototype._onToggleCollapse=function(e){this.setState({isCollapsed:e});this._groupedList&&this._groupedList.toggleCollapseAll(e)};t.prototype._forceListUpdates=function(){this._groupedList&&this._groupedList.forceUpdate();this._list&&this._list.forceUpdate()};t.prototype._adjustColumns=function(e,t,i){var r=this._getAdjustedColumns(e,t,i),o=this.props.viewport.width;r&&this.setState({adjustedColumns:r,lastWidth:o,layoutMode:i})};t.prototype._getAdjustedColumns=function(e,t,i){var r=this,o=e.columns,n=e.items,a=e.viewport.width,l=e.selectionMode;void 0===i&&(i=e.layoutMode);var u=this.props?this.props.columns:[],d=this.state?this.state.lastWidth:-1,c=this.state?this.state.lastSelectionMode:void 0;if(void 0!==a){if(!(t||d!==a||c!==l||u&&o!==u))return}else a=this.props.viewport.width;o=o||h(n,!0);var p;(p=i===s.DetailsListLayoutMode.fixedColumns?this._getFixedColumns(o):this._getJustifiedColumns(o,a,e)).forEach(function(e){(r._columnOverrides[e.key]=r._columnOverrides[e.key]||{}).calculatedWidth=e.calculatedWidth});return p};t.prototype._getFixedColumns=function(e){var t=this;return e.map(function(e){var i=n.assign({},e,t._columnOverrides[e.key]);i.calculatedWidth||(i.calculatedWidth=i.maxWidth||i.minWidth||b);return i})};t.prototype._getJustifiedColumns=function(e,t,i){for(var r=i.selectionMode,o=i.checkboxVisibility,a=i.groups,l=0,u=t-(16+(r!==d.SelectionMode.none&&o!==s.CheckboxVisibility.hidden?36:0)+(a?36:0)),c=e.map(function(e,t){var i=n.assign({},e,{calculatedWidth:e.minWidth||b});l+=i.calculatedWidth+(t>0?16:0);return i}),p=c.length-1;p>1&&l>u;){if((f=c[p]).isCollapsable){l-=f.calculatedWidth+16;c.splice(p,1)}p--}for(var m=0;m<c.length&&l<u;m++){var f=c[m],h=f.maxWidth,g=f.minWidth||h||b,v=u-l,y=h?Math.min(v,h-g):v;m===c.length-1&&(y=v);f.calculatedWidth+=y;l+=y}c.length&&(c[c.length-1].isResizable=!1);return c};t.prototype._onColumnResized=function(e,t){var i=Math.max(e.minWidth||b,t);this.props.onColumnResize&&this.props.onColumnResize(e,i);this._columnOverrides[e.key].calculatedWidth=i;this._adjustColumns(this.props,!0,s.DetailsListLayoutMode.fixedColumns);this._forceListUpdates()};t.prototype._onColumnAutoResized=function(e,t){var i=this,r=0,o=0,n=Object.keys(this._activeRows).length;for(var s in this._activeRows)this._activeRows.hasOwnProperty(s)&&this._activeRows[s].measureCell(t,function(t){r=Math.max(r,t);++o===n&&i._onColumnResized(e,r)})};t.prototype._onActiveRowChanged=function(e,t){var i=this.props,r=i.items,o=i.onActiveItemChanged;if(o&&e){var n=Number(e.getAttribute("data-item-index"));n>=0&&o(r[n],n,t)}};return t}(n.BaseComponent);y.defaultProps={layoutMode:s.DetailsListLayoutMode.justified,selectionMode:d.SelectionMode.multiple,constrainMode:s.ConstrainMode.horizontalConstrained,checkboxVisibility:s.CheckboxVisibility.onHover,isHeaderVisible:!0};i.__decorate([n.autobind],y.prototype,"_onRenderRow",null);i.__decorate([n.autobind],y.prototype,"_onRenderDetailsHeader",null);y=i.__decorate([f.withViewport],y);t.DetailsList=y;t.buildColumns=h});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_6f9421f2",focusZone:"focusZone_6f9421f2",rootIsHorizontalConstrained:"rootIsHorizontalConstrained_6f9421f2"};i.loadStyles([{rawString:".root_6f9421f2{position:relative;font-size:12px;background:0 0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.focusZone_6f9421f2{display:inline-block;vertical-align:top;min-width:100%;min-height:1px}.rootIsHorizontalConstrained_6f9421f2{overflow-x:auto;overflow-y:visible;-webkit-overflow-scrolling:touch}.root_6f9421f2 .ms-List-cell{min-height:38px;word-break:break-word}"}]);return o});define("office-ui-fabric-react/lib/components/DetailsList/DetailsList.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.disabled=0]="disabled";e[e.clickable=1]="clickable";e[e.hasDropdown=2]="hasDropdown"}(t.ColumnActionsMode||(t.ColumnActionsMode={}));!function(e){e[e.unconstrained=0]="unconstrained";e[e.horizontalConstrained=1]="horizontalConstrained"}(t.ConstrainMode||(t.ConstrainMode={}));!function(e){e[e.fixedColumns=0]="fixedColumns";e[e.justified=1]="justified"}(t.DetailsListLayoutMode||(t.DetailsListLayoutMode={}));!function(e){e[e.onHover=0]="onHover";e[e.always=1]="always";e[e.hidden=2]="hidden"}(t.CheckboxVisibility||(t.CheckboxVisibility={}))});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader",["require","exports","tslib","react","react-dom","../../Utilities","./DetailsList.Props","../../FocusZone","../../Icon","../../Layer","../GroupedList/GroupSpacer","./DetailsRowCheck","./DetailsRowCheck.scss","../../utilities/selection/interfaces","./DetailsHeader.scss"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f){"use strict";function h(e){e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var g,v=f;!function(e){e[e.none=0]="none";e[e.hidden=1]="hidden";e[e.visible=2]="visible"}(g=t.SelectAllVisibility||(t.SelectAllVisibility={}));var b=function(e){function t(t){var i=e.call(this,t)||this;i.state={columnResizeDetails:null,groupNestingDepth:i.props.groupNestingDepth,isAllCollapsed:i.props.isAllCollapsed};i._onToggleCollapseAll=i._onToggleCollapseAll.bind(i);i._onSelectAllClicked=i._onSelectAllClicked.bind(i);i._id=n.getId("header");return i}i.__extends(t,e);t.prototype.componentDidMount=function(){var e=this.props.selection;this._events.on(e,m.SELECTION_CHANGE,this._onSelectionChanged);var t=o.findDOMNode(this.refs.root);this._events.on(t,"mousedown",this._onRootMouseDown);this._events.on(t,"keydown",this._onRootKeyDown)};t.prototype.componentWillReceiveProps=function(e){var t=this.state.groupNestingDepth;e.groupNestingDepth!==t&&this.setState({groupNestingDepth:e.groupNestingDepth})};t.prototype.render=function(){var e=this,t=this.props,i=t.columns,o=t.ariaLabel,m=t.ariaLabelForSelectAllCheckbox,f=t.selectAllVisibility,h=t.ariaLabelForSelectionColumn,b=this.state,y=b.isAllSelected,_=b.columnResizeDetails,S=b.isSizing,x=b.groupNestingDepth,I=b.isAllCollapsed,w=f!==g.none,C=this.props.onRenderColumnHeaderTooltip,T=void 0===C?this._onRenderColumnHeaderTooltip:C;return r.createElement(a.FocusZone,{role:"row","aria-label":o,className:n.css("ms-DetailsHeader",v.root,(D={},D["is-allSelected "+v.rootIsAllSelected]=y,D["is-selectAllHidden "+v.rootIsSelectAllHidden]=f===g.hidden,D["is-resizingColumn"]=!!_&&S,D)),ref:"root",onMouseMove:this._onRootMouseMove,"data-automationid":"DetailsHeader",direction:a.FocusZoneDirection.horizontal},w?r.createElement("div",{className:n.css("ms-DetailsHeader-cell","ms-DetailsHeader-cellIsCheck",v.cell,v.cellIsCheck,p.owner,(k={},k[p.isSelected]=y,k)),onClick:this._onSelectAllClicked,"aria-colindex":0,role:"columnheader"},r.createElement("span",{"aria-label":h}),T({hostClassName:n.css(v.checkTooltip),id:this._id+"-checkTooltip",setAriaDescribedBy:!1,content:m,children:r.createElement(c.DetailsRowCheck,{"aria-describedby":this._id+"-checkTooltip",selected:y,anySelected:!1,canSelect:!0})},this._onRenderColumnHeaderTooltip)):null,x>0?r.createElement("div",{className:n.css("ms-DetailsHeader-cell",v.cell),onClick:this._onToggleCollapseAll},r.createElement(l.Icon,{className:n.css("ms-DetailsHeader-collapseButton",v.collapseButton,I&&"is-collapsed "+v.collapseButtonIsCollapsed),iconName:"ChevronDown"})):null,d.GroupSpacer({count:x-1}),i.map(function(t,o){i[o-1];return[r.createElement("div",{key:t.key,role:"columnheader","aria-sort":t.isSorted?t.isSortedDescending?"descending":"ascending":"none","aria-disabled":t.columnActionsMode===s.ColumnActionsMode.disabled,"aria-colindex":(w?1:0)+o,className:n.css("ms-DetailsHeader-cell",v.cell,t.headerClassName,(a={},a["is-actionable "+v.cellIsActionable]=t.columnActionsMode!==s.ColumnActionsMode.disabled,a["is-empty "+v.cellIsEmpty]=!t.name,a["is-icon-visible"]=t.isSorted||t.isGrouped||t.isFiltered,a)),style:{width:t.calculatedWidth+16},"aria-haspopup":t.columnActionsMode===s.ColumnActionsMode.hasDropdown,"data-automationid":"ColumnsHeaderColumn","data-item-key":t.key},T({hostClassName:n.css(v.cellTooltip),id:e._id+"-"+t.key+"-tooltip",setAriaDescribedBy:!1,content:t.columnActionsMode!==s.ColumnActionsMode.disabled?t.ariaLabel:"",children:r.createElement("span",{className:n.css("ms-DetailsHeader-cellTitle",v.cellTitle),"data-is-focusable":t.columnActionsMode!==s.ColumnActionsMode.disabled,role:t.columnActionsMode!==s.ColumnActionsMode.disabled?"button":void 0,"aria-describedby":e._id+"-"+t.key+"-tooltip",onContextMenu:e._onColumnContextMenu.bind(e,t),onClick:e._onColumnClick.bind(e,t)},t.isFiltered&&r.createElement(l.Icon,{className:v.nearIcon,iconName:"Filter"}),t.isSorted&&r.createElement(l.Icon,{className:v.nearIcon,iconName:t.isSortedDescending?"SortDown":"SortUp"}),t.isGrouped&&r.createElement(l.Icon,{className:v.nearIcon,iconName:"GroupedDescending"}),r.createElement("span",{"aria-label":t.isIconOnly?t.name:void 0,className:n.css("ms-DetailsHeader-cellName",v.cellName)},(t.iconName||t.iconClassName)&&r.createElement(l.Icon,{className:n.css(v.nearIcon,t.iconClassName),iconName:t.iconName}),t.isIconOnly?void 0:t.name),t.columnActionsMode===s.ColumnActionsMode.hasDropdown&&!t.isIconOnly&&r.createElement(l.Icon,{className:n.css("ms-DetailsHeader-filterChevron",v.filterChevron),iconName:"ChevronDown"}))},e._onRenderColumnHeaderTooltip)),t.isResizable&&e._renderColumnSizer(o)];var a}),S&&r.createElement(u.Layer,null,r.createElement("div",{className:n.css(S&&v.sizingOverlay),onMouseMove:this._onSizerMouseMove,onMouseUp:this._onSizerMouseUp})));var D,k};t.prototype.focus=function(){return this.refs.root.focus()};t.prototype._renderColumnSizer=function(e){var t=this.props.columns,i=(this.props.columns[e],this.state),o=(i.isSizing,i.columnResizeDetails);return r.createElement("div",{"aria-hidden":!0,role:"button","data-is-focusable":!1,onClick:h,"data-sizer-index":e,onBlur:this._onSizerBlur,className:n.css("ms-DetailsHeader-cellSizer",v.cellSizer,e<t.length-1?v.cellSizerStart:v.cellSizerEnd,(s={},s["is-resizing "+v.cellIsResizing]=o&&o.columnIndex===e,s)),onDoubleClick:this._onSizerDoubleClick.bind(this,e)});var s};t.prototype._onRenderColumnHeaderTooltip=function(e,t){return r.createElement("span",{className:e.hostClassName},e.children)};t.prototype._onSizerDoubleClick=function(e,t){var i=this.props,r=i.onColumnAutoResized,o=i.columns;r&&r(o[e],e)};t.prototype._onSelectAllClicked=function(){this.props.selection.toggleAllSelected()};t.prototype._onRootMouseDown=function(e){var t=e.target.getAttribute("data-sizer-index"),i=Number(t),r=this.props.columns;if(null!==t&&0===e.button){this.setState({columnResizeDetails:{columnIndex:i,columnMinWidth:r[i].calculatedWidth,originX:e.clientX}});e.preventDefault();e.stopPropagation()}};t.prototype._onRootMouseMove=function(e){var t=this.state,i=t.columnResizeDetails,r=t.isSizing;i&&!r&&e.clientX!==i.originX&&this.setState({isSizing:!0})};t.prototype._onRootKeyDown=function(e){var t=this.state,r=t.columnResizeDetails,o=t.isSizing,s=this.props,a=s.columns,l=s.onColumnResized,u=e.target.getAttribute("data-sizer-index");if(u&&!o){var d=Number(u);if(r){var c=void 0;if(e.which===n.KeyCodes.enter){this.setState({columnResizeDetails:null});e.preventDefault();e.stopPropagation()}else e.which===n.KeyCodes.left?c=n.getRTL()?1:-1:e.which===n.KeyCodes.right&&(c=n.getRTL()?-1:1);if(c){e.shiftKey||(c*=10);this.setState({columnResizeDetails:i.__assign({},r,{columnMinWidth:r.columnMinWidth+c})});l&&l(a[d],r.columnMinWidth+c);e.preventDefault();e.stopPropagation()}}else if(e.which===n.KeyCodes.enter){this.setState({columnResizeDetails:{columnIndex:d,columnMinWidth:a[d].calculatedWidth}});e.preventDefault();e.stopPropagation()}}};t.prototype._onSizerMouseMove=function(e){var t=e.buttons,i=this.props,r=i.onColumnIsSizingChanged,o=i.onColumnResized,s=i.columns,a=this.state.columnResizeDetails;if(void 0===t||1===t){e.clientX!==a.originX&&r&&r(s[a.columnIndex],!0);if(o){var l=e.clientX-a.originX;n.getRTL()&&(l=-l);o(s[a.columnIndex],a.columnMinWidth+l)}}else this._onSizerMouseUp(e)};t.prototype._onSizerBlur=function(e){this.state.columnResizeDetails&&this.setState({columnResizeDetails:null,isSizing:!1})};t.prototype._onSizerMouseUp=function(e){var t=this.props,i=t.columns,r=t.onColumnIsSizingChanged,o=this.state.columnResizeDetails;this.setState({columnResizeDetails:null,isSizing:!1});r&&r(i[o.columnIndex],!1)};t.prototype._onSelectionChanged=function(){var e=this.props.selection.isAllSelected();this.state.isAllSelected!==e&&this.setState({isAllSelected:e})};t.prototype._onColumnClick=function(e,t){var i=this.props.onColumnClick;e.onColumnClick&&e.onColumnClick(t,e);i&&i(t,e)};t.prototype._onColumnContextMenu=function(e,t){var i=this.props.onColumnContextMenu;if(e.onColumnContextMenu){e.onColumnContextMenu(e,t);t.preventDefault()}if(i){i(e,t);t.preventDefault()}};t.prototype._onToggleCollapseAll=function(){var e=this.props.onToggleCollapseAll,t=!this.state.isAllCollapsed;this.setState({isAllCollapsed:t});e&&e(t)};return t}(n.BaseComponent);b.defaultProps={isSelectAllVisible:g.visible};i.__decorate([n.autobind],b.prototype,"_onRenderColumnHeaderTooltip",null);i.__decorate([n.autobind],b.prototype,"_onSelectAllClicked",null);i.__decorate([n.autobind],b.prototype,"_onRootMouseDown",null);i.__decorate([n.autobind],b.prototype,"_onRootMouseMove",null);i.__decorate([n.autobind],b.prototype,"_onRootKeyDown",null);i.__decorate([n.autobind],b.prototype,"_onSizerMouseMove",null);i.__decorate([n.autobind],b.prototype,"_onSizerBlur",null);i.__decorate([n.autobind],b.prototype,"_onSizerMouseUp",null);t.DetailsHeader=b});define("office-ui-fabric-react/lib/FocusZone",["require","exports","./components/FocusZone/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/FocusZone/index",["require","exports","./FocusZone","./FocusZone.Props"],function(e,t,i,r){"use strict";function o(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});o(i);o(r)});define("office-ui-fabric-react/lib/components/FocusZone/FocusZone",["require","exports","tslib","react","./FocusZone.Props","../../Utilities"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={},a=["text","number","password","email","tel","url","search"],l=function(e){function t(t){var i=e.call(this,t)||this;i._warnDeprecations({rootProps:null});i._id=n.getId("FocusZone");s[i._id]=i;i._focusAlignment={left:0,top:0};return i}i.__extends(t,e);t.prototype.componentDidMount=function(){for(var e=this.refs.root.ownerDocument.defaultView,t=n.getParent(this.refs.root);t&&t!==document.body&&1===t.nodeType;){if(n.isElementFocusZone(t)){this._isInnerZone=!0;break}t=n.getParent(t)}this._isInnerZone||this._events.on(e,"keydown",this._onKeyDownCapture,!0);this._updateTabIndexes();if(this.props.defaultActiveElement){this._activeElement=n.getDocument().querySelector(this.props.defaultActiveElement);this.focus()}};t.prototype.componentWillUnmount=function(){delete s[this._id]};t.prototype.render=function(){var e=this.props,t=e.rootProps,o=e.ariaDescribedBy,s=e.ariaLabelledBy,a=e.className,l=n.getNativeProps(this.props,n.divProperties);return r.createElement("div",i.__assign({role:"presentation"},l,t,{className:n.css("ms-FocusZone",a),ref:"root","data-focuszone-id":this._id,"aria-labelledby":s,"aria-describedby":o,onKeyDown:this._onKeyDown,onFocus:this._onFocus},{onMouseDownCapture:this._onMouseDown}),this.props.children)};t.prototype.focus=function(e){void 0===e&&(e=!1);if(!e&&"true"===this.refs.root.getAttribute("data-is-focusable")&&this._isInnerZone)return!0;if(this._activeElement&&n.elementContains(this.refs.root,this._activeElement)&&n.isElementTabbable(this._activeElement)){this._activeElement.focus();return!0}var t=this.refs.root.firstChild;return this.focusElement(n.getNextElement(this.refs.root,t,!0))};t.prototype.focusElement=function(e){var t=this.props.onBeforeFocus;if(t&&!t(e))return!1;if(e){var i=this._activeElement;this._activeElement=e;if(i){n.isElementFocusZone(i)&&this._updateTabIndexes(i);i.tabIndex=-1}if(e){this._focusAlignment||this._setFocusAlignment(e,!0,!0);this._activeElement.tabIndex=0;e.focus();return!0}}return!1};t.prototype._onFocus=function(e){var t=this.props.onActiveElementChanged;if(this._isImmediateDescendantOfZone(e.target)){this._activeElement=e.target;this._setFocusAlignment(this._activeElement)}else for(var i=e.target;i&&i!==this.refs.root;){if(n.isElementTabbable(i)&&this._isImmediateDescendantOfZone(i)){this._activeElement=i;break}i=n.getParent(i)}t&&t(this._activeElement,e)};t.prototype._onKeyDownCapture=function(e){e.which===n.KeyCodes.tab&&this._updateTabIndexes()};t.prototype._onMouseDown=function(e){if(!this.props.disabled){for(var t=e.target,i=[];t&&t!==this.refs.root;){i.push(t);t=n.getParent(t)}for(;i.length;){if((t=i.pop())&&n.isElementTabbable(t)){t.tabIndex=0;this._setFocusAlignment(t,!0,!0)}if(n.isElementFocusZone(t))break}}};t.prototype._onKeyDown=function(e){var t=this.props,i=t.direction,r=t.disabled,s=t.isInnerZoneKeystroke;if(!(r||document.activeElement===this.refs.root&&this._isInnerZone)){if(this.props.onKeyDown){this.props.onKeyDown(e);if(e.isDefaultPrevented())return}if(s&&s(e)&&this._isImmediateDescendantOfZone(e.target)){var a=this._getFirstInnerZone();if(a){if(!a.focus(!0))return}else{if(!n.isElementFocusSubZone(e.target))return;if(!this.focusElement(n.getNextElement(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case n.KeyCodes.space:if(this._tryInvokeClickForFocusable(e.target))break;return;case n.KeyCodes.left:if(i!==o.FocusZoneDirection.vertical&&this._moveFocusLeft())break;return;case n.KeyCodes.right:if(i!==o.FocusZoneDirection.vertical&&this._moveFocusRight())break;return;case n.KeyCodes.up:if(i!==o.FocusZoneDirection.horizontal&&this._moveFocusUp())break;return;case n.KeyCodes.down:if(i!==o.FocusZoneDirection.horizontal&&this._moveFocusDown())break;return;case n.KeyCodes.home:var l=this.refs.root.firstChild;if(this.focusElement(n.getNextElement(this.refs.root,l,!0)))break;return;case n.KeyCodes.end:var u=this.refs.root.lastChild;if(this.focusElement(n.getPreviousElement(this.refs.root,u,!0,!0,!0)))break;return;case n.KeyCodes.enter:if(this._tryInvokeClickForFocusable(e.target))break;return;default:return}}e.preventDefault();e.stopPropagation()}};t.prototype._tryInvokeClickForFocusable=function(e){if(e===this.refs.root)return!1;do{if("BUTTON"===e.tagName||"A"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName)return!1;if(this._isImmediateDescendantOfZone(e)&&"true"===e.getAttribute("data-is-focusable")&&"true"!==e.getAttribute("data-disable-click-on-enter")){n.EventGroup.raise(e,"click",null,!0);return!0}e=n.getParent(e)}while(e!==this.refs.root);return!1};t.prototype._getFirstInnerZone=function(e){e=e||this._activeElement||this.refs.root;if(n.isElementFocusZone(e))return s[e.getAttribute("data-focuszone-id")];for(var t=e.firstElementChild;t;){if(n.isElementFocusZone(t))return s[t.getAttribute("data-focuszone-id")];var i=this._getFirstInnerZone(t);if(i)return i;t=t.nextElementSibling}return null};t.prototype._moveFocus=function(e,t,i){var r,s=this._activeElement,a=-1,l=!1,u=this.props.direction===o.FocusZoneDirection.bidirectional;if(!s)return!1;if(this._isElementInput(s)&&!this._shouldInputLoseFocus(s,e))return!1;var d=u?s.getBoundingClientRect():null;do{s=e?n.getNextElement(this.refs.root,s):n.getPreviousElement(this.refs.root,s);if(!u){r=s;break}if(s){var c=t(d,s.getBoundingClientRect());if(-1===c&&-1===a){r=s;break}if(c>-1&&(-1===a||c<a)){a=c;r=s}if(a>=0&&c<0)break}}while(s);if(r&&r!==this._activeElement){l=!0;this.focusElement(r)}else if(this.props.isCircularNavigation)return e?this.focusElement(n.getNextElement(this.refs.root,this.refs.root.firstElementChild,!0)):this.focusElement(n.getPreviousElement(this.refs.root,this.refs.root.lastElementChild,!0,!0,!0));return l};t.prototype._moveFocusDown=function(){var e=-1,t=this._focusAlignment.left;if(this._moveFocus(!0,function(i,r){var o=-1,n=Math.floor(r.top),s=Math.floor(i.bottom);if(n<s)return 999999999;if(-1===e&&n>=s||n===e){e=n;o=t>=r.left&&t<=r.left+r.width?0:Math.abs(r.left+r.width/2-t)}return o})){this._setFocusAlignment(this._activeElement,!1,!0);return!0}return!1};t.prototype._moveFocusUp=function(){var e=-1,t=this._focusAlignment.left;if(this._moveFocus(!1,function(i,r){var o=-1,n=Math.floor(r.bottom),s=Math.floor(r.top),a=Math.floor(i.top);if(n>a)return 999999999;if(-1===e&&n<=a||s===e){e=s;o=t>=r.left&&t<=r.left+r.width?0:Math.abs(r.left+r.width/2-t)}return o})){this._setFocusAlignment(this._activeElement,!1,!0);return!0}return!1};t.prototype._moveFocusLeft=function(){var e=this;this._focusAlignment.top;if(this._moveFocus(n.getRTL(),function(t,i){var r=-1;i.bottom>t.top&&i.right<=t.right&&e.props.direction!==o.FocusZoneDirection.vertical&&(r=t.right-i.right);return r})){this._setFocusAlignment(this._activeElement,!0,!1);return!0}return!1};t.prototype._moveFocusRight=function(){var e=this;this._focusAlignment.top;if(this._moveFocus(!n.getRTL(),function(t,i){var r=-1;i.top<t.bottom&&i.left>=t.left&&e.props.direction!==o.FocusZoneDirection.vertical&&(r=i.left-t.left);return r})){this._setFocusAlignment(this._activeElement,!0,!1);return!0}return!1};t.prototype._setFocusAlignment=function(e,t,i){if(this.props.direction===o.FocusZoneDirection.bidirectional&&(!this._focusAlignment||t||i)){var r=e.getBoundingClientRect(),n=r.left+r.width/2,s=r.top+r.height/2;this._focusAlignment||(this._focusAlignment={left:n,top:s});t&&(this._focusAlignment.left=n);i&&(this._focusAlignment.top=s)}};t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this.refs.root};t.prototype._getOwnerZone=function(e){for(var t=n.getParent(e);t&&t!==this.refs.root&&t!==document.body;){if(n.isElementFocusZone(t))return t;t=n.getParent(t)}return this.refs.root};t.prototype._updateTabIndexes=function(e){if(!e){e=this.refs.root;this._activeElement&&!n.elementContains(e,this._activeElement)&&(this._activeElement=null)}this._activeElement&&!n.isElementTabbable(this._activeElement)&&(this._activeElement=null);for(var t=e.children,i=0;t&&i<t.length;i++){var r=t[i];if(n.isElementFocusZone(r)){if("true"===r.getAttribute("data-is-focusable"))if(this._isInnerZone||this._activeElement&&this._activeElement!==r)"-1"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","-1");else{this._activeElement=r;"0"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","0")}}else{r.getAttribute&&"false"===r.getAttribute("data-is-focusable")&&r.setAttribute("tabindex","-1");if(n.isElementTabbable(r))if(this.props.disabled)r.setAttribute("tabindex","-1");else if(this._isInnerZone||this._activeElement&&this._activeElement!==r)"-1"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","-1");else{this._activeElement=r;"0"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","0")}else"svg"===r.tagName&&"false"!==r.getAttribute("focusable")&&r.setAttribute("focusable","false")}this._updateTabIndexes(r)}};t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())};t.prototype._shouldInputLoseFocus=function(e,t){if(e&&e.type&&a.indexOf(e.type.toLowerCase())>-1){var i=e.selectionStart,r=i!==e.selectionEnd,o=e.value;if(r||i>0&&!t||i!==o.length&&t)return!1}return!0};return t}(n.BaseComponent);l.defaultProps={isCircularNavigation:!1,direction:o.FocusZoneDirection.bidirectional};i.__decorate([n.autobind],l.prototype,"_onFocus",null);i.__decorate([n.autobind],l.prototype,"_onMouseDown",null);i.__decorate([n.autobind],l.prototype,"_onKeyDown",null);t.FocusZone=l});define("office-ui-fabric-react/lib/components/FocusZone/FocusZone.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.vertical=0]="vertical";e[e.horizontal=1]="horizontal";e[e.bidirectional=2]="bidirectional"}(t.FocusZoneDirection||(t.FocusZoneDirection={}))});define("office-ui-fabric-react/lib/Icon",["require","exports","./components/Icon/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Icon/index",["require","exports","./Icon","./Icon.Props"],function(e,t,i,r){"use strict";function o(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});o(i);o(r)});define("office-ui-fabric-react/lib/components/Icon/Icon",["require","exports","tslib","react","./Icon.Props","../Image/Image","../../Utilities","../../Styling","./Icon.styles"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Icon=function(e){var t=e.ariaLabel,u=e.className,d=e.styles,c=e.iconName,p=l.getStyles(void 0,d);if(e.iconType===o.IconType.image||e.iconType===o.IconType.Image){var m=s.css("ms-Icon","ms-Icon-imageContainer",p.root,p.imageContainer,u);return r.createElement("div",{className:s.css(m,p.root)},r.createElement(n.Image,i.__assign({},e.imageProps)))}var f=c?c.charAt(0).toLowerCase()+c.substr(1):"";return r.createElement("i",i.__assign({"aria-label":t},t?{}:{role:"presentation","aria-hidden":!0,"data-icon-name":c},s.getNativeProps(e,s.htmlElementProperties),{className:s.css("ms-Icon",p.root,e.className)}),a.IconCodes[f])}});define("office-ui-fabric-react/lib/components/Icon/Icon.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.default=0]="default";e[e.image=1]="image";e[e.Default=1e5]="Default";e[e.Image=100001]="Image"}(t.IconType||(t.IconType={}))});define("office-ui-fabric-react/lib/components/Image/Image",["require","exports","tslib","react","../../Utilities","./Image.Props","../../Styling","./Image.scss"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a;t.CoverStyleMap=(d={},d[n.ImageCoverStyle.landscape]="ms-Image-image--landscape "+l.imageIsLandscape,d[n.ImageCoverStyle.portrait]="ms-Image-image--portrait "+l.imageIsPortrait,d);t.ImageFitMap=(c={},c[n.ImageFit.center]="ms-Image-image--center "+l.imageIsCenter,c[n.ImageFit.contain]="ms-Image-image--contain "+l.imageIsContain,c[n.ImageFit.cover]="ms-Image-image--cover "+l.imageIsCover,c[n.ImageFit.none]="ms-Image-image--none "+l.imageIsNone,c);var u=function(e){function a(t){var i=e.call(this,t)||this;i._coverStyle=n.ImageCoverStyle.portrait;i.state={loadState:n.ImageLoadState.notLoaded};return i}i.__extends(a,e);a.prototype.componentWillReceiveProps=function(e){e.src!==this.props.src?this.setState({loadState:n.ImageLoadState.notLoaded}):this.state.loadState===n.ImageLoadState.loaded&&this._computeCoverStyle(e)};a.prototype.componentDidUpdate=function(e,t){this._checkImageLoaded();this.props.onLoadingStateChange&&t.loadState!==this.state.loadState&&this.props.onLoadingStateChange(this.state.loadState)};a.prototype.render=function(){var e=o.getNativeProps(this.props,o.imageProperties,["width","height"]),a=this.props,u=a.src,d=a.alt,c=a.width,p=a.height,m=a.shouldFadeIn,f=a.className,h=a.imageFit,g=a.role,v=a.maximizeFrame,b=this.state.loadState,y=void 0!==this.props.coverStyle?this.props.coverStyle:this._coverStyle,_=b===n.ImageLoadState.loaded||b===n.ImageLoadState.notLoaded&&this.props.shouldStartVisible;return r.createElement("div",{className:o.css("ms-Image",l.root,f,(S={},S["ms-Image--maximizeFrame "+l.rootIsMaximizeFrame]=v,S)),style:{width:c,height:p},ref:this._resolveRef("_frameElement")},r.createElement("img",i.__assign({},e,{onLoad:this._onImageLoaded,onError:this._onImageError,key:"fabricImage"+this.props.src||"",className:o.css("ms-Image-image",l.image,t.CoverStyleMap[y],void 0!==h&&t.ImageFitMap[h],!_&&"is-notLoaded",_&&"is-loaded "+l.imageIsLoaded,m&&"is-fadeIn",b===n.ImageLoadState.error&&"is-error",_&&m&&s.AnimationClassNames.fadeIn400,(x={},x["ms-Image-image--scaleWidth "+l.imageIsScaleWidth]=void 0===h&&!!c&&!p,x["ms-Image-image--scaleHeight "+l.imageIsScaleHeight]=void 0===h&&!c&&!!p,x["ms-Image-image--scaleWidthHeight "+l.imageIsScaleWidthHeight]=void 0===h&&!!c&&!!p,x)),ref:this._resolveRef("_imageElement"),src:u,alt:d,role:g})));var S,x};a.prototype._onImageLoaded=function(e){var t=this.props,i=t.src,r=t.onLoad;r&&r(e);this._computeCoverStyle(this.props);i&&this.setState({loadState:n.ImageLoadState.loaded})};a.prototype._checkImageLoaded=function(){var e=this.props.src;if(this.state.loadState===n.ImageLoadState.notLoaded&&(e&&this._imageElement&&this._imageElement.naturalWidth>0&&this._imageElement.naturalHeight>0||this._imageElement.complete&&a._svgRegex.test(e))){this._computeCoverStyle(this.props);this.setState({loadState:n.ImageLoadState.loaded})}};a.prototype._computeCoverStyle=function(e){var t=e.imageFit,i=e.width,r=e.height;if((t===n.ImageFit.cover||t===n.ImageFit.contain)&&void 0===this.props.coverStyle&&this._imageElement){var o=void 0;o=i&&r?i/r:this._frameElement.clientWidth/this._frameElement.clientHeight;var s=this._imageElement.naturalWidth/this._imageElement.naturalHeight;this._coverStyle=s>o?n.ImageCoverStyle.landscape:n.ImageCoverStyle.portrait}};a.prototype._onImageError=function(e){this.props.onError&&this.props.onError(e);this.setState({loadState:n.ImageLoadState.error})};return a}(o.BaseComponent);u.defaultProps={shouldFadeIn:!0};u._svgRegex=/\.svg$/i;i.__decorate([o.autobind],u.prototype,"_onImageLoaded",null);i.__decorate([o.autobind],u.prototype,"_onImageError",null);t.Image=u;var d,c});define("office-ui-fabric-react/lib/components/Image/Image.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.center=0]="center";e[e.contain=1]="contain";e[e.cover=2]="cover";e[e.none=3]="none"}(t.ImageFit||(t.ImageFit={}));!function(e){e[e.landscape=0]="landscape";e[e.portrait=1]="portrait"}(t.ImageCoverStyle||(t.ImageCoverStyle={}));!function(e){e[e.notLoaded=0]="notLoaded";e[e.loaded=1]="loaded";e[e.error=2]="error";e[e.errorLoaded=3]="errorLoaded"}(t.ImageLoadState||(t.ImageLoadState={}))});define("office-ui-fabric-react/lib/components/Image/Image.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_16f289ab",rootIsMaximizeFrame:"rootIsMaximizeFrame_16f289ab",image:"image_16f289ab",imageIsLoaded:"imageIsLoaded_16f289ab",imageIsCenter:"imageIsCenter_16f289ab",imageIsContain:"imageIsContain_16f289ab",imageIsCover:"imageIsCover_16f289ab",imageIsLandscape:"imageIsLandscape_16f289ab",imageIsPortrait:"imageIsPortrait_16f289ab",imageIsNone:"imageIsNone_16f289ab",imageIsScaleWidthHeight:"imageIsScaleWidthHeight_16f289ab",imageIsScaleWidth:"imageIsScaleWidth_16f289ab",imageIsScaleHeight:"imageIsScaleHeight_16f289ab"};i.loadStyles([{rawString:".root_16f289ab{overflow:hidden}.rootIsMaximizeFrame_16f289ab{height:100%;width:100%}.image_16f289ab{display:block;opacity:0}.image_16f289ab.imageIsLoaded_16f289ab{opacity:1}.imageIsCenter_16f289ab,.imageIsContain_16f289ab,.imageIsCover_16f289ab{position:relative;top:50%}[dir=ltr] .imageIsCenter_16f289ab,[dir=ltr] .imageIsContain_16f289ab,[dir=ltr] .imageIsCover_16f289ab{left:50%}[dir=rtl] .imageIsCenter_16f289ab,[dir=rtl] .imageIsContain_16f289ab,[dir=rtl] .imageIsCover_16f289ab{right:50%}html[dir=ltr] .imageIsCenter_16f289ab,html[dir=ltr] .imageIsContain_16f289ab,html[dir=ltr] .imageIsCover_16f289ab{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}html[dir=rtl] .imageIsCenter_16f289ab,html[dir=rtl] .imageIsContain_16f289ab,html[dir=rtl] .imageIsCover_16f289ab{-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.imageIsContain_16f289ab.imageIsLandscape_16f289ab{width:100%;height:auto}.imageIsContain_16f289ab.imageIsPortrait_16f289ab{height:100%;width:auto}.imageIsCover_16f289ab.imageIsLandscape_16f289ab{height:100%;width:auto}.imageIsCover_16f289ab.imageIsPortrait_16f289ab{width:100%;height:auto}.imageIsNone_16f289ab{height:auto;width:auto}.imageIsScaleWidthHeight_16f289ab{height:100%;width:100%}.imageIsScaleWidth_16f289ab{height:auto;width:100%}.imageIsScaleHeight_16f289ab{height:100%;width:auto}"}]);return o});define("office-ui-fabric-react/lib/components/Icon/Icon.styles",["require","exports","../../Styling","../../Utilities"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=r.memoizeFunction(function(e,t){void 0===e&&(e=i.getTheme());void 0===t&&(t=void 0);var r={root:i.mergeStyles([e.fonts.icon,{display:"inline-block"}]),imageContainer:i.mergeStyles({overflow:"hidden"})};return i.mergeStyleSets(r,t)})});define("office-ui-fabric-react/lib/Layer",["require","exports","./components/Layer/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Layer/index",["require","exports","./Layer","./LayerHost"],function(e,t,i,r){"use strict";function o(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});o(i);o(r)});define("office-ui-fabric-react/lib/components/Layer/Layer",["require","exports","tslib","react","react-dom","../../Fabric","../../Utilities","./Layer.scss"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a,u={},d=function(e){function t(t){var i=e.call(this,t)||this;i._warnDeprecations({onLayerMounted:"onLayerDidMount"});if(i.props.hostId){u[i.props.hostId]||(u[i.props.hostId]=[]);u[i.props.hostId].push(i)}return i}i.__extends(t,e);t.notifyHostChanged=function(e){u[e]&&u[e].forEach(function(e){return e.forceUpdate()})};t.prototype.componentDidMount=function(){this.componentDidUpdate()};t.prototype.componentWillUnmount=function(){var e=this;this._removeLayerElement();if(this.props.hostId){u[this.props.hostId]=u[this.props.hostId].filter(function(t){return t!==e});u[this.props.hostId].length||delete u[this.props.hostId]}};t.prototype.componentDidUpdate=function(){var e=this,t=this._getHost();t!==this._host&&this._removeLayerElement();if(t){this._host=t;if(!this._layerElement){var i=s.getDocument(this._rootElement);this._layerElement=i.createElement("div");this._layerElement.className=s.css("ms-Layer",(a={},a["ms-Layer--fixed "+l.rootIsFixed]=!this.props.hostId,a));t.appendChild(this._layerElement);s.setVirtualParent(this._layerElement,this._rootElement)}o.unstable_renderSubtreeIntoContainer(this,r.createElement(n.Fabric,{className:s.css("ms-Layer-content",l.content)},this.props.children),this._layerElement,function(){if(!e._hasMounted){e._hasMounted=!0;e.props.onLayerMounted&&e.props.onLayerMounted();e.props.onLayerDidMount()}})}var a};t.prototype.render=function(){return r.createElement("span",{className:"ms-Layer",ref:this._resolveRef("_rootElement")})};t.prototype._removeLayerElement=function(){if(this._layerElement){this.props.onLayerWillUnmount();o.unmountComponentAtNode(this._layerElement);var e=this._layerElement.parentNode;e&&e.removeChild(this._layerElement);this._layerElement=void 0;this._hasMounted=!1}};t.prototype._getHost=function(){var e=this.props.hostId,t=s.getDocument(this._rootElement);return e?t.getElementById(e):t.body};return t}(s.BaseComponent);d.defaultProps={onLayerDidMount:function(){},onLayerWillUnmount:function(){}};t.Layer=d});define("office-ui-fabric-react/lib/components/Layer/Layer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={rootIsFixed:"rootIsFixed_2c7c091b",content:"content_2c7c091b"};i.loadStyles([{rawString:".rootIsFixed_2c7c091b{position:fixed;z-index:1000000;top:0;left:0;width:100vw;height:100vh;visibility:hidden}.content_2c7c091b{visibility:visible}"}]);return o});define("office-ui-fabric-react/lib/components/Layer/LayerHost",["require","exports","tslib","react","../../Utilities","./Layer"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.shouldComponentUpdate=function(){return!1};t.prototype.componentDidMount=function(){n.Layer.notifyHostChanged(this.props.id)};t.prototype.componentWillUnmount=function(){n.Layer.notifyHostChanged(this.props.id)};t.prototype.render=function(){return r.createElement("div",i.__assign({},this.props,{className:o.css("ms-LayerHost",this.props.className)}))};return t}(o.BaseComponent);t.LayerHost=s});define("office-ui-fabric-react/lib/components/GroupedList/GroupSpacer",["require","exports","react","../../Utilities","./GroupSpacer.scss"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o;t.GroupSpacer=function(e){return e.count>0&&i.createElement("span",{className:r.css("ms-GroupSpacer",n.root),style:{width:36*e.count}})}});define("office-ui-fabric-react/lib/components/GroupedList/GroupSpacer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_fda176b4"};i.loadStyles([{rawString:".root_fda176b4{display:inline-block}"}]);return o});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowCheck",["require","exports","tslib","react","../../Utilities","../../Check","./DetailsRowCheck.scss"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsRowCheck=function(e){e.canSelect,e.isSelected,e.anySelected,e.selected;var t=i.__rest(e,["canSelect","isSelected","anySelected","selected"]),a=e.isSelected||e.selected;return r.createElement("button",i.__assign({},t,{role:"checkbox",className:o.css("ms-DetailsRow-check",s.check,(l={},l[s.isDisabled]=!e.canSelect,l["ms-DetailsRow-check--isDisabled"]=!e.canSelect,l)),"aria-checked":a,"data-selection-toggle":!0,"data-automationid":"DetailsRowCheck"}),r.createElement(n.Check,{checked:a}));var l}});define("office-ui-fabric-react/lib/Check",["require","exports","./components/Check/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Check/index",["require","exports","./Check"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Check/Check",["require","exports","tslib","react","../../Utilities","../../Icon","./Check.scss"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.shouldComponentUpdate=function(e){return this.props.isChecked!==e.isChecked||this.props.checked!==e.checked};t.prototype.render=function(){var e=this.props,t=e.isChecked,i=e.checked;t=t||i;return r.createElement("div",{className:o.css("ms-Check",a.root,t&&"is-checked "+a.rootIsChecked)},n.Icon({className:"ms-Check-circle "+a.circle,iconName:"CircleRing"}),n.Icon({className:"ms-Check-check "+a.check,iconName:"CheckMark"}))};return t}(o.BaseComponent);l.defaultProps={isChecked:!1};t.Check=l});define("office-ui-fabric-react/lib/components/Check/Check.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_a09f2866",rootIsChecked:"rootIsChecked_a09f2866",circle:"circle_a09f2866",check:"check_a09f2866"};i.loadStyles([{rawString:".root_a09f2866{line-height:1;width:22px;height:22px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:24px}.root_a09f2866.rootIsChecked_a09f2866{background:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.rootIsChecked_a09f2866,.root_a09f2866:focus,.root_a09f2866:hover{opacity:1}.check_a09f2866,.circle_a09f2866{position:absolute;height:24px;width:24px;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:24px}.circle_a09f2866{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.rootIsChecked_a09f2866 .circle_a09f2866{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_a09f2866{width:auto;height:auto;color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";font-size:12px}.rootIsChecked_a09f2866 .check_a09f2866{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:900}"}]);return o});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowCheck.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={check:"check_a43e4ac4",owner:"owner_a43e4ac4",isSelected:"isSelected_a43e4ac4",isVisible:"isVisible_a43e4ac4",isDisabled:"isDisabled_a43e4ac4"};i.loadStyles([{rawString:".check_a43e4ac4{display:inline-block;cursor:default;box-sizing:border-box;vertical-align:top;background:0 0;border:none;opacity:0}.check_a43e4ac4::-moz-focus-inner{border:0}.check_a43e4ac4{outline:transparent}.check_a43e4ac4{position:relative}.ms-Fabric.is-focusVisible .check_a43e4ac4:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.check_a43e4ac4:focus{opacity:1}button.check_a43e4ac4{padding:6px}.owner_a43e4ac4.isSelected_a43e4ac4 .check_a43e4ac4,.owner_a43e4ac4.isVisible_a43e4ac4 .check_a43e4ac4,.owner_a43e4ac4:focus .check_a43e4ac4,.owner_a43e4ac4:hover .check_a43e4ac4{opacity:1}.isDisabled_a43e4ac4{visibility:hidden}"}]);return o});define("office-ui-fabric-react/lib/components/DetailsList/DetailsHeader.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_4e1bb51a",rootIsSelectAllHidden:"rootIsSelectAllHidden_4e1bb51a",cell:"cell_4e1bb51a",cellIsCheck:"cellIsCheck_4e1bb51a",cellIsActionable:"cellIsActionable_4e1bb51a",cellIsEmpty:"cellIsEmpty_4e1bb51a",cellSizer:"cellSizer_4e1bb51a",cellIsResizing:"cellIsResizing_4e1bb51a",collapseButton:"collapseButton_4e1bb51a",collapseButtonIsCollapsed:"collapseButtonIsCollapsed_4e1bb51a",nearIcon:"nearIcon_4e1bb51a",filterChevron:"filterChevron_4e1bb51a",cellTitle:"cellTitle_4e1bb51a",checkTooltip:"checkTooltip_4e1bb51a",cellTooltip:"cellTooltip_4e1bb51a",sizingOverlay:"sizingOverlay_4e1bb51a"};i.loadStyles([{rawString:".root_4e1bb51a{display:inline-block;min-width:100%;vertical-align:top;height:36px;line-height:36px;white-space:nowrap;padding-bottom:1px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_4e1bb51a.rootIsSelectAllHidden_4e1bb51a .cell_4e1bb51a.cellIsCheck_4e1bb51a{visibility:hidden}.cell_4e1bb51a{font-size:12px;font-weight:400;background:0 0;color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";font-weight:400;position:relative;display:inline-block;box-sizing:border-box;padding:0 8px;border:none;line-height:inherit;margin:0;height:36px;vertical-align:top;white-space:nowrap;text-overflow:ellipsis}.cell_4e1bb51a::-moz-focus-inner{border:0}.cell_4e1bb51a{outline:transparent}.cell_4e1bb51a{position:relative}.ms-Fabric.is-focusVisible .cell_4e1bb51a:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}html[dir=ltr] .cell_4e1bb51a{text-align:left}html[dir=rtl] .cell_4e1bb51a{text-align:right}html[dir=ltr] .cell_4e1bb51a{text-align:left}html[dir=rtl] .cell_4e1bb51a{text-align:right}.cell_4e1bb51a.cellIsCheck_4e1bb51a{position:relative;padding:0;margin:0}.cell_4e1bb51a.cellIsActionable_4e1bb51a{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.cell_4e1bb51a.cellIsActionable_4e1bb51a:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.cell_4e1bb51a.cellIsActionable_4e1bb51a:active{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.cell_4e1bb51a.cellIsEmpty_4e1bb51a{text-overflow:clip}.cellSizer_4e1bb51a{display:inline-block;position:relative;cursor:ew-resize;bottom:0;top:0;margin:0 -8px;overflow:hidden;height:inherit;background:0 0;z-index:1;width:16px}.cellSizer_4e1bb51a::-moz-focus-inner{border:0}.cellSizer_4e1bb51a{outline:transparent}.cellSizer_4e1bb51a:after{content:'';position:absolute;top:0;bottom:0;width:1px;background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";opacity:0;left:50%}.cellSizer_4e1bb51a.cellIsResizing_4e1bb51a:after,.cellSizer_4e1bb51a:focus:after,.cellSizer_4e1bb51a:hover:after{opacity:1;transition:opacity .3s linear}.cellSizer_4e1bb51a.cellIsResizing_4e1bb51a:after{box-shadow:0 0 5px 0 rgba(0,0,0,.4)}.collapseButton_4e1bb51a{text-align:center;-webkit-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;width:20px;outline:0}.collapseButton_4e1bb51a.collapseButtonIsCollapsed_4e1bb51a{-webkit-transform:rotate(0);transform:rotate(0)}.cell_4e1bb51a .nearIcon_4e1bb51a{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";opacity:1}html[dir=ltr] .cell_4e1bb51a .nearIcon_4e1bb51a{padding-right:4px}html[dir=rtl] .cell_4e1bb51a .nearIcon_4e1bb51a{padding-left:4px}.cell_4e1bb51a .filterChevron_4e1bb51a{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";vertical-align:middle}[dir=ltr] .cell_4e1bb51a .filterChevron_4e1bb51a{padding-left:4px}[dir=rtl] .cell_4e1bb51a .filterChevron_4e1bb51a{padding-right:4px}.cellTitle_4e1bb51a{display:block;overflow:hidden;top:0;left:0;bottom:0;right:0;padding:0 8px}.cellTitle_4e1bb51a::-moz-focus-inner{border:0}.cellTitle_4e1bb51a{outline:transparent}.cellTitle_4e1bb51a{position:absolute}.ms-Fabric.is-focusVisible .cellTitle_4e1bb51a:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.ms-TooltipHost.checkTooltip_4e1bb51a{display:block}.cellTooltip_4e1bb51a{display:block;position:absolute;top:0;left:0;bottom:0;right:0}.sizingOverlay_4e1bb51a{position:absolute;left:0;top:0;right:0;bottom:0;cursor:ew-resize;background:rgba(255,255,255,0)}html[dir=ltr] .cell_4e1bb51a .collapseButton_4e1bb51a{padding-right:0}html[dir=rtl] .cell_4e1bb51a .collapseButton_4e1bb51a{padding-left:0}"}]);return o});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow",["require","exports","tslib","react","react-dom","../../Utilities","./DetailsList.Props","./DetailsRowCheck","../GroupedList/GroupSpacer","./DetailsRowFields","../../FocusZone","../../utilities/selection/interfaces","./DetailsRow.scss","../../Styling","./DetailsRowCheck.scss"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=p,g=function(e){function t(t){var i=e.call(this,t)||this;i.state={selectionState:i._getSelectionState(t),columnMeasureInfo:null,isDropping:!1,groupNestingDepth:t.groupNestingDepth};i._hasSetFocus=!1;i._droppingClassNames="";i._updateDroppingState=i._updateDroppingState.bind(i);i._onToggleSelection=i._onToggleSelection.bind(i);return i}i.__extends(t,e);t.prototype.componentDidMount=function(){var e=this.props.dragDropHelper;e&&(this._dragDropSubscription=e.subscribe(this._root,this._events,this._getRowDragDropOptions()));this._events.on(this.props.selection,c.SELECTION_CHANGE,this._onSelectionChanged);if(this.props.onDidMount&&this.props.item){this._hasMounted=!0;this.props.onDidMount(this)}};t.prototype.componentDidUpdate=function(e){var t=this.state,i=this.props,r=i.item,o=i.onDidMount,n=t.columnMeasureInfo;if(this.props.itemIndex!==e.itemIndex||this.props.item!==e.item||this.props.dragDropHelper!==e.dragDropHelper){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}this.props.dragDropHelper&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root,this._events,this._getRowDragDropOptions()))}if(n&&n.index>=0){var s=this.refs.cellMeasurer.getBoundingClientRect().width;n.onMeasureDone(s);this.setState({columnMeasureInfo:null})}if(r&&o&&!this._hasMounted){this._hasMounted=!0;o(this)}};t.prototype.componentWillUnmount=function(){var e=this.props,t=e.item,i=e.onWillUnmount;i&&t&&i(this);if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}};t.prototype.componentWillReceiveProps=function(e){this.setState({selectionState:this._getSelectionState(e),groupNestingDepth:e.groupNestingDepth})};t.prototype.render=function(){var e=this.props,t=e.columns,o=e.dragDropEvents,a=e.item,p=e.itemIndex,g=e.onRenderCheck,v=void 0===g?this._onRenderCheck:g,b=e.onRenderItemColumn,y=e.selectionMode,_=e.viewport,S=e.checkboxVisibility,x=e.getRowAriaLabel,I=e.checkButtonAriaLabel,w=e.selection,C=this.state,T=C.selectionState,D=T.isSelected,k=T.anySelected,P=C.columnMeasureInfo,L=C.isDropping,R=C.groupNestingDepth,F=Boolean(o&&o.canDrag&&o.canDrag(a)),A=L?this._droppingClassNames?this._droppingClassNames:"is-dropping":"",M=x?x(a):null,E=w.canSelectItem(a),U=y===c.SelectionMode.multiple,B=y!==c.SelectionMode.none&&S!==s.CheckboxVisibility.hidden;return r.createElement(d.FocusZone,i.__assign({},n.getNativeProps(this.props,n.divProperties),{direction:d.FocusZoneDirection.horizontal,ref:this._onRootRef,role:"row","aria-label":M,className:n.css("ms-DetailsRow",m.AnimationClassNames.fadeIn400,h.root,f.owner,A,(O={},O["is-contentUnselectable "+h.rootIsContentUnselectable]=U,O["is-selected "+f.isSelected+" "+h.rootIsSelected]=D,O["is-check-visible "+f.isVisible]=S===s.CheckboxVisibility.always,O)),"data-is-focusable":!0,"data-selection-index":p,"data-item-index":p,"aria-rowindex":p,"data-is-draggable":F,draggable:F,"data-automationid":"DetailsRow",style:{minWidth:_?_.width:0},"aria-selected":D}),B&&r.createElement("div",{role:"gridcell","aria-colindex":0,className:n.css("ms-DetailsRow-cell","ms-DetailsRow-cellCheck",f.owner,h.cell,h.checkCell)},v({isSelected:D,anySelected:k,title:I,canSelect:E})),l.GroupSpacer({count:R}),a&&r.createElement(u.DetailsRowFields,{columns:t,item:a,itemIndex:p,columnStartIndex:B?1:0,onRenderItemColumn:b}),P&&r.createElement("span",{role:"presentation",className:n.css("ms-DetailsRow-cellMeasurer ms-DetailsRow-cell",h.cellMeasurer,h.cell),ref:"cellMeasurer"},r.createElement(u.DetailsRowFields,{columns:[P.column],item:a,itemIndex:p,columnStartIndex:(B?1:0)+t.length,onRenderItemColumn:b})));var O};t.prototype.measureCell=function(e,t){var i=n.assign({},this.props.columns[e]);i.minWidth=0;i.maxWidth=999999;delete i.calculatedWidth;this.setState({columnMeasureInfo:{index:e,column:i,onMeasureDone:t}})};t.prototype.focus=function(){var e=this._root;if(e){e.focus();return!0}return!1};t.prototype._onRenderCheck=function(e){return r.createElement(a.DetailsRowCheck,i.__assign({},e))};t.prototype._getSelectionState=function(e){var t=e.itemIndex,i=e.selection;return{isSelected:i.isIndexSelected(t),anySelected:i.getSelectedCount()>0}};t.prototype._onSelectionChanged=function(){var e=this._getSelectionState(this.props);n.shallowCompare(e,this.state.selectionState)||this.setState({selectionState:e})};t.prototype._onToggleSelection=function(){this.props.selection.toggleIndexSelected(this.props.itemIndex)};t.prototype._onRootRef=function(e){this._root=e?o.findDOMNode(e):void 0};t.prototype._getRowDragDropOptions=function(){var e=this.props,t=e.item,i=e.itemIndex,r=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:i,context:{data:t,index:i},canDrag:r.canDrag,canDrop:r.canDrop,onDragStart:r.onDragStart,updateDropState:this._updateDroppingState,onDrop:r.onDrop,onDragEnd:r.onDragEnd}};t.prototype._updateDroppingState=function(e,t){var i=this.state,r=i.selectionState,o=i.isDropping,n=this.props,s=n.dragDropEvents,a=n.item;e?s.onDragEnter&&(this._droppingClassNames=s.onDragEnter(a,t)):s.onDragLeave&&s.onDragLeave(a,t);o!==e&&this.setState({selectionState:r,isDropping:e})};return t}(n.BaseComponent);i.__decorate([n.autobind],g.prototype,"_onRootRef",null);t.DetailsRow=g});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRowFields",["require","exports","tslib","react","../../Utilities","./DetailsRow.scss"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n,a=function(e){function t(t){var i=e.call(this)||this;i.state=i._getState(t);return i}i.__extends(t,e);t.prototype.componentWillReceiveProps=function(e){this.setState(this._getState(e))};t.prototype.render=function(){var e=this.props,t=e.columns,i=e.columnStartIndex,n=this.state.cellContent;return r.createElement("div",{className:o.css("ms-DetailsRow-fields",s.fields),"data-automationid":"DetailsRowFields",role:"presentation"},t.map(function(e,t){return r.createElement("div",{key:t,role:e.isRowHeader?"rowheader":"gridcell","aria-colindex":t+i,className:o.css("ms-DetailsRow-cell",s.cell,e.className,(a={"is-multiline":e.isMultiline},a[s.isMultiline]=e.isMultiline,a)),style:{width:e.calculatedWidth+16},"data-automationid":"DetailsRowCell","data-automation-key":e.key},n[t]);var a}))};t.prototype._getState=function(e){var t=this,i=e.item,r=e.itemIndex,o=e.onRenderItemColumn;return{cellContent:e.columns.map(function(e){var n;try{var s=e.onRender||o;n=s?s(i,r,e):t._getCellText(i,e)}catch(e){}return n})}};t.prototype._getCellText=function(e,t){var i=e&&t&&t.fieldName?e[t.fieldName]:"";null!==i&&void 0!==i||(i="");return i};return t}(o.BaseComponent);t.DetailsRowFields=a});define("office-ui-fabric-react/lib/components/DetailsList/DetailsRow.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_3c128aa5",rootIsSelected:"rootIsSelected_3c128aa5",rootIsContentUnselectable:"rootIsContentUnselectable_3c128aa5",cell:"cell_3c128aa5",checkCell:"checkCell_3c128aa5",isMultiline:"isMultiline_3c128aa5",fields:"fields_3c128aa5",cellMeasurer:"cellMeasurer_3c128aa5"};i.loadStyles([{rawString:".root_3c128aa5{display:inline-block;min-width:100%;min-height:36px;margin:1px 0;vertical-align:top;white-space:nowrap;padding:0;box-sizing:border-box;background:0 0;border:none;vertical-align:top;line-height:16px}.root_3c128aa5::-moz-focus-inner{border:0}.root_3c128aa5{outline:transparent}.root_3c128aa5{position:relative}.ms-Fabric.is-focusVisible .root_3c128aa5:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}html[dir=ltr] .root_3c128aa5{text-align:left}html[dir=rtl] .root_3c128aa5{text-align:right}.root_3c128aa5:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.rootIsSelected_3c128aa5{background:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.rootIsSelected_3c128aa5:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.rootIsContentUnselectable_3c128aa5{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.cell_3c128aa5{display:inline-block;position:relative;box-sizing:border-box;padding:10px 8px;min-height:36px;vertical-align:top;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cell_3c128aa5::-moz-focus-inner{border:0}.cell_3c128aa5{outline:transparent}.cell_3c128aa5{position:relative}.ms-Fabric.is-focusVisible .cell_3c128aa5:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.cell_3c128aa5>button{max-width:100%}.cell_3c128aa5.checkCell_3c128aa5{padding:0;margin:0}.isMultiline_3c128aa5{white-space:normal;word-break:break-word;text-overflow:clip}.fields_3c128aa5{display:inline-block}.cellMeasurer_3c128aa5 .cell_3c128aa5{overflow:visible;white-space:nowrap}"}]);return o});define("office-ui-fabric-react/lib/utilities/dragdrop/DragDropHelper",["require","exports","react-dom","../../Utilities"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=25,n=function(){function e(e){this._selection=e.selection;this._dragEnterCounts={};this._activeTargets={};this._lastId=0;this._distanceSquaredForDrag="number"==typeof e.minimumPixelsForDrag?e.minimumPixelsForDrag*e.minimumPixelsForDrag:o;this._events=new r.EventGroup(this);this._events.on(document.body,"mouseup",this._onMouseUp.bind(this),!0);this._events.on(document,"mouseup",this._onDocumentMouseUp.bind(this),!0)}e.prototype.dispose=function(){this._events.dispose()};e.prototype.subscribe=function(e,t,i){var r,o,n,s,a,l,u,d,c,p,m=this,f=i.key,h=void 0===f?""+ ++this._lastId:f,g=[];if(i&&e){var v=i.eventMap,b=i.context,y=i.updateDropState,_={root:e,options:i,key:h};d=this._isDraggable(_);c=this._isDroppable(_);if((d||c)&&v)for(var S=0,x=v;S<x.length;S++){var I=x[S],w={callback:I.callback.bind(null,b),eventName:I.eventName};g.push(w);this._events.on(e,w.eventName,w.callback)}if(c){o=function(e){if(!e.isHandled){e.isHandled=!0;0===--m._dragEnterCounts[h]&&y(!1,e)}};n=function(e){e.preventDefault();if(!e.isHandled){e.isHandled=!0;1===++m._dragEnterCounts[h]&&y(!0,e)}};s=function(e){m._dragEnterCounts[h]=0;y(!1,e)};a=function(e){m._dragEnterCounts[h]=0;y(!1,e);i.onDrop&&i.onDrop(i.context.data,e)};l=function(e){e.preventDefault()};this._dragEnterCounts[h]=0;t.on(e,"dragenter",n);t.on(e,"dragleave",o);t.on(e,"dragend",s);t.on(e,"drop",a);t.on(e,"dragover",l)}if(d){u=this._onMouseDown.bind(this,_);s=this._onDragEnd.bind(this,_);r=function(t){t.dataTransfer.setData("id",e.id)};t.on(e,"dragstart",r);t.on(e,"mousedown",u);t.on(e,"dragend",s)}p={target:_,dispose:function(){m._activeTargets[h]===p&&delete m._activeTargets[h];if(e){for(var i=0,f=g;i<f.length;i++){var v=f[i];m._events.off(e,v.eventName,v.callback)}if(c){t.off(e,"dragenter",n);t.off(e,"dragleave",o);t.off(e,"dragend",s);t.off(e,"dragover",l);t.off(e,"drop",a)}if(d){t.off(e,"dragstart",r);t.off(e,"mousedown",u);t.off(e,"dragend",s)}}}};this._activeTargets[h]=p}return{key:h,dispose:function(){p&&p.dispose()}}};e.prototype.unsubscribe=function(e,t){var i=this._activeTargets[t];i&&i.dispose()};e.prototype._onDragEnd=function(e,t){var i=e.options;i.onDragEnd&&i.onDragEnd(i.context.data,t)};e.prototype._onMouseUp=function(e){this._isDragging=!1;if(this._dragData){for(var t=0,i=Object.keys(this._activeTargets);t<i.length;t++){var o=i[t],n=this._activeTargets[o];if(n.target.root){this._events.off(n.target.root,"mousemove");this._events.off(n.target.root,"mouseleave")}}if(this._dragData.dropTarget){r.EventGroup.raise(this._dragData.dropTarget.root,"dragleave");r.EventGroup.raise(this._dragData.dropTarget.root,"drop")}}this._dragData=null};e.prototype._onDocumentMouseUp=function(e){e.target===document.documentElement&&this._onMouseUp(e)};e.prototype._onMouseMove=function(e,t){var i=t.buttons,o=void 0===i?1:i;if(this._dragData&&1!==o)this._onMouseUp(t);else{var n=e.root,s=e.options,a=e.key;if(this._isDragging){if(this._isDroppable(e)){if(this._dragData.dropTarget&&this._dragData.dropTarget.key!==a&&!this._isChild(n,this._dragData.dropTarget.root)){r.EventGroup.raise(this._dragData.dropTarget.root,"dragleave");this._dragData.dropTarget=null}if(!this._dragData.dropTarget){r.EventGroup.raise(n,"dragenter");this._dragData.dropTarget=e}}}else if(this._dragData&&this._isDraggable(e)){var l=this._dragData.clientX-t.clientX,u=this._dragData.clientY-t.clientY;if(l*l+u*u>=this._distanceSquaredForDrag&&this._dragData.dragTarget){this._isDragging=!0;s.onDragStart&&s.onDragStart(s.context.data,s.context.index,this._selection.getSelection(),t)}}}};e.prototype._onMouseLeave=function(e,t){if(this._isDragging&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key===e.key){r.EventGroup.raise(e.root,"dragleave");this._dragData.dropTarget=null}};e.prototype._onMouseDown=function(e,t){if(0===t.button)if(this._isDraggable(e)){this._dragData={clientX:t.clientX,clientY:t.clientY,eventTarget:t.target,dragTarget:e};for(var i=0,r=Object.keys(this._activeTargets);i<r.length;i++){var o=r[i],n=this._activeTargets[o];if(n.target.root){this._events.on(n.target.root,"mousemove",this._onMouseMove.bind(this,n.target));this._events.on(n.target.root,"mouseleave",this._onMouseLeave.bind(this,n.target))}}}else this._dragData=null};e.prototype._isChild=function(e,t){for(var r=i.findDOMNode(e),o=i.findDOMNode(t);o&&o.parentElement;){if(o.parentElement===r)return!0;o=o.parentElement}return!1};e.prototype._isDraggable=function(e){var t=e.options;return t.canDrag&&t.canDrag(t.context.data)};e.prototype._isDroppable=function(e){var t=e.options,i=this._dragData&&this._dragData.dragTarget?this._dragData.dragTarget.options.context:null;return t.canDrop&&t.canDrop(t.context,i)};return e}();t.DragDropHelper=n});define("office-ui-fabric-react/lib/GroupedList",["require","exports","./components/GroupedList/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/GroupedList/index",["require","exports","./GroupedList"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/GroupedList/GroupedList",["require","exports","tslib","react","../../Utilities","./GroupedListSection","../../List","../../utilities/selection/index","./GroupedList.scss"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=l,d=function(e){function t(t){var i=e.call(this,t)||this;i._isSomeGroupExpanded=i._computeIsSomeGroupExpanded(t.groups);i.state={lastWidth:0,groups:t.groups};return i}i.__extends(t,e);t.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.groups,r=t.selectionMode,o=!1;if(e.groups!==i){this.setState({groups:e.groups});o=!0}e.selectionMode!==r&&(o=!0);o&&this._forceListUpdates()};t.prototype.render=function(){var e=this.props.className,t=this.state.groups;return r.createElement("div",{ref:"root",className:o.css("ms-GroupedList",u.root,e),"data-automationid":"GroupedList","data-is-scrollable":"false",role:"grid"},t?r.createElement(s.List,{ref:"list",items:t,onRenderCell:this._renderGroup,getItemCountForPage:function(){return 1}}):this._renderGroup(null,0))};t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this);this._forceListUpdates()};t.prototype.toggleCollapseAll=function(e){var t=this.state.groups,i=this.props.groupProps,r=i&&i.onToggleCollapseAll;if(t){r&&r(e);for(var o=0;o<t.length;o++)t[o].isCollapsed=e;this._updateIsSomeGroupExpanded();this.forceUpdate()}};t.prototype._renderGroup=function(e,t){var i=this.props,s=i.dragDropEvents,a=i.dragDropHelper,l=i.eventsToRegister,u=i.groupProps,d=i.items,c=i.listProps,p=i.onRenderCell,m=i.selectionMode,f=i.selection,h=i.viewport,g={onToggleSelectGroup:this._onToggleSelectGroup,onToggleCollapse:this._onToggleCollapse,onToggleSummarize:this._onToggleSummarize},v=o.assign({},u.headerProps,g),b=o.assign({},u.footerProps,g),y=this._getGroupNestingDepth();return!e||e.count>0?r.createElement(n.GroupedListSection,{ref:"group_"+t,key:this._getGroupKey(e,t),dragDropEvents:s,dragDropHelper:a,eventsToRegister:l,footerProps:b,getGroupItemLimit:u&&u.getGroupItemLimit,group:e,groupIndex:t,groupNestingDepth:y,headerProps:v,listProps:c,items:d,onRenderCell:p,onRenderGroupHeader:u.onRenderHeader,onRenderGroupFooter:u.onRenderFooter,selectionMode:m,selection:f,viewport:h}):null};t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(t))};t.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.state.groups;t&&t.length>0;){e++;t=t[0].children}return e};t.prototype._onToggleCollapse=function(e){var t=this.props.groupProps,i=t&&t.headerProps&&t.headerProps.onToggleCollapse;if(e){i&&i(e);e.isCollapsed=!e.isCollapsed;this._updateIsSomeGroupExpanded();this.forceUpdate()}};t.prototype._onToggleSelectGroup=function(e){e&&this.props.selection.toggleRangeSelected(e.startIndex,e.count)};t.prototype._forceListUpdates=function(e){var t=(e=e||this.state.groups)?e.length:1;if(this.refs.list){this.refs.list.forceUpdate();for(var i=0;i<t;i++)(r=this.refs.list.refs["group_"+String(i)])&&r.forceListUpdate()}else{var r=this.refs["group_"+String(0)];r&&r.forceListUpdate()}};t.prototype._onToggleSummarize=function(e){var t=this.props.groupProps,i=t&&t.footerProps&&t.footerProps.onToggleSummarize;if(i)i(e);else{e&&(e.isShowingAll=!e.isShowingAll);this.forceUpdate()}};t.prototype._computeIsSomeGroupExpanded=function(e){var t=this;return e&&e.some(function(e){return e.children?t._computeIsSomeGroupExpanded(e.children):!e.isCollapsed})};t.prototype._updateIsSomeGroupExpanded=function(){var e=this.state.groups,t=this.props.onGroupExpandStateChanged,i=this._computeIsSomeGroupExpanded(e);if(this._isSomeGroupExpanded!==i){t&&t(i);this._isSomeGroupExpanded=i}};return t}(o.BaseComponent);d.defaultProps={selectionMode:a.SelectionMode.multiple,isHeaderVisible:!0,groupProps:{}};i.__decorate([o.autobind],d.prototype,"_renderGroup",null);i.__decorate([o.autobind],d.prototype,"_onToggleCollapse",null);i.__decorate([o.autobind],d.prototype,"_onToggleSelectGroup",null);i.__decorate([o.autobind],d.prototype,"_onToggleSummarize",null);t.GroupedList=d});define("office-ui-fabric-react/lib/components/GroupedList/GroupedListSection",["require","exports","tslib","react","../../Utilities","../../utilities/selection/index","./GroupFooter","./GroupHeader","../../List","../../Utilities","./GroupedList.scss"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=d,p=function(e){function t(t){var i=e.call(this,t)||this,r=t.selection,o=t.group;i._subGroups={};i.state={isDropping:!1,isSelected:!(!r||!o)&&r.isRangeSelected(o.startIndex,o.count)};return i}i.__extends(t,e);t.prototype.componentDidMount=function(){var e=this.props,t=e.dragDropHelper,i=e.selection;t&&(this._dragDropSubscription=t.subscribe(this.refs.root,this._events,this._getGroupDragDropOptions()));i&&this._events.on(i,n.SELECTION_CHANGE,this._onSelectionChange)};t.prototype.componentWillUnmount=function(){this._dragDropSubscription&&this._dragDropSubscription.dispose()};t.prototype.componentDidUpdate=function(e){if(this.props.group!==e.group||this.props.groupIndex!==e.groupIndex||this.props.dragDropHelper!==e.dragDropHelper){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}this.props.dragDropHelper&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this.refs.root,this._events,this._getGroupDragDropOptions()))}};t.prototype.render=function(){var e=this.props,t=e.getGroupItemLimit,i=e.group,o=e.groupIndex,n=e.headerProps,s=e.footerProps,a=e.viewport,d=e.selectionMode,p=e.onRenderGroupHeader,m=void 0===p?this._onRenderGroupHeader:p,f=e.onRenderGroupFooter,h=void 0===f?this._onRenderGroupFooter:f,g=this.state.isSelected,v=i&&t?t(i):1/0,b=i&&!i.children&&!i.isCollapsed&&!i.isShowingAll&&(i.count>v||i.hasMoreData),y=i&&i.children&&i.children.length>0,_={group:i,groupIndex:o,groupLevel:i?i.level:0,isSelected:g,viewport:a,selectionMode:d},S=u.assign({},n,_),x=u.assign({},s,_);return r.createElement("div",{ref:"root",className:u.css("ms-GroupedList-group",c.group,this._getDroppingClassName())},m(S,this._onRenderGroupHeader),i&&i.isCollapsed?null:y?r.createElement(l.List,{ref:"list",items:i.children,onRenderCell:this._renderSubGroup,getItemCountForPage:function(){return 1}}):this._onRenderGroup(v),b&&h(x,this._onRenderGroupFooter))};t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this);this.forceListUpdate()};t.prototype.forceListUpdate=function(){var e=this.props.group;if(this.refs.list){this.refs.list.forceUpdate();if(e&&e.children&&e.children.length>0)for(var t=e.children.length,i=0;i<t;i++)(r=this.refs.list.refs["subGroup_"+String(i)])&&r.forceListUpdate()}else{var r=this.refs["subGroup_"+String(0)];r&&r.forceListUpdate()}};t.prototype._onRenderGroupHeader=function(e){return r.createElement(a.GroupHeader,i.__assign({},e))};t.prototype._onRenderGroupFooter=function(e){return r.createElement(s.GroupFooter,i.__assign({},e))};t.prototype._onSelectionChange=function(){var e=this.props,t=e.group,i=e.selection.isRangeSelected(t.startIndex,t.count);i!==this.state.isSelected&&this.setState({isSelected:i})};t.prototype._onRenderGroup=function(e){var t=this.props,o=t.group,n=t.items,s=t.onRenderCell,a=t.listProps,u=t.groupNestingDepth,d=o?o.count:n.length,c=o?o.startIndex:0;return r.createElement(l.List,i.__assign({items:n,onRenderCell:function(e,t){return s(u,e,t)},ref:"list",renderCount:Math.min(d,e),startIndex:c},a))};t.prototype._renderSubGroup=function(e,i){var o=this.props,n=o.dragDropEvents,s=o.dragDropHelper,a=o.eventsToRegister,l=o.getGroupItemLimit,u=o.groupNestingDepth,d=o.items,c=o.headerProps,p=o.footerProps,m=o.listProps,f=o.onRenderCell,h=o.selection,g=o.selectionMode,v=o.viewport,b=o.onRenderGroupHeader,y=o.onRenderGroupFooter;return!e||e.count>0?r.createElement(t,{ref:"subGroup_"+i,key:this._getGroupKey(e,i),dragDropEvents:n,dragDropHelper:s,eventsToRegister:a,footerProps:p,getGroupItemLimit:l,group:e,groupIndex:i,groupNestingDepth:u,headerProps:c,items:d,listProps:m,onRenderCell:f,selection:h,selectionMode:g,viewport:v,onRenderGroupHeader:b,onRenderGroupFooter:y}):null};t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(e.level)+String(t))};t.prototype._getGroupDragDropOptions=function(){var e=this.props,t=e.group,i=e.groupIndex,r=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:-1,context:{data:t,index:i,isGroup:!0},canDrag:function(){return!1},canDrop:r.canDrop,onDragStart:null,updateDropState:this._updateDroppingState}};t.prototype._updateDroppingState=function(e,t){var i=this.state.isDropping,r=this.props.dragDropEvents;i?r.onDragEnter&&r.onDragEnter(t,null):r.onDragLeave&&r.onDragLeave(t,null);i!==e&&this.setState({isDropping:e})};t.prototype._getDroppingClassName=function(){var e=this.state.isDropping;e=!(!this.props.group||!e);return u.css(e&&"is-dropping",e&&c.groupIsDropping)};return t}(o.BaseComponent);i.__decorate([o.autobind],p.prototype,"_onRenderGroupHeader",null);i.__decorate([o.autobind],p.prototype,"_onRenderGroupFooter",null);i.__decorate([o.autobind],p.prototype,"_renderSubGroup",null);i.__decorate([o.autobind],p.prototype,"_getGroupDragDropOptions",null);i.__decorate([o.autobind],p.prototype,"_updateDroppingState",null);t.GroupedListSection=p});define("office-ui-fabric-react/lib/components/GroupedList/GroupFooter",["require","exports","tslib","react","../../Utilities","../../Link","./GroupSpacer","./GroupFooter.scss"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.render=function(){var e=this.props,t=e.group,i=e.groupLevel,a=e.showAllLinkText;return t&&r.createElement("div",{className:o.css("ms-groupFooter",l.root)},s.GroupSpacer({count:i}),r.createElement(n.Link,{onClick:this._onSummarizeClick},a))};t.prototype._onSummarizeClick=function(e){this.props.onToggleSummarize(this.props.group);e.stopPropagation();e.preventDefault()};return t}(o.BaseComponent);i.__decorate([o.autobind],u.prototype,"_onSummarizeClick",null);t.GroupFooter=u});define("office-ui-fabric-react/lib/Link",["require","exports","./components/Link/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Link/index",["require","exports","./Link"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Link/Link",["require","exports","tslib","react","../../Utilities","./Link.scss"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.children,a=e.className;return e.href?r.createElement("a",i.__assign({},o.getNativeProps(this.props,o.anchorProperties),{className:o.css("ms-Link",s.root,a,(l={"is-disabled":t},l[s.isDisabled]=t,l[s.isEnabled]=!t,l)),onClick:this._onClick,ref:this._resolveRef("_link"),target:this.props.target}),n):r.createElement("button",i.__assign({},o.getNativeProps(this.props,o.buttonProperties),{className:o.css("ms-Link",s.root,a,(u={"is-disabled":t},u[s.isDisabled]=t,u)),onClick:this._onClick,ref:this._resolveRef("_link")}),n);var l,u};t.prototype.focus=function(){this._link&&this._link.focus()};t.prototype._onClick=function(e){var t=this.props.onClick;t&&t(e)};return t}(o.BaseComponent);i.__decorate([o.autobind],a.prototype,"_onClick",null);t.Link=a});define("office-ui-fabric-react/lib/components/Link/Link.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_5d3b40ca",isEnabled:"isEnabled_5d3b40ca",isDisabled:"isDisabled_5d3b40ca"};i.loadStyles([{rawString:".root_5d3b40ca{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";margin:0;overflow:inherit;padding:0;text-overflow:inherit}.isEnabled_5d3b40ca:focus,.isEnabled_5d3b40ca:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.isEnabled_5d3b40ca:active{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.isDisabled_5d3b40ca{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";pointer-events:none;cursor:default}button.root_5d3b40ca{background:0 0;border:none;cursor:pointer;display:inline;font-size:inherit}button.root_5d3b40ca::-moz-focus-inner{border:0}button.root_5d3b40ca{outline:transparent}button.root_5d3b40ca{position:relative}.ms-Fabric.is-focusVisible button.root_5d3b40ca:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}html[dir=ltr] button.root_5d3b40ca{text-align:left}html[dir=rtl] button.root_5d3b40ca{text-align:right}a.root_5d3b40ca{text-decoration:none}.ms-Fabric.is-focusVisible a.root_5d3b40ca:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}]);return o});define("office-ui-fabric-react/lib/components/GroupedList/GroupFooter.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_3ef59339"};i.loadStyles([{rawString:".root_3ef59339{position:relative;padding:10px 84px;cursor:pointer}.root_3ef59339 .ms-Link{font-size:12px}"}]);return o});define("office-ui-fabric-react/lib/components/GroupedList/GroupHeader",["require","exports","tslib","react","../../Utilities","../../utilities/selection/index","../../Check","../../Icon","./GroupSpacer","../../Spinner","../../FocusZone","./GroupHeader.scss"],function(e,t,i,r,o,n,s,a,l,u,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=c,m=function(e){function t(t){var i=e.call(this,t)||this;i.state={isCollapsed:i.props.group&&i.props.group.isCollapsed,isLoadingVisible:!1};return i}i.__extends(t,e);t.prototype.componentWillReceiveProps=function(e){if(e.group){var t=e.group.isCollapsed,i=e.headerProps&&e.headerProps.isGroupLoading,r=!t&&i&&i(e.group);this.setState({isCollapsed:t,isLoadingVisible:r})}};t.prototype.render=function(){var e=this.props,t=e.group,i=e.groupLevel,c=e.viewport,m=e.selectionMode,f=e.loadingText,h=e.isSelected,g=e.selected,v=e.isCollapsedGroupSelectVisible,b=this.state,y=b.isCollapsed,_=b.isLoadingVisible;void 0===v&&(v=!0);var S=m===n.SelectionMode.multiple&&(v||!(t&&t.isCollapsed)),x=h||g;return t&&r.createElement("div",{className:o.css("ms-GroupHeader",p.root,(I={},I["is-selected "+p.rootIsSelected]=x,I)),style:c?{minWidth:c.width}:{},onClick:this._onHeaderClick,"aria-label":t.ariaLabel||t.name,"data-is-focusable":!0},r.createElement(d.FocusZone,{direction:d.FocusZoneDirection.horizontal},S?r.createElement("button",{type:"button",className:o.css("ms-GroupHeader-check",p.check),"data-selection-toggle":!0,onClick:this._onToggleSelectGroupClick},r.createElement(s.Check,{checked:x})):m!==n.SelectionMode.none?l.GroupSpacer({count:1}):null,l.GroupSpacer({count:i}),r.createElement("div",{className:o.css("ms-GroupHeader-dropIcon",p.dropIcon)},r.createElement(a.Icon,{iconName:"Tag"})),r.createElement("button",{type:"button",className:o.css("ms-GroupHeader-expand",p.expand),onClick:this._onToggleCollapse},r.createElement(a.Icon,{className:o.css(y&&"is-collapsed "+p.expandIsCollapsed),iconName:"ChevronDown"})),r.createElement("div",{className:o.css("ms-GroupHeader-title",p.title)},r.createElement("span",null,t.name),r.createElement("span",null,"(",t.count,t.hasMoreData&&"+",")")),r.createElement("div",{className:o.css("ms-GroupHeader-loading",p.loading,_&&"is-loading "+p.loadingIsVisible)},r.createElement(u.Spinner,{label:f}))));var I};t.prototype._onToggleCollapse=function(e){var t=this.props,i=t.group,r=t.onToggleCollapse,o=t.isGroupLoading,n=!this.state.isCollapsed,s=!n&&o&&o(i);this.setState({isCollapsed:n,isLoadingVisible:s});r&&r(i);e.stopPropagation();e.preventDefault()};t.prototype._onToggleSelectGroupClick=function(e){var t=this.props,i=t.onToggleSelectGroup,r=t.group;i&&i(r);e.preventDefault();e.stopPropagation()};t.prototype._onHeaderClick=function(){var e=this.props,t=e.group,i=e.onGroupHeaderClick,r=e.onToggleSelectGroup;i?i(t):r&&r(t)};return t}(o.BaseComponent);i.__decorate([o.autobind],m.prototype,"_onToggleCollapse",null);i.__decorate([o.autobind],m.prototype,"_onToggleSelectGroupClick",null);i.__decorate([o.autobind],m.prototype,"_onHeaderClick",null);t.GroupHeader=m});define("office-ui-fabric-react/lib/Spinner",["require","exports","./components/Spinner/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/Spinner/index",["require","exports","./Spinner","./Spinner.Props"],function(e,t,i,r){"use strict";function o(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});o(i);o(r)});define("office-ui-fabric-react/lib/components/Spinner/Spinner",["require","exports","tslib","react","../../Utilities","./Spinner.Props","./Spinner.scss"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.render=function(){var e=this.props,t=e.type,i=e.size,s=e.label,l=e.className,u=(e.ariaLive,e.ariaLabel||s);return r.createElement("div",{className:o.css("ms-Spinner",a.root,l)},r.createElement("div",{className:o.css("ms-Spinner-circle",a.circle,(d={},d["ms-Spinner--xSmall "+a.circleIsXSmall]=i===n.SpinnerSize.xSmall,d["ms-Spinner--small "+a.circleIsSmall]=i===n.SpinnerSize.small,d["ms-Spinner--medium "+a.circleIsMedium]=i===n.SpinnerSize.medium,d["ms-Spinner--large "+a.circleIsLarge]=i===n.SpinnerSize.large,d["ms-Spinner--normal "+a.circleIsTypeMedium]=t===n.SpinnerType.normal,d["ms-Spinner--large "+a.circleIsTypeLarge]=t===n.SpinnerType.large,d))}),s&&r.createElement("div",{className:o.css("ms-Spinner-label",a.label)},s),u&&r.createElement("div",{role:"status","aria-live":this.props.ariaLive},r.createElement(o.DelayedRender,null,r.createElement("div",{className:a.screenReaderOnly},u))));var d};return t}(o.BaseComponent);l.defaultProps={size:n.SpinnerSize.medium,ariaLive:"polite"};t.Spinner=l});define("office-ui-fabric-react/lib/components/Spinner/Spinner.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.xSmall=0]="xSmall";e[e.small=1]="small";e[e.medium=2]="medium";e[e.large=3]="large"}(t.SpinnerSize||(t.SpinnerSize={}));!function(e){e[e.normal=0]="normal";e[e.large=1]="large"}(t.SpinnerType||(t.SpinnerType={}))});define("office-ui-fabric-react/lib/components/Spinner/Spinner.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_7b692192",circle:"circle_7b692192",spinAnimation:"spinAnimation_7b692192",circleIsXSmall:"circleIsXSmall_7b692192",circleIsSmall:"circleIsSmall_7b692192",circleIsTypeMedium:"circleIsTypeMedium_7b692192",circleIsMedium:"circleIsMedium_7b692192",circleIsTypeLarge:"circleIsTypeLarge_7b692192",circleIsLarge:"circleIsLarge_7b692192",label:"label_7b692192",screenReaderOnly:"screenReaderOnly_7b692192"};i.loadStyles([{rawString:"@-webkit-keyframes spinAnimation_7b692192{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinAnimation_7b692192{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.root_7b692192>.circle_7b692192{margin:auto;box-sizing:border-box;border-radius:50%;width:100%;height:100%;border:1.5px solid "},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";border-top-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";-webkit-animation:spinAnimation_7b692192 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation_7b692192 1.3s infinite cubic-bezier(.53,.21,.29,.67)}.root_7b692192>.circle_7b692192.circleIsXSmall_7b692192{width:12px;height:12px}.root_7b692192>.circle_7b692192.circleIsSmall_7b692192{width:16px;height:16px}.root_7b692192>.circle_7b692192.circleIsMedium_7b692192,.root_7b692192>.circle_7b692192.circleIsTypeMedium_7b692192{width:20px;height:20px}.root_7b692192>.circle_7b692192.circleIsLarge_7b692192,.root_7b692192>.circle_7b692192.circleIsTypeLarge_7b692192{width:28px;height:28px}.root_7b692192 .label_7b692192{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";margin-top:10px;text-align:center}.root_7b692192 .screenReaderOnly_7b692192{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}@media screen and (-ms-high-contrast:active){.root_7b692192>.circle_7b692192{border-top-style:none}}"}]);return o});define("office-ui-fabric-react/lib/components/GroupedList/GroupHeader.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_3adfcf16",rootIsSelected:"rootIsSelected_3adfcf16",check:"check_3adfcf16",expand:"expand_3adfcf16",title:"title_3adfcf16",expandIsCollapsed:"expandIsCollapsed_3adfcf16",loading:"loading_3adfcf16",loadingIsVisible:"loadingIsVisible_3adfcf16",dropIcon:"dropIcon_3adfcf16"};i.loadStyles([{rawString:".root_3adfcf16{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_3adfcf16::-moz-focus-inner{border:0}.root_3adfcf16{outline:transparent}.root_3adfcf16{position:relative}.ms-Fabric.is-focusVisible .root_3adfcf16:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.root_3adfcf16:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.root_3adfcf16.rootIsSelected_3adfcf16{background:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.root_3adfcf16.rootIsSelected_3adfcf16:hover{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.check_3adfcf16,.expand_3adfcf16{display:inline-block;cursor:default;padding:6px;-webkit-transform:translateY(50%);transform:translateY(50%);margin-top:-12px;box-sizing:border-box;vertical-align:top;background:0 0;border:none;font-size:12px;top:4px}.check_3adfcf16::-moz-focus-inner,.expand_3adfcf16::-moz-focus-inner{border:0}.check_3adfcf16,.expand_3adfcf16{outline:transparent}.check_3adfcf16,.expand_3adfcf16{position:relative}.ms-Fabric.is-focusVisible .check_3adfcf16:focus:after,.ms-Fabric.is-focusVisible .expand_3adfcf16:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.check_3adfcf16{opacity:0;margin-top:-10px}.check_3adfcf16:focus{opacity:1}.root_3adfcf16.rootIsSelected_3adfcf16 .check_3adfcf16,.root_3adfcf16:hover .check_3adfcf16{opacity:1}.title_3adfcf16{font-size:21px;font-weight:100;padding:14px 6px;display:inline-block;cursor:pointer;outline:0}.expand_3adfcf16{width:36px;height:40px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.expand_3adfcf16 .ms-Icon{-webkit-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear}.expand_3adfcf16 .ms-Icon.expandIsCollapsed_3adfcf16{-webkit-transform:rotate(0);transform:rotate(0)}.loading_3adfcf16{display:inline-block;visibility:hidden;opacity:0;padding:0 16px;vertical-align:middle;transition:visibility 367ms,opacity 367ms}.loading_3adfcf16.loadingIsVisible_3adfcf16{visibility:visible;opacity:1}.dropIcon_3adfcf16{display:inline-block;position:relative;top:-16px;font-size:20px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";transition:opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);transition:transform 267ms cubic-bezier(.6,-.28,.735,.045),opacity 467ms cubic-bezier(.39,.575,.565,1);transition:transform 267ms cubic-bezier(.6,-.28,.735,.045),opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);opacity:0;-webkit-transform:rotate(.2deg) scale(.65);transform:rotate(.2deg) scale(.65);-webkit-transform-origin:10px 10px;transform-origin:10px 10px}[dir=ltr] .dropIcon_3adfcf16{left:-26px}[dir=rtl] .dropIcon_3adfcf16{right:-26px}.dropIcon_3adfcf16 .ms-Icon--Tag{position:absolute}.ms-GroupedList-group.is-dropping>.root_3adfcf16 .dropIcon_3adfcf16{transition:opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);transition:transform 467ms cubic-bezier(.075,.82,.165,1),opacity 167ms cubic-bezier(.39,.575,.565,1);transition:transform 467ms cubic-bezier(.075,.82,.165,1),opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);transition-delay:367ms;opacity:1;-webkit-transform:rotate(.2deg) scale(1);transform:rotate(.2deg) scale(1)}.ms-GroupedList-group.is-dropping .check_3adfcf16{opacity:0}"}]);return o});define("office-ui-fabric-react/lib/List",["require","exports","./components/List/index"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/List/index",["require","exports","./List"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("office-ui-fabric-react/lib/components/List/List",["require","exports","tslib","react","../../Utilities"],function(e,t,i,r,o){"use strict";function n(e,t,i){var r=e.top-t*e.height,o=e.height+(t+i)*e.height;return{top:r,bottom:r+o,height:o,left:e.left,right:e.right,width:e.width}}function s(e,t){return e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right}function a(e,t){e.top=t.top<e.top||-1===e.top?t.top:e.top;e.left=t.left<e.left||-1===e.left?t.left:e.left;e.bottom=t.bottom>e.bottom||-1===e.bottom?t.bottom:e.bottom;e.right=t.right>e.right||-1===e.right?t.right:e.right;e.width=e.right-e.left+1;e.height=e.bottom-e.top+1;return e}Object.defineProperty(t,"__esModule",{value:!0});var l=16,u=100,d=500,c=200,p={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},m=function(e){return e.getBoundingClientRect()},f=m,h=m,g=function(e){function t(t){var i=e.call(this,t)||this;i.state={pages:[]};i._estimatedPageHeight=0;i._totalEstimates=0;i._requiredWindowsAhead=0;i._requiredWindowsBehind=0;i._measureVersion=0;i._onAsyncScroll=i._async.debounce(i._onAsyncScroll,u,{leading:!1,maxWait:d});i._onAsyncIdle=i._async.debounce(i._onAsyncIdle,c,{leading:!1});i._onAsyncResize=i._async.debounce(i._onAsyncResize,l,{leading:!1});i._cachedPageHeights={};i._estimatedPageHeight=0;i._focusedIndex=-1;i._scrollingToIndex=-1;return i}i.__extends(t,e);t.prototype.scrollToIndex=function(e,t){for(var i=this.props.startIndex,r=i+this._getRenderCount(),o=0,n=1,s=i;s<r;s+=n){n=this._getItemCountForPage(s,this._allowedRect);if(s<=e&&s+n>e){if(t){for(var a=e-s,l=0;l<a;++l)o+=t(s+l);var u=o+t(e),d=h(this._scrollElement),c={top:this._scrollElement.scrollTop,bottom:this._scrollElement.scrollTop+d.height};if(o>=c.top&&u<=c.bottom)return;var p=o<c.top,m=u>c.bottom;p||m&&(o=this._scrollElement.scrollTop+(u-c.bottom))}this._scrollElement.scrollTop=o;break}o+=this._getPageHeight(s,n,this._surfaceRect)}};t.prototype.componentDidMount=function(){this._updatePages();this._measureVersion++;this._scrollElement=o.findScrollableParent(this.refs.root);this._events.on(window,"resize",this._onAsyncResize);this._events.on(this.refs.root,"focus",this._onFocus,!0);if(this._scrollElement){this._events.on(this._scrollElement,"scroll",this._onScroll);this._events.on(this._scrollElement,"scroll",this._onAsyncScroll)}};t.prototype.componentWillReceiveProps=function(e){if(e.items!==this.props.items||e.renderCount!==this.props.renderCount||e.startIndex!==this.props.startIndex){this._measureVersion++;this._updatePages(e)}};t.prototype.shouldComponentUpdate=function(e,t){var i=this.props,r=(i.renderedWindowsAhead,i.renderedWindowsBehind,this.state.pages),o=t.pages,n=t.measureVersion,s=!1;if(this._measureVersion===n&&e.renderedWindowsAhead,e.renderedWindowsBehind,e.items===this.props.items&&r.length===o.length)for(var a=0;a<r.length;a++){var l=r[a],u=o[a];if(l.key!==u.key||l.itemCount!==u.itemCount){s=!0;break}}else s=!0;return s};t.prototype.forceUpdate=function(){this._updateRenderRects(this.props,!0);this._updatePages();this._measureVersion++;e.prototype.forceUpdate.call(this)};t.prototype.render=function(){var e=this.props,t=e.className,n=e.role,s=this.state.pages,a=[],l=o.getNativeProps(this.props,o.divProperties);n=void 0===n?"list":n;for(var u=0;u<s.length;u++)a.push(this._renderPage(s[u]));return r.createElement("div",i.__assign({ref:"root"},l,{role:n,className:o.css("ms-List",t)}),r.createElement("div",{ref:"surface",className:"ms-List-surface",role:"presentation"},a))};t.prototype._renderPage=function(e){var t=this.props,i=t.onRenderCell,o=t.role,n=[],s=this._getPageStyle(e);o=void 0===o?"listitem":"presentation";for(var a=0;e.items&&a<e.items.length;a++){var l=e.items[a],u=e.startIndex+a,d=this.props.getKey?this.props.getKey(l,u):l&&l.key;null!==d&&void 0!==d||(d=u);n.push(r.createElement("div",{role:o,className:"ms-List-cell",key:d,"data-list-index":a+e.startIndex,"data-automationid":"ListCell"},i(l,e.startIndex+a)))}return r.createElement("div",{className:"ms-List-page",key:e.key,ref:e.key,style:s,role:"presentation"},n)};t.prototype._getPageStyle=function(e){var t,i=this.props.getPageStyle;i&&(t=i(e));e.items||((t=t||{}).height=e.height);return t};t.prototype._onFocus=function(e){for(var t=e.target;t!==this.refs.surface;){var i=t.getAttribute("data-list-index");if(i){this._focusedIndex=Number(i);break}t=o.getParent(t)}};t.prototype._onScroll=function(){this._requiredWindowsAhead=0;this._requiredWindowsBehind=0};t.prototype._onAsyncScroll=function(){this._updateRenderRects();this._materializedRect&&s(this._requiredRect,this._materializedRect)||this._updatePages()};t.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,i=e.renderedWindowsBehind,r=this,o=r._requiredWindowsAhead,n=r._requiredWindowsBehind,s=Math.min(t,o+1),a=Math.min(i,n+1);if(s!==o||a!==n){this._requiredWindowsAhead=s;this._requiredWindowsBehind=a;this._updateRenderRects();this._updatePages()}(t>s||i>a)&&this._onAsyncIdle()};t.prototype._onAsyncResize=function(){this.forceUpdate()};t.prototype._updatePages=function(e){var t=this,i=e||this.props,r=i.items,o=i.startIndex,n=i.renderCount;n=this._getRenderCount(e);this._requiredRect||this._updateRenderRects(e);var s=this._buildPages(r,o,n),a=this.state.pages;this.setState(s,function(){if(t._updatePageMeasurements(a,s.pages)){t._materializedRect=null;if(t._hasCompletedFirstRender)t._onAsyncScroll();else{t._hasCompletedFirstRender=!0;t._updatePages()}}else t._onAsyncIdle()})};t.prototype._updatePageMeasurements=function(e,t){for(var i={},r=!1,o=(this._getRenderCount(),0);o<e.length;o++)(n=e[o]).items&&(i[n.startIndex]=n);for(o=0;o<t.length;o++){var n=t[o];if(n.items){r=this._measurePage(n)||r;i[n.startIndex]?delete i[n.startIndex]:this._onPageAdded(n)}}for(var s in i)i.hasOwnProperty(s)&&this._onPageRemoved(i[s]);return r};t.prototype._measurePage=function(e){var t=!1,i=this.refs[e.key],r=this._cachedPageHeights[e.startIndex];if(i&&(!r||r.measureVersion!==this._measureVersion)){var o={width:i.clientWidth,height:i.clientHeight};if(o.height||o.width){t=e.height!==o.height;e.height=o.height;this._cachedPageHeights[e.startIndex]={height:o.height,measureVersion:this._measureVersion};this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+o.height)/(this._totalEstimates+1));this._totalEstimates++}}return t};t.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)};t.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)};t.prototype._buildPages=function(e,t,i){for(var r=o.assign({},p),n=1,s=[],l=0,u=null,d=this._focusedIndex,c=t+i,m=0===this._estimatedPageHeight&&!this.props.getPageHeight,f=this,h=t;h<c&&"break"!==function(i){n=f._getItemCountForPage(i,f._allowedRect);var p=f._getPageHeight(i,n,f._surfaceRect),h=l+p-1,g=o.findIndex(f.state.pages,function(e){return e.items&&e.startIndex===i})>-1,v=h>=f._allowedRect.top&&l<=f._allowedRect.bottom,b=h>=f._requiredRect.top&&l<=f._requiredRect.bottom,y=!m&&(b||v&&g),_=d>=i&&d<i+n,S=i===t;if(y||_||S){if(u){s.push(u);u=null}var x=Math.min(n,c-i),I=f._createPage(null,e.slice(i,i+x),i);I.top=l;I.height=p;s.push(I);b&&a(r,{top:l,bottom:h,height:p,left:f._allowedRect.left,right:f._allowedRect.right,width:f._allowedRect.width})}else{u||(u=f._createPage("spacer-"+i,null,i,0));u.height=(u.height||0)+(h-l)+1;u.itemCount+=n}l+=h-l+1;if(m)return"break"}(h);h+=n);if(u){u.key="spacer-end";s.push(u)}this._materializedRect=r;return{pages:s,measureVersion:this._measureVersion}};t.prototype._getPageHeight=function(e,t,i){if(this.props.getPageHeight)return this.props.getPageHeight(e,i);var r=this._cachedPageHeights[e];return r?r.height:this._estimatedPageHeight||30};t.prototype._getItemCountForPage=function(e,t){var i=this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10;return i||10};t.prototype._createPage=function(e,t,i,r,o){e=e||"page-"+i;if(t)for(var n=0;n<t.length;n++)t[n]=t[n]||null;return{key:e,startIndex:void 0===i?-1:i,itemCount:void 0===r?t?t.length:0:r,items:t,style:o||{},top:0,height:0}};t.prototype._getRenderCount=function(e){var t=e||this.props,i=t.items,r=t.startIndex,o=t.renderCount;return void 0===o?i?i.length-r:0:o};t.prototype._updateRenderRects=function(e,t){var i=e||this.props,r=i.renderedWindowsAhead,o=i.renderedWindowsBehind,s=this.state.pages,a=(this._getRenderCount(e),this._surfaceRect),l=this._scrollElement&&this._scrollElement.scrollHeight,u=this._scrollElement?this._scrollElement.scrollTop:0;if(t||!s||!this._surfaceRect||!l||l!==this._scrollHeight||Math.abs(this._scrollTop-u)>this._estimatedPageHeight/3){a=this._surfaceRect=f(this.refs.surface);this._scrollTop=u}!t&&l&&l===this._scrollHeight||this._measureVersion++;this._scrollHeight=l;var d=Math.max(0,-a.top),c={top:d,left:a.left,bottom:d+window.innerHeight,right:a.right,width:a.width,height:window.innerHeight};this._requiredRect=n(c,this._requiredWindowsBehind,this._requiredWindowsAhead);this._allowedRect=n(c,o,r)};return t}(o.BaseComponent);g.defaultProps={startIndex:0,onRenderCell:function(e,t,i){return r.createElement("div",null,e&&e.name||"")},renderedWindowsAhead:2,renderedWindowsBehind:2};t.List=g});define("office-ui-fabric-react/lib/components/GroupedList/GroupedList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";var o={root:"root_78d8e162",group:"group_78d8e162",groupIsDropping:"groupIsDropping_78d8e162"};i.loadStyles([{rawString:".root_78d8e162{position:relative;font-size:12px}.root_78d8e162 BUTTON{background-color:transparent}.group_78d8e162{transition:background-color 267ms cubic-bezier(.445,.05,.55,.95)}.groupIsDropping_78d8e162{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.root_78d8e162 .ms-List-cell{min-height:38px}"}]);return o});define("office-ui-fabric-react/lib/utilities/decorators/withViewport",["require","exports","tslib","react","./BaseDecorator","../../Utilities"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=500,a=3;t.withViewport=function(e){return function(t){function o(){var e=t.call(this)||this;e._updateViewport=function(t){var i=e.state.viewport,r=e.refs.root,o=n.findScrollableParent(r),s=n.getRect(o),l=n.getRect(r);if((l.width!==i.width||s.height!==i.height)&&e._resizeAttempts<a){e._resizeAttempts++;e.setState({viewport:{width:l.width,height:s.height}},function(){e._updateViewport(t)})}else{e._resizeAttempts=0;t&&e._composedComponentInstance&&e._composedComponentInstance.forceUpdate()}};e._resizeAttempts=0;e.state={viewport:{width:0,height:0}};return e}i.__extends(o,t);o.prototype.componentDidMount=function(){this._onAsyncResize=this._async.debounce(this._onAsyncResize,s,{leading:!1});this._events.on(window,"resize",this._onAsyncResize);this._updateViewport()};o.prototype.componentWillUnmount=function(){this._events.dispose()};o.prototype.render=function(){var t=this.state.viewport,o=t.width>0&&t.height>0;return r.createElement("div",{className:"ms-Viewport",ref:"root",style:{minWidth:1,minHeight:1}},o&&r.createElement(e,i.__assign({ref:this._updateComposedComponentRef,viewport:t},this.props)))};o.prototype.forceUpdate=function(){this._updateViewport(!0)};o.prototype._onAsyncResize=function(){this._updateViewport()};return o}(o.BaseDecorator)}});define("office-ui-fabric-react/lib/utilities/decorators/BaseDecorator",["require","exports","tslib","../../Utilities"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this)||this;t._shouldUpdateComponentRef=!1;t._updateComposedComponentRef=t._updateComposedComponentRef.bind(t);return t}i.__extends(t,e);t.prototype._updateComposedComponentRef=function(e){this._composedComponentInstance=e;e?this._hoisted=r.hoistMethods(this,e):this._hoisted&&r.unhoistMethods(this,this._hoisted)};return t}(r.BaseComponent);t.BaseDecorator=o});define("office-ui-fabric-react/lib/common/DirectionalHint",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.topLeftEdge=0]="topLeftEdge";e[e.topCenter=1]="topCenter";e[e.topRightEdge=2]="topRightEdge";e[e.topAutoEdge=3]="topAutoEdge";e[e.bottomLeftEdge=4]="bottomLeftEdge";e[e.bottomCenter=5]="bottomCenter";e[e.bottomRightEdge=6]="bottomRightEdge";e[e.bottomAutoEdge=7]="bottomAutoEdge";e[e.leftTopEdge=8]="leftTopEdge";e[e.leftCenter=9]="leftCenter";e[e.leftBottomEdge=10]="leftBottomEdge";e[e.rightTopEdge=11]="rightTopEdge";e[e.rightCenter=12]="rightCenter";e[e.rightBottomEdge=13]="rightBottomEdge"}(t.DirectionalHint||(t.DirectionalHint={}))});define("odsp-next/controls/list/react/ReactBaseList",["require","exports","tslib","react","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/index","office-ui-fabric-react/lib/DetailsList","office-ui-fabric-react/lib/Utilities","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/SPOResourceKeys","./detailsList/ReactDetailsList.resx","@ms/odsp-utilities/lib/async/Promise","../interfaces/ColumnFieldType","../../listGroupHeader/BaseListHeaderViewModel","../../dragAndDrop/DropHelper","../../../resources/ControlResourceKeys","../../../resources/UtilityResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../columnsHeader/ColumnCommonUtilities","../../../bindings/contextMenu/ContextMenuBinding","@ms/odsp-utilities/lib/string/StringHelper","../../../providers/engagement/Engagement","../../../utilities/list/ListViewRenderHelper","../../../bindings/contextMenu/ContextMenuHelper","@ms/odsp-utilities/lib/performance/PerformanceCollection","../../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/scope/Scope","../columns/ListColumns"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T,D,k){"use strict";function P(e,t){return t.fieldType===m.DotDotDot?s.ColumnActionsMode.disabled:e&&t.name?s.ColumnActionsMode.hasDropdown:t.sortable||t.groupable||t.filterable?s.ColumnActionsMode.clickable:s.ColumnActionsMode.disabled}Object.defineProperty(t,"__esModule",{value:!0});var L=30,R=function(e){function t(t){var i=e.call(this,t)||this;i._logPerf=!1;i.resources=t.hostViewModel.resources;i.scope=new D.default;i.observables=i.scope.attach(new(i.resources.consume(o.observablesFactoryTypeResourceKey))({owner:i}));i.async=i.scope.attach(new(i.resources.consume(o.asyncTypeResourceKey))(i));i.events=i.scope.attach(new(i.resources.consume(o.eventGroupTypeResourceKey))(i));i._defaultClickActionsByKey={};i._missingIndex=-1;i._canSelectItem=i._canSelectItem.bind(i);i.selection=new n.Selection({onSelectionChanged:i._onSelectionChange.bind(i),getKey:i._getKey,canSelectItem:i._canSelectItem});i._keyToSubscriptionHash={};i._keyToObservableHash={};if(!t.disableDrop){i._dragDropEvents={canDrop:i._canDrop.bind(i),canDrag:i._canDrag.bind(i),onDragStart:i._onDragStart.bind(i)};i.rowElementEventMap=[{eventName:"od-dragEnter",callback:i._onDragEnter.bind(i)},{eventName:"od-processDrop",callback:i._onProcessDrop.bind(i)}];i._dropHelper=i.resources.consume(h.resourceKey)}i.onItemInvoked=i.onItemInvoked.bind(i);i._onRenderMissingItem=i._onRenderMissingItem.bind(i);i._getAriaLabel=i._getAriaLabel.bind(i);i._getGroupItemLimit=i._getGroupItemLimit.bind(i);i._isGroupLoading=i._isGroupLoading.bind(i);i._onActiveItemChanged=i._onActiveItemChanged.bind(i);i._onShowAll=i._onShowAll.bind(i);i._onToggleCollapseAll=i._onToggleCollapseAll.bind(i);i._onToggleCollapse=i._onToggleCollapse.bind(i);i._onColumnClick=i._onColumnClick.bind(i);i._isMenuOpen=i.observables.create(!1);i._viewRowLimit=L;i._dataManager=i.resources.consume(l.dataManager.optional);i._dataManager&&i._dataManager.itemsPerGroup(i._viewRowLimit);i._selectionHelper=i.resources.consume(T.resourceKey);var r=i.resources.consume(b.platformDetection);i._isMobileView=r.isMobile&&!!i.resources.consume(g.useMobileList.optional);i._mobile=i.resources.consume(v.mobile);i._canModifySchema=i.resources.consume(g.canModifySchema.optional);i._mayEnableDeferredBehaviors=i.observables.create(!1);return i}i.__extends(t,e);t.prototype.componentWillMount=function(){var e=this,t={rateLimit:{timeout:0,method:"notifyWhenChangesStop"}};this.observables.compute(this._computeItems).extend(t);this.observables.compute(this._computeSelectionMode).extend(t);this.observables.compute(this._computeColumns).extend(t);var i=this.resources.consume(u.bundleLoader.optional);this.observables.backgroundCompute(function(){if((!i||i.isPageLoaded())&&e._mayEnableDeferredBehaviors()){C.default.mark("EUPL.ReactDetailsList.enableDeferredBehaviors");e.setState(function(e){return{items:e.items&&e.items.slice(),enableDeferredBehaviors:!0}})}})};t.prototype.componentDidUpdate=function(){C.default.mark("EUPL.ReactDetailsList.componentDidUpdate");if(this._logPerf&&this.state.items&&this.state.items.length>0){this._logPerf=!1;this._markLayoutRenderComplete()}};t.prototype.componentDidMount=function(){var e=this;C.default.mark("EUPL.ReactDetailsList.componentDidMount");var t=this.props,i=t.selectionModel,r=t.isLoading;if(this._logPerf){this._logPerf=!1;this._markLayoutRenderComplete()}r&&r(!1);this.scope.attach(i.selection.subscribe(function(t){if(e._shouldUpdateSelection())if(e.state.selectionMode===n.SelectionMode.multiple&&(i.isAllSelected()&&!e.selection.isAllSelected()||0===i.selectedCount.peek()&&e.selection.isAllSelected()))e.selection.toggleAllSelected();else{e.selection.setChangeEvents(!1);e.selection.setAllSelected(!1);for(var r=0,o=t;r<o.length;r++){var s=o[r];e.selection.setKeySelected(i.getItemKey(s),!0,!1)}e.selection.setChangeEvents(!0)}}))};t.prototype.componentWillUnmount=function(){this.scope.dispose()};t.prototype.onItemInvoked=function(e,t,i){var r=e?e.key:void 0;if(r){var o=(this._defaultClickActionsByKey[r]||[])[0];if(o){if(o.isAvailable.peek()){o.execute(i).done();i.preventDefault();i.stopPropagation()}}else{var n=this.resources.consume(g.actionMap),s=new(this.resources.injected(n.DefaultClickAction,{injectChildResourceScope:!0}))({item:this._keyToObservableHash[r]||this.observables.create(e),userInvokedItem:!0,sourceEngagement:"ItemRow.Click"}),a=void 0;if(s.isAvailable.peek()){a=s.execute(i);i.preventDefault();i.stopPropagation()}var l=function(){return s.dispose()};p.default.as(a).done(l,l)}}};t.prototype.setupDefaultClickAction=function(e){var t=this,i=e?e.key:void 0,r=this.observables.create(e),o=this.resources.consume(g.actionMap),n=this.scope.attach(new(this.resources.injected(o.DefaultClickAction,{injectChildResourceScope:!0}))({item:r,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"}));i&&(this._defaultClickActionsByKey[i]||(this._defaultClickActionsByKey[i]=[])).push(n);return{isAvailable:n.isAvailable,update:function(e){r(e)},dispose:function(){if(i){var e=t._defaultClickActionsByKey[i];if(e){var r=e.indexOf(n);r>-1&&e.splice(r,1);e.length||delete t._defaultClickActionsByKey[i]}}n.dispose()}}};t.prototype._onRenderMissingItem=function(e){var t=this,i=this.props.itemSet.peek(),r=i&&i.content.peek(),o=r&&r.partialResultStatus;if(-1===this._missingIndex&&(void 0===o||0===o)){this._missingIndex=e;this.props.requiredRange({start:e,end:e+1});this._missingIndexTimeoutId=this.async.setTimeout(function(){t._missingIndex=-1;t.forceUpdate()},5e3)}return null};t.prototype._getKey=function(e,t){return e?this.props.selectionModel.getItemKey(this._keyToObservableHash[e.key]):String(t)};t.prototype._getAriaLabel=function(e){return I.getRowAriaLabel(e)};t.prototype._canSelectItem=function(e){return this.props.selectionModel&&this.props.selectionModel.canSelectItem(this._keyToObservableHash[e.key])};t.prototype._onActiveItemChanged=function(e,t,i){var r=this.props.selectionModel;void 0!==t&&r.setIndexFocus(t)};t.prototype._isGroupLoading=function(e){var t=this.state.items;return e&&!e.children&&!t[e.startIndex]};t.prototype._getGroupItemLimit=function(e){var t=this.state.items;return e?this._isGroupLoading(e)?Math.min(e.count,3):e.isShowingAll?e.count:Math.min(e.count,this._viewRowLimit):t.length};t.prototype._onShowAll=function(e){var t=this;f.filterAndExpandGroup(this.resources,e.data,null,function(e){t.scope.attach(e)})};t.prototype._onToggleCollapse=function(e){var t=e.data;if(t&&t.state){var i=!t.state.peek().isCollapsed;t.state({isCollapsed:i})}};t.prototype._onToggleCollapseAll=function(e){var t=this.props.itemSet.peek().content.peek().groupings,i=t&&t.length>0?t[0]:null;if(i){i.isAllCollapsed(e);i.itemGroups.forEach(function(t){t.state({isCollapsed:e})});this._dataManager&&this._dataManager.expandAll(!e)}};t.prototype._onRenderGroupHeaderFooter=function(e,t){return e.group.data.isPlaceholder?null:t(e)};t.prototype._markLayoutRenderComplete=function(){var e=this,t=this.props.onLayoutRenderComplete;t&&t();this.async.setTimeout(function(){e._mayEnableDeferredBehaviors(!0)},0)};t.prototype._computeColumns=function(){var e=this,t=this.props,i=t.itemSet,r=t.columnActionModeAllowChevron,o=i();if(o){var n=o.schema();if(n&&!o.isPlaceholder){var s=n.filter(function(e){return e.isVisible}).map(function(t){return{key:t.key,name:t.name,className:"od-DetailsRow-cell--"+m[t.fieldType],headerClassName:"od-DetailsHeader-cell--"+m[t.fieldType],iconClassName:{type:"ms-Icon--Page od-DetailsListHeader-FileTypeIcon"}[t.key],isIconOnly:t.isIcon||"_calloutInvoker"===t.key,fieldName:t.key,minWidth:t.minWidth||t.width,maxWidth:t.width,isCollapsable:t.isCollapsable,isResizable:void 0!==t.resizable?t.resizable:!!t.name,isSortable:t.sortable,isSorted:t.isSorted,isSortedDescending:!t.isAscending,isFilterable:t.filterable&&!!t.name,isFiltered:t.isFiltered&&t.isFiltered.peek(),isGroupable:t.groupable,isGrouped:t.isGrouped,isRowHeader:t.isRowHeader,ariaLabel:e._computeAriaLabel(t),data:t,columnActionsMode:P(r,t),onColumnClick:e._onColumnClick}});this._canModifySchema&&this._canModifySchema.peek()&&s.push({key:"__newColumnHeaderCommand",ariaLabel:c.strings.addColumnAriaLabel,name:"",headerClassName:"od-DetailsHeader-addColumn",iconClassName:"ms-Icon--Add od-DetailsListHeader-AddNewField",fieldName:"__newColumnHeaderCommand",minWidth:24,onColumnClick:this._onColumnClick});C.default.mark("EUPL.ReactDetailsList._computeColumns.setState  : column count("+s.length+")");this.setState({columns:s})}}};t.prototype._computeItems=function(){var e=this,t=this.props.itemSet();if(t){var i=t.key,r=t.content();if(r){this.props.isLoading&&this.props.isLoading(!0);this._missingIndex=-1;this.async.clearTimeout(this._missingIndexTimeoutId);this._keyToObservableHash={};var o=r.items.map(function(t){if(t){var i=t.peek();e._keyToObservableHash[i.key]=t;return i}return null}),n=r.groupings,s=!!(n&&n.length>0&&n[0].isAllCollapsed)&&n[0].isAllCollapsed.peek(),a=n&&n.length>0?this._getGroups(n[0].itemGroups,s):null;a&&this._updateViewItemLimit();C.default.mark("EUPL.ReactDetailsList._computeItems.setState : item count("+o.length+")");this._logPerf=!0;this.setState({items:o,groups:a,setKey:i,isAllCollapsed:s})}}};t.prototype._updateViewItemLimit=function(){var e=this.resources.consume(g.currentView.optional),t=e&&e.peek();if(t&&t.rowLimit){this._viewRowLimit=t.rowLimit;this._dataManager&&this._dataManager.itemsPerGroup.peek()!==this._viewRowLimit&&this._dataManager.itemsPerGroup(this._viewRowLimit)}};t.prototype._computeSelectionMode=function(){var e=this.props.selectionModel,t=n.SelectionMode.multiple;this._isMobileView&&(t=this._mobile.showItemCheck()||e.selection().length>0?n.SelectionMode.multiple:n.SelectionMode.none);t===n.SelectionMode.multiple&&1===e.mode&&(t=!e.maximumSelectedCount||e.maximumSelectedCount>0?n.SelectionMode.single:n.SelectionMode.none);var i=this.resources.consume(d.listContext.optional);i&&i.rawListSchema&&"0"===i.rawListSchema.TabularView&&(t=n.SelectionMode.none);C.default.mark("EUPL.ReactDetailsList._computeSelectionMode.setState");this.setState({selectionMode:t})};t.prototype._computeAriaLabel=function(e){if(!e.name||P(this.props.columnActionModeAllowChevron,e)===s.ColumnActionsMode.disabled)return"";var t="",i="",r="",o="type"===e.key?c.strings.typeColumnHeaderLabel:e.name;e.isFiltered&&e.isFiltered()&&(i=S.format(c.strings.columnFilterAriaLabel,o,e.filterValues()));if(e.isSorted){var n=y.getSortMenuStrings(e),a=n.ascendingString,l=n.descendingString,u=e.isAscending?a:l;t=S.format(c.strings.columnSortAriaLabel,o,u)}e.isGrouped&&(r=S.format(c.strings.columnGroupAriaLabel,o));return S.format(c.strings.columnCellAriaLabel,o,i,t,r)};t.prototype._getGroups=function(e,t,i){var r=this,o=null,n=c.strings.NoGroupName;e&&e.length>0&&(e[0].name||e[0].fieldSchema)&&(o=e.map(function(e){var i=e.fieldSchema?(e.fieldSchema.DisplayName||e.fieldSchema.Name)+": "+(e.name||n):e.name||n,o=e.state?e.state.peek().isCollapsed:t,s={key:e.groupingId,name:i,startIndex:e.startIndex,count:e.count,level:e.level,isSelected:!1,isCollapsed:o,isShowingAll:!1,data:e,hasMoreData:e.hasMoreData,isDropEnabled:!r.props.disableDrop&&e.isDropEnabled,ariaLabel:r._computeGroupAriaLabel(i,e.count,o)};s.children=e.children?r._getGroups(e.children,t,s):null;return s}));return o};t.prototype._computeGroupAriaLabel=function(e,t,i){var r=S.pluralSelect(t,S.format(c.strings.itemsCountSingular,t),S.format(c.strings.itemCountMulti,t));return S.format(c.strings.groupHeaderAriaLabel,e,r,i?c.strings.collapsedText:c.strings.expandedText)};t.prototype._shouldUpdateSelection=function(){var e=this.props.selectionModel,t=!1;if(e.selectedCount.peek()!==this.selection.count||0===e.mode&&e.isAllSelected.peek()!==this.selection.isAllSelected())t=!0;else if(!this.selection.isAllSelected())for(var i=0,r=e.selection.peek();i<r.length;i++){var o=r[i];if(!this.selection.isKeySelected(e.getItemKey(o))){t=!0;break}}return t};t.prototype._onDragEnter=function(e,t){var i=t.args;if(!(i&&i.dragData&&i.dropSourceElement&&e.data))return!0;if(!this._canDrop(e,{data:i.dragData.item,index:i.dragData.itemIndex}))return!0;i.dropTargetData||1!==i.dragData.type&&0!==i.dragData.type||(i.dropTargetData={targetName:e.data.name});return!0};t.prototype._onProcessDrop=function(e,t){var i=t.args;if(!(i&&i.dragData&&i.dropSourceElement&&e.data))return!0;if(!this._canDrop(e,{data:i.dragData.item,index:i.dragData.itemIndex}))return!0;var r=e.data,o=!1,n=!1;if(e.isGroup){i.dragData.metadata={group:e.data.data};i.dragData.itemSet=this.props.itemSet.peek();o=!0;n=!0;this._dataManager&&(r=this._dataManager.item.peek())}if(!i.isHandled&&this._dropHelper.processDrop(i.dragData,r,o,n)){i.isHandled=!0;return!1}return!0};t.prototype._canDrop=function(e,t){var i=!1;if(e)if(e.isGroup){var r=e.data;if(r){var o=!1;if(t&&!t.isGroup){var n=t.index;o=n>=r.startIndex&&n<r.startIndex+r.count}i=r.isDropEnabled&&!o}}else{var s=e.data;i=s&&s.isDropEnabled}return i};t.prototype._canDrag=function(e){return!0};t.prototype._onDragStart=function(e,t,i,r){var o=this;r.dragData={type:1,itemSet:this.props.itemSet.peek(),item:e,itemIndex:t,selection:{length:this.props.selectionModel.selectedCount.peek(),resolve:function(){return o._selectionHelper.resolveSelection()},resources:this.props.selectionModel.resources}}};t.prototype._onSelectionChange=function(){var e=this.props.selectionModel;if(this._shouldUpdateSelection())if(this.state.selectionMode===n.SelectionMode.multiple&&(!e.isAllSelected()&&this.selection.isAllSelected()||e.isAllSelected()&&0===this.selection.count))e.toggleSelectAll();else{for(var t=this.selection.getSelection(),i=[],r=0,o=t;r<o.length;r++){var s=o[r],a=this._getKey(s);i.push(a)}e.setSelectedKeys(i);1===this.selection.getSelectedCount()&&t}};t.prototype._onColumnClick=function(e,t){var i=this,r=e.nativeEvent;if(this._isMenuOpen.peek())this._isMenuOpen(!1);else if(t.columnActionsMode!==s.ColumnActionsMode.disabled){var o,n=this.scope.attach(new D.default),a=this.resources.consume(x.resourceKey);if("__newColumnHeaderCommand"===t.fieldName){a.logData({name:"OpenPlusMenu.ColumnHeader.Click"});o=this.resources.consumeAsync(k.addColumnCommandHelperTypeResourceKey.local).then(function(e){return new(n.attached(e))({engagementName:".ColumnHeader",includeColumnEditor:!0}).commands})}else{a.logData({name:"OpenContextMenu.ColumnHeader.Click"});o=this.resources.consumeAsync(k.columnMenuHelperTypeResourceKey.local).then(function(e){return new(n.attached(e))({column:t.data,engagementName:".ColumnHeader"}).commands})}o.done(function(e){var t=n.attach(new(i.resources.injected(w))({items:e,point:y.MENU_OFFSET,anchorElement:r.target,dismissOnClick:!0,isMenuOpen:i._isMenuOpen}));_.createContextMenu(r,t,i.props.hostViewModel);i._isMenuOpen(!0)});n.attach(this._isMenuOpen.subscribe(function(e){e||n.dispose()}))}};return t}(r.Component);i.__decorate([a.autobind],R.prototype,"_getKey",null);t.ReactBaseList=R;t.default=R});define("odsp-next/controls/listGroupHeader/BaseListHeaderViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../../bindings/focus/DelayedHasFocusBinding","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,i,r,o,n,s,a,l,u){"use strict";return function(t){function o(e){var i=t.call(this,e)||this;i.group=e.group;i.selectionModel=i.resources.consume(n.itemsSelection);i.isSelected=r.observable(!1);i.isFocused=r.observable(!1);i.isFocused.subscribe(function(e){i.onFocusChange(e)});i.tabindex=i.createPureComputed(function(){return i.isFocused()?0:-1});i._updateSelectionSubscription(e.key);i.addBindingHandlers({keyboard:l,delayedHasFocus:a.default});return i}i.__extends(o,t);o.filterAndExpandGroup=function(t,i,r,o){var a=null;if(i.fieldSchema){var l=t.consume(s.dataManager);l.requiredGroup(null);l.expandAll(!0);u.loadModule({require:e,path:"@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper"}).then(function(e){var s=t.consume(n.currentItemSet),u=s&&s.peek().content.peek().groupings,d=u&&u.length&&u[0].itemGroups,c=e.getFilterDetails(i,d),p=t.consume(n.actionMap);a=new(t.injected(p.FilterAction))({field:c.fields,value:c.values,isFilterOn:!0,clearExistingFilters:l.supportsNestedGroups&&l.supportsNestedGroups.peek()});o&&o(a);a.execute(r)})}if(r){r.stopPropagation();r.preventDefault()}return!1};o.prototype.filterByGroupAndExpand=function(e,t){return o.filterAndExpandGroup(e.resources,e.group,t,function(t){e.addDisposable(t)})};o.prototype.onFocusChange=function(e){};o.prototype.onInvoke=function(e){return!0};o.prototype.dispose=function(){t.prototype.dispose.call(this);this._updateSelectionSubscription(null)};o.prototype._updateSelectionSubscription=function(e){if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,this))};return o}(o.default)});define("odsp-next/controls/columnsHeader/ColumnCommonUtilities",["require","exports","../../bindings/beakAdorner/BeakAdornerBinding","@ms/odsp-utilities/lib/math/Point","./ColumnsHeader.resx","@ms/odsp-list-utilities/lib/ContextualMenu/ColumnUtilities"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MENU_OFFSET=new r.default(0,i.size/2+12);t.getSortMenuStrings=function(e){return n.getSortMenuStrings(e,o.strings)};t.getFieldName=function(e){return e?e.internalName||e.key:null}});define("@ms/odsp-list-utilities/lib/ContextualMenu/ColumnUtilities",["require","exports","@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SPListItemEnums"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="Last_x0020_Modified",o="Created_x0020_Date";t.getSortMenuStrings=function(e,t){var n="",s="";switch(e.fieldType){case i.ColumnFieldType.DateTime:n=t.columnMenuSortAscendingDate;s=t.columnMenuSortDescendingDate;break;case i.ColumnFieldType.Number:case i.ColumnFieldType.Currency:case i.ColumnFieldType.Counter:case i.ColumnFieldType.FileSize:case i.ColumnFieldType.Ratings:case i.ColumnFieldType.AverageRating:case i.ColumnFieldType.Likes:n=t.columnMenuSortAscendingNumber;s=t.columnMenuSortDescendingNumber;break;case i.ColumnFieldType.Text:case i.ColumnFieldType.Name:case i.ColumnFieldType.Title:case i.ColumnFieldType.Note:case i.ColumnFieldType.Taxonomy:case i.ColumnFieldType.User:n=t.columnMenuSortAscendingText;s=t.columnMenuSortDescendingText;break;case i.ColumnFieldType.Boolean:case i.ColumnFieldType.ComplianceRecordFlag:n=t.columnMenuSortAscendingBoolean;s=t.columnMenuSortDescendingBoolean;break;case i.ColumnFieldType.Lookup:if(e.internalName===r||e.internalName===o){n=t.columnMenuSortAscendingDate;s=t.columnMenuSortDescendingDate}else{n=t.columnMenuSortAscending;s=t.columnMenuSortDescending}break;case i.ColumnFieldType.Attachments:n=t.columnMenuSortAscendingAttachments;s=t.columnMenuSortDescendingAttachments;break;default:n=t.columnMenuSortAscending;s=t.columnMenuSortDescending}return{ascendingString:n,descendingString:s}}});define("odsp-next/controls/list/columns/ListColumns",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.columnMenuHelperTypeResourceKey=new r.ResourceKey({name:e("module").id+".columnMenuHelperType",loader:new r.AliasResourceLoader(function(){return i.loadModuleExport({require:e,path:"../../columnsHeader/ColumnMenuHelper",getExport:function(e){return e.typeResourceKey.local}})})});t.addColumnCommandHelperTypeResourceKey=new r.ResourceKey({name:e("module").id+".addColumnCommandHelperType",loader:new r.AliasResourceLoader(function(){return i.loadModuleExport({require:e,path:"../../columnsHeader/AddColumnCommandHelper",getExport:function(e){return e.typeResourceKey.local}})})})});define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index",["require","exports","./ReactDeferredComponent"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i)});define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/ReactDeferredComponent",["require","exports","tslib","react","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/events/PLT.event","@ms/odsp-utilities/lib/performance/PerformanceCollection","office-ui-fabric-react/lib/Utilities"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this,t)||this;i._mounted=!1;i.state={ComponentModule:void 0};i._pltEventHandler=function(e){n.PLT.isTypeOf(e)&&i._deferLoadComponent()};void 0!==t.waitPLT&&!t.waitPLT||s.default.pageLoaded()?i._deferLoadComponent():o.Manager.addLogHandler(i._pltEventHandler);return i}i.__extends(t,e);t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?r.createElement(t,i.__assign({ref:function(t){t&&a.hoistMethods(e,t)}},this.props.props)):null};t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)};t.prototype._deferLoadComponent=function(){var e=this;!this.state.ComponentModule&&this.props.moduleLoader&&this.props.modulePath&&this.props.moduleLoader.load(this.props.modulePath).then(function(t){e.props.moduleLoader.parse&&(t=e.props.moduleLoader.parse(t));e._mounted?e.setState({ComponentModule:t}):e.state={ComponentModule:t};o.Manager.removeLogHandler(e._pltEventHandler)})};return t}(r.Component);t.ReactDeferredComponent=l});define("odsp-next/controls/list/react/detailsList/fields/CustomFormatterRenderer",["require","exports","react","../../../../../resources/SPOResourceKeys","../../../interfaces/ColumnFieldType","./CustomFormatterRenderer.resx"],function(e,t,i,r,o,n){"use strict";function s(e){for(var t={},i=e.consume(r.listContext).listSchema,n=0;n<i.length;n++)t[i[n].key]=o[i[n].fieldType];return t}Object.defineProperty(t,"__esModule",{value:!0});t.customFormatterRenderer=function(e,t,r,o){var a=window.CustomFormatter,l=s(o.resources),u={__html:""};if(a){var d=new a({fieldRendererFormat:r.customFormatter,row:e.properties,currentFieldName:r.key,rowSchema:l,errorStrings:n.strings,pageContextInfo:window._spPageContextInfo});u.__html=d.evaluate()}return i.createElement("div",{dangerouslySetInnerHTML:u})}});define("odsp-next/controls/list/react/detailsList/fields/FieldMap",["require","exports","./DotDotDotRenderer","./FileTypeIconRenderer","./FileSizeRenderer","./NameRenderer","./TextRenderer","./SharedRenderer","./UserRenderer","./LikeRenderer","./AttachmentsRenderer","./UrlRenderer","./ImageRenderer","./LookupRenderer","./DataBarRenderer","./DateRenderer","./TitleRenderer","./RatingRenderer","./HashtagRenderer","./TaxonomyRenderer","./WorkflowRenderer","./SharedWithRenderer","./CustomRenderer","./ComplianceRecordFlagRenderer","./ActivityRenderer","./ClientSideCustomRenderer","./FileActivityRenderer"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v,b,y,_,S,x,I,w,C,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fieldMap={Activity:w.activityRenderer,Attachments:d.attachmentsRenderer,AverageRating:v.ratingRenderer,Boolean:s.textRenderer,Choice:s.textRenderer,ClientSideCustom:C.clientSideCustomRenderer,ComplianceRecordFlag:I.complianceRecordFlagRenderer,Computed:s.textRenderer,Counter:s.textRenderer,Currency:s.textRenderer,Custom:x.customRenderer,DateTime:h.dateRenderer,DotDotDot:i.dotDotDotRenderer,FileActivity:T.fileActivityRenderer,FileIcon:r.fileTypeIconRenderer,FileSize:o.fileSizeRenderer,Hashtag:b.hashtagRenderer,Hyperlink:c.urlRenderer,Image:p.imageRenderer,LikedBy:u.likeRenderer,Likes:u.likeRenderer,Lookup:m.lookupRenderer,Name:n.nameRenderer,Note:s.textRenderer,Number:s.textRenderer,ProgressBar:f.dataBarRenderer,RatedBy:v.ratingRenderer,Ratings:v.ratingRenderer,Shared:a.sharedRenderer,SharedWith:S.sharedWithRenderer,Tag:s.textRenderer,Taxonomy:y.taxonomyRenderer,Text:s.textRenderer,Title:g.titleRenderer,User:l.userRenderer,WorkflowStatus:_.workflowRenderer}});define("odsp-next/controls/list/react/detailsList/fields/DotDotDotRenderer",["require","exports","tslib","react","../../../../../providers/engagement/Engagement","../ReactDetailsList.resx","@ms/odsp-utilities/lib/logging/ABExperiment","../../../../../utilities/killSwitch/KillSwitch","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers","../ReactDetailsList.css"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dotDotDotRenderer=function(e,t,u,d){var c={isDisabled:e.properties.isDisabled||d.isDisabled,ariaLabel:n.strings.showDetailsAriaLabel,onClick:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("contextmenu",!0,!0,e);e.currentTarget.dispatchEvent(t);var i=void 0;a.default.isActivated("93799f5c-4dbd-494f-acfd-7c538337c196","12/09/2016","Dot3Experiment")||(i=new s.ABExperiment({name:"Dot3ShowTo10",startDate:"12/09/2016",segmentPopulation:.1}));d.resources.consume(o.resourceKey).logData({name:"Ellipsis.Callout.Click",experiment:i});e.preventDefault();e.stopPropagation()}};return r.createElement(l.DotDotDotRenderer,i.__assign({},c))}});define("@ms/odsp-list-utilities/lib/Renderers/FieldRenderers",["require","exports","./BaseText","./DateRenderer","./DotDotDotRenderer","./FileTypeIconRenderer","./NameRenderer","./TextRenderer","./TitleRenderer","./FileSizeRenderer","./SharedRenderer","./TaxonomyRenderer","./UrlRenderer","./UserRenderer"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=i.BaseText;t.DateRenderer=r.DateRenderer;t.DotDotDotRenderer=o.DotDotDotRenderer;t.FileTypeIconRenderer=n.FileTypeIconRenderer;t.NameRenderer=s.NameRenderer;t.TextRenderer=a.TextRenderer;t.TitleRenderer=l.TitleRenderer;t.FileSizeRenderer=u.FileSizeRenderer;t.SharedRenderer=d.SharedRenderer;t.TaxonomyRenderer=c.TaxonomyRenderer;t.UrlRenderer=p.UrlRenderer;t.UserRenderer=m.UserRenderer});define("@ms/odsp-list-utilities/lib/Renderers/BaseText",["require","exports","react"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,r=e.isDisabled,o=e.noTextRender,n=e.ariaLabel,s=(e.title,e.children);t=t||" ";n=n||t;var a="";r&&(a="od-FieldRenderer--disabled");return i.createElement("div",{"aria-label":o?n:void 0,className:a},o?null:i.createElement("span",null,t),s)}});define("@ms/odsp-list-utilities/lib/Renderers/DateRenderer",["require","exports","react","./DateRenderer.scss"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=36e5,o="";t.DateRenderer=function(e){var t=e.text,n=e.dateValue,s=e.indicatorEnabled,a=e.isDisabled,l=e.ariaLabel;l=l||t;var u=!1;if(n&&s){var d=new Date(n).getTime();d&&Math.abs(Date.now()-d)<=r&&(u=!0)}var c=a?"od-FieldRenderer--disabled":"";return i.createElement("div",{className:c},u&&i.createElement("span",{className:"od-DateField--newItem"},o),t)}});define("@ms/odsp-list-utilities/lib/Renderers/DateRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-DateField--newItem{color:#107c10;margin-right:3px}"}])});define("@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer",["require","exports","react","./DotDotDotRenderer.scss"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DotDotDotRenderer=function(e){var t=e.onClick,r=e.isDisabled,o=e.ariaLabel,n="ms-Icon ms-Icon--More";r&&(n+=" od-FieldRenderer--disabled");return i.createElement("button",{className:"od-FieldRenderer-dot",onClick:t,"aria-label":o,"aria-haspopup":"true"},i.createElement("i",{className:n}))}});define("@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-DetailsList BUTTON.od-FieldRenderer-dot{display:block;position:relative;width:36px;height:36px;line-height:36px;text-align:center;outline:0;border:none;background-color:transparent;margin:0 -10px;padding:0;color:inherit;font-size:14px;opacity:0;cursor:pointer}.ms-DetailsList BUTTON.od-FieldRenderer-dot:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od--isMobile .ms-DetailsList BUTTON.od-FieldRenderer-dot{opacity:1}.od--isVisible .ms-DetailsList BUTTON.od-FieldRenderer-dot{opacity:1}.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-dot,.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-dot,.od--isNonMobile .od-FieldRenderer-dot:focus{opacity:1}.ms-DetailsRow-cell.od-DetailsRow-cell--DotDotDot{padding:0;overflow:visible}"}])});define("@ms/odsp-list-utilities/lib/Renderers/FileTypeIconRenderer",["require","exports","react"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileTypeIconRenderer=function(e){var t=e.width,r=e.iconUrl,o=e.iconTitle,n=e.overlayUrl,s=e.isDisabled,a=e.tooltipText,l=e.isClickable,u=e.onClick,d=e.ariaLabel,c=void 0===d?o:d,p={width:t,height:t},m=s?"FileTypeIcon-icon od-FieldRenderer--disabled":"FileTypeIcon-icon",f=a?o+"\n"+a:o,h=i.createElement("img",{className:m,title:n?null:o,src:r,style:p});if(n){var g=s?"FileTypeIcon-overlay od-FieldRenderer--disabled":"FileTypeIcon-overlay",v=i.createElement("img",{className:g,src:n}),b=l?"FileTypeIcon FileTypeIcon--clickable":"FileTypeIcon";return i.createElement("div",{className:b,"data-is-focusable":!0,title:f,"aria-label":c,onClick:u},h,v)}return i.createElement("div",{className:"FileTypeIcon","aria-label":o},h)}});define("@ms/odsp-list-utilities/lib/Renderers/NameRenderer",["require","exports","react","office-ui-fabric-react/lib/Link","./NameRenderer.scss"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NameRenderer=function(e){var t=e.linkUrl,o=e.linkText,n=e.onClick,s=e.isDisabled,a=e.ariaLabel;a=a||o;var l="od-FieldRenderer-name";if(s){l+=" od-FieldRenderer--disabled";t="javascript:;"}return i.createElement(r.Link,{className:l,href:t,onClick:n,title:o},o)}});define("@ms/odsp-list-utilities/lib/Renderers/NameRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-DetailsRow-cell .ms-Link.od-FieldRenderer-name{font-size:14px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";display:inline}.ms-DetailsRow-cell .ms-Link.od-FieldRenderer-name:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.ms-DetailsRow-cell .ms-Link.od-FieldRenderer-name:focus,.ms-DetailsRow-cell .ms-Link.od-FieldRenderer-name:visited{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});define("@ms/odsp-list-utilities/lib/Renderers/TextRenderer",["require","exports","react","./BaseText","@ms/odsp-utilities/lib/encoding/Sanitize","./TextRenderer.scss"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextRenderer=function(e){var t=e.text,n=e.isSafeToInnerHTML,s=e.isDisabled,a=e.ariaLabel,l=e.isTruncated;a=a||t;if(n){var u="od-FieldRenderer-text";l&&(u+=" is-truncated");s&&(u+=" od-FieldRenderer--disabled");t&&o.default.decodeHtmlEntities(t);return i.createElement("div",{className:u,dangerouslySetInnerHTML:{__html:t}})}return i.createElement(r.BaseText,{text:t,isDisabled:s,ariaLabel:a})}});define("@ms/odsp-utilities/lib/encoding/Sanitize",["require","exports"],function(e,t){"use strict";var i="(?:[^\"'>]|\"[^\"]*\"|'[^']*')*",r=new RegExp("<(?:!--(?:(?:-*[^->])*--+|-?)|script\\b"+i+">[\\s\\S]*?</script\\s*|style\\b"+i+">[\\s\\S]*?</style\\s*|/?[a-z]"+i+")>","gi"),o=function(){function e(){}e.getTextFromHtml=function(e){var t="";do{e=(t=e).replace(r,"")}while(t!==e);return e};e.decodeHtmlEntities=function(t){t=e.getTextFromHtml(t);var i=document.createElement("div");i.innerHTML=t;return i.textContent};return e}();t.Sanitize=o;Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("@ms/odsp-list-utilities/lib/Renderers/TextRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:'.od-FieldRenderer-text{position:relative}.od-FieldRenderer-text.is-truncated{height:126px;overflow:hidden;position:relative;height:98px;display:inline-block;overflow:hidden}.od-FieldRenderer-text.is-truncated:after{content:"";position:absolute;bottom:0;right:0;width:100%;height:4em;background:linear-gradient(to bottom, rgba(255, 255, 255, 0), '},{theme:"white",defaultValue:"#fff"},{rawString:" 100%)}.ms-DetailsRow.is-selected .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(218, 218, 218, 0), "},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:" 100%)}.ms-DetailsRow:hover .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(244, 244, 244, 0), "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}.ms-DetailsRow.is-selected:hover .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(208, 208, 208, 0), "},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:" 100%)}"}])});define("@ms/odsp-list-utilities/lib/Renderers/TitleRenderer",["require","exports","react","./BaseText","office-ui-fabric-react/lib/Link","./TitleRenderer.scss"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TitleRenderer=function(e){var t=e.text,n=e.hasTitle,s=e.isLinkTitle,a=e.onClick,l=e.isDisabled,u=e.ariaLabel;u=u||t;var d=!0;n&&!s&&(d=!1);return d?n?i.createElement("div",{className:"od-FieldRender-title od-FieldRender-display--link","data-is-focusable":"true",role:"button","aria-label":u,onClick:a,title:t,dangerouslySetInnerHTML:{__html:t}}):i.createElement(o.Link,{className:"od-FieldRender-title od-FieldRender-display--link","aria-label":u,onClick:a,title:t},t):i.createElement(r.BaseText,{text:t,isDisabled:l,ariaLabel:u})}});define("@ms/odsp-list-utilities/lib/Renderers/TitleRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-FieldRender-title{display:inline-block}"}])});define("@ms/odsp-list-utilities/lib/Renderers/FileSizeRenderer",["require","exports","react","./BaseText","@ms/odsp-utilities/lib/string/DriveSpaceHelper","./FileSizeRenderer.scss"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileSizeRenderer=function(e){var t=e.size,n=e.isDisabled,s=e.ariaLabel,a=o.default.getDisplayString(t,{ignoreZero:!0});s||(s=a);return i.createElement(r.BaseText,{text:a,isDisabled:n})}});define("@ms/odsp-list-utilities/lib/Renderers/FileSizeRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:"[dir=ltr] .od-SharedField--shared::before{padding-right:4px}[dir=rtl] .od-SharedField--shared::before{padding-left:4px}"}])});define("@ms/odsp-list-utilities/lib/Renderers/SharedRenderer",["require","exports","react"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedRenderer=function(e){var t=e&&e.fieldValue||"";return i.createElement("div",{"data-is-focusable":!0},t?i.createElement("i",{className:"od-SharedField--shared ms-Icon ms-Icon--People"}):null,t)}});define("@ms/odsp-list-utilities/lib/Renderers/TaxonomyRenderer",["require","exports","react"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TaxonomyRenderer=function(e){var t=e&&e.terms||[];return i.createElement("div",null,t.map(function(e,t){return i.createElement("div",{className:"od-UserField od-FieldRender-nofill","data-is-focusable":!0,"aria-label":e.ariaLabel,key:t},i.createElement("span",{className:"ms-noWrap ms-imnSpan ms-displayInlineBlock"},e.label))}))}});define("@ms/odsp-list-utilities/lib/Renderers/UrlRenderer",["require","exports","react","office-ui-fabric-react/lib/Link","./UrlRenderer.scss"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UrlRenderer=function(e){var t=e.url,o=e.urlDisplay;e.ariaLabel;Boolean(o)||(o=t);return i.createElement(r.Link,{className:"od-FieldRender-display od-FieldRender-display--link",href:t,title:o,target:"_blank"},o)}});define("@ms/odsp-list-utilities/lib/Renderers/UrlRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-DetailsRow-cell .ms-Link,.ms-DetailsRow-cell a.od-FieldRender-display,.ms-DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:12px}.ms-DetailsRow-cell .ms-Link:hover,.ms-DetailsRow-cell a.od-FieldRender-display:hover,.ms-DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});define("@ms/odsp-list-utilities/lib/Renderers/UserRenderer",["require","exports","react","./BaseText"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UserRenderer=function(e){var t=e.users;return e.isAnonymous?i.createElement("div",null,t.map(function(e,t){return i.createElement("div",{key:t},i.createElement(r.BaseText,{text:e.title}))})):t.length?i.createElement("div",null,t.map(function(e,t){return i.createElement("div",{key:t},i.createElement("span",{className:"od-FieldRender od-FieldRender-nofill"},e.title))})):i.createElement(r.BaseText,{text:""})}});define("odsp-next/controls/list/react/detailsList/ReactDetailsList.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-focus--enabled .od-DetailsList a:focus{box-shadow:none}.od-DetailsList .ms-DetailsRow.is-dropping{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";outline:1px solid transparent}.od-DetailsList .ms-DetailsRow.is-dropping .ms-DetailsRow-cell .FileTypeIcon-icon{-ms-transform:scale(1.5,1.5);transform:scale(1.5,1.5)}.od-DetailsListHeader-AddNewField{font-size:13px}.ms-DetailsRow-cell.od-DetailsRow-cell--FileIcon{line-height:0;overflow:visible}.ms-DetailsRow-cell.od-DetailsRow-cell--Title{cursor:pointer}.ms-DetailsRow-cell [data-is-focusable=true]{outline:transparent;vertical-align:top}.ms-DetailsRow-cell .od-FieldRender-nofill{position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.od-FieldRenderer-text{white-space:normal;overflow:hidden;max-height:7em}.od-FieldRenderer--disabled{opacity:.4}.ms-DetailsRow-cell .od-FieldRender-lookup{display:block;max-width:100%}.ms-Fabric.is-focusVisible .ms-DetailsRow-cell [data-is-focusable=true]:focus:after{position:absolute;content:'';left:0;top:0;right:0;bottom:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-DetailsList.is-mobile{margin:0}.od-DetailsList.is-mobile .ms-DetailsRow-check{position:absolute;height:100%}[dir=ltr] .od-DetailsList.is-mobile.is-check-visible .ms-DetailsRow-fields{padding-left:36px}[dir=rtl] .od-DetailsList.is-mobile.is-check-visible .ms-DetailsRow-fields{padding-right:36px}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn{width:40px;padding:0;text-align:center}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn .ms-Icon{line-height:36px}[dir=ltr] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-left:8px}[dir=rtl] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-right:8px}.ms-DetailsHeader-cell .ms-Icon.ms-Icon--GroupedList{position:relative;top:1px}.ms-DetailsHeader-cell .od-DetailsListHeader-FileTypeIcon.ms-Icon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-DetailsList-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}.od-DetailsListHeader-FileTypeIcon{font-size:16px}.od-DetailsHeader-cell--FileIcon .ms-Icon{width:18px;text-align:center}.od-DetailsList .ms-GroupHeader-expand{font-size:12px;margin-top:-8px}"}])});define("odsp-next/controls/list/react/detailsList/fields/FileTypeIconRenderer",["require","exports","tslib","react","knockout","../../../../../utilities/icons/IconHelper","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/modules/Modules","../../../../../providers/fileHandler/FileHandlerProvider","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers","../../../../fileTypeIcon/FileTypeIcon.css","../ReactDetailsList.css"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";function c(e,t){return e&&e.getFileTypeIconUrl(t,!0)}function p(e,t){return e&&e.getFileTypeName(t,!0)}function m(e){var t=h.none;e.policyTip?t=5===e.policyTip?h.none:2&e.policyTip?h.block:h.notify:e.isViolation?t=h.block:e.properties.CheckedOutUserId?t=h.checkOut:4===e.state.upload.status&&(t=h.notify);return t}function f(t,i,r){var n=i.resources;if(1&t.policyTip){a.Engagement.logData({name:"PolicyTip.LaunchFromListView"});l.loadModule({require:e,path:"../../../../../actions/PolicyTipAction"}).then(function(e){new(n.injected(e))({item:o.observable(t)}).execute(r)})}}Object.defineProperty(t,"__esModule",{value:!0});var h;!function(e){e[e.none=0]="none";e[e.checkOut=1]="checkOut";e[e.notify=2]="notify";e[e.block=3]="block"}(h||(h={}));t.fileTypeIconRenderer=function(t,o,a,l){if(!t)return null;var g,v=t.properties,b=l.resources,y=4===t.state.upload.status?s.genericFile:t.iconName,_=a.minWidth||a.width,S=t.extension,x=b.consume(u.resourceKey.optional),I=t.iconUrl||c(x,S)||n.getIconUrl(b,y,_),w=p(x,S)||v.iconFieldAriaLabel,C=m(t);C!==h.none&&(g=e.toUrl("@ms/odsp-media/lib/images/overlays/"+h[C].toLowerCase()+"overlay.svg"));var T={iconName:y,width:_,iconUrl:I,iconTitle:w,overlayUrl:g,isDisabled:v.isDisabled||l.isDisabled,tooltipText:t.tooltipText,ariaLabel:w,isClickable:Boolean(1&t.policyTip),onClick:function(e){f(t,l,e)}};return r.createElement(d.FileTypeIconRenderer,i.__assign({},T))}});define("odsp-next/controls/list/react/detailsList/fields/FileSizeRenderer",["require","exports","tslib","react","@ms/odsp-utilities/lib/string/DriveSpaceHelper","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers"],function(e,t,i,r,o,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileSizeRenderer=function(e,t,a){var l={size:e.size,isDisabled:!1,ariaLabel:n.getAriaLabel(a,o.default.getDisplayString(e.size,{ignoreZero:!0}))};return r.createElement(s.FileSizeRenderer,i.__assign({},l))}});define("odsp-next/controls/list/react/detailsList/fields/BaseText",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers"],function(e,t,i,r,o,n){"use strict";function s(e,t){(!t||e.internalName&&"attachments"===e.internalName.toLowerCase()&&"0"===t)&&(t=o.strings.emptyValueAriaLabel);return r.format(o.strings.cellAriaLabel,e.name,t)}function a(e,t){var i="";if(e&&void 0===(i=e[t.key])&&e.properties){void 0===(i=e.properties[t.key])&&(i=e.recycleBinProperties[t.key]);i&&Array.isArray(i)&&(i=i.join(", "))}return i}Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,r=e.item,o=e.column,l=e.children,u=e.noTextRender,d=e.title,c=s(o,t),p=r&&r.properties.isDisabled||e.isDisabled;void 0===t&&(t=a(r,o));return i.createElement(n.BaseText,{text:t,isDisabled:p,ariaLabel:c,noTextRender:u,title:d},l)};t.getAriaLabel=s;t.getCellText=a});define("odsp-next/controls/list/react/detailsList/fields/NameRenderer",["require","exports","tslib","react","../../../../../resources/DataSourceResourceKeys","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers","../ReactDetailsList.css"],function(e,t,i,r,o,n,s){"use strict";function a(e,t){var i=t.resources.consume(o.url);return i.isRecycleBin(e.queryType)?"":i.getDefaultClickUrl(e,{preferCurrentView:!0,itemSet:t.itemSet})}Object.defineProperty(t,"__esModule",{value:!0});t.nameRenderer=function(e,t,o,l){var u=a(e,l),d=(e?e[o.key]||e.properties[o.key]:null)||"",c={linkUrl:u,linkText:d,onClick:function(t){l.onItemInvoked?l.onItemInvoked(e,null,t):t.preventDefault()},isDisabled:e.properties.isDisabled||l.isDisabled,ariaLabel:n.getAriaLabel(o,d)};return r.createElement(s.NameRenderer,i.__assign({},c))};t.getLinkUrl=a});define("odsp-next/controls/list/react/detailsList/fields/TextRenderer",["require","exports","tslib","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/TextRenderer","@ms/odsp-utilities/lib/encoding/Sanitize","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../../interfaces/ColumnFieldType","../ReactDetailsList.css"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.textRenderer=function(e,t,u,d){var c=u.isAutoHyperLink||u.isAppendOnly||(u.fieldType===l.Number||u.fieldType===l.Currency)&&!u.isCalculated||u.isNote,p=o.getCellText(e,u);u.isNote&&p&&(u.isAppendOnly||(p=(p=a.default.encodeText(p)).replace(/\n/g,"<br>")));var m;if(c){var f="";p&&(f=s.default.getTextFromHtml(p));m=o.getAriaLabel(u,f)}else m=o.getAriaLabel(u,p);var h=!1;u.fieldType===l.Note&&p&&(p.length>255||p.split(/\r|\r\n|\n|<br>/).length>4)&&(h=!0);var g={text:p,isSafeToInnerHTML:c,isDisabled:e.properties.isDisabled||d.isDisabled,ariaLabel:m,isTruncated:h};return r.createElement(n.TextRenderer,i.__assign({},g))}});define("odsp-next/controls/list/react/detailsList/fields/SharedRenderer",["require","exports","tslib","react","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedRenderer=function(e,t,n){var s={fieldValue:(e?e[n.key]:null)||""};return r.createElement(o.SharedRenderer,i.__assign({},s))}});define("odsp-next/controls/list/react/detailsList/fields/UserRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","knockout","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-datasources/lib/Permissions","./../../../../../resources/ProviderResourceKeys","../../../../../resources/DataSourceResourceKeys","../../../../../resources/PagesResourceKeys","../../../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/async/Async","../../../../peopleCard/PeopleCardCommons","../../../../../utilities/features/Features","./BaseText","../../../../../pages/files/spo/PageEvents","../../../../../utilities/delayLoading/DelayLoadingHelper","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v){"use strict";function b(e,t){var i=t.consume(a.profile.optional);if(i){var r=e.map(function(e){return e.sip});i.personRendered(r)}return{lastMouseMove:null,showCardTimeoutId:-1,prepareCardTimeoutId:-1}}function y(t){if(!k){var i=null,r=null;if(t.isExposed(u.eventScope)){i=t.consume(u.eventScope);r=h.default.mainContentLoadComplete}else if(t.isExposed(u.dataManager)){i=t.consume(u.dataManager);r="pageLoadComplete"}k=g.loadModuleOnEvent({eventSource:i,eventName:r},{require:e,path:"../../../../personaCard/PersonaCardLauncher"})}}function _(e,t,r,o){var n=e||[],a=r.text,u=r.ariaLabel,d=r.noTextRender,c=r.title,p=r.isDisabled;if(t.consume(l.identity).getIdentity().type===s.IdentityType.anonymous)return n.map(function(e,t){return i.createElement("div",{key:t},i.createElement(v.BaseText,{text:e.title||a,isDisabled:p,ariaLabel:u,noTextRender:d,title:c}))});y(t);var m=b(n,t);return n.length?n.map(function(e,r){var n=S({resources:t,user:e,ariaLabel:u,cellClassName:o,state:m});return i.createElement("div",{key:r},n)}):i.createElement(v.BaseText,{text:a,isDisabled:p,ariaLabel:u,noTextRender:d,title:c})}function S(e){var t=e.user,r=t.email||t.sip;return i.createElement("span",{ref:function(i){P&&i&&t&&r?x(i,r,e.resources):L&&I(i,r,e.resources)},className:e.cellClassName,"data-is-focusable":!0,role:"button","aria-label":e.ariaLabel,onMouseOut:function(t){return T(e.state)},onMouseMove:function(i){w(t,e.resources,e.state,i)},onClick:function(i){C(t,e.resources,e.state,i)}},t.title)}function x(e,t,i){k&&k.then(function(r){L=e;r.personaRendered(e,t,i.consume(d.pageContext))})}function I(e,t,i){k&&k.then(function(r){r.personaRemoved(e,t,i.consume(d.pageContext))})}function w(e,t,i,r){void 0===r&&(r=null);if(!m.isFeatureEnabled(m.PeopleCardsReactComponent)&&e&&(e.sip||e.email)){if(-1===i.prepareCardTimeoutId){var o=t.consume(a.profile.optional);i.prepareCardTimeoutId=D.setTimeout(function(){return o.getPeopleCardData(e.email||e.sip)},p.PEOPLE_CARD_DATA_PRELOAD_DELAY)}i.lastMouseMove=r;i.lastMouseMove.persist();-1===i.showCardTimeoutId&&(i.showCardTimeoutId=D.setTimeout(function(){return C(e,t,r,!0)},p.PEOPLE_CARD_HOVER_DELAY))}}function C(t,i,r,s,a){void 0===s&&(s=null);void 0===a&&(a=!1);if(!m.isFeatureEnabled(m.PeopleCardsReactComponent)){(s=s||r.lastMouseMove).stopPropagation();s.preventDefault();s=o.utils.extend({},s);T(r);t&&(t.sip||t.email)&&n.loadModule({require:e,path:"../../../../personaCard/PersonaCardLauncher"}).then(function(e){var r={name:t.title,email:t.email,image:t.picture,sip:t.sip||t.email,userId:t.sip};new(i.injected(e))(r).show(s,a)})}}function T(e){D.clearTimeout(e.showCardTimeoutId);D.clearTimeout(e.prepareCardTimeoutId);e.showCardTimeoutId=-1;e.prepareCardTimeoutId=-1;e.lastMouseMove=null}Object.defineProperty(t,"__esModule",{value:!0});var D=new c.default,k=null,P=m.isFeatureEnabled(m.PeopleCardsReactComponent),L=null;t.userRenderer=function(e,t,i,o){var n=e.properties[i.key],s=Array.isArray(n)?n:n?[n]:[],a=o.resources,l=e.properties.isDisabled||o.isDisabled;return _(s,a,{text:f.getCellText(e,i),isDisabled:l,ariaLabel:s.length?f.getAriaLabel(i,s[0].title):""},r.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-person":m.isFeatureEnabled(m.PeopleCardsOnLoki)||m.isFeatureEnabled(m.PeopleCardsReactComponent),"od-FieldRenderer--disabled":l}))};t.generatePeopleCardState=b;t.loadPeopleCardComponent=y;t.userRendererByUser=_;t.getUserComponent=S});define("odsp-next/controls/peopleCard/PeopleCardCommons",["require","exports","@ms/odsp-utilities/lib/navigation/AddressParser","@ms/odsp-utilities/lib/logging/events/Qos.event","./../../utilities/features/Features"],function(e,t,i,r,o){"use strict";function n(e){var t=new r.default({name:"LivePersonaCard.GetLokiRegion"}),i=e.farmLabel.toLowerCase();if(!i){t.end({resultType:r.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"});throw new Error("LokiNoFarmLabel")}var n="us_16_content"===i?"latam":i.split("_",1)[0],a=s[n];if(!a){t.end({resultType:r.ResultTypeEnum.Failure,resultCode:"LokiNoRegionMapping",error:"Farm label mapping for "+n+" not found. Aborting connection!"});throw new Error("LokiNoRegionMapping")}"msit"===a&&o.isFeatureEnabled(o.PeopleCardsLokiDogfood)&&(a="df");t.end({resultType:r.ResultTypeEnum.Success});return a}Object.defineProperty(t,"__esModule",{value:!0});var s={edog:"ppe",msit:"msit",spdf:"df",emea:"eur",apac:"apc",aus:"aus",can:"can",ind:"ind",jpn:"jpn",gbr:"gbr",latam:"lam",kor:"kor",us:"nam",usa:"nam"};t.PEOPLE_CARD_HOVER_DELAY=300;t.PEOPLE_CARD_DATA_PRELOAD_DELAY=50;t.PEOPLE_CARD_HOVER_EVENT_NAME="mousemove";t.openNewTab=function(e){window.open(e,"_blank").opener=null};t.getLokiRegion=function(e){if(o.isFeatureEnabled(o.DebugWindow)){var t=window.location.search;t&&"?"===t.charAt(0)&&(t=t.substr(1));var r=i.deserializeQuery(t);if(r.lokideployment)return r.lokideployment}return n(e)}});define("odsp-next/utilities/delayLoading/DelayLoadingHelper",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/async/Promise"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadModuleOnEvent=function(t,n){if(t){var s=t.eventSource,a=t.eventName,l=t.eventGroup,u=void 0===l?new r.default(this):l;return new o.default(function(t){u.on(s,a,function(){u.off(s,a);i.loadModule({require:n.require||e,path:n.path}).then(t)})})}return i.loadModule({require:n.require||e,path:n.path})}});define("odsp-next/controls/list/react/detailsList/fields/LikeRenderer",["require","exports","tslib","react","react","../../../../../resources/ProviderResourceKeys","../../../../../resources/SPOResourceKeys","./FieldsRender.resx","./Like","../../../../../providers/item/ItemProvider","./Like.css"],function(e,t,i,r,o,n,s,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReactHTMLElement=o;t.likeRenderer=function(e,t,i,o){return r.createElement(d,{item:e,rowBehavior:o})};var d=function(e){function t(t){var i=e.call(this,t)||this,r=t.item,o=t.rowBehavior.resources;i.state=i._generateStateFromItem(r,o);i._onLikeClicked=i._onLikeClicked.bind(i);return i}i.__extends(t,e);t.prototype.componentWillReceiveProps=function(e){this.setState(this._generateStateFromItem(e.item,e.rowBehavior.resources))};t.prototype.render=function(){var e=this.state,t=e.likeCount,i=e.isLiked;return r.createElement(l.default,{likeTitle:a.strings.LikesCountText,likeCount:t,isLiked:i,onLikeClicked:this._onLikeClicked})};t.prototype._generateStateFromItem=function(e,t){var i=t.consume(s.pageContext),r=e.reputationProperties.LikedBy,o=!!r&&r.some(function(e){return Number(e.id)===i.userId});return{likeCount:Number(e.properties.LikesCount)||0,isLiked:o}};t.prototype._onLikeClicked=function(e){var t=this.state.likeCount;this.setState({likeCount:e?t-1:t+1,isLiked:!e});this._setLike(!e)};t.prototype._setLike=function(e){var t=this.props,i=t.item,r=t.rowBehavior.resources,o=r.consume(n.likeProvider),s=r.consume(u.resourceKey),a={parentKey:i.parentKey,itemId:Number(i.properties.ID),like:e,listId:i.parent.id};return o.setLike(a).then(function(e){return s.invalidateItem(i.parentKey,{triggerFetch:!0})})};return t}(r.Component)});define("odsp-next/controls/list/react/detailsList/fields/Like",["require","exports","tslib","react","@uifabric/utilities/lib/css"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,i){var r=e.call(this,t,i)||this;r.state={isLikedState:t.isLiked};r._onClick=r._onClick.bind(r);return r}i.__extends(t,e);t.prototype.render=function(){var e=this.props,t=e.likeCount,i=e.likeTitle,n=e.isLiked;this.state={isLikedState:n};return r.createElement("div",{className:"od-Like","data-is-focusable":"true",onClick:this._onClick},r.createElement("div",{className:o.css({"od-Like-heartFull ms-Icon ms-Icon--HeartFill ":n,"od-Like-heartEmpty ms-Icon ms-Icon--Heart":!n})}),r.createElement("span",{className:"od-Like-count"},t),r.createElement("span",{className:"od-Like-text"},i))};t.prototype._onClick=function(e){var t=this.props.onLikeClicked,i=this.state.isLikedState;t&&t(i);e.stopPropagation();e.preventDefault()};return t}(r.Component);t.default=n});define("odsp-next/controls/list/react/detailsList/fields/Like.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Like{height:0;line-height:0}"}])});define("odsp-next/controls/list/react/detailsList/fields/AttachmentsRenderer",["require","exports","react","./BaseText"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.attachmentsRenderer=function(e,t,o){var n=r.getCellText(e,o);return i.createElement(r.BaseText,{text:n,column:o,noTextRender:!0},"1"===n&&i.createElement("span",{className:"ms-Icon ms-Icon--Attach"}))}});define("odsp-next/controls/list/react/detailsList/fields/UrlRenderer",["require","exports","tslib","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers","./UrlRenderer.css"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.urlRenderer=function(e,t,s){var a=e.properties[s.key]||e[s.key];if(!a)return r.createElement(o.BaseText,{column:s});var l=e.properties[s.key+".desc"]||a,u={url:a,urlDisplay:l,ariaLabel:o.getAriaLabel(s,l)};return r.createElement(n.UrlRenderer,i.__assign({},u))}});define("odsp-next/controls/list/react/detailsList/fields/UrlRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-DetailsRow-cell .ms-Link,.ms-DetailsRow-cell a.od-FieldRender-display,.ms-DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:12px}.ms-DetailsRow-cell .ms-Link:hover,.ms-DetailsRow-cell a.od-FieldRender-display:hover,.ms-DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});define("odsp-next/controls/list/react/detailsList/fields/ImageRenderer",["require","exports","react","./BaseText","./ImageRenderer.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.imageRenderer=function(e,t,o){var n=e.properties[o.key];if(!n)return i.createElement(r.BaseText,{column:o});var s=e.properties[o.key+".desc"];Boolean(s)||(s=n);return i.createElement("div",{className:"od-FieldRender-image","data-is-focusable":"true",onClick:function(e){Boolean(e)&&Boolean(e.target)&&Boolean(n)&&window.open(n,"_blank")}},i.createElement("img",{src:n,title:s,className:"od-FieldRender-imageDisplay"}))}});define("odsp-next/controls/list/react/detailsList/fields/ImageRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRender-image{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.od-FieldRender-imageDisplay{cursor:pointer;max-width:100%;max-height:100%}"}])});define("odsp-next/controls/list/react/detailsList/fields/LookupRenderer",["require","exports","react","../../../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../../iFrameDialog/IFrameDialog","./BaseText","office-ui-fabric-react/lib/Link"],function(e,t,i,r,o,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.lookupRenderer=function(e,t,l,u){var d=this,c=e.properties[l.key];if(!c||Array.isArray(c)&&0===c.length)return i.createElement(s.BaseText,{column:l});if("string"==typeof c)return i.createElement(s.BaseText,{column:l,item:e});var p=function(e,t){var i=l.dispFormUrl;i+="&ID=";i+=t;i+="&RootFolder=*&IsDlg=1";return u.resources.consume(r.resourceKey).requestDialog({title:"",size:"Large",component:{name:n.default.tagName,params:{componentUrl:i,showInDialog:!0,heightOffset:.5}}}).wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})},m=function(e,t){p(0,e)};return c.map(function(e,t){return i.createElement(a.Link,{className:"od-FieldRender od-FieldRender-lookup",onClick:m.bind(d,e.lookupId),"aria-label":s.getAriaLabel(l,e.lookupValue),key:t},e.lookupValue+" ")})}});define("odsp-next/controls/iFrameDialog/IFrameDialog",["require","exports","./IFrameDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IFrameDialog.html","./IFrameDialog.css","../iframeLoader/IframeLoader"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-iframe-dialog",template:e("./IFrameDialog.html"),viewModel:i});t.default=o});define("odsp-next/controls/iFrameDialog/IFrameDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./IFrameDialog.resx","../../providers/dialog/DialogProvider","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/locale/Locale","../../utilities/iframe/IframeHelper"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";return function(e){function t(t){var i=e.call(this,t)||this;i.loadingLabel=o.strings.IFrameDialogLoadingLabel;i.progressSpinnerFlatTagName=a.default.tagName;i._isIframeAvailable=!0;i.isLoading=s.observable(!0);i.componentUrl=t.componentUrl;i.showInDialog=t.showInDialog;i.heightOffset=t.heightOffset;i.forceSharePointScrollbar=t.forceSharePointScrollbar;i.maxHeight=t.maxHeight;i.addDisposable({dispose:function(){d.disposeIframe(i._iframeElement,function(){i._isIframeAvailable=!1})}});return i}i.__extends(t,e);t.prototype.iframeOnLoad=function(e,t){var i=this;if(this._isIframeAvailable){this._iframeElement=t.target;var r=this._iframeElement;r&&r.contentWindow&&this.async.setTimeout(function(){i.showInDialog&&i._setupIframeElementFunctions(r);i.isLoading(!1);if(!i.maxHeight){r.style.height=document.body.clientHeight*i.heightOffset+"px";i._modifyFramedPageHeight(r)}if(i.forceSharePointScrollbar){var e=r.contentWindow.document.getElementById("s4-workspace");if(e){u.default.isRightToLeft?e.style.paddingLeft="10px":e.style.paddingRight="10px";e.style.boxSizing="border-box"}}},10)}};t.prototype._modifyFramedPageHeight=function(e){var t=e.contentWindow.document.getElementById("s4-workspace");t&&(t.style.height=e.style.height)};t.prototype._setupIframeElementFunctions=function(e){var t=this,i=function(e){t.resources.consume(l.navigation).navigateTo(e)};e.cancelPopUp=function(){t.resources.consume(n.resourceKey).currentDialog().dismiss()};e.commitPopup=function(e){"string"==typeof e&&"{"!==e[0]?i(e):t.resources.consume(n.resourceKey).currentDialog().complete()};e.navigateParent=i};return t}(r.default)});define("odsp-next/controls/iFrameDialog/IFrameDialog.html",[],function(){return'<div class=od-IFrameDialog data-bind="css: { \'od-IFrameDialog--maxHeight\': maxHeight}"><iframe frameborder=0 data-bind="attr: {src: componentUrl}, event: {load: iframeOnLoad}, visible: !isLoading()" style=width:100%></iframe><label class=od-Dialog-subText data-bind="text: loadingLabel, visible: isLoading"></label><div class=od-IFrameDialog-ProgressContainer data-bind="visible: isLoading"><div data-bind="component: {name: progressSpinnerFlatTagName}"></div></div></div>'});define("odsp-next/controls/iFrameDialog/IFrameDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-IFrameDialog{border:none;width:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight{position:absolute;height:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight iframe{height:100%}.od-IFrameDialog-ProgressContainer{width:250px;padding:15px 0}"}])});define("odsp-next/controls/list/react/detailsList/fields/DataBarRenderer",["require","exports","react","./DataBarRenderer.css"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataBarRenderer=function(e,t,r){var o=e.properties.progress,n=o.maximum.peek()-o.minimum.peek(),s=o.current.peek()-o.minimum.peek(),a={width:(0===n?0:s/n*100)+"%"};return i.createElement("div",{className:"od-DataBarField-track","aria-label":e.properties.progressFieldAriaLabel,title:e.properties.progressFieldAriaLabel},i.createElement("div",{className:"od-DataBarField-value",style:a}))}});define("odsp-next/controls/list/react/detailsList/fields/DataBarRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DataBarField-track{height:100%}.od-DataBarField-value{height:7px;display:inline-block;vertical-align:middle;background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";transition:width 267ms cubic-bezier(.1,.9,.2,1)}"}])});define("odsp-next/controls/list/react/detailsList/fields/DateRenderer",["require","exports","tslib","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="dateModified";t.dateRenderer=function(e,t,a,l){var u=o.getCellText(e,a),d={text:u,dateValue:e.dateModified||e.dateDeleted||void 0,indicatorEnabled:a.key===s,isDisabled:e.properties.isDisabled||l.isDisabled,ariaLabel:o.getAriaLabel(a,u)};return r.createElement(n.DateRenderer,i.__assign({},d))}});define("odsp-next/controls/list/react/detailsList/fields/TitleRenderer",["require","exports","tslib","react","./NameRenderer","../../../../../resources/SPOResourceKeys","../../../../../models/item/ItemType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers","@ms/odsp-utilities/lib/encoding/Sanitize"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.titleRenderer=function(e,t,c,p){var m,f=p.resources.consume(n.listContext),h=f.rawListSchema&&f.rawListSchema.Field&&Boolean(f.rawListSchema.HasTitle),g="LinkTitle"===c.internalName||"LinkTitleNoMenu"===c.internalName,v=l.getCellText(e,c),b=d.default.getTextFromHtml(v),y={text:v,hasTitle:h,isLinkTitle:g,onClick:m=e.type===s.Folder||"1"===e.properties.FSObjType?function(t){var i=o.getLinkUrl(e,p);if(i){p.resources.consume(a.navigation).navigateTo(i);t.preventDefault();t.stopPropagation()}}:function(t){p.onItemInvoked&&p.onItemInvoked(e,null,t)},isDisabled:e.properties.isDisabled||p.isDisabled,ariaLabel:l.getAriaLabel(c,b)};return r.createElement(u.TitleRenderer,i.__assign({},y))}});define("odsp-next/controls/list/react/detailsList/fields/RatingRenderer",["require","exports","tslib","react","react","../../../../../resources/ProviderResourceKeys","../../../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","./FieldsRender.resx","./Rating","../../../../../providers/item/ItemProvider","./Rating.css"],function(e,t,i,r,o,n,s,a,l,u,d){"use strict";function c(e){return Array.apply(null,Array(e))}Object.defineProperty(t,"__esModule",{value:!0});t.ReactHTMLElement=o;t.ratingRenderer=function(e,t,i,o){return r.createElement(p,{item:e,rowBehavior:o})};var p=function(e){function t(t){var i=e.call(this,t)||this,r=t.item,o=t.rowBehavior.resources;i.state=i._generateStateFromItem(r,o);i._onRatingClicked=i._onRatingClicked.bind(i);return i}i.__extends(t,e);t.prototype.componentWillReceiveProps=function(e){this.setState(this._generateStateFromItem(e.item,e.rowBehavior.resources))};t.prototype.render=function(){var e=this,t=this.state,i=t.averageRating,o=t.userRatingCount;return r.createElement(u.default,{maxRating:5,starTitles:c(5).map(function(t,i){return e._getElementTitle(i)}),starArialLabels:c(5).map(function(t,i){return e._getAriaLabel(i)}),averageRating:i,userRatingTitle:a.format(l.strings.RatedByCountTitle,o),userRatingCount:o,onRatingClicked:this._onRatingClicked})};t.prototype._generateStateFromItem=function(e,t){var i=t.consume(s.pageContext),r=e.reputationProperties,o=-1,n=r.Ratings;n&&","===n.slice(-1)&&(n=n.slice(0,-1));var a=n?n.split(",").map(Number):[],l=r&&r.RatedBy,u=!!l&&l.some(function(e,t){if(Number(e.id)===i.userId){o=a[t];return!0}return!1});return{averageRating:parseFloat(r.AverageRating)||0,userRatingCount:l&&l.length||0,hasUserRated:u,userRating:o,allRatings:a}};t.prototype._onRatingClicked=function(e){var t=this.state,i=t.hasUserRated,r=t.allRatings;this.setState({averageRating:this._computeAverageRating(e),userRatingCount:i?r.length:r.length+1});this._setRating(e)};t.prototype._getElementTitle=function(e){var t=this.state,i=t.hasUserRated,r=t.userRating;return i?a.format(l.strings.ModifyRatingTitle,r):a.format(l.strings.ApplyRatingTitle,Number(e)+1)};t.prototype._getAriaLabel=function(e){var t=this.state,i=t.averageRating,r=t.hasUserRated,o=t.userRating,n=i>0?a.pluralSelect(i,a.format(l.strings.AverageRatingAriaLabel,i),a.format(l.strings.AverageRatingPluralAriaLabel,i)):"";n+=r?a.format(l.strings.ModifyRatingTitle,o):"";return n+=a.format(l.strings.ApplyRatingTitle,e+1)};t.prototype._setRating=function(e){var t=this.props,i=t.item,r=t.rowBehavior.resources,o=r.consume(n.ratingProvider),s=r.consume(d.resourceKey),a={parentKey:i.parentKey,itemId:Number(i.properties.ID),rating:e,listId:i.parent.id};return o.setRating(a).then(function(e){return s.invalidateItem(i.parentKey,{triggerFetch:!0})})};t.prototype._computeAverageRating=function(e){var t=this.state,i=t.hasUserRated,r=t.userRating,o=t.allRatings,n=o.reduce(function(e,t){return Number(e)+Number(t)},0),s=o.length;i?n-=r:s++;return(n+=e)/s};return t}(r.Component);t.ItemRating=p;t.default=p});define("odsp-next/controls/list/react/detailsList/fields/Rating",["require","exports","tslib","react","@uifabric/utilities/lib/css"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,i){var r=e.call(this,t,i)||this;r.state={hoveredRating:-1};return r}i.__extends(t,e);t.prototype.render=function(){var e=this.props,t=e.maxRating,i=e.averageRating,n=e.userRatingCount,s=e.userRatingTitle,a=e.starTitles,l=e.starArialLabels,u=this.state.hoveredRating,d=[];i=-1===u?i:u;for(var c=0;c<t;c++)d.push(r.createElement("div",{key:c,title:a[c],"aria-label":l[c],className:o.css("ms-Icon ms-Icon--FavoriteStarFill",{"od-Rating-starEmpty":i<c+1,"od-Rating-starHalf":c+1>i&&i>c,"od-Rating-starFull":Math.floor(i)>=c+1,"od-Rating-starHover":-1!==u&&u>=c+1}),"data-is-focusable":"true",onClick:this._onClick.bind(this,c),onMouseOver:this._onMouseOver.bind(this,c),onMouseOut:this._onMouseOut.bind(this,c)}));return r.createElement("div",null,r.createElement("div",{className:"od-Rating"},d),r.createElement("span",{title:s,className:"od-Rating-count"},n))};t.prototype._onClick=function(e,t){var i=this.props.onRatingClicked;i&&i(e+1);t.stopPropagation();t.preventDefault()};t.prototype._onMouseOver=function(e,t){this.setState({hoveredRating:e+1})};t.prototype._onMouseOut=function(e,t){this.setState({hoveredRating:-1})};return t}(r.Component);t.default=n});define("odsp-next/controls/list/react/detailsList/fields/Rating.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Rating{display:inline-block}.od-Rating-starEmpty,.od-Rating-starFull,.od-Rating-starHalf,.od-Rating-starHover{margin-top:-6px;margin-bottom:-20px}.od-Rating-count{line-height:21px}.ms-DetailsRow-cell.od-DetailsRow-cell--AverageRating{padding:0}"}])});define("odsp-next/controls/list/react/detailsList/fields/HashtagRenderer",["require","exports","react","knockout","@ms/odsp-utilities/lib/async/Promise","../../../../../utilities/features/Features","../../../../../resources/SPOResourceKeys","../../../../../resources/PagesResourceKeys","../../../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/list/HashtagUtilities","@ms/odsp-utilities/lib/resources/Resources","./BaseText","@ms/odsp-utilities/lib/string/StringHelper","../ReactDetailsList.resx","../../../layouts/LayoutType","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,i,r,o,n,s,a,l,u,d,c,p,m,f,h,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hashtagRenderer=function(t,b,y,_){var S=this,x=t.properties[y.key];if(!x||Array.isArray(x)&&0===x.length)return i.createElement(c.BaseText,{column:y});"string"==typeof x&&(x=[x]);var I=function(t,i){if(!n.isFeatureEnabled(n.Hashtags)||!n.isFeatureEnabled(n.HashtagsUI))return o.default.wrap({resultType:v.ResultTypeEnum.Success});var u=new v.default({name:"Hashtag.DiscoverPanel.Launch"}),c=new d.ResourceScope(_.resources);c.expose(s.currentHashtag,t);c.expose(a.files.layoutType,r.observable(f.DocumentCardsGrid));return g.loadModule({require:e,path:"odsp-next/controls/hashtag/HashtagDiscoverViewComponent"}).then(function(e){var i=c.consume(a.files.resx),r=h.format(i.otherItemsTagged,t);return c.consume(l.resourceKey).requestPanel({title:r,hasCommandBar:!1,size:"Large",component:{name:e.tagName,params:{hashtag:t}}}).wait().then(function(){u.end({resultType:v.ResultTypeEnum.Success,extraData:{CurrentHashtag:t}});return{resultType:v.ResultTypeEnum.Success}})})};return x.map(function(e,t){return i.createElement("div",{className:"od-FieldRender od-FieldRender-nofill",key:t,"data-is-focusable":!0,role:"button","aria-label":p.format(m.strings.cellAriaLabel,y.name,e.lookupValue),onClick:I.bind(S,e.lookupValue)},i.createElement("span",{className:"od-FieldRender-display od-FieldRender-display--link"},u.HASHTAG_DISPLAY_PREFIX,e.lookupValue))})}});define("odsp-next/controls/list/react/detailsList/fields/TaxonomyRenderer",["require","exports","tslib","react","./BaseText","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.taxonomyRenderer=function(e,t,s){var a=e.properties[s.key];if(!a||Array.isArray(a)&&0===a.length)return r.createElement(o.BaseText,{column:s});!a||a instanceof Array||""===a||(a=[{Label:a.Label,TermID:a.TermID}]);var l={terms:a.map(function(e){return{label:e.Label,termId:e.TermID,ariaLabel:o.getAriaLabel(s,e.Label)}})};return r.createElement(n.TaxonomyRenderer,i.__assign({},l))}});define("odsp-next/controls/list/react/detailsList/fields/WorkflowRenderer",["require","exports","react","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./BaseText","./UrlRenderer.css","./WorkflowRenderer.css"],function(e,t,i,r,o){"use strict";function n(e){var t=document.createElement("div");t.innerHTML=e;var i=t.querySelector("a");return{url:i.href,display:i.innerHTML}}Object.defineProperty(t,"__esModule",{value:!0});t.workflowRenderer=function(e,t,s,a){var l=e.properties[s.key];if(!l)return i.createElement(o.BaseText,{column:s});var u=n(l);return i.createElement("a",{className:"ms-workflowStatus--linkText od-FieldRender-display od-FieldRender-display--link",href:u.url,title:u.url,target:"_self",onClick:function(e){var t=a.resources.consume(r.navigation);if(Boolean(e)&&Boolean(e.target)){var i=e.currentTarget,o=null;"A"===i.tagName?o=i.href:"IMG"===i.tagName&&(o=i.src);t.navigateTo(o)}},dangerouslySetInnerHTML:{__html:u.display}})}});define("odsp-next/controls/list/react/detailsList/fields/WorkflowRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-workflowStatus--linkText>span{font-size:12px}"}])});define("odsp-next/controls/list/react/detailsList/fields/SharedWithRenderer",["require","exports","react","./FieldsRender.resx","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithRenderer=function(t,n,s,a){var l,u,d;if(Number(t.properties.PrincipalCount)<1){u="ms-Icon ms-Icon--Lock";d=r.strings.SharedWithNoneIcon;l=r.strings.SharedWithNone_Short}else{u="ms-Icon ms-Icon--People";d=r.strings.SharedWithSomeIcon;l=r.strings.SharingHintShared_Short}return i.createElement("div",{className:"od-FieldRender ms-noWrap ms-displayInlineBlock","data-is-focusable":"true",title:l,onClick:function(t){o.loadModule({require:e,path:"../../../../../actions/ShowPropertiesAction"}).then(function(e){new(a.resources.injected(e))({useToggleBehavior:!1,isSharingSectionExpanded:!0}).execute(t)})}},i.createElement("i",{className:u,alt:d}),i.createElement("span",null,""),i.createElement("span",null,l))}});define("odsp-next/controls/list/react/detailsList/fields/CustomRenderer",["require","exports","react","../../../interfaces/ColumnFieldType","@uifabric/utilities/lib/css","./FieldMap","./CustomRenderer.css"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.customRenderer=function(e,t,s,a){var l=s.customFields.length-1,u=s.customFields.map(function(t,s){var u=n.fieldMap[r[t.fieldType]||"Text"];return i.createElement("span",{key:"field_"+s,className:o.css("od-FieldRenderer-custom",{"is-last-row":s===l})},u(e,s,t,a))});return i.createElement("span",null,u)}});define("odsp-next/controls/list/react/detailsList/fields/CustomRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRenderer-custom{font-size:12px;line-height:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=ltr] .od-FieldRenderer-custom{float:left}html[dir=rtl] .od-FieldRenderer-custom{float:right}[dir=ltr] .od-FieldRenderer-custom{margin-right:10px}[dir=rtl] .od-FieldRenderer-custom{margin-left:10px}.od-FieldRenderer-custom.is-last-row{clear:both}.od-FieldRenderer-custom .od-FieldRenderer-name{font-size:17px;line-height:20px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("odsp-next/controls/list/react/detailsList/fields/ComplianceRecordFlagRenderer",["require","exports","react","../../../../../utilities/complianceTag/ComplianceTagUtilities","./BaseText"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.complianceRecordFlagRenderer=function(e,t,n){var s=r.complianceRecordFlagValueAsYesNoString(e);return i.createElement(o.BaseText,{column:n,text:s})}});define("odsp-next/utilities/complianceTag/ComplianceTagUtilities",["require","exports","../../controls/fieldEditor/booleanEditor/BooleanEditor.resx","@ms/odsp-utilities/lib/string/StringHelper","./ComplianceTagUtilities.resx"],function(e,t,i,r,o){"use strict";var n;!function(e){function t(t,i){return!(!t||"lookup"!==t.toLowerCase()||!i||i.toLowerCase()!==e.COMPLIANCETAG_FIELD_ID.toLowerCase())}function n(e){var t="";if(e>0){var i=Math.floor(e/365);if(i>0){var n=i>1?o.strings.RetentionPeriodYears:o.strings.RetentionPeriodYear;t=r.format(n,i)}else{var s=Math.floor(e/30);if(s>0){var a=s>1?o.strings.RetentionPeriodMonths:o.strings.RetentionPeriodMonth;t=r.format(a,s)}else{var l=e>1?o.strings.RetentionPeriodDays:o.strings.RetentionPeriodDay;t=r.format(l,e)}}}return t}e.COMPLIANCETAG_FIELD_NAME="_ComplianceTag";e.COMPLIANCETAG_FIELD_ID="D4B6480A-4BED-4094-9A52-30181EA38F1D";e.isClientFormComplianceTagField=function(e){return!!(e&&e.schema&&t(e.schema.FieldType,e.schema.Id))};e.isComplianceTagField=t;e.complianceRecordFlagValueAsYesNoString=function(e){var t=i.strings.no;if(e.properties.hasOwnProperty("_ComplianceFlags")){var r=+e.properties._ComplianceFlags;4&r&&1&r&&(t=i.strings.yes)}return t};e.getPlaceholder=function(){return o.strings.ComplianceTagFieldPlaceHolder};e.getTagDescription=function(e){if(!e.HasRetentionAction)return"";if(0===e.TagDuration)return e.BlockDelete?o.strings.RetainForeverText:"";var t=n(e.TagDuration);return e.BlockDelete?r.format(o.strings.PreserveTagText,t):e.AutoDelete?r.format(o.strings.DeleteTagText,t):""};e.getTagTooltip=function(e){if(!e.HasRetentionAction)return o.strings.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?o.strings.PreserveForeverTooltip:o.strings.NoRetentionTooltip;var t=n(e.TagDuration),i="",s="";if(e.BlockDelete){i="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(s=o.strings.PreserveIsRecordTooltipModifier);e.ReviewerEmail?s+=o.strings.ReviewTooltip:s+=e.AutoDelete?o.strings.PreserveAutoDeleteTooltipModifier:o.strings.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(i="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var a=o.strings[i];return a?r.format(a,t)+s:null};e.getDurationAsString=n}(n||(n={}));return n});define("odsp-next/controls/list/react/detailsList/fields/ActivityRenderer",["require","exports","react","./BaseText","../ReactDetailsList.css"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.activityRenderer=function(e,t,o,n){var s=r.getCellText(e,o),a="od-FieldRenderer-text";(e&&e.properties.isDisabled||n.isDisabled)&&(a+=" od-FieldRenderer--disabled");return i.createElement("div",{className:a,"data-is-focusable":!0,"aria-label":r.getAriaLabel(o,s),title:s,dangerouslySetInnerHTML:{__html:s}})}});define("odsp-next/controls/list/react/detailsList/fields/ClientSideCustomRenderer",["require","exports","tslib","react","./BaseText"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clientSideCustomRenderer=function(e,t,i,s){var a=e.properties[i.key],l=o.getAriaLabel(i,a),u=i.clientSideColumnAdapter;if(u&&u.fieldCustomizerLoaded&&u.renderCell)try{var d=u.listViewAdapter;if(d){var c={values:e.properties},p=d.createRowAdapter(c);if(p)return r.createElement(n,{ariaLabel:l,title:a,columnAdapter:u,rowAdapter:p});console.log("Could not create row adapter for column: "+i.internalName)}}catch(e){console.log("Error in using clientSideCustomRenderer, error: "+e)}return r.createElement("div",{title:a,"aria-label":l},a)};var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}i.__extends(t,e);t.prototype.render=function(){var e=this;return r.createElement("div",{ref:function(t){return e._div=t}})};t.prototype.componentDidMount=function(){var e=document.createElement("DIV");this._div.appendChild(e);this._cellAdapter=this.props.columnAdapter.renderCell(this.props.rowAdapter,this._div)};t.prototype.componentWillUnmount=function(){this._cellAdapter.dispose()};return t}(r.Component)});define("odsp-next/controls/list/react/detailsList/fields/FileActivityRenderer",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-list-utilities/lib/Renderers/FieldRenderers","./BaseText","../ReactDetailsList.resx","../../../../../utilities/features/Features","./UserRenderer"],function(e,t,i,r,o,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileActivityRenderer=function(e,t,u,d){var c=e.properties.editorName,p=c&&c.length?c[0]:void 0,m=n.getCellText(e,u),f=e.properties.isDisabled||d.isDisabled,h=p?n.getAriaLabel(u,p.title):"";if(!p)return i.createElement(o.BaseText,{text:m,isDisabled:f,ariaLabel:h});l.loadPeopleCardComponent(d.resources);var g=l.generatePeopleCardState([p],d.resources),v="od-FieldRender od-FieldRender-nofill ms-fontWeight-semibold";(a.isFeatureEnabled(a.PeopleCardsOnLoki)||a.isFeatureEnabled(a.PeopleCardsReactComponent))&&(v+=" od-FieldRender-person");var b=l.getUserComponent({resources:d.resources,user:p,ariaLabel:h,cellClassName:v,state:g}),y=r.formatToArray(s.strings.fileActivityContent,b,e.dateModified);return i.createElement("div",{className:"od-FieldRender-activity"},i.createElement("i",{className:"ms-Icon ms-Icon--Edit"}),y)}});define("odsp-next/providers/teachingBubble/TeachingBubbleHelper.key",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.asyncKey=new r.ResourceKey({name:e("module").id,loader:new r.AliasResourceLoader(function(){return i.loadModuleExport({require:e,path:"./TeachingBubbleHelper",getExport:function(e){return e.resourceKey}})})})});