window.O365 = window.O365 || {}; O365.ShellAriaLogger = (function() {var clienttelemetry_build;(function(f){f.version="2.8.0"})(clienttelemetry_build||(clienttelemetry_build={}));var Microsoft;
(function(f){(function(e){(function(b){b[b.BT_STOP=0]="BT_STOP";b[b.BT_STOP_BASE=1]="BT_STOP_BASE";b[b.BT_BOOL=2]="BT_BOOL";b[b.BT_UINT8=3]="BT_UINT8";b[b.BT_UINT16=4]="BT_UINT16";b[b.BT_UINT32=5]="BT_UINT32";b[b.BT_UINT64=6]="BT_UINT64";b[b.BT_FLOAT=7]="BT_FLOAT";b[b.BT_DOUBLE=8]="BT_DOUBLE";b[b.BT_STRING=9]="BT_STRING";b[b.BT_STRUCT=10]="BT_STRUCT";b[b.BT_LIST=11]="BT_LIST";b[b.BT_SET=12]="BT_SET";b[b.BT_MAP=13]="BT_MAP";b[b.BT_INT8=14]="BT_INT8";b[b.BT_INT16=15]="BT_INT16";b[b.BT_INT32=16]="BT_INT32";
b[b.BT_INT64=17]="BT_INT64";b[b.BT_WSTRING=18]="BT_WSTRING";b[b.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"})(e.BondDataType||(e.BondDataType={}));(function(b){b[b.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL";b[b.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL";b[b.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL";b[b.JSON_PROTOCOL=21322]="JSON_PROTOCOL";b[b.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL";b[b.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"})(e.ProtocolType||(e.ProtocolType={}))})(f.Bond||(f.Bond={}))})(Microsoft||
(Microsoft={}));
(function(f){(function(e){(function(b){var c=function(){function a(){this._buffer=[]}a.prototype.Add=function(a){for(var d=0;d<this._buffer.length&&this._buffer[d]!=a;++d);d==this._buffer.length&&this._buffer.push(a)};a.prototype.Count=function(){return this._buffer.length};a.prototype.GetBuffer=function(){return this._buffer};return a}();b.Set=c;c=function(){function a(){this._buffer=[]}a.prototype.Add=function(a,d){-1==this._getIndex(a)&&this._buffer.push({Key:a,Value:d})};a.prototype.AddOrReplace=function(a,
d){var m=this._getIndex(a);0<=m?this._buffer[m]={Key:a,Value:d}:this._buffer.push({Key:a,Value:d})};a.prototype.Remove=function(a){a=this._getIndex(a);0<=a&&this._buffer.splice(a,1)};a.prototype.Count=function(){return this._buffer.length};a.prototype.GetBuffer=function(){return this._buffer};a.prototype.ContainsKey=function(a){return 0<=this._getIndex(a)?!0:!1};a.prototype.Get=function(a){a=this._getIndex(a);return 0<=a?this._buffer[a].Value:null};a.prototype._getIndex=function(a){for(var d=0,m=
-1;d<this._buffer.length;++d)if(this._buffer[d].Key==a){m=d;break}return m};return a}();b.Map=c})(e.Collections||(e.Collections={}))})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(e){(function(c){var a=function(){function a(){}a.GetBytes=function(d){for(var m=[],a=0;a<d.length;++a){var b=d.charCodeAt(a);128>b?m.push(b):2048>b?m.push(192|b>>6,128|b&63):55296>b||57344<=b?m.push(224|b>>12,128|b>>6&63,128|b&63):(b=65536+((b&1023)<<10|d.charCodeAt(++a)&1023),m.push(240|b>>18,128|b>>12&63,128|b>>6&63,128|b&63))}return m};return a}();c.Utf8=a;a=function(){function a(){}a.GetString=function(d){var m=[],a=d.length%3,b,c,k,n=function(d){return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>
18&63),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>12&63),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6&63),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d&63)].join("")};b=0;for(k=d.length-a;b<k;b+=3)c=(d[b]<<16)+(d[b+1]<<8)+d[b+2],m.push(n(c));switch(a){case 1:c=d[d.length-1];m.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>2));m.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c<<
4&63));m.push("==");break;case 2:c=(d[d.length-2]<<8)+d[d.length-1],m.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>10)),m.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>4&63)),m.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c<<2&63)),m.push("=")}return m.join("")};return a}();c.Base64=a;a=function(){function a(){}a.GetBytes=function(d){for(var a=[];d&4294967168;)a.push(d&127|128),d>>>=7;a.push(d&
127);return a};return a}();c.Varint=a;a=function(){function a(){}a.GetBytes=function(d){var a=d.low;d=d.high;for(var b=[];d||4294967168&a;)b.push(a&127|128),a=(d&127)<<25|a>>>7,d>>>=7;b.push(a&127);return b};return a}();c.Varint64=a;a=function(){function a(){}a.GetBytes=function(d){if(e.BrowserChecker.IsDataViewSupport()){var a=new DataView(new ArrayBuffer(4));a.setFloat32(0,d,!0);d=[];for(var c=0;4>c;++c)d.push(a.getUint8(c));return d}return b.ConvertNumberToArray(d,!1)};return a}();c.Float=a;a=
function(){function a(){}a.GetBytes=function(d){if(e.BrowserChecker.IsDataViewSupport()){var a=new DataView(new ArrayBuffer(8));a.setFloat64(0,d,!0);d=[];for(var c=0;8>c;++c)d.push(a.getUint8(c));return d}return b.ConvertNumberToArray(d,!0)};return a}();c.Double=a;a=function(){function a(){}a.EncodeZigzag16=function(d){d=e.Number.ToInt16(d);return d<<1^d>>15};a.EncodeZigzag32=function(d){d=e.Number.ToInt32(d);return d<<1^d>>31};a.EncodeZigzag64=function(d){var a=d.low,b=d.high;d=b<<1|a>>>31;a<<=1;
b&2147483648&&(d=~d,a=~a);b=new e.UInt64("0");b.low=a;b.high=d;return b};return a}();c.Zigzag=a})(e.Encoding||(e.Encoding={}));(function(c){var a=function(){function a(){}a.GetString=function(d){for(var a=[],b=0;b<d.length;++b){var c=d[b];if(191>=c)a.push(String.fromCharCode(c));else if(223>=c){var k=d[++b];a.push(String.fromCharCode((c&31)<<6|k&63))}else if(239>=c){var k=d[++b],e=d[++b];a.push(String.fromCharCode((c&15)<<12|(k&63)<<6|e&63))}else{var k=d[++b],e=d[++b],n=d[++b],c=(c&7)<<18|(k&63)<<
12|(e&63)<<6|n&63,c=c-65536;a.push(String.fromCharCode(55296|c>>10&1023));a.push(String.fromCharCode(56320|c&1023))}}return a.join("")};return a}();c.Utf8=a;a=function(){function a(){}a.GetBytes=function(d){for(var a=[],b=0;b<d.length;++b){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(d.charAt(b++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(d.charAt(b++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(d.charAt(b++)),
n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(d.charAt(b));a.push(c<<2|k>>4);0<=e&&(a.push(k<<4&240|e>>2),0<=n&&a.push(e<<6&192|n))}return a};return a}();c.Base64=a;a=function(){function a(){}a.GetInt64=function(a){var b=new f.Bond.Int64("0");a=this._Read(a);b.low=a[0];1<a.length&&(b.high=a[1]);return b};a.GetNumber=function(a){return this._Read(a)[0]};a._Read=function(a){for(var b=[],c=0,k=!0,e=0;k;){var f=a.shift(),k=0!=(f&128),f=f&127;if(28>e)c|=f<<e,e+=7;else{c|=
f<<e;b.push(c);c=f>>4;e=3;break}}for(;k&&!(f=a.shift(),k=0!=(f&128),f&=127,c|=f<<e,e+=7,32<=e););b.push(c);return b};return a}();c.Varint=a;a=function(){function a(){}a.GetNumber=function(a){if(e.BrowserChecker.IsDataViewSupport()){for(var c=new DataView(new ArrayBuffer(4)),k=0;4>k;++k)c.setUint8(k,a[k]);return c.getFloat32(0,!0)}return b.ConvertArrayToNumber(a,!1)};return a}();c.Float=a;a=function(){function a(){}a.GetNumber=function(a){if(e.BrowserChecker.IsDataViewSupport()){for(var c=new DataView(new ArrayBuffer(8)),
k=0;8>k;++k)c.setUint8(k,a[k]);return c.getFloat64(0,!0)}return b.ConvertArrayToNumber(a,!0)};return a}();c.Double=a;a=function(){function a(){}a.DecodeZigzag16=function(a){return((65535&a)>>>1^-(a&1))<<16>>16};a.DecodeZigzag32=function(a){return a>>>1^-(a&1)};a.DecodeZigzag64=function(a){var b=a.high>>>1,c=a.low&1,k=a.low>>>1,k=(a.high&1)<<31|k;c&&(k^=4294967295,b^=4294967295);a=new f.Bond.UInt64("0");a.low=k;a.high=b;return a};return a}();c.Zigzag=a})(e.Decoding||(e.Decoding={}));var b=function(){function b(){}
b.ConvertNumberToArray=function(a,b){if(!a)return b?this._doubleZero:this._floatZero;var d=b?52:23,c=(1<<(b?11:8)-1)-1,e=0>a?1:0;a=Math.abs(a);for(var g=Math.floor(a),f=a-g,q=2*(c+2)+d,n=Array(q),h=0;h<q;)n[h++]=0;for(h=c+2;h&&g;)n[--h]=g%2,g=Math.floor(g/2);for(h=c+1;h<q-1&&0<f;)f*=2,1<=f?(n[++h]=1,--f):n[++h]=0;for(f=0;f<q&&!n[f];++f);q=c+1-f;h=f+d;if(n[h+1]){for(;h>f&&!(n[h]=1-n[h]);--h);h==f&&++q}if(q>c||g)return e?b?this._doubleNegInifinity:this._floatNegInifinity:b?this._doubleInifinity:this._floatInifinity;
if(q<1-c)return b?this._doubleZero:this._floatZero;if(b){for(h=g=0;20>h;++h)g=g<<1|n[++f];for(d=0;52>h;++h)d=d<<1|n[++f];g=e<<31|(g|q+c<<20)&2147483647;c=[d&255,d>>8&255,d>>16&255,d>>>24,g&255,g>>8&255,g>>16&255,g>>>24]}else{for(h=g=0;23>h;++h)g=g<<1|n[++f];g=e<<31|(g|q+c<<23)&2147483647;c=[g&255,g>>8&255,g>>16&255,g>>>24]}return c};b.ConvertArrayToNumber=function(a,b){var d=(1<<(b?11:8)-1)-1,c=0!=(a[b?7:3]&128),f=b?(a[7]&127)<<4|(a[6]&240)>>4:(a[3]&127)<<1|(a[2]&128)>>7;if(255==f)throw new e.Exception("Not a valid float/double buffer.");
var g=1,t=1;if(b){var q=(a[6]&15)<<28|(a[5]&255)<<20|(a[4]&255)<<12,n=a[3]<<24|(a[2]&255)<<16|(a[1]&255)<<8|a[0]&255;if(!f&&!q&&!n)return 0;for(var h=0;20>h;++h)t/=2,0>q&&(g+=t),q<<=1;for(h=0;32>h;++h)t/=2,0>n&&(g+=t),n<<=1}else{q=(a[2]&127)<<25|(a[1]&255)<<17|(a[0]&255)<<9;if(!f&&!q)return 0;for(h=0;23>h;++h)t/=2,0>q&&(g+=t),q<<=1}g*=Math.pow(2,f-d);return c?0-g:g};b._floatZero=[0,0,0,0];b._doubleZero=[0,0,0,0,0,0,0,0];b._floatInifinity=[0,0,128,127];b._floatNegInifinity=[0,0,128,255];b._doubleInifinity=
[0,0,0,0,0,0,240,127];b._doubleNegInifinity=[0,0,0,0,0,0,240,255];return b}()})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(e){(function(b){var c=function(){function a(){this._buffer=[]}a.prototype.WriteByte=function(a){this._buffer.push(e.Number.ToByte(a))};a.prototype.Write=function(a,d,b){for(;b--;)this.WriteByte(a[d++])};a.prototype.GetBuffer=function(){return this._buffer};return a}();b.MemoryStream=c})(e.IO||(e.IO={}))})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(e){var b=function(){return function(b,a){this.Type=b;this.Id=a}}();e.FieldTag=b;b=function(){return function(b,a){this.ElementType=b;this.Size=a}}();e.ContainerTag=b;b=function(){return function(b,a,k){this.KeyType=b;this.ValueType=a;this.Size=k}}();e.KeyValueContainerTag=b;b=function(){return function(){}}();e.Bonded=b;b=function(){function b(a){this.high=this.low=0;this.low=parseInt(a);0>this.low&&(this.high=-1)}b.prototype.Equals=function(a){a=new b(a);return this.low==a.low&&
this.high==a.high};return b}();e.Int64=b;b=function(){function b(a){this.high=this.low=0;this.low=parseInt(a)}b.prototype.Equals=function(a){a=new b(a);return this.low==a.low&&this.high==a.high};return b}();e.UInt64=b;b=function(){function b(){}b.ToByte=function(a){return this.ToUInt8(a)};b.ToInt8=function(a){return a&127|(a&128)<<24>>24};b.ToInt16=function(a){return a&32767|(a&32768)<<16>>16};b.ToInt32=function(a){return a&2147483647|a&2147483648};b.ToUInt8=function(a){return a&255};b.ToUInt16=function(a){return a&
65535};b.ToUInt32=function(a){return a&4294967295};return b}();e.Number=b;b=function(){return function(b){this.Message=b}}();e.Exception=b;b=function(){return function(){}}();e.KeyValuePair=b;b=function(){function b(){}b.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView};return b}();e.BrowserChecker=b})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(e){var b=function(){function b(a){this._stream=a}b.prototype.WriteBlob=function(a){this._stream.Write(a,0,a.length)};b.prototype.WriteBool=function(a){this._stream.WriteByte(a?1:0)};b.prototype.WriteContainerBegin=function(a,b){this.WriteUInt8(b);this.WriteUInt32(a)};b.prototype.WriteMapContainerBegin=function(a,b,d){this.WriteUInt8(b);this.WriteUInt8(d);this.WriteUInt32(a)};b.prototype.WriteContainerEnd=function(){};b.prototype.WriteDouble=function(a){a=e.Encoding.Double.GetBytes(a);
this._stream.Write(a,0,a.length)};b.prototype.WriteFloat=function(a){a=e.Encoding.Float.GetBytes(a);this._stream.Write(a,0,a.length)};b.prototype.WriteFieldBegin=function(a,b,d){5>=b?this._stream.WriteByte(a|b<<5):255>=b?(this._stream.WriteByte(a|192),this._stream.WriteByte(b)):(this._stream.WriteByte(a|224),this._stream.WriteByte(b),this._stream.WriteByte(b>>8))};b.prototype.WriteFieldEnd=function(){};b.prototype.WriteFieldOmitted=function(a,b,d){};b.prototype.WriteInt16=function(a){a=e.Encoding.Zigzag.EncodeZigzag16(a);
this.WriteUInt16(a)};b.prototype.WriteInt32=function(a){a=e.Encoding.Zigzag.EncodeZigzag32(a);this.WriteUInt32(a)};b.prototype.WriteInt64=function(a){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(a))};b.prototype.WriteInt8=function(a){this._stream.WriteByte(e.Number.ToInt8(a))};b.prototype.WriteString=function(a){""==a?this.WriteUInt32(0):(a=e.Encoding.Utf8.GetBytes(a),this.WriteUInt32(a.length),this._stream.Write(a,0,a.length))};b.prototype.WriteStructBegin=function(a,b){};b.prototype.WriteStructEnd=
function(a){this.WriteUInt8(a?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)};b.prototype.WriteUInt16=function(a){a=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(a));this._stream.Write(a,0,a.length)};b.prototype.WriteUInt32=function(a){a=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(a));this._stream.Write(a,0,a.length)};b.prototype.WriteUInt64=function(a){a=e.Encoding.Varint64.GetBytes(a);this._stream.Write(a,0,a.length)};b.prototype.WriteUInt8=function(a){this._stream.WriteByte(e.Number.ToUInt8(a))};
b.prototype.WriteWString=function(a){this.WriteUInt32(a.length);for(var b=0;b<a.length;++b){var d=a.charCodeAt(b);this._stream.WriteByte(d);this._stream.WriteByte(d>>>8)}};return b}();e.CompactBinaryProtocolWriter=b;b=function(){return function(){}}();e.CompactBinaryProtocolReader=b})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));var sct;
(function(f){var e=function(){function b(){}b.IsSafari=function(){if(null===b._isSafari)if("undefined"!==typeof navigator&&navigator.userAgent){var c=navigator.userAgent.toLowerCase();0<=c.indexOf("safari")&&0>c.indexOf("chrome")?b._isSafari=!0:b._isSafari=!1}else b._isSafari=!1;return b._isSafari};b.IsReactNative=function(){null===b._isReactNative&&(b._isReactNative="undefined"!==typeof navigator&&navigator.product?"ReactNative"===navigator.product:!1);return b._isReactNative};b.IsUint8ArrSupported=
function(){return!f.Utils.IsSafari()&&"undefined"!==typeof Uint8Array&&!f.Utils.IsReactNative()};b.ajax=function(c,a){var e=b._createConnection();if(c.headers){var d="qsp=true",m;for(m in c.headers)d+="&",d+=encodeURIComponent(m),d+="=",d+=encodeURIComponent(c.headers[m]);0>c.url.indexOf("?")?c.url+="?":c.url+="&";c.url+=d}e.open(c.type,c.url,!a);c.complete&&(e.onload=function(){"undefined"==typeof e.status&&(e.status=200);c.complete(e)},e.ontimeout=function(){"undefined"==typeof e.status&&(e.status=
500);c.complete(e)},e.onerror=function(){c.complete(e)});e.send(c.data)};b.keys=function(b){if(Object.keys)return Object.keys(b);var a=[],e;for(e in b)b.hasOwnProperty(e)&&a.push(e);return a};b.IsUsingXDomainRequest=function(){null==b._usingXDomainRequest&&(b._usingXDomainRequest="undefined"==typeof(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?!0:!1);return b._usingXDomainRequest};b._createConnection=function(){var c=new XMLHttpRequest;return b.IsUsingXDomainRequest()?new XDomainRequest:
c};b._isSafari=null;b._isReactNative=null;b._usingXDomainRequest=null;return b}();f.Utils=e})(sct||(sct={}));var microsoft;
(function(f){(function(e){(function(b){(function(c){var a=function(){function a(){}a.GetGuid=function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[a(),a(),"-",a(),"-",a(),"-",a(),"-",a(),a(),a()].join("")};a.GetTimeStamp=function(){var a=(new Date).getTime(),b=new Microsoft.Bond.Int64("0");b.low=a&4294967295;b.high=Math.floor(a/4294967296);return b};a.GetTimeStampWithValue=function(a){var b=new Microsoft.Bond.Int64("0");b.low=a&4294967295;b.high=
Math.floor(a/4294967296);return b};return a}();c.utils=a;(function(a){a[a.NotSet=0]="NotSet";a[a.Event=1]="Event";a[a.PerformanceCounter=2]="PerformanceCounter";a[a.Anomaly=3]="Anomaly";a[a.Prediction=4]="Prediction";a[a.TraceLog=5]="TraceLog";a[a.EventSourceLog=6]="EventSourceLog";a[a.HttpLog=7]="HttpLog";a[a.PerformanceCounterAzure=8]="PerformanceCounterAzure";a[a.PerformanceCounterGfs=9]="PerformanceCounterGfs"})(c.RecordType||(c.RecordType={}));(function(a){a[a.NotSet=0]="NotSet";a[a.O365=1]=
"O365";a[a.SkypeBI=2]="SkypeBI";a[a.SkypeData=3]="SkypeData"})(c.PIIScrubber||(c.PIIScrubber={}));(function(a){a[a.NotSet=0]="NotSet";a[a.DistinguishedName=1]="DistinguishedName";a[a.GenericData=2]="GenericData";a[a.IPV4Address=3]="IPV4Address";a[a.IPv6Address=4]="IPv6Address";a[a.MailSubject=5]="MailSubject";a[a.PhoneNumber=6]="PhoneNumber";a[a.QueryString=7]="QueryString";a[a.SipAddress=8]="SipAddress";a[a.SmtpAddress=9]="SmtpAddress";a[a.Identity=10]="Identity";a[a.Uri=11]="Uri";a[a.Fqdn=12]="Fqdn";
a[a.IPV4AddressLegacy=13]="IPV4AddressLegacy"})(c.PIIKind||(c.PIIKind={}));(function(a){a[a.Unknown=0]="Unknown";a[a.MSACID=1]="MSACID";a[a.MSAPUID=2]="MSAPUID";a[a.ANID=3]="ANID";a[a.OrgIdCID=4]="OrgIdCID";a[a.OrgIdPUID=5]="OrgIdPUID";a[a.UserObjectId=6]="UserObjectId";a[a.Skype=7]="Skype";a[a.Yammer=8]="Yammer";a[a.EmailAddress=9]="EmailAddress";a[a.PhoneNumber=10]="PhoneNumber";a[a.SipAddress=11]="SipAddress";a[a.MUID=12]="MUID"})(c.UserIdType||(c.UserIdType={}));var e=function(){function a(){this.ScrubType=
b.datamodels.PIIScrubber.NotSet;this.Kind=b.datamodels.PIIKind.NotSet;this.RawContent=""}a.prototype.Write=function(a){this.WriteImpl(a,!1)};a.prototype.WriteImpl=function(a,d){a.WriteStructBegin(null,d);this.ScrubType!=b.datamodels.PIIScrubber.NotSet?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),a.WriteInt32(this.ScrubType),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null);this.Kind!=b.datamodels.PIIKind.NotSet?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,
2,null),a.WriteInt32(this.Kind),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null);""!=this.RawContent?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),a.WriteString(this.RawContent),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null);a.WriteStructEnd(d)};a.prototype.Read=function(a){this.ReadImpl(a,!1)};a.prototype.ReadImpl=function(a,b){};return a}();c.PII=e;e=function(){function d(){this.Id=a.GetGuid();this.Timestamp=
a.GetTimeStamp();this.EventType=this.Type="";this.Extension=new Microsoft.Bond.Collections.Map;this.RecordType=b.datamodels.RecordType.NotSet;this.PIIExtensions=new Microsoft.Bond.Collections.Map}d.prototype.AddOrReplacePII=function(a,d,c){var e=new b.datamodels.PII;e.RawContent=d;e.Kind=c;e.ScrubType=b.datamodels.PIIScrubber.O365;this.PIIExtensions.AddOrReplace(a,e)};d.prototype.Write=function(a){this.WriteImpl(a,!1)};d.prototype.WriteImpl=function(a,d){a.WriteStructBegin(null,d);""!=this.Id?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,
1,null),a.WriteString(this.Id),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null);this.Timestamp.Equals("0")?a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),a.WriteInt64(this.Timestamp),a.WriteFieldEnd());""!=this.Type?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),a.WriteString(this.Type),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,
5,null);""!=this.EventType?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),a.WriteString(this.EventType),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null);if(this.Extension.Count()){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null);a.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING);for(var c=0;c<this.Extension.GetBuffer().length;++c)a.WriteString(this.Extension.GetBuffer()[c].Key),
a.WriteString(this.Extension.GetBuffer()[c].Value);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null);this.RecordType!=b.datamodels.RecordType.NotSet?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),a.WriteInt32(this.RecordType),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null);if(this.PIIExtensions.Count()){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null);a.WriteMapContainerBegin(this.PIIExtensions.Count(),
Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT);for(c=0;c<this.PIIExtensions.GetBuffer().length;++c)a.WriteString(this.PIIExtensions.GetBuffer()[c].Key),this.PIIExtensions.GetBuffer()[c].Value.WriteImpl(a,!1);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null);a.WriteStructEnd(d)};d.prototype.Read=function(a){this.ReadImpl(a,!1)};d.prototype.ReadImpl=function(a,b){};return d}();c.Record=e;e=function(){function a(){this.DataPackageId=
this.Source="";this.Timestamp=new Microsoft.Bond.Int64("0");this.Records=[]}a.prototype.Write=function(a){this.WriteImpl(a,!1)};a.prototype.WriteImpl=function(a,b){a.WriteStructBegin(null,b);""!=this.Source?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),a.WriteString(this.Source),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null);""!=this.DataPackageId?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),a.WriteString(this.DataPackageId),
a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null);this.Timestamp.Equals("0")?a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),a.WriteInt64(this.Timestamp),a.WriteFieldEnd());if(this.Records.length){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null);a.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var d=0;d<this.Records.length;++d)this.Records[d].WriteImpl(a,
!1);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null);a.WriteStructEnd(b)};a.prototype.Read=function(a){this.ReadImpl(a,!1)};a.prototype.ReadImpl=function(a,b){};return a}();c.DataPackage=e;e=function(){function a(){this.DataPackages=[];this.RequestRetryCount=0}a.prototype.Write=function(a){this.WriteImpl(a,!1)};a.prototype.WriteImpl=function(a,b){a.WriteStructBegin(null,b);if(this.DataPackages.length){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,
1,null);a.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var d=0;d<this.DataPackages.length;++d)this.DataPackages[d].WriteImpl(a,!1);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),a.WriteInt32(this.RequestRetryCount),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null);a.WriteStructEnd(b)};
a.prototype.Read=function(a){this.ReadImpl(a,!1)};a.prototype.ReadImpl=function(a,b){};return a}();c.ClientToCollectorRequest=e})(b.datamodels||(b.datamodels={}))})(e.telemetry||(e.telemetry={}))})(f.applications||(f.applications={}))})(microsoft||(microsoft={}));
(function(f){(function(e){(function(b){(function(c){(function(a){a[a.SENT=0]="SENT";a[a.SEND_FAILED=1]="SEND_FAILED"})(c.CallbackEventType||(c.CallbackEventType={}));var a=c.CallbackEventType;(function(a){a[a.DATARV_ERROR_OK=0]="DATARV_ERROR_OK";a[a.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT";a[a.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG";a[a.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES";a[a.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS";
a[a.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"})(c.DATARV_ERROR||(c.DATARV_ERROR={}));var e=c.DATARV_ERROR,d=function(){function a(b){this._errorCode=e.DATARV_ERROR_OK;this._errorCode=b}a.prototype.ErrorCode=function(){return this._errorCode};a.prototype.toString=function(){switch(this._errorCode){case e.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case e.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";
case e.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case e.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case e.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case e.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}};return a}();c.Exception=d;var f=function(){return function(){}}();c.TelemetryConfig=f;f=function(){function a(){}a.CreateTelemetryManager=
function(){return new t};return a}();c.TelemetryManagerFactory=f;var r=function(){function a(){}a.MaxPackageSizeInBytes=function(){return 3E6};a.TimeIntervalForNextSendInMS=function(){return 1E3};return a}(),g;(function(a){a[a.Created=0]="Created";a[a.Initialized=1]="Initialized";a[a.Started=2]="Started"})(g||(g={}));var t=function(){function c(){this._MaxPackageSizeInBytes=r.MaxPackageSizeInBytes();this._listeners=[];this._status=g.Created;this._testServerResponseHook=this._etag=null;this._isPaused=
!1}c.prototype.Initialize=function(a){if(this._status!=g.Created)throw new d(e.DATARV_ERROR_INVALID_STATUS);if(!a||!a.collectorUrl)throw new d(e.DATARV_ERROR_INVALID_CONFIG);this._config=a;this._Reset();this._status=g.Initialized;this._Verbose("Initialize() done")};c.prototype.AddListener=function(a){if(this._status<g.Initialized)throw new d(e.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",a].join(""));for(var b=
0;b<this._listeners.length;++b)if(this._listeners[b]==a){this._Verbose("the listener has been added already, index: "+b);return}this._listeners.push(a);this._Verbose("AddListener() done, the new length: "+this._listeners.length)};c.prototype.RemoveListener=function(a){if(this._status<g.Initialized)throw new d(e.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",a].join(""));for(var b=0;b<this._listeners.length;++b)if(this._listeners[b]==
a){1==this._listeners.length?this._listeners=[]:b==this._listeners.length-1?this._listeners.pop():this._listeners[b]=this._listeners.pop();this._Verbose(["this listener has been found, index: ",b,"new length: ",this._listeners.length].join(""));return}this._Verbose("listener isn't been found, new length"+this._listeners.length)};c.prototype.Start=function(){if(this._status<g.Initialized)throw new d(e.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",c._tag].join(" "));
this._status>=g.Started&&this._Verbose("Start() already, ignore");++c._tag;this._status=g.Started;this._Verbose(["Start() done, status: ",this._status,"tag: ",c._tag].join(""))};c.prototype.Stop=function(){if(this._status<g.Initialized)throw new d(e.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status);this._status==g.Initialized?this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=g.Initialized,this._Verbose("Stop() done, status: "+this._status))};c.prototype.Pause=
function(){this._isPaused=!0;this._CleanTimer()};c.prototype.Resume=function(){this._isPaused=!1;this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)};c.prototype.Flush=function(a){this._eventsCache.IsEmpty()||this._WorkThread(a,!0)};c.prototype.SendAsync=function(a,b){if(this._status<g.Initialized)throw new d(e.DATARV_ERROR_INVALID_STATUS);this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",a,"count:",b.length].join(" "));if(this._status<g.Started)return this._Info("SendAsync(), not started, ignore, return false"),
!1;if(!a||!b)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new d(e.DATARV_ERROR_INVALID_ARG);for(var p=0;p<b.length;++p)if(!b[p].Id||!c._eventTypeRegex.test(b[p].EventType)||b[p].Timestamp.Equals("0"))throw this._Error(["eventId:",b[p].Id,"eventType:",b[p].EventType,"timestamp high:",b[p].Timestamp.high,"timestamp low:",b[p].Timestamp.low].join("")),new d(e.DATARV_ERROR_INVALID_EVENT);this._eventsCache.AddEvents(a,b);this._Verbose(["SendAsync(), currentTimer: ",this._timer,
"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" "));this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1);this._Verbose("SendAsync() done");return!0};c.prototype._WorkThread=function(a,b){var p=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<g.Started)this._Verbose("_WorkThread, status is not started, return");else{var l=this._eventsCache.DequeuEvents();if(null==l)this._Verbose("_WorkThread, No events found, return"),this._CleanTimer();else{var d=
this._PackEvents(l.tenantToken,l.events);this._eventsCache.AddEvents(l.tenantToken,d.remainedEvents);if(null==d.buffer||0==d.buffer.length)this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1));else if(this._testServerResponseHook){var e=this._testServerResponseHook();setTimeout(this._SendCallback(k,l.tenantToken,d.sendEvents,e,!1,null),100)}else{var f={type:"POST",
url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(c){return p._SendCallback(k,l.tenantToken,d.sendEvents,c,b,a)}};sct.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),f.data=new Uint8Array(d.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),f.data=Microsoft.Bond.Encoding.Base64.GetString(d.buffer),
f.headers["content-encoding"]="base64");l.tenantToken&&(f.headers["x-apikey"]=l.tenantToken);var k=c._tag;this._lastActiveTime=(new Date).getTime();sct.Utils.ajax(f,b);this._Verbose("_Workthread, send via jquery, tag: "+k)}}}}catch(m){this._Error("_WorkThread, exception: "+m)}};c.prototype._PackEvents=function(a,c){this._Verbose("_PackageEvents, total Count: "+c.length);var p=new b.datamodels.ClientToCollectorRequest,l=new b.datamodels.DataPackage;l.Source="JS_default_source";l.DataPackageId=b.datamodels.utils.GetGuid();
l.Timestamp=b.datamodels.utils.GetTimeStamp();var d,e=c;for(c=[];;){l.Records=[];l.Records.push.apply(l.Records,e);p.DataPackages=[];p.DataPackages.push(l);d=this._Serialize(p);this._Verbose(["_PackageEvents, sendEvents.length:",e.length,"buffer.length:",d.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join(""));if(d.length<this._MaxPackageSizeInBytes)break;else if(1==e.length){e=[];d=null;break}d=e.splice(0,Math.floor(e.length/2));this._Verbose("_PackageEvents, too large, package again");
c.push.apply(c,e);e=d}this._Verbose(["_PakcageEvents done, sendEventsCount:",e.length,"buffer.length:",null==d?0:d.length,"remained events:",c.length].join(""));return{buffer:d,sendEvents:e,remainedEvents:c}};c.prototype._Serialize=function(a){var b=new Microsoft.Bond.IO.MemoryStream,p=new Microsoft.Bond.CompactBinaryProtocolWriter(b);a.Write(p);return b.GetBuffer()};c.prototype._SendCallback=function(b,d,p,l,e,v){this._Verbose(["_SendCallbacktag:",b,"current tag:",c._tag,"tenantToken:",d,"events count:",
p.length,"jqXHR:",l].join(""));v&&v(l?l.status:0,d,p);if(!e)if(e=null!=l&&200<=l.status&&300>l.status,this._status<g.Started||b<c._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else if(e||l&&(!l.status||400==l.status)){for(b=0;b<this._listeners.length;++b)this._listeners[b](e?a.SENT:a.SEND_FAILED,l?l.status:0,d,p);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),
this._ScheduleTimer(!1))}else this._Verbose("retry statusCode: "+(l?l.status:0)),this._eventsCache.AddEvents(d,p),this._ScheduleTimer(!0)};c.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer);this._timer&&(clearTimeout(this._timer),this._timer=null)};c.prototype._ScheduleTimer=function(a){var b=this;this._isPaused||(this._Verbose("_ScheduleTimer: isRetry: "+a),this._CleanTimer(),a?(this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor),a=Math.floor(5*
this._rescheduleFactor*(1+Math.random())),this._timer=setTimeout(function(){return b._WorkThread(null,!1)},1E3*a),this._Verbose("_ScheduleTimer, next try (s): "+a),this._rescheduleFactor<<=1,64<this._rescheduleFactor&&(this._rescheduleFactor=1)):(a=0,a=(new Date).getTime()-this._lastActiveTime,a=a>r.TimeIntervalForNextSendInMS()?0:r.TimeIntervalForNextSendInMS()-a,this._timer=setTimeout(function(){return b._WorkThread(null,!1)},a),this._Verbose("_ScheduleTimer, next try: "+a),this._rescheduleFactor=
1))};c.prototype._Verbose=function(a){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+a)};c.prototype._Info=function(a){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+a)};c.prototype._Error=function(a){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+a)};c.prototype._Reset=function(){this._Verbose("Reset()");this._CleanTimer();this._lastActiveTime=0;this._rescheduleFactor=1;this._sendingEvents=[];this._eventsCache=new q};c.prototype.__GetListenerArray=
function(){return this._listeners};c.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()};c.prototype.__IsScheduled=function(){return null!=this._timer};c.prototype.__ChageMaxPackageSizeInKB=function(a){this._MaxPackageSizeInBytes=1024*a};c.prototype.__SetTestServerResponseHook=function(a){this._testServerResponseHook=a};c._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/;c._tag=0;return c}(),q=function(){function a(){this._events={};this._tokens=
[]}a.prototype.AddEvents=function(a,b){b.length&&(this._events[a]||(this._events[a]=[],this._tokens.push(a)),this._events[a].push.apply(this._events[a],b))};a.prototype.IsEmpty=function(){return 0==this._tokens.length};a.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var a=this._tokens.shift(),b=this._events[a];delete this._events[a];return{tenantToken:a,events:b}};a.prototype.GetTotalEventsCount=function(){var a=0,b;for(b in this._events)a+=this._events[b].length;return a};
return a}()})(b._sender||(b._sender={}))})(e.telemetry||(e.telemetry={}))})(f.applications||(f.applications={}))})(microsoft||(microsoft={}));
(function(f){(function(e){(function(b){var c=b._sender.TelemetryManagerFactory.CreateTelemetryManager(),a=function(){function a(){this.collectorUrl=null;this.enableAutoUserSession=!1;this.browserOverrides=new e}a.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/";a.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/";a.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/";a.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/";
a.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/";return a}();b.LogConfiguration=a;var e=function(){return function(){this.onGetData=this.onSaveData=null}}();b.LogConfigurationBrowserOverrides=e;var d=function(){function a(){this.pii=this.value=null}a._isPii=function(a){return null===a||void 0===a||a===b.datamodels.PIIKind.NotSet||isNaN(a)?!1:void 0!==b.datamodels.PIIKind[a]};return a}(),m=function(){function a(){this.timestamp=this.name=null;this.properties={};this.eventType=
null}a.prototype.setProperty=function(l,c,d){if(!l||!a._propertyNameRegex.test(l))throw new g(r.INVALID_PROPERTY_NAME);this.properties[l]=d?{value:c,pii:d!=b.datamodels.PIIKind.NotSet?d:null}:{value:c,pii:null}};a._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/;return a}();b.EventProperties=m;(function(a){a[a.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN";a[a.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME";a[a.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME";
a[a.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE";a[a.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL";a[a.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID";a[a.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME";a[a.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE";a[a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"})(b.TelemetryError||(b.TelemetryError={}));var r=b.TelemetryError,g=function(){function a(b){this.errorCode=null;this.errorCode=b}a.prototype.ErrorCode=
function(){return this.errorCode};a.prototype.toString=function(){switch(this.errorCode){case r.INVALID_TENANT_TOKEN:return"Invalid tenant token";case r.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case r.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case r.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case r.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";
case r.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case r.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case r.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case r.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}};
return a}();b.Exception=g;var t=function(){function a(p){this.contextMap={};this.piiKind=b.datamodels.PIIKind.NotSet;this._allowDeviceInfoFields=!1;this._allowDeviceInfoFields=p}a.prototype.setAppId=function(a){a&&(this.contextMap["AppInfo.Id"]=a)};a.prototype.setAppVersion=function(a){a&&(this.contextMap["AppInfo.Version"]=a)};a.prototype.setAppLanguage=function(a){a&&(this.contextMap["AppInfo.Language"]=a)};a.prototype.setDeviceId=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=
a,q.checkAndUpdateDeviceId(a))};a.prototype.setDeviceOsName=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=a)};a.prototype.setDeviceOsVersion=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=a)};a.prototype.setDeviceBrowserName=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=a)};a.prototype.setDeviceBrowserVersion=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=
a)};a.prototype.setUserId=function(a,b,p){a&&(this.contextMap["UserInfo.Id"]=a);if(p)this.contextMap["UserInfo.IdType"]=p;else{switch(b){case f.applications.telemetry.datamodels.PIIKind.SipAddress:a=f.applications.telemetry.datamodels.UserIdType.SipAddress;break;case f.applications.telemetry.datamodels.PIIKind.PhoneNumber:a=f.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case f.applications.telemetry.datamodels.PIIKind.SmtpAddress:a=f.applications.telemetry.datamodels.UserIdType.EmailAddress;
break;default:a=f.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=a}if(!b)switch(p){case f.applications.telemetry.datamodels.UserIdType.Skype:b=f.applications.telemetry.datamodels.PIIKind.Identity;break;case f.applications.telemetry.datamodels.UserIdType.EmailAddress:b=f.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case f.applications.telemetry.datamodels.UserIdType.PhoneNumber:b=f.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case f.applications.telemetry.datamodels.UserIdType.SipAddress:b=
f.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:b=f.applications.telemetry.datamodels.PIIKind.NotSet}d._isPii(b)&&(this.piiKind=b)};a.prototype.setUserMsaId=function(a){a&&(this.contextMap["UserInfo.MsaId"]=a)};a.prototype.setUserANID=function(a){a&&(this.contextMap["UserInfo.ANID"]=a)};a.prototype.setUserAdvertisingId=function(a){a&&(this.contextMap["UserInfo.AdvertisingId"]=a)};a.prototype.setUserTimeZone=function(a){a&&(this.contextMap["UserInfo.TimeZone"]=a)};a.prototype.setUserLanguage=
function(a){a&&(this.contextMap["UserInfo.Language"]=a)};return a}();b.SemanticContext=t;var q=function(){function a(){}a.initialize=function(c){this._overrides=c;(c=a._getAppLanguage())&&a.semanticContext.setAppLanguage(c);(c=a._getUserLanguage())&&a.semanticContext.setUserLanguage(c);var d=(new Date).getTimezoneOffset();c=d%60;var d=(d-c)/60,e="+";0<d&&(e="-");a.semanticContext.setUserTimeZone(e+(10>d?"0"+d:d.toString())+":"+(10>c?"0"+c:c.toString()));a._getUserAgent()&&(a.semanticContext.setDeviceBrowserName(a._getBrowserName()),
a.semanticContext.setDeviceBrowserVersion(a._getBrowserVersion()),a.semanticContext.setDeviceOsName(a._getOsName()),a.semanticContext.setDeviceOsVersion(a._getOsVersion()));(c=a._getData(a.DEVICE_ID_COOKIE))&&""!=c||(c=b.datamodels.utils.GetGuid());a.semanticContext.setDeviceId(c)};a.checkAndUpdateDeviceId=function(b){a._getData(a.DEVICE_ID_COOKIE)!=b&&(a._saveData(a.DEVICE_ID_COOKIE,b),a._saveData(a.FIRST_LAUNCH_TIME_COOKIE,(new Date).getTime().toString()));b=a._getData(a.FIRST_LAUNCH_TIME_COOKIE);
a.firstLaunchTime=parseInt(b)};a._saveData=function(a,b){if(this._overrides.onSaveData)this._overrides.onSaveData(a,b);else"undefined"!==typeof document&&document.cookie&&(document.cookie=a+"="+b+"; expires=Mon, 31 Dec 2029 23:59:59 GMT")};a._getData=function(a){if(this._overrides.onGetData)return this._overrides.onGetData(a)||"";if("undefined"!==typeof document&&document.cookie){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c],e=0;" "==d.charAt(e);)e++;d=d.substring(e);
if(0==d.indexOf(a))return d.substring(a.length,d.length)}}return""};a._getUserAgent=function(){return"undefined"!==typeof navigator?navigator.userAgent||"":""};a._getAppLanguage=function(){return"undefined"!==typeof document&&document.documentElement?document.documentElement.lang:null};a._getUserLanguage=function(){return"undefined"!==typeof navigator?navigator.userLanguage||navigator.language:null};a._userAgentContainsString=function(b){return-1<a._getUserAgent().indexOf(b)};a._isIe=function(){return a._userAgentContainsString("Trident")};
a._isEdge=function(){return a._userAgentContainsString(a.BROWSERS.EDGE)};a._isOpera=function(){return a._userAgentContainsString("OPR/")};a._getBrowserName=function(){return a._isOpera()?a.BROWSERS.UNKNOWN:a._userAgentContainsString(a.BROWSERS.PHANTOMJS)?a.BROWSERS.PHANTOMJS:a._isIe()?a.BROWSERS.MSIE:a._isEdge()?a.BROWSERS.EDGE:a._userAgentContainsString(a.BROWSERS.ELECTRON)?a.BROWSERS.ELECTRON:a._userAgentContainsString(a.BROWSERS.CHROME)?a.BROWSERS.CHROME:a._userAgentContainsString(a.BROWSERS.FIREFOX)?
a.BROWSERS.FIREFOX:a._userAgentContainsString(a.BROWSERS.SAFARI)?a.BROWSERS.SAFARI:a._userAgentContainsString(a.BROWSERS.SKYPE_SHELL)?a.BROWSERS.SKYPE_SHELL:a.BROWSERS.UNKNOWN};a._getBrowserVersion=function(){function b(){var c;c=a._getUserAgent();var d=c.match(new RegExp(a.BROWSERS.MSIE+" "+a.REGEX_VERSION));if(d)return d[1];if(c=c.match(new RegExp("rv:"+a.REGEX_VERSION)))return c[1]}function c(b){b===a.BROWSERS.SAFARI&&(b="Version");return(b=a._getUserAgent().match(new RegExp(b+"/"+a.REGEX_VERSION)))?
b[1]:a.UNKNOWN_VERSION}return a._isIe()?b():c(a._getBrowserName())};a._getOsName=function(){return a._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?a.OPERATING_SYSTEMS.WINDOWS_PHONE:a._getUserAgent().match(/ arm;/i)?a.OPERATING_SYSTEMS.WINDOWS_RT:a._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?a.OPERATING_SYSTEMS.IOS:a._getUserAgent().match(/android/i)?a.OPERATING_SYSTEMS.ANDROID:a._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?
a.OPERATING_SYSTEMS.LINUX:a._getUserAgent().match(/(macintosh|mac os x)/i)?a.OPERATING_SYSTEMS.MACOSX:a._getUserAgent().match(/(windows|win32)/i)?a.OPERATING_SYSTEMS.WINDOWS:a.OPERATING_SYSTEMS.UNKNOWN};a._getOsVersion=function(){function b(){var c=a._getUserAgent().match(new RegExp("Windows NT "+a.REGEX_VERSION));return c&&a.VERSION_MAPPINGS[c[1]]?a.VERSION_MAPPINGS[c[1]]:a.UNKNOWN_VERSION}function c(){var b=a._getUserAgent().match(new RegExp(a.OPERATING_SYSTEMS.MACOSX+" "+a.REGEX_VERSION_MAC));
if(b){var b=b[1].replace(/_/g,"."),d=[];if(b)return d=-1<b.indexOf(".")?".":-1<b.indexOf("_")?"_":null,d?(d=b.split(d),d[0]):b}return a.UNKNOWN_VERSION}return a._getOsName()===a.OPERATING_SYSTEMS.WINDOWS?b():a._getOsName()===a.OPERATING_SYSTEMS.MACOSX?c():a.UNKNOWN_VERSION};a.semanticContext=new t(!0);a.firstLaunchTime=-1;a.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"};a.OPERATING_SYSTEMS=
{WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"};a.VERSION_MAPPINGS={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","10.0":"10"};a.REGEX_VERSION="([\\d,.]+)";a.REGEX_VERSION_MAC="([\\d,_,.]+)";a.UNKNOWN_VERSION="Unknown";a.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId";a.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime";return a}();(function(a){a[a.STARTED=
0]="STARTED";a[a.ENDED=1]="ENDED"})(b.SessionState||(b.SessionState={}));var n=b.SessionState,h=function(){function a(){}a.initialize=function(b,d){if(!a._initialized){if(!b)throw new g(r.INVALID_TENANT_TOKEN);a._defaultToken=b;a._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/";a._configuration=d;if(!("undefined"!==typeof window||d&&d.browserOverrides&&d.browserOverrides.onGetData))throw new g(r.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var f=new e;if(d&&(d.collectorUrl&&
(a._tmConfig.collectorUrl=d.collectorUrl),d.browserOverrides)){if(d.browserOverrides.onGetData?!d.browserOverrides.onSaveData:d.browserOverrides.onSaveData)throw new g(r.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);f.onGetData=d.browserOverrides.onGetData;f.onSaveData=d.browserOverrides.onSaveData}c.Initialize(a._tmConfig);c.Start();q.initialize(f);a._initialized=!0;"undefined"!==typeof window&&window.addEventListener&&(d&&d.enableAutoUserSession&&(a._logger=new u,a._logger.logSession(n.STARTED)),window.addEventListener("beforeunload",
a._teardown))}};a.pauseTransmission=function(){c.Pause()};a.resumeTransmission=function(){c.Resume()};a.flush=function(a){c.Flush(a)};a.addCallbackListener=function(b){a._initialized&&c.AddListener(b)};a.setContext=function(b,c,d){a._contextProperties.setProperty(b,c,d)};a.isInitialized=function(){return a._initialized};a.getDefaultToken=function(){return a._defaultToken};a.getSemanticContext=function(){return a._semanticContext};a._getInitIdForToken=function(c){a._initIdMap[c]||(a._initIdMap[c]=
b.datamodels.utils.GetGuid());return a._initIdMap[c]};a._getSequenceForToken=function(b){a._sequenceMap[b]||(a._sequenceMap[b]=0);a._sequenceMap[b]++;return a._sequenceMap[b]};a._teardown=function(){a._logger&&a._logger.logSession(n.ENDED);a.flush()};a.__backToUninitialized=function(){a._tmConfig=new b._sender.TelemetryConfig;a._semanticContext=new t(!0);a._contextProperties=new m;a._configuration=null;c=b._sender.TelemetryManagerFactory.CreateTelemetryManager();a._initialized=!1;a._initIdMap={};
a._sequenceMap={}};a._initialized=!1;a._defaultToken=null;a._tmConfig=new b._sender.TelemetryConfig;a._logger=null;a._initIdMap={};a._sequenceMap={};a._configuration=null;a._contextProperties=new m;a._semanticContext=new t(!0);return a}();b.LogManager=h;var u=function(){function a(b){this._tenantToken=this._initId=null;this._contextProperties=new m;this._semanticContext=new t(!1);this._sessionStartTime=0;this._sessionId=null;this._tenantToken=b?b:h.getDefaultToken();this._initId=h._getInitIdForToken(this._tenantToken)}
a.prototype.logEvent=function(a){if(!a.name)throw new g(r.MISSING_EVENT_PROPERTIES_NAME);var b=this._createEventRecord(a.name,a.eventType);this._addPropertiesAndSendEvent(b,a)};a.prototype.logFailure=function(a,b,c,d,e){if(!a)throw new g(r.MISSING_FAILURE_SIGNATURE);if(!b)throw new g(r.MISSING_FAILURE_DETAIL);var f=this._createEventRecord("failure","failure");f.Extension.Add("Failure.Signature",a);f.Extension.Add("Failure.Detail",b);c&&f.Extension.Add("Failure.Category",c);d&&f.Extension.Add("Failure.Id",
d);this._addPropertiesAndSendEvent(f,e)};a.prototype.logPageView=function(a,b,c,d,e,f){if(!a)throw new g(r.MISSING_PAGEVIEW_ID);if(!b)throw new g(r.MISSING_PAGEVIEW_NAME);var h=this._createEventRecord("pageview","pageview");h.Extension.Add("PageView.Id",a);h.Extension.Add("PageView.Name",b);c&&h.Extension.Add("PageView.Category",c);d&&h.Extension.Add("PageView.Uri",d);e&&h.Extension.Add("PageView.ReferrerUri",e);this._addPropertiesAndSendEvent(h,f)};a.prototype.logSession=function(a,c){if(a!==n.STARTED&&
a!==n.ENDED)throw new g(r.INVALID_SESSION_STATE);var d=this._createEventRecord("session","session");if(a===n.STARTED){if(0<this._sessionStartTime)return;this._sessionStartTime=(new Date).getTime();this._sessionId=b.datamodels.utils.GetGuid();d.Extension.Add("Session.Id",this._sessionId);d.Extension.Add("Session.State","Started")}else if(a===n.ENDED){if(0==this._sessionStartTime)return;var e=Math.floor(((new Date).getTime()-this._sessionStartTime)/1E3);d.Extension.Add("Session.Duration",e.toString());
d.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(e));d.Extension.Add("Session.Id",this._sessionId);d.Extension.Add("Session.State","Ended");this._sessionId=null;this._sessionStartTime=0}d.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(q.firstLaunchTime)));this._addPropertiesAndSendEvent(d,c)};a.prototype.getSessionId=function(){return this._sessionId};a.prototype.setContext=function(a,b,c){this._contextProperties.setProperty(a,b,c)};a.prototype.getSemanticContext=
function(){return this._semanticContext};a.prototype._getSessionDurationFromTime=function(a){return 0>a?"Undefined":3>=a?"UpTo3Sec":10>=a?"UpTo10Sec":30>=a?"UpTo30Sec":60>=a?"UpTo60Sec":180>=a?"UpTo3Min":600>=a?"UpTo10Min":1800>=a?"UpTo30Min":"Above30Min"};a.prototype._createEventRecord=function(a,c){var d=new b.datamodels.Record;c||(c="custom");d.EventType=a.toLowerCase();d.Type=c.toLowerCase();d.Extension.Add("EventInfo.Source","JS_default_source");d.Extension.Add("EventInfo.InitId",this._initId);
d.Extension.Add("EventInfo.Sequence",h._getSequenceForToken(this._tenantToken).toString());d.Extension.Add("EventInfo.Name",a.toLowerCase());var e=new Date;d.Timestamp=b.datamodels.utils.GetTimeStampWithValue(e.getTime());d.Extension.Add("EventInfo.Time",this._getISOString(e));d.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version);return d};a.prototype._getISOString=function(a){function b(a){return 10>a?"0"+a:a.toString()}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+
1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+function(a){return 10>a?"00"+a:100>a?"0"+a:a.toString()}(a.getUTCMilliseconds())+"Z"};a.prototype._addCustomPropertiesToEvent=function(a,b){this._addSemanticContext(a,q.semanticContext);this._addSemanticContext(a,h._semanticContext);this._addSemanticContext(a,this._semanticContext);this._sessionId&&a.Extension.Add("Session.Id",this._sessionId);this._addEventPropertiesToEvent(a,h._contextProperties);
this._addEventPropertiesToEvent(a,this._contextProperties);this._addEventPropertiesToEvent(a,b)};a.prototype._addSemanticContext=function(a,d){if(d&&d.contextMap){var c=d.contextMap,e;for(e in d.contextMap)"UserInfo.Id"==e&&d.piiKind!=b.datamodels.PIIKind.NotSet?a.AddOrReplacePII(e,c[e],d.piiKind):a.Extension.AddOrReplace(e,c[e])}};a.prototype._addEventPropertiesToEvent=function(a,c){if(c){c.timestamp&&c.timestamp>=(new Date("1/1/2000")).getTime()&&(a.Timestamp=b.datamodels.utils.GetTimeStampWithValue(c.timestamp),
a.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(c.timestamp))));c.name&&(a.EventType=c.name.toLowerCase(),a.Extension.AddOrReplace("EventInfo.Name",c.name.toLowerCase()));var e=c.properties;if(e)for(var f in e)f&&(e[f].value||!1===e[f].value||0==e[f].value||""==e[f].value)&&(d._isPii(e[f].pii)?(a.AddOrReplacePII(f,e[f].value.toString(),e[f].pii),a.Extension.Remove(f)):(a.Extension.AddOrReplace(f,e[f].value.toString()),a.PIIExtensions.Remove(f)))}};a.prototype._addPropertiesAndSendEvent=
function(a,b){this._addCustomPropertiesToEvent(a,b);h.isInitialized()&&(this._sanitizeName(a),c.SendAsync(this._tenantToken,[a]))};a.prototype._sanitizeName=function(a){var b=a.EventType.replace(/\./g,"_");a.EventType=b;a.Extension.AddOrReplace("EventInfo.Name",b)};return a}();b.Logger=u})(e.telemetry||(e.telemetry={}))})(f.applications||(f.applications={}))})(microsoft||(microsoft={}));"undefined"!=typeof module&&(module.exports=microsoft.applications.telemetry);; return microsoft.applications.telemetry;})();
