define("odsp-next/pages/files/spo/Files",["require","exports","./FilesViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Files.html","./Files.css","./FilesViewModel","odsp-next/controls/suiteNav/SuiteNav.css","odsp-next/controls/leftPane/LeftPane","odsp-next/controls/transclusion/host/TransclusionHost","odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame","odsp-next/controls/userFeedback/UserFeedback","../../../controls/commandBar/CommandBar","@ms/odsp-utilities/lib/async/Promise","../../../utilities/css/utilities.css","./StringResource"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"ms-files",template:e("./Files.html"),viewModel:n,synchronous:!0})});define("odsp-next/pages/files/spo/FilesViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/PagesResourceKeys","../../../resources/SPOResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/locale/Locale","./PageEvents","../../../resources/LoggingResourceKeys","../../../resources/UtilityResourceKeys","../../../resources/ModelResourceKeys","./SPOFiles.resx","../../../controls/overlays/host/OverlayHost","../../../controls/dialogHost/DialogHost","../../../controls/panelHost/PanelHost","../../../controls/leftNavExpander/LeftNavExpander","../../../controls/topBar/TopBar","../splist/SPListDeferredResources","../../../controls/leftPane/LeftPane","../../../providers/suiteNav/SuiteNavProvider.key","@ms/odsp-utilities/lib/browser/PlatformDetection","@ms/odsp-utilities/lib/modules/ModuleLoader","../../../utilities/suiteExtensions/SuiteExtensionsHelper","@ms/odsp-utilities/lib/require/RequireConfigInjector","../../../providers/transclusion/TransclusionProvider","@ms/odsp-utilities/lib/string/StringHelper","../../../models/item/ItemParentHelper","@ms/odsp-utilities/lib/async/Promise","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/dragAndResize/DragAndResizeBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/dragAndDrop/DragAndDropBinding","../../../bindings/element/ElementBinding","../../../bindings/component/ControlBinding","../../../utilities/features/Features","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-shared/lib/models/store/KnockoutDataStore","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../../dataSources/url/odb/UrlQueryKeys","@ms/odsp-datasources/lib/Permissions","../../../actions/odb/ActionMap"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b,y,x,_,w,I,C,k,S,T,P,E,A,L,B,O,D,M,R,N,F,U,H,V,K,j,q,z){"use strict";return function(t){function o(n){var i=n.appResources,o=n.pageSettings,a=t.call(this)||this;a._rightPaneInitialWidth=320;a.addBindingHandlers({scrollContainer:B.default,dragAndResize:O.default,dragAndDrop:M.default,interactionScope:D.default,element:R,control:N.default});a._rumone=a.resources.consume(p.rumOneHelper);a._rumone.mark("FilesViewModel.constructor");a.overlayHostTagName=g.default.tagName;a.dialogHostTagName=v.default.tagName;a.panelHostTagName=b.default.tagName;a.topBarTagName=x.default.tagName;a.leftNavExpanderTagName=y.tagName;a.dragAndDropTagName=a.createObservable();a._appResources=i;a._pageSettings=o;a._inPageEditorUrl=a.resources.expose(l.inplaceEditorUrl,a.createObservable(""));a.isUserFeedbackEnabled=a.createPureComputed(function(){return F.isFeatureEnabled(F.ODBNextUserFeedback)&&!a._inPageEditorUrl()});a._pageContext=a.resources.consume(l.pageContext);a.userFeedbackFeatureTitle=a._pageContext.listBaseTemplate===K.default.documentLibrary?h.strings.docLibUserFeedbackFeatureTitle:null;a.isDragAndDropDecorationEnabled=F.isFeatureEnabled(F.UseDragAndDropPageDecoration);a.isDroppingTarget=a.createObservable(!1);a._eventScope=i.eventScope;a.responsiveUI=i.responsiveUI;a.platform=i.platformDetection;a._isFooterVisible=a.resources.isExposed(u.footer);a._store=new U.default("FilesViewModel",H.default.local);a._dataStore=a.addDisposable(new V.default("RightPane",H.default.local));a._userIsAnonymous=a.resources.consume(u.identity).getIdentity().type===q.IdentityType.anonymous;a.isUserSelectEnabled=a.resources.expose(r.canUserSelect,a.createObservable(!0));a._setupPageResources();a.isLeftNavUserExpanded=a.resources.expose(s.base.leftNav.isLeftNavUserExpanded,a.createObservable(!1));a.resources.expose(s.base.leftNav.toggleIsLeftNavUserExpanded,a.toggleIsLeftNavUserExpanded.bind(a));a.isLeftNavClosing=a.createObservable(!1);a.isLeftNavVisible=a.createComputed(a._computeIsLeftNavVisible);a.leftNavReadyToRender=a.createObservable(!1);a._pageSettings.leftNavSettings.leftNavDataSourcePromise.then(function(e){a.resources.expose(u.leftNav,e);a.leftNavReadyToRender(!0)});a.commandBarCustomClass=a._pageSettings.commandBarCustomClass||"";a.navigationRegionLabel=a._pageSettings.navigationRegionLabel||E.format(h.strings.spListNavigationRegionLabel,i.pageContext.webTitle);a.h1PageTitle=a._pageSettings.pageTitle||i.pageContext.webTitle;a.h2NavigationHeader=a._pageSettings.navigationHeader||E.format(h.strings.spListNavigationRegionLabel,i.pageContext.webTitle);a.h2CommandBarHeader=a._pageSettings.commandBarHeader||h.strings.commandBarRegionLabel;a.h2ContentHeader=a._pageSettings.contentHeader||h.strings.listRegionLabel;a.dragAndDropDisabled=o.dragAndDropDisabled;a.isActive=a.createObservable(!1);a.isO365FlexPaneVisible=a.createObservable(!1);a.hamburgerCallback=a.toggleIsLeftNavUserExpanded.bind(a);a.suiteNavRenderedCallback=function(e){a._rumone.logRUMOneForDeferredControl("SuiteNav",e)};a.suiteNavHamburgerIsUnavailable=a.createObservable(!1);a.isTopBarHamburgerVisible=a.createComputed(a._computeIsTopBarHamburgerVisible);a.isSuiteNavHamburgerVisible=a.createComputed(a._computeIsSuiteNavHamburgerVisible);a._setupEvents();a._setupHeader();a._setupMainContentArea();a.firstRunComponent=a.createObservable(null);if(a._pageSettings.firstRunScenarioType){var c=a.resources.consume(r.isFirstRunExperienceVisible);a.createBackgroundComputed(function(){c()?k.loadModule({require:e,path:"odsp-next/controls/firstRunExperience/FirstRunExperience"}).then(function(e){a.firstRunComponent({name:e.tagName,params:{scenario:a._pageSettings.firstRunScenarioType}})}):a.firstRunComponent(null)});a.resources.consume(u.firstRunExperience).getFirstRunFlag().then(function(e){e||c(!0)})}a._itemSetSelectionModelDependencyHack();a._exposeLeftPaneResourcesHack();a.leftPaneSpecification=N.toSpecification(w.default,{isLeftNavVisible:a.isLeftNavVisible});a.spfxClientSideExtensionEnabled=a.createObservable(F.isFeatureEnabled(F.CustomActionsInModernPage)||a._pageContext.isTenantDevSite);a.spfxClientSideExtensionEnabled&&a._defineClientSidePlaceholders();a.suiteNavComponentTagName=a.createObservable();a.showSuiteNav=a.createPureComputed(a._computeShowSuiteNav);a.teachingBubbleEnabled=o.teachingBubbleEnabled;if(a.teachingBubbleEnabled){a.teachingBubbleComponentTagName=a.createObservable();a.showTeachingBubble=a.createPureComputed(a._computeShowTeachingBubble)}return a}n.__extends(o,t);o.prototype.toggleIsLeftNavUserExpanded=function(){this.isLeftNavUserExpanded(!this.isLeftNavUserExpanded());if(!this.isLeftNavVisible()){this.isLeftNavClosing(!0);this.async.setTimeout(function(){this.isLeftNavClosing(!1)},367)}return!1};o.prototype.onDragging=function(e,t){var n=e&&0===t.dragData.type;this.isDroppingTarget(n)};o.prototype._setupPageResources=function(){var e=new(this.managed(P.default)),t=this._setupRightPaneHost(),n=t.rightPaneTransclusionProvider,i=t.isRightPaneExpanded,o=this.createObservable(null),l=this.createObservable(!1);this._setupSearch();this.pageResources={resourceScope:this.resources,appResources:this._appResources,overlayProvider:e,rightPaneProvider:n,isRightPaneExpanded:i,commandSet:o,mainContentLoadComplete:l};this.topLevelCommandSet=o;this.resources.expose(a.overlay,e);this.resources.expose(a.infoPane,n);this.resources.expose(s.base.infoPane.isInfoPaneExpanded,this.isInfoPaneExpanded);this.resources.expose(s.base.filtersPane.isFiltersPaneExpanded,this.isFiltersPaneExpanded);this.resources.expose(r.focusedInfoPaneSection,this.createObservable(null));this.resources.expose(s.base.commandBar.commandSet,o);this.resources.expose(s.files.mainContentLoadComplete,l)};o.prototype._setupSearch=function(){this.showSearch=this.createObservable(!1);var e=this.responsiveUI,t=e.formFactorSize;this.isSearchCollapsed=this.createComputed(function(){return e.compareSize(t(),"Large")<=0});this.searchHasBack=this.createComputed(function(){return e.compareSize(t(),"Small")<=0});var n=this._pageSettings.searchSettings;this.searchParams={hasBack:this.searchHasBack,submitAction:n&&n.submitAction,searchText:n&&n.searchText,placeholder:n&&n.placeholder,submitPlaceholder:n&&n.submitPlaceholder,submitOnClear:n&&n.submitOnClear,searchBoxAriaLabel:n&&n.searchBoxAriaLabel}};o.prototype._setupHeader=function(){var e=this;this.headerComponent=this.wrapObservable(this._pageSettings.headerComponent);this.hasHeader=this.createPureComputed(function(){return!!e.headerComponent()})};o.prototype._setupMainContentArea=function(){var e=this,t=this.unwrapObservable(this._pageSettings.route);t.initialize&&t.initialize(this.pageResources);this.mainContentComponent=this.createObservable({name:this.unwrapObservable(t.component.name),params:this.unwrapObservable(t.component.params)});this.isObservable(this._pageSettings.route)&&(this._onPageRouteChanged=this.createComputed(function(){var t=e._pageSettings.route();t.initialize(e.pageResources);e.mainContentComponent({name:e.unwrapObservable(t.component.name),params:e.unwrapObservable(t.component.params)})}))};o.prototype._computeIsLeftNavVisible=function(){var e=this.isLeftNavUserExpanded(),t=this.responsiveUI;return!this._userIsAnonymous&&(e||t.compareSize(t.formFactorSize(),"Large")>0)};o.prototype._computeIsTopBarHamburgerVisible=function(){return this.responsiveUI.isHamburgerVisible()&&this.suiteNavHamburgerIsUnavailable()};o.prototype._computeIsSuiteNavHamburgerVisible=function(){return this.responsiveUI.isHamburgerVisible()&&!this.suiteNavHamburgerIsUnavailable()};o.prototype._setupRightPaneHost=function(){var e=this,t=new(this.managed(P.default));this.rightPaneTransclusionHostParams={provider:t};this.isInfoPaneExpanded=this.createObservable(!1);this.isFiltersPaneExpanded=this.createObservable(!1);var n=this.createPureComputed(function(){return e.isInfoPaneExpanded()||e.isFiltersPaneExpanded()});this.isRightPaneExpanded=n;this._isRightPaneExpandedInUI=this.createPureComputed(function(){return n()&&t.contexts().length>0});this.rightPaneWidth=this.createObservable(this._rightPaneInitialWidth);this._dataStore.persistNumber(this.rightPaneWidth,"rightPaneWidth");this.rightPaneWidthStyle=this.createComputed(function(){var t="";e._isRightPaneExpandedInUI()&&(t="Small"===e.responsiveUI.formFactorSize()?"100%":e.rightPaneWidth()+"px");return{width:t}});this._rightPanePushedContainerStyle=this.createComputed(this._computeRightPanePushedContainerStyle);return{rightPaneTransclusionProvider:t,isRightPaneExpanded:n}};o.prototype._setupEvents=function(){var e=this;this.events.on(this._eventScope,d.default.mainContentLoadComplete,function(){e.pageResources.mainContentLoadComplete(!0);e._initializeDeferredComponents();e.events.off(e._eventScope,d.default.mainContentLoadComplete)})};o.prototype._itemSetSelectionModelDependencyHack=function(){if(this.resources.isExposed(r.currentSelectionModelGroup)){var e=this.resources.consume(r.currentSelectionModelGroup);this.hasSelection=this.createComputed(function(){return!!e.currentSelection()})}else if(this.resources.isExposed(r.itemsSelection)){var t=this.resources.consume(r.itemsSelection);this.hasSelection=this.createComputed(function(){return t.selection().length>0})}else this.hasSelection=this.createComputed(function(){return!1})};o.prototype._exposeLeftPaneResourcesHack=function(){this.resources.isExposed(r.actionMap)||this.resources.expose(r.actionMap,new(this.managed(z)));this.resources.isExposed(r.currentItem)||this.resources.expose(r.currentItem,this.createObservable(null))};o.prototype._initializeDeferredComponents=function(){var t=this;this._pageSettings.leftNavSettings.deferredInitialize&&this._pageSettings.leftNavSettings.deferredInitialize(this.pageResources);if((F.isFeatureEnabled(F.ODBNextFileHandler)||F.isFeatureEnabled(F.ODBNextFileCreation))&&!F.isFeatureEnabled(F.FileHandlersV2)){T.default.addPaths({SuiteExtensions:this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/online/scripts/SuiteExtensions"});k.loadModule({require:e,path:"SuiteExtensions"}).then(function(){S.getInstance().initializeSuiteExtensions(t._pageContext)})}var n=this._appResources.resourceScope;L.default.as(n.load({teachingBubbleProvider:this._pageSettings.teachingBubbleEnabled?a.teachingBubble.optional:void 0})).then(function(){return _.loadResourcesWhenPLT(t._pageSettings.loadOnlyBasicDeferredResources,t._pageSettings.teachingBubbleEnabled)}).then(function(e){var o=e.basicResources,c=e.listResources,p=e.teachingBubbleResources,m=t.resources.consume(l.pageContext);if(c){t.dragAndDropDisabled||t.dragAndDropTagName(c.DragAndDropComponent.tagName);var h=new(n.injected(c.SearchDataSource))({useEnableDynamicGroups:null!==m.groupId});n.expose(u.search,h);t.createComputed(function(){var e=t.resources.consume(r.viewParams);h.setPath(e()[j.default.idParamKey])})}n.expose(a.search,new(n.injected(o.SearchProvider)));t.searchComponentTagName=o.SearchComponent.tagName;t.showSearch(!t._userIsAnonymous);n.expose(u.sharing,new(n.injected(o.SharingDataSource))(m));n.expose(u.sharingData,new(n.injected(o.SharingDataDataSource))(m));n.expose(u.people,new(n.injected(o.PeoplePickerDataSource))(m));t._exposeIfNeeded(n,u.suiteNav,function(){return new(n.resolved(o.SuiteNavDataSource))(t._pageSettings.suiteNavParams)});n.consumeAsync(I.resourceKey).then(function(e){return e.getO365Shell()}).done(function(e){e.OnHasMember("FlexPane",function(){e.FlexPane.OnFlexPaneVisibilityChanged(function(e){t.isO365FlexPaneVisible(e);i.default.raise(document.body,"resize",void 0,!0)})})});t.suiteNavComponentTagName(o.SuiteNavComponent.tagName);if(t.teachingBubbleEnabled&&p){var g=n.expose(f.userSettingsStore,new(n.injected(p.UserSettingsStore)));n.expose(f.userInfoStore,new(n.injected(p.UserInfoStore)));n.expose(u.userInfo,new(n.injected(p.UserInfoDataSource))(m));var v=n.expose(a.userInfo,new(n.injected(p.UserInfoProvider)));t.teachingBubbleComponentTagName(p.TeachingBubbleComponent.tagName);var b=t.resources.consume(s.base.filtersPane.isFiltersPaneExpanded.optional);if(b){g.getValue("isFiltersPaneExpanded")&&b(!0);t.subscribe(b,function(e){g.setValue("isFiltersPaneExpanded",e)})}var y=t.resources.consume(s.base.infoPane.isInfoPaneExpanded.optional);if(y){g.getValue("isInfoPaneExpanded")&&y(!0);t.subscribe(y,function(e){g.setValue("isInfoPaneExpanded",e)})}if(b&&!b.peek()&&F.isFeatureEnabled(F.RenderMetadataNavigationInFiltersPane)&&v){var x=t.resources.consume(r.currentItem.optional);if(x&&x.peek()){var _=t.resources.consume(A.resourceKey).getFacetedAncestorOrSelf(x.peek(),"list"),w=_&&_.peek()&&_.peek().list;w&&w.metadataNavFeatureEnabled&&v.getBubbleUserFact(p.TeachingBubbleCampaign.FILTERS_PANE,!0).then(function(e){e&&!e.d&&e.v<p.TeachingBubbleCampaign.FILTERS_PANE.maxUserViewCount&&b(!0)})}}}i.default.raise(t._eventScope,d.default.deferredResourcesInitialized)});var o=new C.default;if(!o.isWindows&&!o.isWinPhone){k.loadModule({require:e,path:"odsp-next/controls/oneDriveApp/OneDriveAppFontsPLT.css"});k.loadModule({require:e,path:"odsp-next/controls/oneDriveApp/OneDriveAppFontsDeferred.css"})}};o.prototype._computeRightPanePushedContainerStyle=function(){var e=(this._isRightPaneExpandedInUI()?this.rightPaneWidth():0)+"px";return c.default.isRightToLeft?{left:e}:{right:e}};o.prototype._exposeIfNeeded=function(e,t,n){return e.isExposed(t)?e.consume(t):e.expose(t,n())};o.prototype._defineClientSidePlaceholders=function(){if(this.resources.isExposed(m.clientSideExtensionHelper)){var e=this.resources.consume(m.clientSideExtensionHelper);if(e){for(var t=document.getElementsByClassName("os-Files-extensionPlaceHolder"),n=[],i=[],o=0;o<t.length;o++){var r=t[o];if(r){var a=r.getAttribute("data-sp-placeholder");if(a&&a.length>0){n.push({name:a,div:r});i.push(a)}}}e.getAdapter().then(function(e){e.definePlaceholders(n);console.log("Defined clientSidePlaceholders: "+i.join(","))})}}};o.prototype._computeShowSuiteNav=function(){var e=this.resources.consume(l.onePageContext.optional);return this.suiteNavComponentTagName()&&!(e&&e.onePageNavigationDataFetch&&e.onePageNavigationDataFetch())};o.prototype._computeShowTeachingBubble=function(){var e=this.resources.consume(a.teachingBubble.optional);this.currentTeachingBubble=e&&e.currentBubble();return this.teachingBubbleComponentTagName()&&!!this.currentTeachingBubble};return o}(o.default)});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__await,__asyncGenerator,__asyncDelegator,__asyncValues;!function(e){function t(e,t){return function(n,i){return e[n]=t?t(n,i):i}}var n="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(i){e(t(n,t(i)))}):e("object"==typeof module&&"object"==typeof module.exports?t(n,t(module.exports)):t(n))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};__extends=function(e,n){function i(){this.constructor=e}t(e,n);e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)};__assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};__rest=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&(n[i[o]]=e[i[o]]);return n};__decorate=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a};__param=function(e,t){return function(n,i){t(n,i,e)}};__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};__awaiter=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})};__generator=function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(r,n[1])).done)return a;(r=0,a)&&(n=[0,a.value]);switch(n[0]){case 0:case 1:a=n;break;case 4:l.label++;return{value:n[1],done:!1};case 5:l.label++;r=n[1];n=[0];continue;case 7:n=l.ops.pop();l.trys.pop();continue;default:if(!(a=l.trys,a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1];a=n;break}if(a&&l.label<a[2]){l.label=a[2];l.ops.push(n);break}a[2]&&l.ops.pop();l.trys.pop();continue}n=t.call(e,l)}catch(e){n=[6,e];r=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};__exportStar=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])};__values=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){e&&n>=e.length&&(e=void 0);return{value:e&&e[n++],done:!e}}}};__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a};__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e};__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)};__asyncGenerator=function(e,t,n){function i(e){c[e]&&(u[e]=function(t){return new Promise(function(n,i){d.push([e,t,n,i])>1||o(e,t)})})}function o(e,t){try{r(c[e](t))}catch(e){l(d[0][3],e)}}function r(e){e.value instanceof __await?Promise.resolve(e.value.v).then(a,s):l(d[0][2],e)}function a(e){o("next",e)}function s(e){o("throw",e)}function l(e,t){(e(t),d.shift(),d.length)&&o(d[0][0],d[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,c=n.apply(e,t||[]),d=[];return u={},i("next"),i("throw"),i("return"),u[Symbol.asyncIterator]=function(){return this},u};__asyncDelegator=function(e){function t(t,o){e[t]&&(n[t]=function(n){return(i=!i)?{value:__await(e[t](n)),done:"return"===t}:o?o(n):n})}var n,i;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n};__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof __values?__values(e):e[Symbol.iterator]()};e("__extends",__extends);e("__assign",__assign);e("__rest",__rest);e("__decorate",__decorate);e("__param",__param);e("__metadata",__metadata);e("__awaiter",__awaiter);e("__generator",__generator);e("__exportStar",__exportStar);e("__values",__values);e("__read",__read);e("__spread",__spread);e("__await",__await);e("__asyncGenerator",__asyncGenerator);e("__asyncDelegator",__asyncDelegator);e("__asyncValues",__asyncValues)});define("@ms/odsp-utilities/lib/events/EventGroup",["require","exports","../logging/ErrorHelper"],function(e,t,n){"use strict";var i=function(){function e(t){this._id=e._uniqueId++;this._parent=t;this._eventRecords=[]}e.raise=function(t,n,i,o){var r;if(e._isElement(t)){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(n,o,!0);a.args=i;r=t.dispatchEvent(a)}}else for(;t&&!1!==r;){var s=t.__events__,l=s?s[n]:null;for(var u in l)for(var c=l[u],d=0;!1!==r&&d<c.length;d++){var p=c[d];p.objectCallback&&(r=p.objectCallback.call(p.parent,i))}t=o?t.parent:null}return r};e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]};e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]};e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()};e._isElement=function(e){return!!e&&(e instanceof HTMLElement||e.addEventListener)};e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this.off();this._parent=null}};e.prototype.onAll=function(e,t,n){for(var i in t)this.on(e,i,t[i],n)};e.prototype.on=function(t,i,o,r){var a=this;if(i.indexOf(",")>-1)for(var s=i.split(/[ ,]+/),l=0;l<s.length;l++)this.on(t,s[l],o,r);else{var u=this._parent,c={target:t,eventName:i,parent:u,callback:o,objectCallback:null,elementCallback:null,useCapture:r},d=t.__events__=t.__events__||{};d[i]=d[i]||{count:0};d[i][this._id]=d[i][this._id]||[];d[i][this._id].push(c);d[i].count++;if(e._isElement(t)){var p=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(!a._isDisposed){try{var r=o.apply(u,t);if(!1===r&&t[0]&&t[0].preventDefault){var s=t[0];s.preventDefault();e.stopPropagation(s)}}catch(s){n.default.log(s)}return r}};c.elementCallback=p;t.addEventListener&&t.addEventListener(i,p,r)}else{c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!a._isDisposed)return o.apply(u,e)}}this._eventRecords.push(c)}};e.prototype.off=function(e,t,n,i){for(var o=0;o<this._eventRecords.length;o++){var r=this._eventRecords[o];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof i&&i!==r.useCapture)){var a=r.target.__events__,s=a[r.eventName],l=s?s[this._id]:null;if(l){if(1!==l.length&&n){s.count--;l.splice(l.indexOf(r),1)}else{s.count-=l.length;delete a[r.eventName][this._id]}s.count||delete a[r.eventName]}r.elementCallback&&r.target.removeEventListener&&r.target.removeEventListener(r.eventName,r.elementCallback,r.useCapture);this._eventRecords.splice(o--,1)}}};e.prototype.raise=function(t,n,i){return e.raise(this._parent,t,n,i)};e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0};return e}();i._uniqueId=0;Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/logging/ErrorHelper",["require","exports","./events/CaughtError.event","./events/QosError.event","./events/Verbose.event","../store/CircularBuffer","../object/ObjectUtil"],function(e,t,n,i,o,r,a){"use strict";var s=function(){function e(){}e.verbose=function(t,n){e._verboseLogs.push({name:n,message:t})};e.logError=function(t,r,a){if(t&&!t._handled){for(var s,l=this.getErrorMessage(t),u=t&&t.stack?t.stack:"";Boolean(s=e._verboseLogs.popOldest());)o.Verbose.logData(s);a&&a.eventName?i.QosError.logData({name:a.eventName,resultCode:a.resultCode,resultType:a.resultType,extraData:r||void 0,message:l,stack:u}):n.CaughtError.logData({extraData:r||void 0,message:l,stack:u})}};e.log=function(e,t,n,i){this.logError(e,null,{eventName:t,resultCode:n,resultType:i})};e.getErrorMessage=function(e){var t="";e&&(e.message?t=e.message:e.description?t=e.description:"object"==typeof e?t=a.safeSerialize(e):e.toString&&(t=e.toString()));return t};return e}();s._verboseLogs=new r.default(50);Object.defineProperty(t,"__esModule",{value:!0});t.default=s});define("@ms/odsp-utilities/lib/logging/events/CaughtError.event",["require","exports","../SingleEventBase","./Trace.event"],function(e,t,n,i){"use strict";t.CaughtError=n.createSingleEvent({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0,requiresParent:!1},{stack:1,extraData:4},i.Trace);Object.defineProperty(t,"__esModule",{value:!0});t.default=t.CaughtError});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define("@ms/odsp-utilities/lib/logging/SingleEventBase",["require","exports","./EventBase"],function(e,t,n){"use strict";function i(e,t){return new this(e,n.ClonedEventType.Single,t)}function o(e){return new this(null,n.ClonedEventType.Single,e)}t.createSingleEvent=function(e,t,r){var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}__extends(t,e);return t}(n.EventBase);a.logData=t?i:o;n.addEventProps(a.prototype,e,t||{},r);return a}});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-utilities/lib/logging/EventBase",["require","exports","./Manager","./CorrelationVector","../object/ObjectUtil","../features/Features"],function(e,t,n,i,o,r){"use strict";var a=0;!function(e){e[e.Single=0]="Single";e[e.Start=1]="Start";e[e.End=2]="End"}(t.ClonedEventType||(t.ClonedEventType={}));var s;!function(e){e[e.NoParent=1]="NoParent"}(s=t.ValidationErrorType||(t.ValidationErrorType={}));!function(e){e[e.Consumer=0]="Consumer";e[e.ConsumerAnonymous=1]="ConsumerAnonymous";e[e.Business=2]="Business";e[e.BusinessAnonymous=3]="BusinessAnonymous";e[e.Unknown=4]="Unknown"}(t.AccountType||(t.AccountType={}));t.addEventProps=function(e,t,n,i){o.extend(e,t);var r={};for(var a in n){var s=n[a],l=r[a]="number"==typeof s?{type:s}:s;l.definedInName=t.shortEventName;2===l.type&&(l.isMetric=!0)}e.metadata=i?__assign({},i.prototype.metadata,r):r};var l=function(){function e(e,t,o){this.validationErrors=0;this.data={};this.id=a++;this.enabled=this._isEnabled();o?this.parentId=o.id:this.requiresParent&&this.addValidationError(s.NoParent);this.startTime=n.Manager.getTime();this.vector=new i.default(o?o.vector:i.default.RootVector);e&&this._setData(e);this._logEvent(t)}e.enabled=function(){return this.prototype._isEnabled()};e.isTypeOf=function(e){return e.eventName.indexOf(this.prototype.shortEventName+",")>=0};e.prototype._isEnabled=function(){return!this.samplingFeature||r.default.isFeatureEnabled(this.samplingFeature)};e.prototype._setData=function(e){for(var t=this.data,i=0,o=Object.keys(e);i<o.length;i++){var r=o[i];if(r in this.metadata){var a=e[r];switch(typeof a){case"string":t[r]=n.Manager.cleanString(a);break;case"undefined":break;default:t[r]=a}}}};e.prototype._logEvent=function(e){n.Manager.logEvent(this,e)};e.prototype.addValidationError=function(e){this.validationErrors=this.validationErrors|e;n.Manager.logValidationError(this,e)};return e}();t.EventBase=l;var u=l.prototype;u.eventName="EventBase,";u.shortEventName="EventBase";u.critical=!1;u.requiresParent=!0});define("@ms/odsp-utilities/lib/logging/Manager",["require","exports","../object/ObjectUtil"],function(e,t,n){"use strict";var i=[],o=[],r=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date,a=function(){function e(){}e.getTime=function(){return(new Date).getTime()};e.cleanString=function(e){return e};e.addLogHandler=function(e){i.push(e);return o};e.removeLogHandler=function(e){for(var t=0;t<i.length;t++)if(i[t]===e){i.splice(t,1);break}};e.logEvent=function(e,t){var r=Object.freeze({data:n.deepCopy(e.data),id:e.id,enabled:e.enabled,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,validationErrors:e.validationErrors});o.push(r);if(o.length>100){o=o.slice(1);0===i.length&&this.handleBaseLoggingError(new Error("Logging buffer overflow hit before any logging handler was registered"))}for(var a=0;a<i.length;a++)try{i[a](r)}catch(e){this.handleBaseLoggingError(e)}};e.logValidationError=function(e,t){};e.getStack=function(){var e;try{window.______ExpectedError______()}catch(t){e=t}return e.stack};e.handleBaseLoggingError=function(e){};return e}();a.startDate=r;a.startTime=r.getTime();t.Manager=a;Object.defineProperty(t,"__esModule",{value:!0});t.default=a});define("@ms/odsp-utilities/lib/object/ObjectUtil",["require","exports","../encoding/UriEncoding"],function(e,t,n){"use strict";t.DEFAULT_DELIMITER="&";t.KEYVALUE_DELIMITER="=";t.deepCopy=function(e){var t=[],n=function(e){var i=null;if(e){i=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));Object.keys(e).forEach(function(o){var r=e[o];if("object"==typeof r){if(-1!==t.indexOf(r))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: "+String(e)+", property: "+String(o));t.push(r);i[o]=n(r);t.pop()}else i[o]=r})}return i};return n(e)};t.deepCompare=function(e,t,n){var i=[],o=[],r=Boolean(n)?n:function(e,t){return e===t},a=function(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var n=Object.keys(e).sort(),s=Object.keys(t).sort();return n.length===s.length&&!!n.every(function(n,l){if(n!==s[l])return!1;if("function"==typeof e[n]||"function"==typeof t[n])return!0;if(r(e[n],t[n]))return!0;if("object"==typeof e[n]){if(-1!==i.indexOf(e[n]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: "+String(e)+", property: "+n);i.push(e[n]);if(-1!==o.indexOf(t[n]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: "+String(t)+", property: "+n);o.push(t[n]);if(!a(e[n],t[n]))return!1;i.pop();o.pop();return!0}return!1})};return a(e,t)};t.safeSerialize=function(e){var t;try{var n=[];t=JSON.stringify(e,function(e,t){if(t===window)return"[window]";if(t instanceof HTMLElement)return"[HTMLElement]";if("function"==typeof t)return"[function]";if("object"==typeof t){if(null===t)return t;if(-1===n.indexOf(t)){n.push(t);return t}return"[circular]"}return t})}catch(e){t=JSON.stringify("[object]")}return t};t.serialize=function(e,i,o){i=i||t.DEFAULT_DELIMITER;return Object.keys(e).map(function(i){var r=e[i];r=r?r.toString():"";o||(r=n.default.encodeURIComponent(r));return i+t.KEYVALUE_DELIMITER+r}).join(i)};t.extend=function(e,t){if(t)for(var n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];e[o]=t[o]}return e}});define("@ms/odsp-utilities/lib/logging/CorrelationVector",["require","exports","../guid/Guid"],function(e,t,n){"use strict";var i=function(){function e(e,t){if(e){this.root=e.root;this.parent=e.current}else this.root=this.parent=n.default.Empty;this.current=t||n.default.generate()}e.prototype.toString=function(){return this.root+"#"+this.parent+"#"+this.current};return e}();i.RootVector=window.rootVector||new i;Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/guid/Guid",["require","exports"],function(e,t){"use strict";function n(e){for(var t="";t.length<e;){var n=16*Math.random();t+=(n|=0).toString(16)}return t}var i=function(){function e(){}e.generate=function(){var e=[];e.push(n(8));e.push(n(4));var t="4"+n(3);e.push(t);var i=n(4),o=parseInt(i[0],10);o&=3;i=(o|=8).toString(16)+i.substr(1);e.push(i);e.push(n(12));return e.join("-")};e.normalizeLower=function(t,n){return t?e._normalizeBrackets(t.toLowerCase(),n):""};e.normalizeUpper=function(t,n){return t?e._normalizeBrackets(t.toUpperCase(),n):""};e._normalizeBrackets=function(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e};return e}();i.Empty="00000000-0000-0000-0000-000000000000";Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/logging/events/Trace.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";t.Trace=n.createSingleEvent({eventName:"Trace,",shortEventName:"Trace",requiresParent:!1},{message:1});Object.defineProperty(t,"__esModule",{value:!0});t.default=t.Trace});define("@ms/odsp-utilities/lib/logging/events/QosError.event",["require","exports","../SingleEventBase","./CaughtError.event","./ResultTypeEnum"],function(e,t,n,i,o){"use strict";t.ResultTypeEnum=o.ResultTypeEnum;t.QosError=n.createSingleEvent({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:1},resultCode:1,resultType:{typeRef:o.ResultTypeEnum,type:6}},i.CaughtError);Object.defineProperty(t,"__esModule",{value:!0});t.default=t.QosError});define("@ms/odsp-utilities/lib/logging/events/ResultTypeEnum",["require","exports"],function(e,t){"use strict";!function(e){e[e.Success=0]="Success";e[e.Failure=1]="Failure";e[e.ExpectedFailure=2]="ExpectedFailure"}(t.ResultTypeEnum||(t.ResultTypeEnum={}))});define("@ms/odsp-utilities/lib/logging/events/Verbose.event",["require","exports","../SingleEventBase","./Trace.event"],function(e,t,n,i){"use strict";t.Verbose=n.createSingleEvent({eventName:"Verbose,Trace,",shortEventName:"Verbose",requiresParent:!1},{name:{isKey:!0,type:1}},i.Trace);Object.defineProperty(t,"__esModule",{value:!0});t.default=t.Verbose});define("@ms/odsp-utilities/lib/store/CircularBuffer",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){this._length=0;this._head=-1;if(e<=0)throw new Error("Size must be positive");this._size=e;this._buffer=new Array(e)}e.prototype.push=function(e){this._length<this._size&&this._length++;++this._head===this._size&&(this._head=0);this._buffer[this._head]=e};e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;this._length--;return this._buffer[e]};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=n});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define("@ms/odsp-shared/lib/base/ViewModel",["require","exports","./BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../bindings/automation/AutomationBinding","../bindings/automation/AutomationTypeBinding","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,i,o,r,a){"use strict";var s=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.bindingHandlers={};i.automationId=t&&t.automationId||"";i.addBindingHandlers({automation:o,automationType:r});return i}__extends(t,e);t.prototype.getAutomationElement=function(e){var t,n=this[o.AUTOMATION_ELEMENTS_KEY];n&&(t=n[e]);return t};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return i.format(e,t)};t.prototype.addBindingHandlers=function(e){a.extend(this.bindingHandlers,e)};return t}(n.default);t.ViewModel=s;Object.defineProperty(t,"__esModule",{value:!0});t.default=s});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-shared/lib/base/BaseModel",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/async/Async","../utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/component/Component"],function(e,t,n,i,o,r,a){"use strict";t.asyncTypeResourceKey=new n.ResourceKey({name:e("module").id+".asyncType",factory:new n.ConstantResourceFactory(o.default)});t.observablesFactoryTypeResourceKey=new n.ResourceKey({name:e("module").id+".observablesFactoryType",factory:new n.ResolvedResourceTypeFactory(r.default,{asyncType:t.asyncTypeResourceKey.optional})});t.eventGroupTypeResourceKey=new n.ResourceKey({name:e("module").id+".eventGroupType",factory:new n.ConstantResourceFactory(i.default)});var s=function(e){function a(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this,o=t.id,r=void 0===o?"":o;i.id=r;i._BaseModel_dependencies=n;return i}__extends(a,e);Object.defineProperty(a.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!0,configurable:!0});a.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,n)};a.prototype.createComputed=function(e,t){return this.observables.compute(e,t)};a.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)};a.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)};a.prototype.addDisposable=function(e){return this.scope.attach(e)};a.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),i=function(){t=!0;n.dispose()};e.done(i,i);return e};a.prototype.wrapObservable=function(e){return this.observables.wrap(e)};a.prototype.peekUnwrapObservable=function(e){return r.peekUnwrap(e)};a.prototype.createObservable=function(e){return this.observables.create(e)};a.prototype.unwrapObservable=function(e){return r.unwrap(e)};a.prototype.isObservable=function(e){return r.isObservable(e)};a.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this);this._BaseModel_getAsync=function(){return e};return e};a.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this);this._BaseModel_getEvents=function(){return e};return e};a.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});this._BaseModel_getObservables=function(){return e};return e};a.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(t.asyncTypeResourceKey.optional)||o.default};a.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(t.eventGroupTypeResourceKey.optional)||i.default};a.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(t.observablesFactoryTypeResourceKey.optional)||n.getResolvedConstructor(r.default,{asyncType:this._BaseModel_getAsyncType()}))||r.default};return a}(a.default);s.dependencies=__assign({},a.default.dependencies,{asyncType:t.asyncTypeResourceKey.optional,observablesFactoryType:t.observablesFactoryTypeResourceKey.optional,eventGroupType:t.eventGroupTypeResourceKey.optional});t.BaseModel=s;Object.defineProperty(t,"__esModule",{value:!0});t.default=s});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-utilities/lib/resources/Resources",["require","exports","./ResourceScope","../disposable/Disposable","./ResourceScope"],function(e,t,n,i,o){"use strict";var r=function(){function e(e,t){this._load=e;this._dependencies=t}e.prototype.load=function(){var e=this,t=this._load().then(function(t){return new a(t,e._dependencies)});this.load=function(){return t};return t};return e}();t.ResolvedResourceLoader=r;var a=function(){function e(e,t){this._type=e;this.dependencies=__assign({},e.dependencies||{},t||{})}e.prototype.create=function(e){var t=new this._type({},e);return{instance:t,disposable:t}};return e}();t.ResolvedResourceFactory=a;var s=function(){function e(e,t){this._type=e;this.dependencies=__assign({},e.dependencies||{},t||{})}e.prototype.create=function(e){return{instance:n.getResolvedConstructor(this._type,e)}};return e}();t.ResolvedResourceTypeFactory=s;var l=function(){function e(e){this._type=e;this.dependencies={}}e.prototype.create=function(){var e=new this._type;return{instance:e,disposable:i.isDisposable(e)&&e}};return e}();t.SimpleResourceFactory=l;var u=function(){function e(e){this._load=e}e.prototype.load=function(){var e=this._load().then(function(e){return new c(e)});this.load=function(){return e};return e};return e}();t.AliasResourceLoader=u;var c=function(){function e(e){this.dependencies={value:e.lazy}}e.prototype.create=function(e){return{instance:e.value()}};return e}();t.AliasResourceFactory=c;t.createDefaultResourceKey=function(e,t,i){return new n.ResourceKey({name:e("module").id,factory:new a(t,i)})};t.createDefaultTypeResourceKey=function(e,t,i){return new n.ResourceKey({name:e("module").id,factory:new s(t,i)})};!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(o)});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-utilities/lib/resources/ResourceScope",["require","exports","../async/Promise","../async/Signal","../scope/Scope","../disposable/Disposable"],function(e,t,n,i,o,r){"use strict";function a(e,t){var n=function(n){return e.call(this,n,t)||this};n.prototype=e.prototype;return n}function s(){throw new Error("Cannot consume a resource from a ResourceScope that has been disposed.")}function l(){throw new Error("Cannot load a resource from a ResourceScope that has been disposed.")}function u(){}function c(e){for(var t in e)if(e[t])return n.default.wrapError(e[t]);return n.default.wrapError(new Error("A dependency could not be loaded."))}function d(){this.resources.dispose()}function p(e){var t=new i.default;e.done(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()}var m=0,f=function(){function e(e){this.id=++m;if("string"==typeof e)this.name=e;else{this.name=e.name;this.factory=e.factory;this.loader=e.loader}}Object.defineProperty(e.prototype,"lazy",{get:function(){return new h(this,1)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"local",{get:function(){return new h(this,2)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"optional",{get:function(){return new h(this,4)},enumerable:!0,configurable:!0});e.prototype.toString=function(){return"Resource #"+this.id+' "'+this.name+'"'};return e}();t.ResourceKey=f;var h=function(){function e(e,t){this.key=e;this.flags=t}Object.defineProperty(e.prototype,"lazy",{get:function(){return new e(this.key,1|this.flags)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"local",{get:function(){return new e(this.key,2|this.flags)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"optional",{get:function(){return new e(this.key,4|this.flags)},enumerable:!0,configurable:!0});return e}(),g=function(){function e(e){this._value=e;this.dependencies={}}e.prototype.create=function(){return{instance:this._value}};return e}();t.ConstantResourceFactory=g;t.resourceScopeKey=new f({name:"resources"});t.asyncLoadBarrierKey=new f({name:"asyncLoadBarrier"});var v=function(){function e(e){this._loader=e}e.prototype.load=function(){var e=this,t=p(this._loader.load());t.done(void 0,function(){delete e.load});this.load=function(){return t};return t};return e}(),b=function(){function e(e,t){this.entry=e;this.manager=t}e.prototype.getInstance=function(e,t){var n=this.manager,i=this.entry.factory,o=i.create(n.resolve(i.dependencies,t)),r=o.instance;o.disposable&&n.scope.attach(o.disposable);this.getInstance=function(){return r};return r};e.prototype.promote=function(t){var n=this.entry;return new e({manager:t,loader:n.loader,factory:n.factory})};return e}();t.getResolvedConstructor=a;var y=function(){function e(t){this._handles={};this._isLocked=!1;var n;if(t instanceof e){if(t.isDisposed)throw new Error("Parent ResourceScope has already been disposed!");n=t.options;this._parent=t;this._level=t._level+1}else{n=t||{};this._level=0}this.scope=new o.default;this.options=n}Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!0,configurable:!0});e.prototype.block=function(e){return this._expose(e)};e.prototype.isDescendantOf=function(e){return this._level>e._level};e.prototype.getHandle=function(e){for(var t=this,n=e.id;!(n in t._handles)&&t._parent;)t=t._parent;var i=t._handles;return i[n]||this.options.useFactoriesOnKeys&&(e.factory&&(i[n]=new b({factory:e.factory,manager:t}))||e.loader&&(i[n]=new b({loader:new v(e.loader),manager:t})))};e.prototype.expose=function(e,t,n){return this._expose(e,function(e){return new b({factory:t.factory,loader:t.loader,manager:e},n&&e)})};e.prototype.getLoader=function(){this.lock();var e=new x(this);this.getLoader=function(){return e};return e};e.prototype.dispose=function(){this.scope.dispose();this._handles={};this.consume=this.resolve=s;this.getLoader=l};e.prototype.bind=function(e){var t=this.getHandle(e);return t?this._expose(e,function(e){return t.promote(e)}):this};e.prototype.lock=function(){this._isLocked=!!this.options.lockResourcesForChildren};e.prototype.consume=function(e,n){var i=this;this.lock();var o,r=e.key||e,a=e.flags;if(r===t.resourceScopeKey){var s;o=function(){s||(s=i.scope.attach(new _(i,n||{owner:""+r})));return s}}else{var l=this._getValidHandle(e,[]);if(l instanceof Error){if(!(4&a))throw l}else o=function(){return l.getInstance(r,n||{owner:""+r})}}return 1&a?o:o&&o()};e.prototype.isExposed=function(e){return!(this._getValidHandle(e,[])instanceof Error)};e.prototype.resolve=function(e,t){for(var n={},i=0,o=Object.keys(e);i<o.length;i++){var r=o[i];e[r]&&(n[r]=this.consume(e[r],t))}return n};e.prototype._getValidHandle=function(e,n){var i=e.key||e,o=i.id;if(n.indexOf(i)>=0)throw new Error(i+" has a circular dependency.");var r=this._handles[o];if(r&&r.manager)return r;var a=this.getHandle(i);if(!a)return new Error(i+" is being consumed, but has not been exposed by a parent scope.");var s=a.entry,l=s.factory;if(!l)return new Error(i+" is being consumed synchronously, but was exposed asynchronously and has not been loaded.");n.push(i);for(var u=a.manager,c=2&e.flags?this:u||s.manager,d=l.dependencies||{},p=0,m=Object.keys(d);p<m.length;p++){var f=d[m[p]];if(f&&(f.key||f)!==t.resourceScopeKey){var h=this._getValidHandle(f,n);if(h instanceof Error){if(!(4&f.flags)){n.pop();return h}}else h.manager.isDescendantOf(c)&&(c=h.manager)}}n.pop();if(!u||u!==c){a=new b(s,c);c._handles[o]=a}return this._handles[o]=a};e.prototype._expose=function(n,i){if(this.isDisposed)throw new Error("Cannot expose a resource on a ResourceScope that has been disposed.");if(n===t.resourceScopeKey)throw new Error("It is illegal to expose the ResourceScope key");var o=n.id,r=this._isLocked?this.scope.attach(new e(this)):this,a=r._handles;if(a[o]&&this.options.noDoubleExpose)throw new Error(n+" has already been exposed/consumed at this scope.");a[o]=i?i(r):void 0;return r};return e}(),x=function(){function e(e){this._handleManager=e;this._loadState={};this._root=e.consume(t.asyncLoadBarrierKey.optional)}e.prototype.loadAsync=function(e){var i=e.key||e;if(i===t.resourceScopeKey)return n.default.as();var o=e.flags,r=this._loadAsync(i);return 4&o?r.then(null,u):r};e.prototype.loadAllAsync=function(e){if(e){var t=Object.keys(e),i=t.length;if(i>0){for(var o={};i--;){var r=t[i],a=e[r];a&&(o[r]=this.loadAsync(a))}return n.default.all(o).then(u,c)}}return n.default.as()};e.prototype._loadAsync=function(e){var t=this,i=e.id,o=this._loadState,r=o[i];if(r)return r;var a=this._handleManager.getHandle(e);if(!a)return o[i]=n.default.wrapError(new Error(e+" is being loaded, but has no factory/loader."));o[i]=n.default.as();var s=a.entry,l=s.factory;if(l)return o[i]=this.loadAllAsync(l.dependencies);var u=s.loader;if(!u)return o[i]=n.default.wrapError(new Error(e+" is being loaded, but no loader was defined."));var c=this._root,d=c&&c.wait()||n.default.as();return o[i]=d.then(function(){return u.load()}).then(function(e){s.factory=e;var n=e.dependencies;if(n)return t.loadAllAsync(n)})};return e}(),_=function(){function e(t,n){var i,r;if(t instanceof e){r=t._handleManager;i=t._owner}else t instanceof y?r=t:n=t||n;var a=new o.default;if(r){if(r.scope.isDisposed)throw new Error("Parent ResourceScope has already been disposed.");r.lock();r.options.lockResourcesForChildren||(this._prepareWrite=this._fork)}this._handleManager=r||(r=a.attach(new y(n)));this._scope=a;var s=n?n.owner:"";this._owner=i?i+" > "+s:s}e.prototype.consume=function(e){return this._handleManager.consume(e)};e.prototype.consumeAsync=function(e){var t=this._handleManager;return p(t.getLoader().loadAsync(e).then(function(){return t.consume(e)}))};e.prototype.load=function(e){return p(this._handleManager.getLoader().loadAllAsync(e))};e.prototype.exposeAsync=function(e,t){this._expose(e,{loader:new v(t)})};e.prototype.exposeFactory=function(e,t){this._expose(e,{factory:t})};e.prototype.expose=function(e,t){this._expose(e,{factory:new g(t)},t);return t};e.prototype.block=function(e){this._handleManager=this._prepareWrite().block(e)};e.prototype.bind=function(e){this._handleManager=this._prepareWrite().bind(e)};e.prototype.isDefined=function(e){var t=this._handleManager;return!t.isDisposed&&!!t.getHandle(e)};e.prototype.isExposed=function(e){var t=this._handleManager;return!t.isDisposed&&t.isExposed(e)};e.prototype.injected=function(t,n){void 0===n&&(n={});var i=n.injectChildResourceScope,o={owner:n.owner||t.name},a=i?this._scope.attach(new e(this,o)):this,s=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.resources=a;var o=t.apply(this,e)||this;i&&r.hook(o,d);return o};s.prototype=t.prototype;return s};e.prototype.resolve=function(e){return this._handleManager.resolve(e)};e.prototype.resolveAsync=function(e){var t=this;return this.load(e).then(function(){return t.resolve(e)})};e.prototype.resolved=function(e,t){return a(e,this.resolve(__assign({},e.dependencies||{},t||{})))};e.prototype.resolvedAsync=function(e,t){var n=this;return this.load(__assign({},e.dependencies||{},t||{})).then(function(){return n.resolved(e,t)})};e.prototype.dispose=function(){this._scope.dispose()};e.prototype._expose=function(e,t,n){this._handleManager=this._prepareWrite().expose(e,t,n)};e.prototype._prepareWrite=function(){return this._handleManager};e.prototype._fork=function(){delete this._prepareWrite;return this._scope.attach(new y(this._handleManager))};return e}();t.ResourceScope=_;Object.defineProperty(t,"__esModule",{value:!0});t.default=_});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define("@ms/odsp-utilities/lib/async/Promise",["require","exports","./Async","../events/EventGroup"],function(e,t,n,i){"use strict";function o(e){R.setImmediate(function(){throw e})}function r(){}function a(e,t){e._value=t;e._setState(q.is(t)?P:B)}function s(e,t,n,i,o,r){return{exception:e,error:t,promise:n,handler:r,id:i,parent:o}}function l(e,t,n,i){var o=n._isException,r=n._errorId;return s(o?t:null,o?null:t,e,r,n,i)}function u(e,t,n){var i=n._isException,o=n._errorId;b(e,o,i);return s(i?t:null,i?null:t,e,o,n)}function c(e,t){var n=++U;b(e,n);return s(null,t,e,n)}function d(e,t){var n=++U;b(e,n,!0);return s(t,null,e,n)}function p(e,t,n){v(e,{c:t,e:n})}function m(e,t,n,i){e._value=t;g(e,t,n,i);e._setState(D)}function f(e,t){var n=e._value,i=e._listeners;if(i){e._listeners=null;var o,r;for(o=0,r=Array.isArray(i)?i.length:1;o<r;o++){var a=1===r?i:i[o],s=a.c,l=a.promise;if(l){try{l._setCompleteValue(s?s(n):n)}catch(e){l._setExceptionValue(e)}l._state!==P&&l._listeners&&t.push(l)}else j.prototype.done.call(e,s)}}}function h(e,t){var n=e._value,i=e._listeners;if(i){e._listeners=null;var o,r;for(o=0,r=Array.isArray(i)?i.length:1;o<r;o++){var a=1===r?i:i[o],s=a.e,u=a.promise;if(u){try{if(s){!0;s.handlesOnError||g(u,n,l,e,s);u._setCompleteValue(s(n))}else u._setChainedErrorValue(n,e)}catch(e){u._setExceptionValue(e)}u._state!==P&&u._listeners&&t.push(u)}else V.prototype.done.call(e,null,s)}}}function g(e,t,n,i,o){t instanceof Error&&t.message===F||k.raise(N,n(e,t,i,o))}function v(e,t){var n=e._listeners;n?(n=Array.isArray(n)?n:[n]).push(t):n=t;e._listeners=n}function b(e,t,n){e._isException=n||!1;e._errorId=t}function y(e,t,n,i){e._value=t;g(e,t,n,i);e._setState(M)}function x(e,t){var n;n=q.is(t)?P:O;e._value=t;e._setState(n)}function _(e,t,n){var i=new z(e);v(e,{promise:i,c:t,e:n});return i}function w(e){var t;return new q(function(n){e?t=R.setTimeout(n,e):R.setImmediate(n)},function(){t&&R.clearTimeout(t)})}function I(e,t){var n=function(){e.cancel()};e.then(function(){t.cancel()});t.then(n,n);return t}function C(e){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],o=q.as(e[i]);"function"==typeof o.cancel&&o.cancel()}}}var k,S,T,P,E,A,L,B,O,D,M,R=new n.default,N="error",F="Canceled",U=1;S={name:"created",enter:function(e){e._setState(T)},cancel:r,done:r,then:r,_completed:r,_error:r,_notify:r,_setCompleteValue:r,_setErrorValue:r};T={name:"working",enter:r,cancel:function(e){e._setState(A)},done:p,then:_,_completed:a,_error:m,_notify:r,_setCompleteValue:x,_setErrorValue:y};P={name:"waiting",enter:function(e){var t=e._value;if(t instanceof z&&t._state!==M&&t._state!==O)v(t,{promise:e});else{var n=function(i){if(t._errorId)e._chainedError(i,t);else{g(e,i,l,t,n);e._error(i)}};n.handlesOnError=!0;t.then(e._completed.bind(e),n)}},cancel:function(e){e._setState(E)},done:p,then:_,_completed:a,_error:m,_notify:r,_setCompleteValue:x,_setErrorValue:y};E={name:"waiting_canceled",enter:function(e){e._setState(L);var t=e._value;t.cancel&&t.cancel()},cancel:r,done:p,then:_,_completed:a,_error:m,_notify:r,_setCompleteValue:x,_setErrorValue:y};A={name:"canceled",enter:function(e){e._setState(L);e._cancelAction()},cancel:r,done:p,then:_,_completed:a,_error:m,_notify:r,_setCompleteValue:x,_setErrorValue:y};L={name:"canceling",enter:function(e){var t=new Error(F);t.name=t.message;t._handled=!0;e._value=t;e._setState(D)},cancel:r,done:r,then:r,_completed:r,_error:r,_notify:r,_setCompleteValue:r,_setErrorValue:r};B={name:"complete_notify",enter:function(e){e.done=j.prototype.done;e.then=j.prototype.then;if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())._state._notify(n,t);e._setState(O)},cancel:r,done:null,then:null,_completed:r,_error:r,_notify:f,_setCompleteValue:r,_setErrorValue:r};O={name:"success",enter:function(e){e.done=j.prototype.done;e.then=j.prototype.then;e._cleanupAction()},cancel:r,done:null,then:null,_completed:r,_error:r,_notify:f,_setCompleteValue:r,_setErrorValue:r};D={name:"error_notify",enter:function(e){e.done=V.prototype.done;e.then=V.prototype.then;if(e._listeners)for(var t=[e],n=void 0;t.length;)(n=t.shift())._state._notify(n,t);e._setState(M)},cancel:r,done:null,then:null,_completed:r,_error:r,_notify:h,_setCompleteValue:r,_setErrorValue:r};M={name:"error",enter:function(e){e.done=V.prototype.done;e.then=V.prototype.then;e._cleanupAction()},cancel:r,done:null,then:null,_completed:r,_error:r,_notify:h,_setCompleteValue:r,_setErrorValue:r};var H,V=function(){function e(e,t){void 0===t&&(t=c);this._value=e;g(this,e,t)}e.prototype.cancel=function(){};e.prototype.done=function(e,t){var n=this._value;if(t)try{t.handlesOnError||g(null,n,l,this,t);var i=t(n);q.is(i)&&i.done();return}catch(e){n=e}n instanceof Error&&n.message===F||o(n)};e.prototype.then=function(e,t){if(!t)return this;var n,i=this._value;try{t.handlesOnError||g(null,i,l,this,t);n=new j(t(i))}catch(e){n=e===i?this:new K(e)}return n};return e}(),K=function(e){function t(t){return e.call(this,t,d)||this}__extends(t,e);return t}(V),j=function(){function e(e){if(q.is(e)){var t=new z(void 0);t._setCompleteValue(e);return t}this._value=e}e.prototype.cancel=function(){};e.prototype.done=function(e){if(e)try{var t=e(this._value);q.is(t)&&t.done()}catch(e){o(e)}};e.prototype.then=function(t){var n;try{var i=t?t(this._value):this._value;n=i===this._value?this:new e(i)}catch(e){n=new K(e)}return n};return e}(),q=function(){function e(e,t){this._init(e,t)}Object.defineProperty(e,"cancel",{get:function(){return H||(H=new V(F))},enumerable:!0,configurable:!0});e.any=function(t){return new e(function(n,i){var o=Object.keys(t),r=o.length;0===r&&n();for(var a=0,s=o;a<s.length;a++)!function(o){e.as(t[o]).then(function(){n({key:o,value:t[o]})},function(a){a instanceof Error&&a.name===F?0==--r&&n(e.cancel):i({key:o,value:t[o]})})}(s[a])},C(t))};e.as=function(t){return e.is(t)?t:new j(t)};e.is=function(e){return e&&"object"==typeof e&&"function"==typeof e.then};e.isCanceled=function(e){return e instanceof Error&&e.name===F};e.all=function(t){return new e(function(n,i){for(var o=Object.keys(t),r=Array.isArray(t)?[]:{},a=Array.isArray(t)?[]:{},s=o.length,l=function(){if(0==--s){var t=Object.keys(r);0===t.length?n(a):t.every(function(t){return e.isCanceled(r[t])})?n(e.cancel):i(r)}},u=0,c=o;u<c.length;u++)!function(n){var i=t[n];void 0===i?s--:e.then(i,function(e){a[n]=e;l()},function(e){r[n]=e;l()})}(c[u]);0===s&&n(a)},C(t))};e.then=function(t,n,i){return e.as(t).then(n,i)};e.thenEach=function(t,n,i){for(var o=Array.isArray(t)?[]:{},r=0,a=Object.keys(t);r<a.length;r++){var s=a[r];o[s]=e.then(t[s],n,i)}return e.all(o)};e.serial=function(t){return t.reduce(function(e,t){return e.then(t)},e.wrap())};e.timeout=function(e,t){var n=w(e);return t?I(n,t):n};e.wrap=function(e){return new j(e)};e.wrapError=function(e){return new V(e)};e.prototype.cancel=function(){this._state.cancel(this);this._run()};e.prototype.done=function(e,t){this._state.done(this,e,t)};e.prototype.then=function(e,t){return this._state.then(this,e,t)};e.prototype._init=function(e,t){this._oncancel=t;this._setState(S);this._run();try{e(this._completed.bind(this),this._error.bind(this))}catch(e){this._setExceptionValue(e)}};e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel()}catch(e){}};e.prototype._cleanupAction=function(){this._oncancel=null};e.prototype._chainedError=function(e,t){var n=this._state._error(this,e,u,t);this._run();return n};e.prototype._completed=function(e){var t=this._state._completed(this,e);this._run();return t};e.prototype._error=function(e){var t=this._state._error(this,e,c);this._run();return t};e.prototype._setState=function(e){this._nextState=e};e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e);this._run()};e.prototype._setChainedErrorValue=function(e,t){var n=this._state._setErrorValue(this,e,u,t);this._run();return n};e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,d);this._run();return t};e.prototype._run=function(){for(;this._nextState;){this._state=this._nextState;this._nextState=null;this._state.enter(this)}};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=q;(k=new i.default(q)).declare(N);var z=function(e){function t(t){var n=e.call(this)||this;n._creator=t;n._initThen();return n}__extends(t,e);t.prototype._init=function(){};t.prototype._cancelAction=function(){this._creator&&this._creator.cancel()};t.prototype._cleanupAction=function(){this._creator=null};t.prototype._initThen=function(){this._setState(S);this._run()};return t}(q),W=function(e){function t(t){var n=e.call(this)||this;n._oncancel=t;n._initSignal();return n}__extends(t,e);t.prototype._init=function(){};t.prototype._cancelAction=function(){this._oncancel&&this._oncancel()};t.prototype._cleanupAction=function(){this._oncancel=null};t.prototype._initSignal=function(){this._setState(S);this._run()};return t}(q);t.SignalPromise=W});define("@ms/odsp-utilities/lib/async/Async",["require","exports"],function(e,t){"use strict";function n(){}var i=function(){function e(e,t){this._isDisposed=!1;this._parent=e||null;this._onErrorHandler=t;this._timeoutIds=null;this._immediateIds=null;this._animationFrameIds=null;this._intervalIds=null}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._parent=null;if(this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){l=t[e];this.clearTimeout(Number(l))}this._timeoutIds=null}if(this._immediateIds){for(var n=0,i=Object.keys(this._immediateIds);n<i.length;n++){l=i[n];this.clearImmediate(Number(l))}this._immediateIds=null}if(this._intervalIds){for(var o=0,r=Object.keys(this._intervalIds);o<r.length;o++){l=r[o];this.clearInterval(Number(l))}this._intervalIds=null}if(this._animationFrameIds){for(var a=0,s=Object.keys(this._animationFrameIds);a<s.length;a++){var l=s[a];this.cancelAnimationFrame(Number(l))}this._animationFrameIds=null}}};e.prototype.setTimeout=function(e,t){var n=this,i=0;if(!this._isDisposed){var o=this._timeoutIds||(this._timeoutIds={});i=setTimeout(function(){try{delete o[i];e.apply(n._parent)}catch(e){n._logError(e)}},t);o[i]=!0}return i};e.prototype.clearTimeout=function(e){var t=this._timeoutIds;if(t&&t[e]){clearTimeout(e);delete t[e]}};e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){var i=this._immediateIds||(this._immediateIds={}),o=function(){try{delete i[n];e.apply(t._parent)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(o):window.setTimeout(o,0);i[n]=!0}return n};e.prototype.clearImmediate=function(e){var t=this._immediateIds;if(t&&t[e]){window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e);delete t[e]}};e.prototype.setInterval=function(e,t){var n=this,i=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});i=setInterval(function(){try{e.apply(n._parent)}catch(e){n._logError(e)}},t);this._intervalIds[i]=!0}return i};e.prototype.clearInterval=function(e){if(this._intervalIds&&this._intervalIds[e]){clearInterval(e);delete this._intervalIds[e]}};e.prototype.throttle=function(e,t,i){var o=this;void 0===i&&(i={});if(this._isDisposed)return n;var r,a,s=t||0,l=i.leading,u=void 0===l||l,c=i.trailing,d=void 0===c||c,p=0,m=null,f=function(t){var n=(new Date).getTime(),i=n-p,l=u?s-i:s;if(i>=s&&(!t||u)){p=n;if(m){o.clearTimeout(m);m=null}r=e.apply(o._parent,a)}else null===m&&d&&(m=o.setTimeout(f,l));return r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a=e;return f(!0)}};e.prototype.debounce=function(e,t,i){var o=this;void 0===i&&(i={});if(this._isDisposed)return n;var r,a,s=t||0,l=i.leading,u=void 0!==l&&l,c=i.trailing,d=void 0===c||c,p=i.maxWait,m=void 0===p?NaN:p,f=0,h=(new Date).getTime(),g=null,v=function(t){var n=(new Date).getTime(),i=!1;if(t){u&&n-f>=s&&(i=!0);f=n}var l=n-f,c=s-l,p=n-h,b=!1;isNaN(m)||(p>=m&&g?b=!0:c=Math.min(c,m-p));if(l>=s||b||i){if(g){o.clearTimeout(g);g=null}h=n;r=e.apply(o._parent,a)}else null!==g&&t||!d||(g=o.setTimeout(v,c));return r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a=e;return v(!0)}};e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){var i=this._animationFrameIds||(this._animationFrameIds={}),o=function(){try{delete i[n];e.apply(t._parent)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(o):window.setTimeout(o,0);i[n]=!0}return n};e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;if(t&&t[e]){window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e);delete t[e]}};e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/async/Signal",["require","exports","./Promise"],function(e,t,n){"use strict";var i=function(){function e(e){this._promise=new n.SignalPromise(e)}e.prototype.getPromise=function(){return this._promise};e.prototype.cancel=function(){this._promise.cancel()};e.prototype.complete=function(e){this._promise._completed(e)};e.prototype.error=function(e){this._promise._error(e)};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/scope/Scope",["require","exports","../disposable/Disposable"],function(e,t,n){"use strict";var i=function(){function e(){this._disposables={};this._lastDisposableId=0}e.prototype.attached=function(e){var t=this,n=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.attach(e.apply(this,n)||this)};n.prototype=e.prototype;return n};e.prototype.attach=function(e){var t=this,i=""+ ++this._lastDisposableId,o=n.hook(e,function(){delete t._disposables[i]});this._disposables[i]=o;return o};e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,i=Object.keys(e);t<i.length;t++){var o=i[t],r=e[o];r&&n.isDisposable(r)&&r.dispose();delete e[o]}};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/disposable/Disposable",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){this._callbacks=[];this._owner=e}e.prototype.addCallback=function(e){this._callbacks.push(e)};e.prototype.dispose=function(){for(;this._callbacks.length;)this._callbacks.pop().call(this._owner)};return e}();t.isDisposable=function(e){return"function"==typeof e.dispose};t.hook=function(e,t){var i=e,o=i.dispose,r="function"==typeof o&&o.disposalChain;if(!r){r=new n(i);var a=function(){r.dispose();if(o){i.dispose=o;i.dispose()}};i.dispose=a;a.disposalChain=r}r.addCallback(t);return i}});define("@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory",["require","exports","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/async/Async","knockout","./Projections"],function(e,t,n,i,o){"use strict";function r(e){return o.unwrap(e)}function a(e){return o.isObservable(e)}function s(e){return o.ignoreDependencies(e)}function l(e){return"object"==typeof e}t.peekUnwrap=function(e){return a(e)?e.peek():e};t.unwrap=r;t.isObservable=a;t.ignore=s;var u=function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});this._owner=e.owner;this._asyncType=t.asyncType}Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new n.default)},enumerable:!0,configurable:!0});e.prototype.subscribe=function(e,t,n){var i,o=(void 0===n?{}:n).isBeforeChange;void 0!==o&&o&&(i="beforeChange");return this.scope.attach(e.subscribe(t,this._owner,i))};e.prototype.create=function(e){return o.observable(e)};e.prototype.createArray=function(e){return o.observableArray(e)};e.prototype.compute=function(e,t){var n=this,i={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},r=l(e)?e:{read:e},a=o.utils.extend(i,r);t&&o.utils.extend(a,t);var s=o.computed(a);return this.scope.attach(s)};e.prototype.pureCompute=function(e,t){var n={pure:!0};t&&o.utils.extend(n,t);return this.compute(e,n)};e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};t&&o.utils.extend(n,t);return this._setupBackgroundTask(this.compute(e,n))};e.prototype.wrap=function(e){return a(e)?e:this.create(e)};e.prototype.peekUnwrap=function(e){return a(e)?e.peek():e};e.prototype.unwrap=function(e){return r(e)};e.prototype.isObservable=function(e){return a(e)};e.prototype.ignore=function(e){return s(e)};e.prototype.dispose=function(){this._scope&&this._scope.dispose()};e.prototype._setupBackgroundTask=function(e){var t=this;this._backgroundTasks||(this._backgroundTasks=[]);this._backgroundTasks.push(e);this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()}));return e};e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId;delete this._backgroundTasks};e.prototype._getAsync=function(){var e=this._asyncType||i.default,t=this.scope.attach(new e(this));this._getAsync=function(){return t};return t};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=u});define("@ms/odsp-shared/lib/utilities/knockout/Projections",["require","exports","knockout","knockout-projections"],function(e,t,n){"use strict";return n});define("@ms/odsp-utilities/lib/component/Component",["require","exports","../scope/Scope","../resources/Resources"],function(e,t,n,i){"use strict";var o=function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var o=this.resources,r=void 0===o?t.resources?new i.ResourceScope(t.resources):e.resources:o;this.resources=r;this._Component_scope=new n.default}Object.defineProperty(e.prototype,"scope",{get:function(){return this._Component_scope},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.scope.isDisposed},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._Component_scope.dispose()};e.prototype.managed=function(e){this.resources&&(e=this.resources.injected(e));return this.scope.attached(e)};e.prototype.child=function(e){var t;t=e instanceof i.ResourceKey?this.resources.consume(e):this.resources?this.resources.injected(e,{injectChildResourceScope:!0}):e;return this.scope.attached(t)};return e}();o.dependencies={resources:i.resourceScopeKey};t.Component=o;Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("@ms/odsp-utilities/lib/string/StringHelper",["require","exports"],function(e,t){"use strict";function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(o,function(e,n){var i=t[n];return null===i?"":i})}function i(e,t,n){n=Number(n);if(void 0===e||void 0===t||void 0===n)return null;for(var i="",o=-1,r=t.split("||"),a=0,s=r.length;a<s;a++){var l=r[a];if(l){for(var u=0,c=l.split(",");u<c.length;u++){var d=c[u];if(d)if(isNaN(Number(d))){if(-1!==d.indexOf("-")){var p=d.split("-");if(2!==p.length)continue;var m=void 0;if(""===p[0])m=0;else{if(isNaN(Number(p[0])))continue;m=parseInt(p[0],10)}if(n>=m){if(""===p[1]){o=a;break}if(isNaN(Number(p[1])))continue;if(n<=parseInt(p[1],10)){o=a;break}}}else if(-1!==d.indexOf("*")){var f=d.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^"+f+"$").test(n.toString())){o=a;break}}}else if(n===parseInt(d,10)){o=a;break}}if(-1!==o)break}}if(-1!==o){var h=e.split("||");h[o]&&(i=h[o])}return i}var o=/\{(\d+)\}/g;t.format=n;t.formatToArray=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i,r=[],a=0;i=o.exec(e);){var s=i[0],l=t[parseInt(s.replace(/\{|\}+/g,""),10)];i.index>a&&r.push(e.substring(a,i.index));a=o.lastIndex;r.push(l)}a!==e.length&&r.push(e.substring(a,e.length));return r};t.doesStringEndWith=function(e,t){return e.substr(e.length-t.length)===t};t.doesStringStartWith=function(e,t){return e.substr(0,t.length)===t};t.rightPad=function(e,t){for(var n=e.toString();n.length<t;)n+="0";return n};t.findOneOf=function(e,t){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return n;return-1};t.equalsCaseInsensitive=function(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t};t.capitalize=function(e){return e?e[0].toUpperCase()+e.substr(1):e};t.decapitalize=function(e){return e?e[0].toLowerCase()+e.substr(1):e};t.pluralSelect=function(e,t,n){return 1===e?t:n};t.getLocalizedCountValue=i;t.formatWithLocalizedCountValue=function(e,t,o){return n(i(e,t,o),o.toString())}});define("@ms/odsp-shared/lib/bindings/automation/AutomationBinding",["require","exports","knockout"],function(e,t,n){"use strict";var i=function(){function e(){}e.init=function(t,i,o,r,a){n.applyBindingsToNode(t,{attr:{"data-automationId":i()}},a);if(a){var s=a.$component;if(s){var l=n.utils.unwrapObservable(i());if(l){var u=s[e.AUTOMATION_ELEMENTS_KEY];u||(u=s[e.AUTOMATION_ELEMENTS_KEY]={});u[l]=t;n.utils.domNodeDisposal.addDisposeCallback(t,function(){u[l]&&delete u[l]})}}}};return e}();i.AUTOMATION_ELEMENTS_KEY="__automationBinding$elements";return i});define("@ms/odsp-shared/lib/bindings/automation/AutomationTypeBinding",["require","exports","knockout"],function(e,t,n){"use strict";var i=function(){function e(){}e.init=function(t,i,o,r,a){n.applyBindingsToNode(t,{attr:{"data-automationType":i()}},a);if(a){var s=a.$component;if(s){var l=n.utils.unwrapObservable(i());if(l){var u=s[e.AUTOMATION_TYPE_ELEMENTS_KEY];u||(u=s[e.AUTOMATION_TYPE_ELEMENTS_KEY]={});var c=u[l];c||(c=u[l]=[]);c.push(t);n.utils.domNodeDisposal.addDisposeCallback(t,function(){var e=c.indexOf(t);if(-1!==e){delete c[e];c.splice(e,1)}})}}}};return e}();i.AUTOMATION_TYPE_ELEMENTS_KEY="__automationTypeBinding$elements";return i});define("odsp-next/resources/ControlResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";var i;!function(e){e.currentItem=new n.ResourceKey("currentItem");e.currentItemSet=new n.ResourceKey("currentItemSet");e.groupThrottle=new n.ResourceKey("groupThrottle");e.focusItem=new n.ResourceKey("focusItem");e.currentDataManagerMapper=new n.ResourceKey("dataManagerMapper");e.viewParams=new n.ResourceKey("viewParams");e.itemsSelection=new n.ResourceKey("itemsSelection");e.selectionIndexResolver=new n.ResourceKey("selectionIndexResolver");e.autoFillParams=new n.ResourceKey("autoFillParams");e.actionMap=new n.ResourceKey("actionMap");e.slideshowState=new n.ResourceKey("slideshowState");e.isDebugWindowVisible=new n.ResourceKey("isDebugWindowVisible");e.canUserSelect=new n.ResourceKey("canUserSelect");e.promiseTracker=new n.ResourceKey("promiseTracker");e.focusedInfoPaneSection=new n.ResourceKey("focusedInfoPaneSection");e.currentPage=new n.ResourceKey("currentPage");e.disableCalloutInvoker=new n.ResourceKey("disableCalloutInvoker");e.currentSelectionModelGroup=new n.ResourceKey("currentSelectionModelGroup");e.useMobileList=new n.ResourceKey("useMobileList");e.currentView=new n.ResourceKey("currentView");e.backToClassicUrl=new n.ResourceKey("backToClassicUrl");e.isItemSetRendered=new n.ResourceKey("isItemSetRendered");e.isFirstRunExperienceVisible=new n.ResourceKey("isFirstRunExperienceVisible");e.isExistingUserPremiumUpsellEligible=new n.ResourceKey("isExistingUserPremiumUpsellEligible");e.canModifySchema=new n.ResourceKey("canModifySchema");e.displayImageTileNames=new n.ResourceKey("displayImageTileNames");e.isSharingSectionExpanded=new n.ResourceKey("isSharingSectionExpanded");e.didUserUploadOrCreateFile=new n.ResourceKey("didUserUploadOrCreateFile");e.didUserCreateOfficeFile=new n.ResourceKey("didUserCreateOfficeFile")}(i||(i={}));return i});define("odsp-next/resources/ProviderResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.search=new n.ResourceKey("provider.search");t.suiteNav=new n.ResourceKey("provider.suiteNav");t.peopleCard=new n.ResourceKey("provider.peopleCard");t.shareByLink=new n.ResourceKey("provider.shareByLink");t.folderItemCount=new n.ResourceKey("provider.folderItemCount");t.groups=new n.ResourceKey("provider.groups");t.groupSiteProvider=new n.ResourceKey("provider.groupSiteProvider");t.groupsAsync=new n.ResourceKey("provider.groupsAsync");t.groupsLeftNav=new n.ResourceKey("provider.groupsLeftNav");t.publishingSiteProvider=new n.ResourceKey("provider.publishingSiteProvider");t.itemActivity=new n.ResourceKey("provider.itemActivity");t.ticketRedeemer=new n.ResourceKey("provider.ticketRedeemer");t.userInfo=new n.ResourceKey("provider.userInfo");t.tag=new n.ResourceKey("provider.tag");t.photo=new n.ResourceKey("provider.photo");t.overlay=new n.ResourceKey("provider.overlay");t.infoPane=new n.ResourceKey("provider.infoPane");t.notification=new n.ResourceKey("provider.notification");t.notificationManager=new n.ResourceKey("provider.notificationManager");t.instrumentation=new n.ResourceKey("provider.instrumentation");t.teachingBubble=new n.ResourceKey("provider.teachingBubble");t.feedback=new n.ResourceKey("provider.feedback");t.embed=new n.ResourceKey("provider.embed");t.userActivity=new n.ResourceKey("provider.userActivity");t.storageInfo=new n.ResourceKey("provider.storageInfo");t.storageOptions=new n.ResourceKey("provider.storageOptions");t.subscriptions=new n.ResourceKey("provider.subscriptions");t.customAction=new n.ResourceKey("provider.customAction");t.taxonomy=new n.ResourceKey("provider.taxonomy");t.hashtag=new n.ResourceKey("provider.hashtag");t.thumbnail=new n.ResourceKey("provider.thumbnail");t.appsItem=new n.ResourceKey("provider.appsItem");t.externallySharedItem=new n.ResourceKey("provider.externallySharedItem");t.popularItem=new n.ResourceKey("provider.popularItem");t.subsiteItem=new n.ResourceKey("provider.subsiteItem");t.itemHistory=new n.ResourceKey("provider.itemHistory");t.spotlight=new n.ResourceKey("provider.spotlight");t.encoding=new n.ResourceKey("provider.encoding");t.ratingProvider=new n.ResourceKey("provider.ratingProvider");t.error=new n.ResourceKey("provider.error");t.publish=new n.ResourceKey("provider.publish");t.likeProvider=new n.ResourceKey("provider.likeProvider");t.bundleLoader=new n.ResourceKey("provider.bundleLoader");t.upsell=new n.ResourceKey("provider.upsell");t.newFeatureExperience=new n.ResourceKey("provider.newFeatureExperience");t.profile=new n.ResourceKey("provider.profile");t.processFilters=new n.ResourceKey("provider.processFilters");t.quota=new n.ResourceKey("provider.userState");t.teachingBanner=new n.ResourceKey("provider.teachingBanner");t.promotedPhotos=new n.ResourceKey("provider.promotedPhotos");t.site=new n.ResourceKey("provider.site");t.graphToken=new n.ResourceKey("provider.graphToken");t.firstRunExperience=new n.ResourceKey("provider.firstRunExperience");t.guidedTour=new n.ResourceKey("provider.guidedTour");t.dragAndDropRobot=new n.ResourceKey("provider.dragAndDropRobot");t.dragAndDropAnimation=new n.ResourceKey("provider.dragAndDropAnimation");t.uploadTeachingBubble=new n.ResourceKey("provider.uploadTeachingBubble");t.recycleBin=new n.ResourceKey("provider.recycleBin");t.smartFilters=new n.ResourceKey("provider.smartFilters")});define("odsp-next/resources/PagesResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortManager=new n.ResourceKey("sortManager");t.dataManager=new n.ResourceKey("dataManager");t.listViewContextMenuCommandSet=new n.ResourceKey("listViewContextMenuCommandSet");t.topCommandSet=new n.ResourceKey("topCommandSet");t.listViewContextMenuHelper=new n.ResourceKey("listViewContextMenuHelper");t.fileContent=new n.ResourceKey("fileContent");t.contentRange=new n.ResourceKey("contentRange");t.error=new n.ResourceKey("error");!function(e){!function(e){e.isLeftNavClosing=new n.ResourceKey("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new n.ResourceKey("base.leftNav.isLeftNavVisible");e.hideLeftNav=new n.ResourceKey("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new n.ResourceKey("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new n.ResourceKey("base.leftNav.toggleIsLeftNavUserExpanded")}(e.leftNav||(e.leftNav={}));!function(e){e.isTopBarVisible=new n.ResourceKey("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new n.ResourceKey("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new n.ResourceKey("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new n.ResourceKey("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new n.ResourceKey("base.suiteNav.isSuiteNavHidden")}(e.suiteNav||(e.suiteNav={}));!function(e){e.commandSet=new n.ResourceKey("base.commandBar.commandSet");e.originalCommandSet=new n.ResourceKey("base.commandBar.originalCommandSet");e.hasSelectionState=new n.ResourceKey("base.commandBar.hasSelectionState");e.isDarkTheme=new n.ResourceKey("base.commandBar.isDarkTheme");e.isSearchHidden=new n.ResourceKey("base.commandBar.isSearchHidden")}(e.commandBar||(e.commandBar={}));!function(e){e.isInfoPaneExpanded=new n.ResourceKey("base.infoPane.isInfoPaneExpanded");e.infoPane=new n.ResourceKey("base.infoPane.infoPane");e.isInfoPaneAvailable=new n.ResourceKey("base.infoPane.isInfoPaneAvailable");e.hidePreview=new n.ResourceKey("base.infoPane.hidePreview")}(e.infoPane||(e.infoPane={}));!function(e){e.isFiltersPaneExpanded=new n.ResourceKey("base.infoPane.isFiltersPaneExpanded");e.isFiltersPaneAvailable=new n.ResourceKey("base.infoPane.isFiltersPaneAvailable")}(e.filtersPane||(e.filtersPane={}));e.contextMenuHelper=new n.ResourceKey("base.contextMenuHelper");e.isRetrievingData=new n.ResourceKey("base.isRetrievingData");e.isSmartBannerVisible=new n.ResourceKey("base.isSmartBannerVisible")}(t.base||(t.base={}));!function(e){e.layoutType=new n.ResourceKey("files.layoutType");e.resx=new n.ResourceKey("files.resx");e.isArrangeControlVisible=new n.ResourceKey("files.isArrangeControlVisible");e.mainContentLoadComplete=new n.ResourceKey("mainContentLoadComplete")}(t.files||(t.files={}));(t.photos||(t.photos={})).layoutType=new n.ResourceKey("photos.layoutType");(t.storageInfo||(t.storageInfo={})).layoutType=new n.ResourceKey("storageInfo.layoutType");t.eventScope=new n.ResourceKey("eventScope")});define("odsp-next/resources/SPOResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";var i;!function(e){e.pageContext=new n.ResourceKey("pageContext");e.listContext=new n.ResourceKey("listContext");e.listItems=new n.ResourceKey("listItems");e.currentHashtag=new n.ResourceKey("currentHashtag");e.inplaceEditorUrl=new n.ResourceKey("inplaceEditorUrl");e.inplaceEditorClosing=new n.ResourceKey("inplaceEditorClosing");e.appViewChangeInProgress=new n.ResourceKey("appViewChangeInProgress");e.appViewErrorMessage=new n.ResourceKey("appViewChangeInProgress");e.itemsPerGroup=new n.ResourceKey("itemsPerGroup");e.loggingContext=new n.ResourceKey("loggingContext");e.loggingContextBuckets=new n.ResourceKey("loggingContextBuckets");e.contentTypes=new n.ResourceKey("provider.contentTypes");e.scrollToHashtags=new n.ResourceKey("scrollToHashtags");e.onePageContext=new n.ResourceKey("onePageContext");e.sharingContextInformation=new n.ResourceKey("sharingContextInformation")}(i||(i={}));return i});define("odsp-next/resources/DataSourceResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.folder=new n.ResourceKey("folder");t.appsItem=new n.ResourceKey("appsItem");t.externallySharedItem=new n.ResourceKey("externallySharedItem");t.popularItem=new n.ResourceKey("popularItem");t.subsiteItem=new n.ResourceKey("subsiteItem");t.settings=new n.ResourceKey("settings");t.items=new n.ResourceKey("items");t.versionControl=new n.ResourceKey("versionControl");t.versionHistory=new n.ResourceKey("versionHistory");t.identity=new n.ResourceKey("identity");t.people=new n.ResourceKey("people");t.peopleCardFactory=new n.ResourceKey("peopleCardFactory");t.peopleCard=new n.ResourceKey("peopleCard");t.language=new n.ResourceKey("language");t.leftNav=new n.ResourceKey("leftNav");t.search=new n.ResourceKey("search");t.sharing=new n.ResourceKey("sharing");t.sharingData=new n.ResourceKey("sharingData");t.groups=new n.ResourceKey("groups");t.suiteNav=new n.ResourceKey("suiteNav");t.iosMobileAppPath=new n.ResourceKey("iosMobileAppPath");t.url=new n.ResourceKey("url");t.download=new n.ResourceKey("download");t.footer=new n.ResourceKey("footer");t.manifests=new n.ResourceKey("manifests");t.itemActivity=new n.ResourceKey("itemActivity");t.userInfo=new n.ResourceKey("userInfo");t.storageInfo=new n.ResourceKey("storageInfo");t.storageOptions=new n.ResourceKey("storageOptions");t.album=new n.ResourceKey("album");t.tag=new n.ResourceKey("tag");t.shareByLink=new n.ResourceKey("shareByLink");t.folderItemCount=new n.ResourceKey("folderItemCount");t.video=new n.ResourceKey("video");t.photo=new n.ResourceKey("photo");t.subscriptions=new n.ResourceKey("subscriptions");t.analytics=new n.ResourceKey("analytics");t.feedback=new n.ResourceKey("feedback");t.embed=new n.ResourceKey("embed");t.userActivity=new n.ResourceKey("userActivity");t.application=new n.ResourceKey("application");t.list=new n.ResourceKey("list");t.policyTip=new n.ResourceKey("policyTip");t.customAction=new n.ResourceKey("customAction");t.taxonomy=new n.ResourceKey("taxonomy");t.hashtag=new n.ResourceKey("hashtag");t.quickLaunch=new n.ResourceKey("quickLaunch");t.web=new n.ResourceKey("web");t.shortcut=new n.ResourceKey("shortcutsDS");t.encoding=new n.ResourceKey("encoding");t.rating=new n.ResourceKey("rating");t.publish=new n.ResourceKey("publish");t.videoItem=new n.ResourceKey("videoItem");t.like=new n.ResourceKey("like");t.sites=new n.ResourceKey("sites");t.copy=new n.ResourceKey("copy");t.upsell=new n.ResourceKey("upsell");t.newFeatureExperience=new n.ResourceKey("newFeatureExperience");t.notifications=new n.ResourceKey("notifications");t.itemCommand=new n.ResourceKey("command");t.processFilters=new n.ResourceKey("processFilters");t.quota=new n.ResourceKey("quota");t.firstRunExperience=new n.ResourceKey("firstRun");t.flow=new n.ResourceKey("flow");t.teachingBanner=new n.ResourceKey("teachingBanner");t.bundle=new n.ResourceKey("bundle");t.itemPicker=new n.ResourceKey("itemPicker");t.site=new n.ResourceKey("site");t.pushChannel=new n.ResourceKey("pushChannel");t.itemAutoRefresh=new n.ResourceKey("itemAutoRefresh");t.loginApp=new n.ResourceKey("loginApp");t.microService=new n.ResourceKey("microService");t.zip=new n.ResourceKey("zip");t.urlDoNotUse=new n.ResourceKey("url2");t.attachments=new n.ResourceKey("attachments");t.spotlight=new n.ResourceKey("spotlight");t.error=new n.ResourceKey("error");t.promotedPhotos=new n.ResourceKey("promotedPhotos");t.oAuthTokenUtility=new n.ResourceKey("oAuthTokenUtility");t.fileHandler=new n.ResourceKey("fileHandler");t.recycleBin=new n.ResourceKey("recycleBin");t.instrumentation=new n.ResourceKey("instrumentation");t.graph=new n.ResourceKey("graph");t.guidedTour=new n.ResourceKey("guidedTour");t.formula=new n.ResourceKey("formula");t.appUrl=new n.ResourceKey("appUrl");t.engagementHandlers=new n.ResourceKey("engagementHandlers");t.teachingBubble=new n.ResourceKey("teachingBubble");t.batchUploaderType=new n.ResourceKey("batchUploaderType");t.vroomItemIdentityProcessor=new n.ResourceKey("vroomItemIdentityProcessor")});define("@ms/odsp-utilities/lib/locale/Locale",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}e.invalidate=function(t){e.isRightToLeft="rtl"===document.documentElement.getAttribute("dir");e.safeLeft=e.isRightToLeft?"right":"left";e.safeRight=e.isRightToLeft?"left":"right";t=t||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName;e.language=t||document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang")||"en-us"};return e}();n.invalidate();Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("odsp-next/pages/files/spo/PageEvents",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(){}}();n.mainContentLoadComplete="SPOApp.mainContentLoadComplete";n.deferredResourcesInitialized="SPOApp.deferredResourcesLoaded";t.default=n});define("odsp-next/resources/LoggingResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.beacon=new n.ResourceKey("beacon");t.rumOneHelper=new n.ResourceKey("rumOneHelper");t.rumOneEmbedVideoHelper=new n.ResourceKey("rumOneEmbedVideoHelper")});define("odsp-next/resources/UtilityResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.idle=new n.ResourceKey("idle");t.beforeUnload=new n.ResourceKey("beforeUnload");t.mobile=new n.ResourceKey("mobile");t.newFeatureExperienceEnabler=new n.ResourceKey("newFeatureExperienceEnabler");t.syncActiveXClient=new n.ResourceKey("syncActiveXClient");t.experimentHelper=new n.ResourceKey("experimentHelper");t.attributionHelper=new n.ResourceKey("attributionHelper");t.educationAndUpsells=new n.ResourceKey("educationAndUpsells");t.fileHandlerHelper=new n.ResourceKey("fileHandlerHelper");t.clientSideExtensionHelper=new n.ResourceKey("clientSideExtensionHelper")});define("odsp-next/resources/ModelResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";var i;!function(e){e.dataStore=new n.ResourceKey("dataStore");e.userSettingsStore=new n.ResourceKey("userSettingsStore");e.userInfoStore=new n.ResourceKey("userInfoStore");e.smartFiltersStore=new n.ResourceKey("smartFiltersStore")}(i||(i={}));return i});define("odsp-next/controls/overlays/host/OverlayHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OverlayHostViewModel","./OverlayHost.css","./OverlayHost.html","../../transclusion/host/TransclusionHost"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.registerComponent({tagName:"od-overlay-host",template:e("./OverlayHost.html"),viewModel:i,synchronous:!0});t.default=o});define("@ms/odsp-shared/lib/utilities/knockout/ComponentFactory",["require","exports","knockout","@ms/odsp-utilities/lib/domUtils/DomUtils"],function(e,t,n,i){"use strict";t.registerComponent=function(e){var t=e.tagName,i=e.template,o=e.viewModel,r=e.synchronous,a=void 0!==r&&r;n.components.register(t,{viewModel:o,template:i,synchronous:a});return e};t.registerTemplate=function(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.default.setText(n,t);document.head.appendChild(n)}});define("@ms/odsp-utilities/lib/domUtils/DomUtils",["require","exports","../math/Rectangle","../browser/PlatformDetection"],function(e,t,n,i){"use strict";var o;t.loadStyles=function(e){r.loadStyles(e)};var r=function(){function e(){}e.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1!==(e.className?e.className.split(" "):[]).indexOf(t)};e.toggleClass=function(e,t,n){if(e.classList)n?e.classList.add(t):e.classList.remove(t);else{var i=e.className?e.className.split(" "):[],o=i.indexOf(t);n?-1===o&&i.push(t):o>-1&&i.splice(o,1);e.className=i.join(" ")}};e.loadStyles=function(t){e._platform.isUnlimitedStyleSheetsSupported?e.registerStyle(t):e.registerStyleIE(t)};e.registerStyle=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css";n.appendChild(document.createTextNode(e));t.appendChild(n)};e.registerStyleIE=function(t){var n=document.getElementsByTagName("head")[0],i=e._lastStyleElement?e._lastStyleElement.styleSheet.cssText:"";if(!e._lastStyleElement||i.length+e._styleText.length>e.MAX_STYLE_CONTENT_SIZE){(e._lastStyleElement=document.createElement("style")).type="text/css";n.appendChild(e._lastStyleElement)}e._lastStyleElement.styleSheet.cssText+=t};e.loadStylesheet=function(e){var t=document.createElement("link");t.rel="stylesheet";t.type="text/css";t.href=e;document.head.appendChild(t)};e.setText=function(t,n){void 0===o&&(o=void 0!==e.ce("div").textContent?"textContent":"innerText");t[o]=n};e.ce=function(e,t,n){var i=document.createElement(e);if(t)for(var o=Object.keys(t),r=0;r<o.length;r++){var a=o[r];i.setAttribute(a,t[a])}if(n)for(var s=0;s<n.length;s++)i.appendChild(n[s]);return i};e.setShadowParent=function(t,n){t[e.SHADOW_PARENT_KEY]=n};e.getParent=function(t,n){void 0===n&&(n=!0);return n&&t[e.SHADOW_PARENT_KEY]||t.parentElement};e.ct=function(e){return document.createTextNode(e)};e.createComment=function(e){return document.createComment(e)};e.clickElement=function(e){e.onclick?e.onclick(void 0):e.click&&e.click()};e.insertAfter=function(e,t){var n=t.parentNode,i=t.nextSibling;i?n.insertBefore(e,i):n.appendChild(e)};e.getElementByTagAndPartialId=function(e,t,n){for(var i=[],o=e.getElementsByTagName(t),r=0;r<o.length;r++)o[r].id.indexOf(n)>=0&&i.push(o[r]);return i.length>0?i[0]:null};e.findAncestor=function(t,n,i){void 0===i&&(i=!0);for(;t&&t!==document.body;){if(e.hasClass(t,n))return t;t=e.getParent(t,i)}return null};e.calculateRect=function(e,t){var i=e.getBoundingClientRect(),o=0,r=0,a=0,s=0;if(t){var l=window.getComputedStyle(e);o=parseFloat(l.marginLeft);r=parseFloat(l.marginRight);a=parseFloat(l.marginTop);s=parseFloat(l.marginBottom)}return new n.default(i.left-o,i.top-a,i.width+o+r,i.height+a+s)};e.calculateSubtreeRect=function(t){for(var i=null,o=[t];o.length>0;){t=o.shift();var r=e.calculateRect(t);r.width>0&&r.height>0&&(i=i?i.union(r):r);for(var a=0,s=t.children.length;a<s;a++)o.push(t.children[a])}i||(i=new n.default);return i};e.insertAtIndex=function(e,t,n,i){if(e&&t){n=n<0?0:n;for(var o=e.firstElementChild,r=0;r<n&&o;){i&&i!==o.tagName||r++;o=o.nextElementSibling}o?e.insertBefore(t,o):e.appendChild(t)}};return e}();r.MAX_STYLE_CONTENT_SIZE=1e4;r.SHADOW_PARENT_KEY="_OneDrive_shadowParent";r._platform=new i.default;r._lastStyleElement=null;r._styleText="";Object.defineProperty(t,"__esModule",{value:!0});t.default=r});define("@ms/odsp-utilities/lib/math/Rectangle",["require","exports","./Point","./Size"],function(e,t,n,i){"use strict";var o=function(){function e(t,i,o,r){this.x=0;this.y=0;this.width=0;this.height=0;if(0===arguments.length){this.x=0;this.y=0;this.width=0;this.height=0}else if(t instanceof e){var a=t;this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height}else if(t instanceof n.default){var s=t,l=i;this.x=s.x;this.y=s.y;this.width=l.width;this.height=l.height}else if("object"==typeof t&&"number"==typeof t.left&&"number"==typeof t.top&&"number"==typeof t.width&&"number"==typeof t.height){var u=t;this.x=u.left;this.y=u.top;this.width=u.width;this.height=u.height}else{this.x=t;this.y=i;this.width=o;this.height=r}}e.prototype.clip=function(t){var n=new e(this);if(n.x<t.x){n.width-=t.x-n.x;n.x=t.x}n.getRight()>t.getRight()&&(n.width-=n.getRight()-t.getRight());if(n.y<t.y){n.height-=t.y-n.y;n.y=t.y}n.getBottom()>t.getBottom()&&(n.height-=n.getBottom()-t.getBottom());return n};e.prototype.contains=function(e){if(e instanceof n.default){var t=e;return t.x>=this.x&&t.y>=this.y&&t.x<=this.getRight()&&t.y<=this.getBottom()}var i=e,o=i.getPoint(),r=new n.default(i.getRight(),i.getBottom());return this.contains(o)&&this.contains(r)};e.prototype.getCenter=function(){return new n.default(this.x+this.width/2,this.y+this.height/2)};e.prototype.getLeft=function(){return this.x};e.prototype.getTop=function(){return this.y};e.prototype.getRight=function(){return this.x+this.width};e.prototype.getBottom=function(){return this.y+this.height};e.prototype.getPoint=function(){return new n.default(this.x,this.y)};e.prototype.getSize=function(){return new i.default(this.width,this.height)};e.prototype.inflate=function(t,n){var i,o;if("object"==typeof t){var r=t;i=r.width;o=r.height}else{i=t;o=n}return new e(this.x-i/2,this.y-o/2,this.width+i,this.height+o)};e.prototype.nudge=function(t){var n=new e(this);n.x<t.x?n.x=t.x:n.getRight()>t.getRight()&&(n.x=t.getRight()-n.width);n.y<t.y?n.y=t.y:n.getBottom()>t.getBottom()&&(n.y=t.getBottom()-n.height);return n};e.prototype.translate=function(t,i){var o;if(t instanceof n.default){var r=t;o=this.translate(r.x,r.y)}else{var a=t,s=i;o=new e(this.x+a,this.y+s,this.width,this.height)}return o};e.prototype.union=function(t){var n=Math.min(this.x,t.x),i=Math.min(this.y,t.y);return new e(n,i,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-i)};e.prototype.fit=function(t,n){var i=t;i=this.width&&this.height&&(n?this.width>i.width||this.height>i.height:this.width>i.width&&this.height>i.height)?this._scaleTo(t,n):this;var o=(t.width-i.width)/2,r=(t.height-i.height)/2;return new e(o+this.x,r+this.y,i.width,i.height)};e.prototype._scaleTo=function(t,n){var i=t.width/t.height,o=this.width/this.height,r=0,a=0;if((n?o:i)<(n?i:o)){a=t.height;r=o*t.height}else{r=t.width;a=t.width/o}return new e(this.x,this.y,r,a)};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("@ms/odsp-utilities/lib/math/Point",["require","exports"],function(e,t){"use strict";var n=function(){function e(t,n){void 0===t&&(t=0);void 0===n&&(n=0);if(t instanceof e){var i=t;this.x=i.x;this.y=i.y}else{this.x=t;this.y=n}}e.areEqual=function(e,t,n){void 0===n&&(n=1e-6);return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n};e.getCenter=function(t){return t.reduce(function(e,t){return e.add(t)},e.ORIGIN).scale(1/t.length)};e.prototype.scale=function(t){return new e(this.x*t,this.y*t)};e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)};e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)};e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)};e.prototype.negate=function(){return new e(-this.x,-this.y)};e.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};e.prototype.unit=function(){var e=this.abs();return this.scale(e&&1/e||0)};e.prototype.toString=function(){return"[Point "+this.x+", "+this.y+"]"};return e}();n.ORIGIN=new n;Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("@ms/odsp-utilities/lib/math/Size",["require","exports"],function(e,t){"use strict";var n=function(){return function(e,t){this.width=0;this.height=0;this.width=e;this.height=t}}();Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("@ms/odsp-utilities/lib/browser/PlatformDetection",["require","exports"],function(e,t){"use strict";var n=function(){return function(e){function t(t){return i=RegExp(t+"(\\d+)([\\d.]*)").exec(e)}e||(e=window&&window.navigator&&navigator.userAgent||"");var n=e;e=e.toLowerCase();var i,o,r,a,s,l,u;if(t("msie ")){o=!0;r="9"===i[1]}else if(t("trident.*rv:"))o=!0;else if(t("edge/"))a=!0;else if(t("fxios|firefox/"))s=!0;else if(t("(?:chrome|crios)/"))l=!0;else if(/safari\/(\d+)/.test(e)){u=!0;t("version/")}var c=i&&parseInt(i[1],10)||0,d=i&&i[2]&&i[2].substr(1)||"0",p=/windows phone|wpdesktop/.test(e),m=p||/ipad|iphone|ipod|android/.exec(e),f=m&&m[0],h="android"===f,g="ipad"===f,v=!!f&&!h,b=!m&&e.indexOf("macintosh")>-1,y=!m&&e.indexOf("windows nt")>-1,x=document.createElement("input");x.type="file";var _=window.File,w=_&&_.prototype,I=document.createElement("style");I.type="text/css";var C=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(e);return{isChrome:!!l,isEdge:!!a,isFirefox:!!s,isIE:!!o,isIE9:!!r,isSafari:!!u,browserName:o?"IE":a?"Edge":l?"Chrome":s?"Firefox":u?"Safari":"NA",browserMajor:c,browserMinor:d,isAndroid:h,isIOS:v,isMac:b,isWindows:y,isWinPhone:p,osVersion:C?C[2]:"NA",osName:y?"Windows":p?"Windows Phone":b?"OSX":v?"IOS":h?"Android":"NA",isWindows81:!m&&/windows (?:8\.1|nt 6\.3)/.test(e),isWindows10:!m&&e.indexOf("windows nt 10")>-1,isWindows7:!m&&e.indexOf("windows nt 6.1")>-1,isMobile:!!m,isIPad:g,areCSS3TransitionsSupported:!o||c>9,areTouchEventsSupported:"ontouchstart"in window,isFolderUploadSupported:"webkitdirectory"in x,isHtml5FileUploadSupported:!(!w||!(w.slice||w.mozSlice||w.webkitSlice)),isRetinaSupported:window.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:!I.styleSheet,isWebDavSupported:"addBehavior"in document.createElement("div"),userAgent:n}}}();Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("odsp-next/controls/overlays/host/OverlayHostViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/domUtils/DomUtils","../../../bindings/transclusion/host/TransclusionHostBinding","../../../bindings/focus/FocusTrapBinding","../../../bindings/clientRect/ClientRectBinding","@uifabric/utilities/lib/dom"],function(e,t,n,i,o,r,a,s,l,u,c){"use strict";function d(e){for(var t,n=[];(t=c.getParent(e))&&t.children;){var i=Array.prototype.indexOf.call(t.children,e);n.unshift(i);e=t}return n}function p(e,t){for(var n=0;n<e.length&&n<t.length;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.length<t.length?-1:e.length>t.length?1:0}function m(e,t){return p(e.shadowPosition,t.shadowPosition)}var f=i.utils.toggleDomNodeCssClass,h=i.removeNode;return function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({transclusionHost:s.default,focusTrap:l.default,clientRect:u.default});var i=n.observables;n.overlayProvider=n.resources.consume(r.overlay);n.hasOverlays=i.pureCompute(n._computeHasOverlays);n.topTab=i.create();n.bottomTab=i.create();n.isReady=i.create(!1);n.isInitial=i.create(!0);n.clientRect=i.create();n.async.requestAnimationFrame(n._onIsReadyTimeoutCompleted);return n}n.__extends(t,e);t.prototype.onAddOverlayElement=function(e,t,n){var i=n.options.animation,o=i&&i.afterAdd;if(void 0===(i&&i.isOpen))if(o)this.async.setTimeout(function(){f(e,"od-OverlayHost-overlay--opened",!0);f(e,"od-OverlayHost-overlay--initial",!1);n.options.isOpen(!0)},o);else{f(e,"od-OverlayHost-overlay--opened",!0);f(e,"od-OverlayHost-overlay--initial",!1);n.options.isOpen(!0)}};t.prototype.onRemoveOverlayElement=function(e,t,n){var i=n.options.animation,o=i&&i.beforeRemove;if(void 0===(i&&i.isOpen))if(o){f(e,"od-OverlayHost-overlay--initial",!1);f(e,"od-OverlayHost-overlay--opened",!1);f(e,"od-OverlayHost-overlay--closed",!0);n.options.isOpen(!1);this.async.setTimeout(function(){h(e)},o)}else{n.options.isOpen(!1);h(e)}};t.prototype.getOverlaysInDomOrder=function(e){var t=e.map(function(e){return{overlay:e,shadowPosition:d(e.parentElement)}});t.sort(m);return t.map(function(e){return e.overlay})};t.prototype.isPositioned=function(e){return e.alignToParent()};t.prototype.getOverlayStyle=function(e,t){if(this.isPositioned(e)){var n=this.clientRect(),i=a.default.calculateRect(e.parentElement||t);if(n)return{top:i.getTop()-n.top+"px",left:i.getLeft()-n.left+"px",right:n.width-i.getRight()+"px",bottom:n.height-i.height+"px"}}return{}};t.prototype._onIsReadyTimeoutCompleted=function(){this.isReady(!0);this.isInitial(!1)};t.prototype._computeHasOverlays=function(){return this.overlayProvider.contexts().length>0};return t}(o.default)});define("odsp-next/bindings/transclusion/host/TransclusionHostBinding",["require","exports","tslib","../../BaseBinding","knockout","@uifabric/utilities/lib/dom"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,i=n._context=n.valueAccessor();i.parentElement&&r.setVirtualParent(n.element,i.parentElement);o.applyBindingsToNode(n.element,{template:{nodes:i.templateNodes}},i.bindingContext);i.renderCount(i.renderCount.peek()+1);n.controlsDescendantBindings=!0;return n}n.__extends(t,e);t.prototype.dispose=function(){this._context.renderCount(this._context.renderCount.peek()-1);e.prototype.dispose.call(this)};return t}(i);a.supportsVirtualElements=!0;t.default=a});define("odsp-next/bindings/BaseBinding",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","knockout","@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o,r,a){"use strict";var s=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.element=t.element;i.valueAccessor=t.valueAccessor;i.allBindingsAccessor=t.allBindingsAccessor;i.bindingContext=t.bindingContext;i.controlsDescendantBindings=!1;return i}n.__extends(t,e);t.init=function(e,t,n,i,s){var l=new(new a.ResourceScope(r.getCurrentResourceScope(s)).injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:s});o.utils.domNodeDisposal.addDisposeCallback(e,function(){return l.dispose()});return{controlsDescendantBindings:l.controlsDescendantBindings}};return t}(i.default);s.dependencies=n.__assign({},i.default.dependencies);s.supportsVirtualElements=!1;return s});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/disposable/Disposable","./AutomationHelper","knockout","./KnockoutOverrides"],function(e,t,n,i,o,r){"use strict";function a(e){return"function"==typeof e.createViewModel}function s(e,t,s){s(function(s,u){void 0===s&&(s={});var c=r.contextFor(u.element),d=r.utils.unwrapObservable(s.resources)||l(c),p={owner:e,useFactoriesOnKeys:!0},m=d?new n.ResourceScope(d,p):new n.ResourceScope(p);s=__assign({},s,{resources:m});var f;f=a(t)?t.createViewModel(s,u):new(m.injected(t))(s);var h=new o.default({name:e,viewModel:f,element:u.element,bindingContext:c});return i.hook(f,function(){h.dispose();m.dispose()})})}function l(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}t.loadViewModel=s;t.getCurrentResourceScope=l;t.loader={loadViewModel:s};r.components.loaders.unshift(t.loader)});define("@ms/odsp-shared/lib/utilities/knockout/AutomationHelper",["require","exports"],function(e,t){"use strict";var n="__ResourceComponentLoader$componentName",i="__ResourceComponentLoader$componentId",o="__ResourceComponentLoader$childComponents",r="__ResourceComponentLoader$parentComponentViewModel",a="__ResourceComponentLoader$componentBindingElement",s=0,l=function(){function e(e){var t=this._viewModel=e.viewModel,l=t[i]=""+ ++s;t[a]=e.element;t[o]={};t[n]=e.name;for(var u=e.bindingContext;u&&(!u.$data||u.$data===t||!u.$data[o]);)u=u.$parentContext;if(u){var c=this._parentViewModel=u.$data;c[o][l]=t;t[r]=c}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,s=e[i],l=t&&t[o];s&&l&&delete l[s];if(e){delete e[r];delete e[o];delete e[a];delete e[n]}};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=l});define("@ms/odsp-shared/lib/utilities/knockout/KnockoutOverrides",["require","exports","knockout"],function(e,t,n){"use strict";"boolean"==typeof n.options.preferJQueryEvents?n.options.preferJQueryEvents=!1:"boolean"==typeof n.options.useOnlyNativeEvents&&(n.options.useOnlyNativeEvents=!0)});define("@uifabric/utilities/lib/dom",["require","exports"],function(e,t){"use strict";function n(e){var t;e&&o(e)&&(t=e._virtual.parent);return t}function i(e,t){void 0===t&&(t=!0);return e&&(t&&n(e)||e.parentNode&&e.parentNode)}function o(e){return e&&!!e._virtual}Object.defineProperty(t,"__esModule",{value:!0});t.setVirtualParent=function(e,t){var n=e,i=t;n._virtual||(n._virtual={children:[]});var o=n._virtual.parent;if(o&&o!==t){var r=o._virtual.children.indexOf(n);r>-1&&o._virtual.children.splice(r,1)}n._virtual.parent=i||void 0;if(i){i._virtual||(i._virtual={children:[]});i._virtual.children.push(n)}};t.getVirtualParent=n;t.getParent=i;t.elementContains=function(e,t,n){void 0===n&&(n=!0);var o=!1;if(e&&t)if(n){o=!1;for(;t;){var r=i(t);if(r===e){o=!0;break}t=r}}else e.contains&&(o=e.contains(t));return o};var r=!1;t.setSSR=function(e){r=e};t.getWindow=function(e){return r||"undefined"==typeof window?void 0:e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window};t.getDocument=function(e){return r||"undefined"==typeof document?void 0:e&&e.ownerDocument?e.ownerDocument:document};t.getRect=function(e){var t;e&&(e===window?t={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect&&(t=e.getBoundingClientRect()));return t}});define("odsp-next/bindings/focus/FocusTrapBinding",["require","exports","tslib","knockout","../../utilities/accessibility/Accessibility","../BaseBinding"],function(e,t,n,i,o,r){"use strict";function a(){var e=document.createElement("a");e.href="javascript:;";e.className="ms-accessible";e.setAttribute("aria-hidden","true");return e}Object.defineProperty(t,"__esModule",{value:!0});var s=o.focusNextTabStop,l=o.focusPreviousTabStop,u=i.virtualElements,c=i.applyBindingsToNode,d=i.applyBindingsToDescendants,p=function(e){function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var i=n,o=i.events,r=i.observables,p=i.bindingContext,m=i.element,f=t.valueAccessor()||{},h=f,g=h.isEnabled,v=h.invert,b=a(),y=a();if(g){c(b,{visible:g},p);c(y,{visible:g},p)}var x=u.childNodes(m);u.prepend(m,b);u.insertAfter(m,y,x[x.length-1]);d(p,m);var _=r.peekUnwrap(f.before)||y,w=r.peekUnwrap(f.after)||b;o.on(b,"focus",function(){v?s(y):l(_)});o.on(y,"focus",function(){v?l(b):s(w)});if(!v&&b!==w){o.on(_,"focus",function(){s(b)});o.on(w,"focus",function(){l(y)})}return n}n.__extends(t,e);return t}(r);p.supportsVirtualElements=!0;t.default=p});define("odsp-next/utilities/accessibility/Accessibility",["require","exports"],function(e,t){"use strict";function n(e,t){return e&&c(e,t)}function i(e,t){return e&&d(e,t)}function o(e,t){return e&&(u(e.firstElementChild,s,c,t)||p(e,s,c,t))}function r(e,t){return e&&p(e,l,d,t)}function a(e,t,n){var i=t(e,n);i&&i.focus()}function s(e){return e.nextElementSibling}function l(e){return e.previousElementSibling}function u(e,t,n,i){for(;e;e=t(e)){var o=n(e);if(o)return o}}function c(e,t){return m(e,t)||u(e.firstElementChild,s,c,t)}function d(e,t){return u(e.lastElementChild,l,d,t)||m(e,t)}function p(e,t,n,i){for(;e;e=e.parentElement){var o=u(t(e),t,n,i);if(o)return o}}function m(e,t){var n=e.tagName.toLowerCase();if((n in f||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&!(0===e.offsetWidth&&0===e.offsetHeight||e.disabled||"input"===n&&"hidden"===e.type.toLowerCase()))return e}Object.defineProperty(t,"__esModule",{value:!0});t.focusFirstTabStop=function(e,t){a(e,n,t)};t.focusLastTabStop=function(e,t){a(e,i,t)};t.focusNextTabStop=function(e,t){a(e,o,t)};t.focusPreviousTabStop=function(e,t){a(e,r,t)};t.getFirstTabStop=n;t.getLastTabStop=i;t.getNextTabStop=o;t.getPreviousTabStop=r;t.isTabStop=function(e,t){return!(!e||!m(e,t))};var f={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1}});define("odsp-next/bindings/clientRect/ClientRectBinding",["require","exports","tslib","../BaseBinding","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,n,i,o,r){"use strict";function a(){for(var e in p)l(p[e])}function s(){for(;d.length;){var e=d.pop();if(!e.isDisposed){p[e.id]=e;l(e)}}}function l(e){var t=e.element.getBoundingClientRect(),n=t.top<window.innerHeight&&t.bottom>=0;(e.allowHiddenSizeUpdates||n)&&e.size(e.includePosition?{bottom:t.bottom,left:t.left,right:t.right,top:t.top,height:t.height,width:t.width}:{height:t.height,width:t.width});e.isOnScreen&&e.isOnScreen(n)}Object.defineProperty(t,"__esModule",{value:!0});var u=new o.default,c=0,d=[],p={};new r.default(window).onAll(window,{resize:u.debounce(a,50),scroll:u.throttle(a,50,{leading:!1})});var m=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor(),o={id:c++,element:n.element,isDisposed:!1,size:i.size,isOnScreen:i.isOnScreen,allowHiddenSizeUpdates:i.allowHiddenSizeUpdates,includePosition:!!i.includePosition};i.trigger&&n.createComputed(function(){i.trigger();l(o)});d.push(o);u.setTimeout(s,0);n.addDisposable({dispose:function(){o.isDisposed=!0;delete p[o.id]}});return n}n.__extends(t,e);return t}(i);t.default=m});define("odsp-next/controls/overlays/host/OverlayHost.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OverlayHost{position:absolute;z-index:600;top:0;left:0;bottom:0;right:0;visibility:hidden;overflow:hidden}.od-OverlayHost-content{visibility:visible}.od-OverlayHost-overlay--positioned{position:absolute}"}])});define("@microsoft/load-themed-styles",["require","exports"],function(e,t){"use strict";function n(e,t){p.loadStyles?p.loadStyles(r(e),e):c?l(e,t):s(e,t)}function i(){if(p.theme)for(var e=0,t=p.registeredStyles;e<t.length;e++){var i=t[e];n(i.themableStyle,i)}}function o(e){e&&(e=r(a(e)));return e}function r(e){var t=p.theme;return(e||[]).map(function(e){var n=e.theme;if(n){var i=t?t[n]:void 0,o=e.defaultValue||"inherit";(t&&!i&&console,1)||console.warn('Theming value not provided for "'+n+'". Falling back to "'+o+'".');return i||o}return e.rawString}).join("")}function a(e){var t=[];if(e){for(var n=0,i=void 0;i=m.exec(e);){var o=i.index;o>n&&t.push({rawString:e.substring(n,o)});t.push({theme:i[1],defaultValue:i[2]});n=m.lastIndex}t.push({rawString:e.substring(n)})}return t}function s(e,t){var n=document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css";i.appendChild(document.createTextNode(r(e)));if(t){n.replaceChild(i,t.styleElement);t.styleElement=i}else n.appendChild(i);t||p.registeredStyles.push({styleElement:i,themableStyle:e})}function l(e,t){var n=document.getElementsByTagName("head")[0],i=p.registeredStyles,a=p.lastStyleElement,s=a?a.styleSheet:void 0,l=s?s.cssText:"",u=i[i.length-1],c=r(e);if(!a||l.length+c.length>f){(a=document.createElement("style")).type="text/css";if(t){n.replaceChild(a,t.styleElement);t.styleElement=a}else n.appendChild(a);if(!t){u={styleElement:a,themableStyle:e};i.push(u)}}a.styleSheet.cssText+=o(c);Array.prototype.push.apply(u.themableStyle,e);p.lastStyleElement=a}function u(){var e=!1;if("undefined"!=typeof document){var t=document.createElement("style");t.type="text/css";e=!!t.styleSheet}return e}Object.defineProperty(t,"__esModule",{value:!0});var c,d="undefined"==typeof window?global:window,p=d.__themeState__=d.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]},m=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,f=1e4;t.loadStyles=function(e){var t=Array.isArray(e)?e:a(e);void 0===c&&(c=u());n(t)};t.configureLoadStyles=function(e){p.loadStyles=e};t.loadTheme=function(e){p.theme=e;i()};t.clearStyles=function(){p.registeredStyles.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)});p.registeredStyles=[]};t.detokenize=o;t.splitStyles=a});define("odsp-next/providers/theming/ThemeInitializer",["require","exports","@uifabric/styling/lib/styles/theme","./ThemeProviderFactory","./FabricConfig"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}e.initializeTheme=function(){window.__loadTheme=n.loadTheme;var e=window.FabricConfig||{};e.fontBaseUrl="";window.FabricConfig=e;var t=i.default();t&&t.loadThemeTokenMap().done(function(e){var t={};for(var i in e)e[i]&&(t[i]=e[i]);n.loadTheme({palette:t})})};return e}();t.default=o;o.initializeTheme()});define("@uifabric/styling/lib/styles/theme",["require","exports","tslib","./DefaultFontStyles","./DefaultPalette","@uifabric/utilities/lib/index","@microsoft/load-themed-styles"],function(e,t,n,i,o,r,a){"use strict";function s(e){var t=n.__assign({},u.palette,e.palette);return{palette:t,fonts:n.__assign({},u.fonts,e.fonts),semanticColors:n.__assign({},l(t),e.semanticColors)}}function l(e){return{bodyBackground:e.white,bodyText:e.neutralPrimary,bodySubtext:e.neutralSecondary,bodyDivider:e.neutralLight,disabledBackground:e.neutralLighter,disabledText:e.neutralTertiaryAlt,disabledSubtext:e.neutralQuaternary,focusBorder:e.black,errorText:e.redDark,inputBorder:e.neutralTertiary,inputBorderHovered:e.neutralPrimary,inputBackgroundChecked:e.themePrimary,inputBackgroundCheckedHovered:e.themeDarkAlt,inputForegroundChecked:e.white,inputFocusBorderAlt:e.themePrimary,menuItemBackgroundHovered:e.neutralLighter,menuItemBackgroundChecked:e.neutralQuaternaryAlt,menuIcon:e.themePrimary,menuHeader:e.themePrimary,listBackground:e.white,listTextColor:e.neutralPrimary,listItemBackgroundHovered:e.neutralLighter,listItemBackgroundChecked:e.neutralQuaternary,listItemBackgroundCheckedHovered:e.neutralQuaternaryAlt}}Object.defineProperty(t,"__esModule",{value:!0});var u={palette:o.DefaultPalette,semanticColors:l(o.DefaultPalette),fonts:i.DefaultFontStyles},c=r.getWindow();c&&c.FabricConfig&&c.FabricConfig.theme&&(u=s(c.FabricConfig.theme));r.Customizer.setDefault("theme",u);t.getTheme=function(){return u};t.loadTheme=function(e){u=s(e);a.loadTheme(u.palette);r.Customizer.setDefault("theme",u)};t.createTheme=s});define("@uifabric/styling/lib/styles/DefaultFontStyles",["require","exports","../glamorExports","@uifabric/utilities/lib/index"],function(e,t,n,i){"use strict";function o(){var e=i.getLanguage(),t=I;for(var n in C)if(C.hasOwnProperty(n)&&0===n.indexOf(e)){t=C[n];break}return t+", "+d}function r(e,t){return{fontFamily:o(),MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}function a(e,t,i){e="'"+e+"'";n.fontFace({fontFamily:e,src:"url('"+t+".woff2') format('woff2'),url('"+t+".woff') format('woff')",fontWeight:i,fontStyle:"normal"})}function s(e,t,n,i){void 0===i&&(i="segoeui");var o=e+"/"+n+"/"+i;a(t,o+"-light",k.light);a(t,o+"-semilight",k.semilight);a(t,o+"-regular",k.regular);a(t,o+"-semibold",k.semibold)}function l(){var e=i.getWindow(),t=e?e.FabricConfig:void 0;return t&&void 0!==t.fontBaseUrl?t.fontBaseUrl:c}Object.defineProperty(t,"__esModule",{value:!0});var u,c="https://static2.sharepointonline.com/files/fabric/assets",d="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif",p="Segoe UI Web (Arabic)",m="Segoe UI Web (Cyrillic)",f="Segoe UI Web (East European)",h="Segoe UI Web (Greek)",g="Segoe UI Web (Hebrew)",v="Leelawadee UI Web",b="Segoe UI Web (Vietnamese)",y="Segoe UI Web (West European)",x="'"+m+"'",_="'"+f+"'",w="'Selawik Web'",I="'"+y+"'",C={ar:"'"+p+"'",bg:x,cs:_,el:"'"+h+"'",et:_,he:"'"+g+"'",hi:"'Nirmala UI'",hr:_,hu:_,ja:"'Yu Gothic', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",kk:_,ko:"'Malgun Gothic', Gulim",lt:_,lv:_,pl:_,ru:x,sk:_,"sr-latn":_,th:"'Leelawadee UI Web', 'Kmer UI'",tr:_,uk:x,vi:"'"+b+"'","zh-hans":"'Microsoft Yahei', Verdana, Simsun","zh-hant":"'Microsoft Jhenghei', Pmingliu"};!function(e){e.mini="10px";e.xSmall="11px";e.small="12px";e.smallPlus="13px";e.medium="14px";e.mediumPlus="15px";e.icon="16px";e.large="17px";e.xLarge="21px";e.xxLarge="28px";e.superLarge="42px";e.mega="72px"}(u=t.FontSizes||(t.FontSizes={}));var k;!function(e){e.light=100;e.semilight=300;e.regular=400;e.semibold=600;e.bold=700}(k=t.FontWeights||(t.FontWeights={}));t.DefaultFontStyles={tiny:r(u.mini,k.semibold),xSmall:r(u.xSmall,k.regular),small:r(u.small,k.regular),smallPlus:r(u.smallPlus,k.regular),medium:r(u.medium,k.regular),mediumPlus:r(u.mediumPlus,k.regular),large:r(u.large,k.semilight),xLarge:r(u.xLarge,k.light),xxLarge:r(u.xxLarge,k.light),superLarge:r(u.superLarge,k.light),mega:r(u.mega,k.light),icon:{fontFamily:'"FabricMDL2Icons"',fontWeight:k.regular,fontStyle:"normal"}};!function(){var e=l();if(e){var t=e+"/fonts",n=e+"/icons";s(t,v,"leelawadeeui-thai","leelawadeeui");s(t,p,"segoeui-arabic");s(t,m,"segoeui-cyrillic");s(t,f,"segoeui-easteuropean");s(t,h,"segoeui-greek");s(t,g,"segoeui-hebrew");s(t,b,"segoeui-vietnamese");s(t,y,"segoeui-westeuropean");s(t,w,"selawik","selawik");a("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-semilight",k.light);a("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-bold",k.semibold);a("FabricMDL2Icons",n+"/fabricmdl2icons",k.regular)}}()});define("@uifabric/styling/lib/glamorExports",["require","exports","glamor","rtl-css-js","@uifabric/utilities/lib/index"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(){n.styleSheet&&n.styleSheet.isSpeedy||n.speedy(!0);n.plugins.add(function(e){var t=e.selector,n=e.style;return{selector:t,style:o.getRTL()?i.default(n):n}})}();t.before=function(e){return n.before(e)};t.after=function(e){return n.after(e)};t.parent=function(e,t){return n.parent(e,t)};t.insertGlobal=function(e,t){n.insertGlobal(e,t)};t.fontFace=function(e){return n.fontFace(e)};t.keyframes=function(e){return n.keyframes(e)}});!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("glamor",[],t):"object"==typeof exports?exports.Glamor=t():e.Glamor=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,t,n){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(e,t){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,a,s=n(e),l=1;l<arguments.length;l++){r=Object(arguments[l]);for(var u in r)i.call(r,u)&&(s[u]=r[u]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(r);for(var c=0;c<a.length;c++)o.call(r,a[c])&&(s[a[c]]=r[a[c]])}}return s}},function(e,t,n){"use strict";var i=n(11),o=(n.n(i),n(8)),r=n(14),a=n.n(r),s=n(15),l=n.n(s),u=n(2);n.n(u);n.d(t,"a",function(){return c}),t.b=function(e,t){var i="";for(var r in e){var a=0===r.indexOf("--");if(e.hasOwnProperty(r)){var s=e[r];null!=s&&(a?i+=r+":"+s+";":(i+=c(r)+":",i+=n.i(o.a)(r,s,t)+";"))}}return i||null};var c=l()(a.a)},function(e,t,n){"use strict";var i=n(12);e.exports=i},function(e,t,n){"use strict";function i(e){return null===e||void 0===e||!1===e||"object"===(void 0===e?"undefined":s(e))&&0===Object.keys(e).length}function o(e){if(i(e))return null;if("object"!==(void 0===e?"undefined":s(e)))return e;for(var t={},n=Object.keys(e),o=!1,r=0;r<n.length;r++){var l=e[n[r]],u=a(l);null!==u&&u===l||(o=!0),null!==u&&(t[n[r]]=u)}return 0===Object.keys(t).length?null:o?t:e}function r(e){var t=!1,n=[];return e.forEach(function(e){var i=a(e);null!==i&&i===e||(t=!0),null!==i&&n.push(i)}),0==n.length?null:t?n:e}function a(e){return Array.isArray(e)?r(e):o(e)}t.a=a;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}},function(e,t,n){"use strict";function i(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function o(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function r(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}t.a=function(e,t){for(var n=1540483477,a=t^e.length,s=e.length,l=0;s>=4;){var u=i(e,l);u=r(u,n),u=r(u^=u>>>24,n),a=r(a,n),a^=u,l+=4,s-=4}switch(s){case 3:a^=o(e,l),a^=e.charCodeAt(l+2)<<16,a=r(a,n);break;case 2:a^=o(e,l),a=r(a,n);break;case 1:a^=e.charCodeAt(l),a=r(a,n)}return a^=a>>>13,a=r(a,n),(a^=a>>>15)>>>0}},function(e,t,n){"use strict";function i(e){this.fns=e||[]}var o=n(0),r=n.n(o),a=n(1);t.a=i,t.c=function(e){var t=Object.keys(e.style).map(function(t){return Array.isArray(e.style[t])}).indexOf(!0)>=0;if(t){var i=function(){var t=e.style,i=Object.keys(t).reduce(function(e,i){return e[i]=Array.isArray(t[i])?t[i].join("; "+n.i(a.a)(i)+": "):t[i],e},{});return{v:r()({},e,{style:i})}}();if("object"===(void 0===i?"undefined":s(i)))return i.v}return e},t.b=function(e){return r()({},e,{style:l(e.style)})};var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r()(i.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach(function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))})},remove:function(e){this.fns=this.fns.filter(function(t){return t!==e})},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce(function(e,t){return t(e)},e)}});var l=n(9)},function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){return e[e.length-1]}function r(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function a(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t?!d&&!p:t,i=e.maxLength,o=void 0===i?c&&m?4e3:65e3:i;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=o,this.ctr=0}var l=n(0),u=n.n(l);t.a=s;var c="undefined"!=typeof window,d=!1,p=!1,m=function(){if(c){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();u()(s.prototype,{getSheet:function(){return r(o(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");c?this.tags[0]=a():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(t){d&&console.warn("whoops, illegal rule inserted",e)}},insert:function(e){if(c)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=o(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else o(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,c&&this.ctr%this.maxLength==0&&this.tags.push(a()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){c?(this.tags.forEach(function(e){return e.parentNode.removeChild(e)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!c)return this.sheet.cssRules;var e=[];return this.tags.forEach(function(t){return e.splice.apply(e,[e.length,0].concat(i(Array.from(r(t).cssRules))))}),e}})},function(e,t,n){"use strict";function i(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var o={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(e){r.forEach(function(t){o[i(t,e)]=o[e]})});var a={isUnitlessNumber:o,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.a=a},function(e,t,n){"use strict";var i=n(7),o=n(2),r=(n.n(o),i.a.isUnitlessNumber);t.a=function(e,t,n){var i=null==t||"boolean"==typeof t||""===t;if(i)return"";var o=isNaN(t);if(o||0===t||r.hasOwnProperty(e)&&r[e])return""+t;"string"==typeof t&&(t=t.trim());return t+"px"}},function(e,t,n){var i,o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(a,s){"object"===r(t)&&void 0!==e?e.exports=s():(i=s,void 0!==(o="function"==typeof i?i.call(t,n,t,e):i)&&(e.exports=o))}(0,function(){"use strict";function e(e){return Object.keys(e).sort(function(e,t){return l(e)&&!l(t)?-1:!l(e)&&l(t)?1:0}).reduce(function(t,n){return t[n]=e[n],t},{})}function t(e){if(c(e))return e;var t=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g);return t.forEach(function(e,n){t[n]=Object.keys(a).reduce(function(t,n){var i="-"+n.toLowerCase()+"-";return Object.keys(a[n]).forEach(function(n){var o=v(n);e.indexOf(o)>-1&&"order"!==o&&(t=e.replace(o,i+o)+","+t)}),t},e)}),t.join(",")}function n(t){return Object.keys(t).forEach(function(e){var i=t[e];i instanceof Object&&!Array.isArray(i)?t[e]=n(i):Object.keys(a).forEach(function(n){a[n][e]&&(t[n+s(e)]=i)})}),Object.keys(t).forEach(function(e){[].concat(t[e]).forEach(function(n,o){I.forEach(function(o){return i(t,o(e,n))})})}),e(t)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(t).forEach(function(n){var i=e[n];Array.isArray(i)?[].concat(t[n]).forEach(function(t){var o=i.indexOf(t);o>-1&&e[n].splice(o,1),e[n].push(t)}):e[n]=t[n]})}var o={};o.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o.defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};var a={Webkit:{transform:!0,transformOrigin:!0,transformOriginX:!0,transformOriginY:!0,backfaceVisibility:!0,perspective:!0,perspectiveOrigin:!0,transformStyle:!0,transformOriginZ:!0,animation:!0,animationDelay:!0,animationDirection:!0,animationFillMode:!0,animationDuration:!0,animationIterationCount:!0,animationName:!0,animationPlayState:!0,animationTimingFunction:!0,appearance:!0,userSelect:!0,fontKerning:!0,textEmphasisPosition:!0,textEmphasis:!0,textEmphasisStyle:!0,textEmphasisColor:!0,boxDecorationBreak:!0,clipPath:!0,maskImage:!0,maskMode:!0,maskRepeat:!0,maskPosition:!0,maskClip:!0,maskOrigin:!0,maskSize:!0,maskComposite:!0,mask:!0,maskBorderSource:!0,maskBorderMode:!0,maskBorderSlice:!0,maskBorderWidth:!0,maskBorderOutset:!0,maskBorderRepeat:!0,maskBorder:!0,maskType:!0,textDecorationStyle:!0,textDecorationSkip:!0,textDecorationLine:!0,textDecorationColor:!0,filter:!0,fontFeatureSettings:!0,breakAfter:!0,breakBefore:!0,breakInside:!0,columnCount:!0,columnFill:!0,columnGap:!0,columnRule:!0,columnRuleColor:!0,columnRuleStyle:!0,columnRuleWidth:!0,columns:!0,columnSpan:!0,columnWidth:!0,flex:!0,flexBasis:!0,flexDirection:!0,flexGrow:!0,flexFlow:!0,flexShrink:!0,flexWrap:!0,alignContent:!0,alignItems:!0,alignSelf:!0,justifyContent:!0,order:!0,backdropFilter:!0,scrollSnapType:!0,scrollSnapPointsX:!0,scrollSnapPointsY:!0,scrollSnapDestination:!0,scrollSnapCoordinate:!0,shapeImageThreshold:!0,shapeImageMargin:!0,shapeImageOutside:!0,hyphens:!0,flowInto:!0,flowFrom:!0,regionFragment:!0,textSizeAdjust:!0,transition:!0,transitionDelay:!0,transitionDuration:!0,transitionProperty:!0,transitionTimingFunction:!0},Moz:{appearance:!0,userSelect:!0,boxSizing:!0,textAlignLast:!0,textDecorationStyle:!0,textDecorationSkip:!0,textDecorationLine:!0,textDecorationColor:!0,tabSize:!0,hyphens:!0,fontFeatureSettings:!0,breakAfter:!0,breakBefore:!0,breakInside:!0,columnCount:!0,columnFill:!0,columnGap:!0,columnRule:!0,columnRuleColor:!0,columnRuleStyle:!0,columnRuleWidth:!0,columns:!0,columnSpan:!0,columnWidth:!0},ms:{flex:!0,flexBasis:!1,flexDirection:!0,flexGrow:!1,flexFlow:!0,flexShrink:!1,flexWrap:!0,alignContent:!1,alignItems:!1,alignSelf:!1,justifyContent:!1,order:!1,userSelect:!0,wrapFlow:!0,wrapThrough:!0,wrapMargin:!0,scrollSnapType:!0,scrollSnapPointsX:!0,scrollSnapPointsY:!0,scrollSnapDestination:!0,scrollSnapCoordinate:!0,touchAction:!0,hyphens:!0,flowInto:!0,flowFrom:!0,breakBefore:!0,breakAfter:!0,breakInside:!0,regionFragment:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridTemplate:!0,gridAutoColumns:!0,gridAutoRows:!0,gridAutoFlow:!0,grid:!0,gridRowStart:!0,gridColumnStart:!0,gridRowEnd:!0,gridRow:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnGap:!0,gridRowGap:!0,gridArea:!0,gridGap:!0,textSizeAdjust:!0}},s=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},l=function(e){return null!==e.match(/^(Webkit|Moz|O|ms)/)},u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return e+t};return o.defineProperty({},e,["-webkit-","-moz-",""].map(function(e){return n(e,t)}))},c=function(e){return Array.isArray(e)&&(e=e.join(",")),null!==e.match(/-webkit-|-moz-|-ms-/)},d={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0},p={flex:!0,"inline-flex":!0},m={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},f={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0},h=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/,g=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){var t=/[A-Z]/g,n=/^ms-/,i={};e.exports=function(e){return e in i?i[e]:i[e]=e.replace(t,"-$&").toLowerCase().replace(n,"-ms-")}}),v=g&&"object"===(void 0===g?"undefined":r(g))&&"default"in g?g.default:g,b={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0},y={"space-around":"distribute","space-between":"justify","flex-start":"start","flex-end":"end"},x={alignContent:"msFlexLinePack",alignSelf:"msFlexItemAlign",alignItems:"msFlexAlign",justifyContent:"msFlexPack",order:"msFlexOrder",flexGrow:"msFlexPositive",flexShrink:"msFlexNegative",flexBasis:"msPreferredSize"},_={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},w={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"},I=[function(e,t){if("position"===e&&"sticky"===t)return{position:["-webkit-sticky","sticky"]}},function(e,t){if("string"==typeof t&&!c(t)&&t.indexOf("calc(")>-1)return u(e,t,function(e,t){return t.replace(/calc\(/g,e+"calc(")})},function(e,t){if("cursor"===e&&d[t])return u(e,t)},function(e,t){if(m[e]&&f[t])return u(e,t)},function(e,t){if("string"==typeof t&&!c(t)&&null!==t.match(h))return u(e,t)},function(e,n){if("string"==typeof n&&b[e]){var i,r=t(n),a=r.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(e){return null===e.match(/-moz-|-ms-/)}).join(",");return e.indexOf("Webkit")>-1?o.defineProperty({},e,a):(i={},o.defineProperty(i,"Webkit"+s(e),a),o.defineProperty(i,e,r),i)}},function(e,t){if(x[e])return o.defineProperty({},x[e],y[t]||t)},function(e,t){return"flexDirection"===e&&"string"==typeof t?{WebkitBoxOrient:t.indexOf("column")>-1?"vertical":"horizontal",WebkitBoxDirection:t.indexOf("reverse")>-1?"reverse":"normal"}:w[e]?o.defineProperty({},w[e],_[t]||t):void 0},function(e,t){if("display"===e&&p[t])return{display:["-webkit-box","-moz-box","-ms-"+t+"box","-webkit-"+t,t]}}];return n})},function(e,t){"use strict";var n=/-(.)/g;e.exports=function(e){return e.replace(n,function(e,t){return t.toUpperCase()})}},function(e,t,n){"use strict";var i=n(10),o=/^-ms-/;e.exports=function(e){return i(e.replace(o,"ms-"))}},function(e,t){"use strict";function n(e){return function(){return e}}var i=function(){};i.thatReturns=n,i.thatReturnsFalse=n(!1),i.thatReturnsTrue=n(!0),i.thatReturnsNull=n(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},function(e,t){"use strict";var n=/([A-Z])/g;e.exports=function(e){return e.replace(n,"-$1").toLowerCase()}},function(e,t,n){"use strict";var i=n(13),o=/^ms-/;e.exports=function(e){return i(e).replace(o,"-ms-")}},function(e,t){"use strict";e.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}function a(){for(var e="",t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];for(var r=0;r<i.length;r++)e+=JSON.stringify(i[r]);return n.i(F.a)(e).toString(36)}function s(e){var t=Object.keys(e).filter(function(e){return"toString"!==e});return 1===t.length&&!!/data\-css\-([a-zA-Z0-9]+)/.exec(t[0])}function l(e){var t=Object.keys(e).filter(function(e){return"toString"!==e});if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}function u(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=t.split(",").map(function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t}).join(",");return j&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+r(t)+"],[data-css-"+e+"][data-simulate-"+r(t)+"]"),n}function c(e){var t=e.selector,i=e.style,o=H.transform({selector:t,style:i});return o.selector+"{"+n.i(M.b)(o.style)+"}"}function d(e){var t=void 0,n=void 0,i=void 0,o=void 0;return Object.keys(e).forEach(function(r){r.indexOf("&")>=0?(n=n||{},n[r]=e[r]):0===r.indexOf("@media")?(i=i||{},i[r]=d(e[r])):0===r.indexOf("@supports")?(o=o||{},o[r]=d(e[r])):"label"===r?e.label.length>0&&(t=t||{},t.label=W?e.label.join("."):""):(t=t||{},t[r]=e[r])}),{plain:t,selects:n,medias:i,supports:o}}function p(e,t){var n=[],i=t.plain,o=t.selects,r=t.medias,a=t.supports;return i&&n.push(c({style:i,selector:u(e)})),o&&Object.keys(o).forEach(function(t){return n.push(c({style:o[t],selector:u(e,t)}))}),r&&Object.keys(r).forEach(function(t){return n.push(t+"{"+p(e,r[t]).join("")+"}")}),a&&Object.keys(a).forEach(function(t){return n.push(t+"{"+p(e,a[t]).join("")+"}")}),n}function m(e){if(!G[e.id]){G[e.id]=!0;var t=d(e.style);p(e.id,t).map(function(e){return U.insert(e)})}}function f(e){$[e.id]||($[e.id]=e)}function h(e){if(s(e)){var t=$[l(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}function g(e){if(f(e),m(e),X[e.id])return X[e.id];var t=o({},"data-css-"+e.id,W?e.label||"":"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),X[e.id]=t,t}function v(e){for(var t=[":",".","[",">"," "],n=!1,i=e.charAt(0),o=0;o<t.length;o++)if(i===t[o]){n=!0;break}return n||e.indexOf("&")>=0}function b(e,t){var n=e.split(",").map(function(e){return e.indexOf("&")>=0?e:"&"+e});return t.split(",").map(function(e){return e.indexOf("&")>=0?e:"&"+e}).reduce(function(e,t){return e.concat(n.map(function(e){return t.replace(/\&/g,e)}))},[]).join(",")}function y(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function x(e){return 0===e.indexOf("@media")}function _(e){return 0===e.indexOf("@supports")}function w(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function I(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(I(e[n])):t.concat(e[n]);return t}function C(e,t){var i=t.selector,o=void 0===i?"":i,r=t.mq,a=void 0===r?"":r,l=t.supp,u=void 0===l?"":l,c=t.src,d=void 0===c?{}:c;Array.isArray(d)||(d=[d]),(d=I(d)).forEach(function(t){if(s(t)){var i=h(t);if("css"!==i.type)throw new Error("cannot merge this rule");t=i.style}(t=n.i(R.a)(t))&&t.composes&&C(e,{selector:o,mq:a,supp:u,src:t.composes}),Object.keys(t||{}).forEach(function(n){if(v(n))"::placeholder"===n&&(C(e,{selector:b(o,"::-webkit-input-placeholder"),mq:a,supp:u,src:t[n]}),C(e,{selector:b(o,"::-moz-placeholder"),mq:a,supp:u,src:t[n]}),C(e,{selector:b(o,"::-ms-input-placeholder"),mq:a,supp:u,src:t[n]})),C(e,{selector:b(o,n),mq:a,supp:u,src:t[n]});else if(x(n))C(e,{selector:o,mq:y(a,n),supp:u,src:t[n]});else if(_(n))C(e,{selector:o,mq:a,supp:w(u,n),src:t[n]});else if("composes"===n);else{var i=e;u&&(i[u]=i[u]||{},i=i[u]),a&&(i[a]=i[a]||{},i=i[a]),o&&(i[o]=i[o]||{},i=i[o]),"label"===n?W&&(e.label=e.label.concat(t.label)):i[n]=t[n]}})})}function k(e){var t={label:[]};C(t,{src:e});return g({id:a(t),style:t,label:W?t.label.join("."):"",type:"css"})}function S(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=n.i(R.a)(t),t?Z(t):Y}function T(e){G[e.id]||function(){var t=Object.keys(e.keyframes).map(function(t){var i=H.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return i.name+"{"+n.i(M.b)(i.style)+"}"}).join("");["-webkit-","-moz-","-o-",""].forEach(function(n){return U.insert("@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}")}),G[e.id]=!0}()}function P(e){G[e.id]||(U.insert("@font-face{"+n.i(M.b)(e.font)+"}"),G[e.id]=!0)}function E(){V&&console.warn("[Deprecation] In glamor v3 the `presets` object will be removed. See https://github.com/threepointone/glamor/issues/213 for more information.")}function A(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e?S(o({},e,n)):re(n)}function L(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return S(o({},e,n))}var B=n(0),O=n.n(B),D=n(6),M=n(1),R=n(3),N=n(5),F=n(4);n.d(t,"styleSheet",function(){return U}),t.speedy=function(e){return U.speedy(e)},n.d(t,"plugins",function(){return H}),t.simulations=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];j=!!e},t.simulate=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t=n.i(R.a)(t),t?j?t.reduce(function(e,t){return e["data-simulate-"+r(t)]="",e},{}):(q||(console.warn("can't simulate without once calling simulations(true)"),q=!0),V||K||z||(console.warn("don't use simulation outside dev"),z=!0),{}):{}},t.cssLabels=function(e){W=!!e},t.isLikeRule=s,t.idFor=l,t.css=S,n.d(t,"insertRule",function(){return ee}),n.d(t,"insertGlobal",function(){return te}),n.d(t,"fontFace",function(){return ne}),n.d(t,"keyframes",function(){return ie}),t.rehydrate=function(e){O()(G,e.reduce(function(e,t){return e[t]=!0,e},{}))},t.flush=function(){G=U.inserted={},$=U.registered={},X={},U.flush(),U.inject()},n.d(t,"presets",function(){return oe}),n.d(t,"style",function(){return re}),t.select=A,n.d(t,"$",function(){return ae}),t.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return S(o({},e+" &",n))},n.d(t,"merge",function(){return se}),n.d(t,"compose",function(){return le}),t.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return S(o({},"@media "+e,n))},t.pseudo=L,t.active=function(e){return L(":active",e)},t.any=function(e){return L(":any",e)},t.checked=function(e){return L(":checked",e)},t.disabled=function(e){return L(":disabled",e)},t.empty=function(e){return L(":empty",e)},t.enabled=function(e){return L(":enabled",e)},t._default=function(e){return L(":default",e)},t.first=function(e){return L(":first",e)},t.firstChild=function(e){return L(":first-child",e)},t.firstOfType=function(e){return L(":first-of-type",e)},t.fullscreen=function(e){return L(":fullscreen",e)},t.focus=function(e){return L(":focus",e)},t.hover=function(e){return L(":hover",e)},t.indeterminate=function(e){return L(":indeterminate",e)},t.inRange=function(e){return L(":in-range",e)},t.invalid=function(e){return L(":invalid",e)},t.lastChild=function(e){return L(":last-child",e)},t.lastOfType=function(e){return L(":last-of-type",e)},t.left=function(e){return L(":left",e)},t.link=function(e){return L(":link",e)},t.onlyChild=function(e){return L(":only-child",e)},t.onlyOfType=function(e){return L(":only-of-type",e)},t.optional=function(e){return L(":optional",e)},t.outOfRange=function(e){return L(":out-of-range",e)},t.readOnly=function(e){return L(":read-only",e)},t.readWrite=function(e){return L(":read-write",e)},t.required=function(e){return L(":required",e)},t.right=function(e){return L(":right",e)},t.root=function(e){return L(":root",e)},t.scope=function(e){return L(":scope",e)},t.target=function(e){return L(":target",e)},t.valid=function(e){return L(":valid",e)},t.visited=function(e){return L(":visited",e)},t.dir=function(e,t){return L(":dir("+e+")",t)},t.lang=function(e,t){return L(":lang("+e+")",t)},t.not=function(e,t){var n=e.split(",").map(function(e){return e.trim()}).map(function(e){return":not("+e+")"});return 1===n.length?L(":not("+e+")",t):A(n.join(""),t)},t.nthChild=function(e,t){return L(":nth-child("+e+")",t)},t.nthLastChild=function(e,t){return L(":nth-last-child("+e+")",t)},t.nthLastOfType=function(e,t){return L(":nth-last-of-type("+e+")",t)},t.nthOfType=function(e,t){return L(":nth-of-type("+e+")",t)},t.after=function(e){return L("::after",e)},t.before=function(e){return L("::before",e)},t.firstLetter=function(e){return L("::first-letter",e)},t.firstLine=function(e){return L("::first-line",e)},t.selection=function(e){return L("::selection",e)},t.backdrop=function(e){return L("::backdrop",e)},t.placeholder=function(e){return S({"::placeholder":e})},t.cssFor=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t=n.i(R.a)(t),t?t.map(function(e){var t={label:[]};return C(t,{src:e}),p(a(t),d(t)).join("")}).join(""):""},t.attribsFor=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];t=n.i(R.a)(t);var o=t?t.map(function(e){l(e);var t=Object.keys(e)[0],n=e[t];return t+'="'+(n||"")+'"'}).join(" "):"";return o};var U=new D.a;U.inject();var H=U.plugins=new N.a([N.b,N.c]);H.media=new N.a,H.fontFace=new N.a,H.keyframes=new N.a([N.b]);var V=!1,K=!1,j=V,q=!1,z=!1,W=V,G=U.inserted={},$=U.registered={},X={},Y={};Object.defineProperty(Y,"toString",{enumerable:!1,value:function(){return"css-nil"}});var Q="undefined"!=typeof WeakMap?[Y,new WeakMap,new WeakMap,new WeakMap]:[Y],J=!1,Z="undefined"!=typeof WeakMap?function(e){return function(t){if(Q[t.length]){for(var n=Q[t.length],o=0;o<t.length-1;)n.has(t[o])||n.set(t[o],new WeakMap),n=n.get(t[o]),o++;if(n.has(t[t.length-1])){var r=n.get(t[o]);if($[r.toString().substring(4)])return r}}var a=e(t);if(Q[t.length]){for(var s=0,l=Q[t.length];s<t.length-1;)l=l.get(t[s]),s++;try{l.set(t[s],a)}catch(e){if(V&&!J){var u;J=!0,(u=console).warn.apply(u,["failed setting the WeakMap cache for args:"].concat(i(t))),console.warn("this should NOT happen, please file a bug on the github repo.")}}}return a}}(k):k;S.insert=function(e){var t={id:a(e),css:e,type:"raw"};f(t),G[t.id]||(U.insert(t.css),G[t.id]=!0)};var ee=S.insert;S.global=function(e,t){return S.insert(c({selector:e,style:t}))};var te=S.global;S.keyframes=function(e,t){t||(t=e,e="animation");var i={id:a(e,t=n.i(R.a)(t)||{}),type:"keyframes",name:e,keyframes:t};return f(i),T(i),e+"_"+i.id},S.fontFace=function(e){var t={id:a(e=n.i(R.a)(e)),type:"font-face",font:e};return f(t),P(t),e.fontFamily};var ne=S.fontFace,ie=S.keyframes,oe={get mobile(){return E(),"(min-width: 400px)"},get Mobile(){return E(),"@media (min-width: 400px)"},get phablet(){return E(),"(min-width: 550px)"},get Phablet(){return E(),"@media (min-width: 550px)"},get tablet(){return E(),"(min-width: 750px)"},get Tablet(){return E(),"@media (min-width: 750px)"},get desktop(){return E(),"(min-width: 1000px)"},get Desktop(){return E(),"@media (min-width: 1000px)"},get hd(){return E(),"(min-width: 1200px)"},get Hd(){return E(),"@media (min-width: 1200px)"}},re=S,ae=A,se=S,le=S}])});!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("rtl-css-js",[],t):"object"==typeof exports?exports.rtlCSSJS=t():e.rtlCSSJS=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var i=n(1);e.exports=i.default;for(var o in i)i.hasOwnProperty(o)&&(e.exports[o]=i[o])},function(e,t){"use strict";function n(e){return Object.keys(e).reduce(function(t,n){var o=e[n];p(o)&&(o=o.trim());var r=i(n,o),a=r.key,s=r.value;return t[a]=s,t},{})}function i(e,t){var n=/\/\*\s?@noflip\s?\*\//.test(t),i=n?e:o(e);return{key:i,value:n?t:r(i,t)}}function o(e){return g[e]||e}function r(e,t){if(d(t))return n(t);var i=c(t),o=i?t:t.replace(/ !important.*?$/,""),r=!i&&o.length!==t.length,a=b[e],s=void 0;return s=a?a(o):v[o]||o,r?s+" !important":s}function a(e){return e.replace(/ +/g," ").split(" ").map(function(e){return e.trim()}).filter(Boolean).reduce(function(e,t){var n=e.list,i=e.state,o=(t.match(/\(/g)||[]).length,r=(t.match(/\)/g)||[]).length;return i.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),i.parensDepth+=o-r,{list:n,state:i}},{list:[],state:{parensDepth:0}}).list}function s(e){var t=a(e);if(t.length<=3||t.length>4)return e;var n=h(t,4),i=n[0],o=n[1],r=n[2];return[i,n[3],r,o].join(" ")}function l(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var n=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(n)+"%"}return e}function u(e){return e.reduce(function(e,t){var n=h(t,2),i=n[0],o=n[1];return e[i]=o,e[o]=i,e},{})}function c(e){return"number"==typeof e}function d(e){return"object"===(void 0===e?"undefined":f(e))}function p(e){return"string"==typeof e}function m(e,t){return-1!==e.indexOf(t)}Object.defineProperty(t,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=function(){function e(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=u([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"]]),v=u([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),b={padding:function(e){return c(e)?e:s(e)},textShadow:function(e){return e.replace(/(-*)([.|\d]+)/,function(e,t,n){return"0"===n?e:""+(""===t?"-":"")+n})},borderColor:function(e){return s(e)},borderRadius:function(e){if(c(e))return e;if(m(e,"/")){var t=e.split("/"),n=h(t,2),i=n[0],o=n[1];return b.borderRadius(i.trim())+" / "+b.borderRadius(o.trim())}var r=a(e);switch(r.length){case 2:return r.reverse().join(" ");case 4:var s=h(r,4),l=s[0],u=s[1],d=s[2];return[u,l,s[3],d].join(" ");default:return e}},background:function(e){var t=e.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return e=e.replace(t,b.backgroundPosition(t)),b.backgroundImage(e)},backgroundImage:function(e){return m(e,"url(")?e.replace(/(^|\W|_)((ltr)|(rtl)|(left)|(right))(\W|_|$)/g,function(e,t,n){return e.replace(n,v[n])}):e},backgroundPosition:function(e){return e.replace(/^((-|\d|\.)+%)/,function(e,t){return l(t)}).replace(/(left)|(right)/,function(e){return v[e]})},backgroundPositionX:function(e){return c(e)?e:b.backgroundPosition(e)}};b.margin=b.padding,b.borderWidth=b.padding,b.boxShadow=b.textShadow,b.webkitBoxShadow=b.textShadow,b.mozBoxShadow=b.textShadow,b.borderStyle=b.borderColor,t.default=n}])});define("@uifabric/utilities/lib/index",["require","exports","./Async","./AutoScroll","./BaseComponent","./Customizer","./DelayedRender","./EventGroup","./FabricPerformance","./KeyCodes","./Rectangle","./array","./autobind","./css","./customizable","./dom","./focus","./hoist","./initials","./language","./math","./object","./overflow","./properties","./resources","./rtl","./scroll","./string","./warn","./memoize"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b,y,x,_,w,I,C,k,S,T,P,E){"use strict";function A(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});A(n);A(i);A(o);A(r);A(a);A(s);A(l);A(u);A(c);A(d);A(p);A(m);A(f);A(h);A(g);A(v);A(b);A(y);A(x);A(_);A(w);A(I);A(C);A(k);A(S);A(T);A(P);A(E)});define("@uifabric/utilities/lib/Async",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._timeoutIds=null;this._immediateIds=null;this._intervalIds=null;this._animationFrameIds=null;this._isDisposed=!1;this._parent=e||null;this._onErrorHandler=t;this._noop=function(){}}e.prototype.dispose=function(){var e;this._isDisposed=!0;this._parent=null;if(this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}};e.prototype.setTimeout=function(e,t){var n=this,i=0;if(!this._isDisposed){this._timeoutIds||(this._timeoutIds={});i=setTimeout(function(){try{delete n._timeoutIds[i];e.apply(n._parent)}catch(e){n._onErrorHandler&&n._onErrorHandler(e)}},t);this._timeoutIds[i]=!0}return i};e.prototype.clearTimeout=function(e){if(this._timeoutIds&&this._timeoutIds[e]){clearTimeout(e);delete this._timeoutIds[e]}};e.prototype.setImmediate=function(e){var t=this,n=0;if(!this._isDisposed){this._immediateIds||(this._immediateIds={});var i=function(){try{delete t._immediateIds[n];e.apply(t._parent)}catch(e){t._logError(e)}};n=window.setImmediate?window.setImmediate(i):window.setTimeout(i,0);this._immediateIds[n]=!0}return n};e.prototype.clearImmediate=function(e){if(this._immediateIds&&this._immediateIds[e]){window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e);delete this._immediateIds[e]}};e.prototype.setInterval=function(e,t){var n=this,i=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});i=setInterval(function(){try{e.apply(n._parent)}catch(e){n._logError(e)}},t);this._intervalIds[i]=!0}return i};e.prototype.clearInterval=function(e){if(this._intervalIds&&this._intervalIds[e]){clearInterval(e);delete this._intervalIds[e]}};e.prototype.throttle=function(e,t,n){var i=this;if(this._isDisposed)return this._noop;var o,r,a=t||0,s=!0,l=!0,u=0,c=null;n&&"boolean"==typeof n.leading&&(s=n.leading);n&&"boolean"==typeof n.trailing&&(l=n.trailing);var d=function(t){var n=(new Date).getTime(),p=n-u,m=s?a-p:a;if(p>=a&&(!t||s)){u=n;if(c){i.clearTimeout(c);c=null}o=e.apply(i._parent,r)}else null===c&&l&&(c=i.setTimeout(d,m));return o};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r=e;return d(!0)}};e.prototype.debounce=function(e,t,n){var i=this;if(this._isDisposed)return this._noop;var o,r,a=t||0,s=!1,l=!0,u=null,c=0,d=(new Date).getTime(),p=null;n&&"boolean"==typeof n.leading&&(s=n.leading);n&&"boolean"==typeof n.trailing&&(l=n.trailing);n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(u=n.maxWait);var m=function(t){var n=(new Date).getTime(),f=!1;if(t){s&&n-c>=a&&(f=!0);c=n}var h=n-c,g=a-h,v=n-d,b=!1;null!==u&&(v>=u&&p?b=!0:g=Math.min(g,u-v));if(h>=a||b||f){if(p){i.clearTimeout(p);p=null}d=n;o=e.apply(i._parent,r)}else null!==p&&t||!l||(p=i.setTimeout(m,g));return o};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r=e;return m(!0)}};e.prototype.requestAnimationFrame=function(e){var t=this,n=0;if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var i=function(){try{t._animationFrameIds&&delete t._animationFrameIds[n];e.apply(t._parent)}catch(e){t._logError(e)}};n=window.requestAnimationFrame?window.requestAnimationFrame(i):window.setTimeout(i,0);this._animationFrameIds[n]=!0}return n};e.prototype.cancelAnimationFrame=function(e){if(this._animationFrameIds&&this._animationFrameIds[e]){window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e);delete this._animationFrameIds[e]}};e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)};return e}();t.Async=n});define("@uifabric/utilities/lib/AutoScroll",["require","exports","./EventGroup","./scroll","./dom"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._events=new n.EventGroup(this);this._scrollableParent=i.findScrollableParent(e);this._incrementScroll=this._incrementScroll.bind(this);this._scrollRect=o.getRect(this._scrollableParent);this._scrollableParent===window&&(this._scrollableParent=document.body);if(this._scrollableParent){this._events.on(window,"mousemove",this._onMouseMove,!0);this._events.on(window,"touchmove",this._onTouchMove,!0)}}e.prototype.dispose=function(){this._events.dispose();this._stopScroll()};e.prototype._onMouseMove=function(e){this._computeScrollVelocity(e.clientY)};e.prototype._onTouchMove=function(e){e.touches.length>0&&this._computeScrollVelocity(e.touches[0].clientY)};e.prototype._computeScrollVelocity=function(e){if(this._scrollRect){var t=this._scrollRect.top,n=t+this._scrollRect.height-100;this._scrollVelocity=e<t+100?Math.max(-15,(100-(e-t))/100*-15):e>n?Math.min(15,(e-n)/100*15):0;this._scrollVelocity?this._startScroll():this._stopScroll()}};e.prototype._startScroll=function(){this._timeoutId||this._incrementScroll()};e.prototype._incrementScroll=function(){this._scrollableParent&&(this._scrollableParent.scrollTop+=Math.round(this._scrollVelocity));this._timeoutId=setTimeout(this._incrementScroll,16)};e.prototype._stopScroll=function(){if(this._timeoutId){clearTimeout(this._timeoutId);delete this._timeoutId}};return e}();t.AutoScroll=r});define("@uifabric/utilities/lib/EventGroup",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t){this._id=e._uniqueId++;this._parent=t;this._eventRecords=[]}e.raise=function(t,n,i,o){var r;if(e._isElement(t)){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(n,o||!1,!0);a.args=i;r=t.dispatchEvent(a)}else if(document.createEventObject){var s=document.createEventObject(i);t.fireEvent("on"+n,s)}}else for(;t&&!1!==r;){var l=t.__events__,u=l?l[n]:null;if(u)for(var c in u)if(u.hasOwnProperty(c))for(var d=u[c],p=0;!1!==r&&p<d.length;p++){var m=d[p];m.objectCallback&&(r=m.objectCallback.call(m.parent,i))}t=o?t.parent:null}return r};e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]};e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]};e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0};e._isElement=function(e){return!!e&&(e.addEventListener||e instanceof HTMLElement)};e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this.off();this._parent=null}};e.prototype.onAll=function(e,t,n){for(var i in t)t.hasOwnProperty(i)&&this.on(e,i,t[i],n)};e.prototype.on=function(t,n,i,o){var r=this;if(n.indexOf(",")>-1)for(var a=n.split(/[ ,]+/),s=0;s<a.length;s++)this.on(t,a[s],i,o);else{var l=this._parent,u={target:t,eventName:n,parent:l,callback:i,useCapture:o||!1};(a=t.__events__=t.__events__||{})[n]=a[n]||{count:0};a[n][this._id]=a[n][this._id]||[];a[n][this._id].push(u);a[n].count++;if(e._isElement(t)){var c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed){var n;try{if(!1===(n=i.apply(l,e))&&e[0]){var o=e[0];o.preventDefault&&o.preventDefault();o.stopPropagation&&o.stopPropagation();o.cancelBubble=!0}}catch(o){}return n}};u.elementCallback=c;t.addEventListener?t.addEventListener(n,c,o):t.attachEvent&&t.attachEvent("on"+n,c)}else{u.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed)return i.apply(l,e)}}this._eventRecords.push(u)}};e.prototype.off=function(e,t,n,i){for(var o=0;o<this._eventRecords.length;o++){var r=this._eventRecords[o];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof i&&i!==r.useCapture)){var a=r.target.__events__,s=a[r.eventName],l=s?s[this._id]:null;if(l){if(1!==l.length&&n){s.count--;l.splice(l.indexOf(r),1)}else{s.count-=l.length;delete a[r.eventName][this._id]}s.count||delete a[r.eventName]}r.elementCallback&&(r.target.removeEventListener?r.target.removeEventListener(r.eventName,r.elementCallback,r.useCapture):r.target.detachEvent&&r.target.detachEvent("on"+r.eventName,r.elementCallback));this._eventRecords.splice(o--,1)}}};e.prototype.raise=function(t,n,i){return e.raise(this._parent,t,n,i)};e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0};return e}();n._uniqueId=0;t.EventGroup=n});define("@uifabric/utilities/lib/scroll",["require","exports","./dom","./scroll.scss"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=0;t.DATA_IS_SCROLLABLE_ATTRIBUTE="data-is-scrollable";t.disableBodyScroll=function(){var e=n.getDocument();e&&e.body&&!r&&e.body.classList.add(i.default.msFabricScrollDisabled);r++};t.enableBodyScroll=function(){if(r>0){var e=n.getDocument();e&&e.body&&1===r&&e.body.classList.remove(i.default.msFabricScrollDisabled);r--}};t.getScrollbarWidth=function(){if(void 0===o){var e=document.createElement("div");e.style.setProperty("width","100px");e.style.setProperty("height","100px");e.style.setProperty("overflow","scroll");e.style.setProperty("position","absolute");e.style.setProperty("top","-9999px");document.body.appendChild(e);o=e.offsetWidth-e.clientWidth;document.body.removeChild(e)}return o};t.findScrollableParent=function(e){for(var n=e;n&&n!==document.body;){if("true"===n.getAttribute(t.DATA_IS_SCROLLABLE_ATTRIBUTE))return n;n=n.parentElement}n=e;for(;n&&n!==document.body;){if("false"!==n.getAttribute(t.DATA_IS_SCROLLABLE_ATTRIBUTE)){var i=getComputedStyle(n),o=i?i.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return n}n=n.parentElement}n&&n!==document.body||(n=window);return n}});define("@uifabric/utilities/lib/scroll.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={msFabricScrollDisabled:"msFabricScrollDisabled_723ab801"};t.default=o;n.loadStyles([{rawString:".msFabricScrollDisabled_723ab801{overflow:hidden!important}"}])});define("@uifabric/utilities/lib/BaseComponent",["require","exports","tslib","react","./Async","./EventGroup","./warn"],function(e,t,n,i,o,r,a){"use strict";function s(e,t,n){for(var i=0,o=n.length;i<o;i++)l(e,t,n[i])}function l(e,t,n){var i=e[n],o=t[n];(i||o)&&(e[n]=function(){var t;try{o&&(t=o.apply(this,arguments));i!==o&&(t=i.apply(this,arguments))}catch(t){var r="Exception in "+e.className+"."+n+"(): "+("string"==typeof t?t:t.stack);u.onError&&u.onError(r,t)}return t})}Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(n,i){var o=e.call(this,n,i)||this;n&&(o.props=n);o._shouldUpdateComponentRef=!0;s(o,t.prototype,["componentWillMount","componentDidMount","shouldComponentUpdate","componentWillUpdate","componentWillReceiveProps","render","componentDidUpdate","componentWillUnmount"]);return o}n.__extends(t,e);t.prototype.componentWillReceiveProps=function(e,t){this._updateComponentRef(this.props,e)};t.prototype.componentDidMount=function(){this._updateComponentRef(void 0,this.props)};t.prototype.componentWillUnmount=function(){if(this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var n=this.__disposables[e];n.dispose&&n.dispose()}this.__disposables=null}};Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_disposables",{get:function(){this.__disposables||(this.__disposables=[]);return this.__disposables},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_async",{get:function(){if(!this.__async){this.__async=new o.Async(this);this._disposables.push(this.__async)}return this.__async},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_events",{get:function(){if(!this.__events){this.__events=new r.EventGroup(this);this._disposables.push(this.__events)}return this.__events},enumerable:!0,configurable:!0});t.prototype._resolveRef=function(e){var t=this;this.__resolves||(this.__resolves={});this.__resolves[e]||(this.__resolves[e]=function(n){return t[e]=n});return this.__resolves[e]};t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={});if(this._shouldUpdateComponentRef&&(!e&&t.componentRef||e&&e.componentRef!==t.componentRef)){e&&e.componentRef&&e.componentRef(null);t.componentRef&&t.componentRef(this)}};t.prototype._warnDeprecations=function(e){a.warnDeprecations(this.className,this.props,e)};t.prototype._warnMutuallyExclusive=function(e){a.warnMutuallyExclusive(this.className,this.props,e)};return t}(i.Component);t.BaseComponent=u;u.onError=function(e){console.error(e);throw e};t.nullRender=function(){return null}});define("@uifabric/utilities/lib/warn",["require","exports"],function(e,t){"use strict";function n(e){console&&console.warn&&console.warn(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n;t.warnDeprecations=function(e,t,n){for(var o in n)if(t&&o in t){var r=e+" property '"+o+"' was used but has been deprecated.",a=n[o];a&&(r+=" Use '"+a+"' instead.");i(r)}};t.warnMutuallyExclusive=function(e,t,n){for(var o in n)if(t&&o in t){var r=n[o];r&&r in t&&i(e+" property '"+o+"' is mutually exclusive with '"+n[o]+"'. Use one or the other.")}};t.warn=n;t.setWarningCallback=function(e){i=void 0===e?n:e}});define("@uifabric/utilities/lib/Customizer",["require","exports","tslib","react","prop-types","./BaseComponent"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={},s=[],l=function(e){function t(t,n){var i=e.call(this,t)||this;i.state=i._getInjectedProps(t,n);return i}n.__extends(t,e);t.setDefault=function(e,n){a[e]=n;t._change(e)};t.getDefault=function(e){return a[e]};t.addChangeListener=function(e){s.push(e)};t.removeChangeListener=function(e){var t=s.indexOf(e);t>=0&&s.splice(t,1)};t._change=function(e){for(var t=0,n=s;t<n.length;t++)(0,n[t])(e)};t.prototype.getChildContext=function(){return this.state};t.prototype.componentWillReceiveProps=function(e,t){this.setState(this._getInjectedProps(e,t))};t.prototype.render=function(){return i.Children.only(this.props.children)};t.prototype._getInjectedProps=function(e,t){var i=e.settings,o=void 0===i?{}:i,r=t.injectedProps,a=void 0===r?{}:r;return{injectedProps:n.__assign({},a,o)}};return t}(r.BaseComponent);l.contextTypes={injectedProps:o.object};l.childContextTypes=l.contextTypes;t.Customizer=l});!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("prop-types",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PropTypes=e()}}(function(){return function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t){"use strict";var n=e(4),i=e(5),o=e(3);t.exports=function(){function e(e,t,n,r,a,s){s!==o&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return r.checkPropTypes=n,r.PropTypes=r,r}},{3:3,4:4,5:5}],2:[function(e,t){t.exports=e(1)()},{1:1}],3:[function(e,t){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},{}],4:[function(e,t){"use strict";function n(e){return function(){return e}}var i=function(){};i.thatReturns=n,i.thatReturnsFalse=n(!1),i.thatReturnsTrue=n(!0),i.thatReturnsNull=n(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},t.exports=i},{}],5:[function(e,t){"use strict";var n=function(){};t.exports=function(e,t,i,o,r,a,s,l){if(n(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[i,o,r,a,s,l],d=0;(u=new Error(t.replace(/%s/g,function(){return c[d++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},{}]},{},[2])(2)});define("@uifabric/utilities/lib/DelayedRender",["require","exports","tslib","react"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t)||this;n.state={isRendered:!1};return n}n.__extends(t,e);t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=setTimeout(function(){e.setState({isRendered:!0})},t)};t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)};t.prototype.render=function(){return this.state.isRendered?i.Children.only(this.props.children):null};return t}(i.Component);o.defaultProps={delay:0};t.DelayedRender=o});define("@uifabric/utilities/lib/FabricPerformance",["require","exports","./Async"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()},o=function(){function e(){}e.measure=function(t,n){var o=i();n();var r=i(),a=e.summary[t]||{totalDuration:0,count:0,all:[]},s=r-o;a.totalDuration+=s;a.count++;a.all.push({duration:s,timeStamp:r});e.summary[t]=a};e.reset=function(){e.summary={};e._async.clearTimeout(e._timeoutId);e.setPeriodicReset()};e.setPeriodicReset=function(){e._timeoutId=e._async.setTimeout(function(){return e.reset()},18e4)};return e}();o.summary={};o._async=new n.Async;t.FabricPerformance=o;o.setPeriodicReset()});define("@uifabric/utilities/lib/KeyCodes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.a=65]="a";e[e.backspace=8]="backspace";e[e.comma=188]="comma";e[e.del=46]="del";e[e.down=40]="down";e[e.end=35]="end";e[e.enter=13]="enter";e[e.escape=27]="escape";e[e.home=36]="home";e[e.left=37]="left";e[e.pageDown=34]="pageDown";e[e.pageUp=33]="pageUp";e[e.right=39]="right";e[e.semicolon=186]="semicolon";e[e.space=32]="space";e[e.tab=9]="tab";e[e.up=38]="up"}(t.KeyCodes||(t.KeyCodes={}))});define("@uifabric/utilities/lib/Rectangle",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,i){void 0===e&&(e=0);void 0===t&&(t=0);void 0===n&&(n=0);void 0===i&&(i=0);this.top=n;this.bottom=i;this.left=e;this.right=t}Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0});e.prototype.equals=function(e){return parseFloat(this.top.toFixed(4))===parseFloat(e.top.toFixed(4))&&parseFloat(this.bottom.toFixed(4))===parseFloat(e.bottom.toFixed(4))&&parseFloat(this.left.toFixed(4))===parseFloat(e.left.toFixed(4))&&parseFloat(this.right.toFixed(4))===parseFloat(e.right.toFixed(4))};return e}();t.Rectangle=n});define("@uifabric/utilities/lib/array",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.findIndex=function(e,t){for(var n=-1,i=0;e&&i<e.length;i++)if(t(e[i],i)){n=i;break}return n};t.createArray=function(e,t){for(var n=[],i=0;i<e;i++)n.push(t(i));return n}});define("@uifabric/utilities/lib/autobind",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.autobind=function(e,t,n){var i=n.value,o=!1;return{configurable:!0,get:function(){if(o||i&&this===i.prototype||this.hasOwnProperty(t))return i;var e=i&&i.bind(this);o=!0;Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e});o=!1;return e},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e})}}}});define("@uifabric/utilities/lib/css",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.css=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0,o=e;i<o.length;i++){var r=o[i];if(r)if("string"==typeof r)n.push(r);else if(r.hasOwnProperty("toString")&&"function"==typeof r.toString)n.push(r.toString());else for(var a in r)r[a]&&n.push(a)}return n.join(" ")}});define("@uifabric/utilities/lib/customizable",["require","exports","tslib","react","prop-types","./Customizer"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.customizable=function(e){return function(t){return a=function(o){function a(e,t){var n=o.call(this,e,t)||this;n._onSettingChanged=n._onSettingChanged.bind(n);return n}n.__extends(a,o);a.prototype.componentDidMount=function(){r.Customizer.addChangeListener(this._onSettingChanged)};a.prototype.componentWillUnmount=function(){r.Customizer.removeChangeListener(this._onSettingChanged)};a.prototype.render=function(){for(var o={},a=0,s=e;a<s.length;a++){var l=s[a];o[l]=this.context.injectedProps?this.context.injectedProps[l]:r.Customizer.getDefault(l)}return i.createElement(t,n.__assign({},o,this.props))};a.prototype._onSettingChanged=function(t){e.indexOf(t)>=0&&this.forceUpdate()};return a}(i.Component),a.contextTypes={injectedProps:o.object},a;var a}}});define("@uifabric/utilities/lib/focus",["require","exports","./dom"],function(e,t,n){"use strict";function i(e,t,n,o,u,c){if(!t||t===e)return null;var d=r(t);if(u&&d&&(c||!s(t)&&!l(t))){var p=i(e,t.lastElementChild,!0,!0,!0,c);if(p)return p}if(n&&d&&a(t))return t;var m=i(e,t.previousElementSibling,!0,!0,!0,c);return m||(o?null:i(e,t.parentElement,!0,!1,!1,c))}function o(e,t,n,i,u,c){if(!t||t===e&&u)return null;var d=r(t);if(n&&d&&a(t))return t;if(!u&&d&&(c||!s(t)&&!l(t))){var p=o(e,t.firstElementChild,!0,!0,!1,c);if(p)return p}if(t===e)return null;var m=o(e,t.nextElementSibling,!0,!0,!1,c);return m||(i?null:o(e,t.parentElement,!1,!1,!0,c))}function r(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(c);return null!==t&&void 0!==t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function a(e){if(!e||e.disabled)return!1;var t=0,n=null;e&&e.getAttribute&&(n=e.getAttribute("tabIndex"))&&(t=parseInt(n,10));var i=e.getAttribute?e.getAttribute(u):null,o=null!==n&&t>=0;return!!e&&"false"!==i&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"true"===i||o||e.getAttribute&&"button"===e.getAttribute("role"))}function s(e){return!!(e&&e.getAttribute&&e.getAttribute(d))}function l(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(p))}Object.defineProperty(t,"__esModule",{value:!0});var u="data-is-focusable",c="data-is-visible",d="data-focuszone-id",p="data-is-sub-focuszone";t.getFirstFocusable=function(e,t,n){return o(e,t,!0,!1,!1,n)};t.getLastFocusable=function(e,t,n){return i(e,t,!0,!1,!0,n)};t.focusFirstChild=function(e){var t=o(e,e,!0,!1,!1,!0);if(t){t.focus();return!0}return!1};t.getPreviousElement=i;t.getNextElement=o;t.isElementVisible=r;t.isElementTabbable=a;t.isElementFocusZone=s;t.isElementFocusSubZone=l;t.doesElementContainFocus=function(e){var t=n.getDocument(e),i=t&&t.activeElement;return!(!i||!n.elementContains(e,i))}});define("@uifabric/utilities/lib/hoist",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["setState","render","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount"];t.hoistMethods=function(e,t,i){void 0===i&&(i=n);var o=[];for(var r in t)!function(n){if("function"==typeof t[n]&&void 0===e[n]&&(!i||-1===i.indexOf(n))){o.push(n);e[n]=function(){t[n].apply(t,arguments)}}}(r);return o};t.unhoistMethods=function(e,t){t.forEach(function(t){return delete e[t]})}});define("@uifabric/utilities/lib/initials",["require","exports"],function(e,t){"use strict";function n(e,t){var n="",i=e.split(" ");if(2===i.length){n+=i[0].charAt(0).toUpperCase();n+=i[1].charAt(0).toUpperCase()}else if(3===i.length){n+=i[0].charAt(0).toUpperCase();n+=i[2].charAt(0).toUpperCase()}else 0!==i.length&&(n+=i[0].charAt(0).toUpperCase());return t&&n.length>1?n.charAt(1)+n.charAt(0):n}function i(e){return e=(e=(e=e.replace(o,"")).replace(r," ")).trim()}Object.defineProperty(t,"__esModule",{value:!0});var o=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,r=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;t.getInitials=function(e,t){if(null==e)return"";e=i(e);return a.test(e)?"":n(e,t)}});define("@uifabric/utilities/lib/language",["require","exports","./dom"],function(e,t,n){"use strict";function i(e,t){void 0===t&&(t=!1);var i=n.getDocument();i&&i.documentElement.setAttribute("lang",e);var r=n.getWindow();r&&r.localStorage&&!t&&localStorage.setItem("language",e);o=e}Object.defineProperty(t,"__esModule",{value:!0});var o;t.getLanguage=function(){if(void 0===o){var e=n.getDocument(),t=n.getWindow();if(t&&t.localStorage){var r=localStorage.getItem("language");null!==r&&(o=r)}void 0===o&&e&&(o=e.documentElement.getAttribute("lang"));void 0===o&&i("en",!1)}return o};t.setLanguage=i});define("@uifabric/utilities/lib/math",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDistanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}});define("@uifabric/utilities/lib/object",["require","exports"],function(e,t){"use strict";function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;return!0}function i(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t=t||{};for(var o=0,r=n;o<r.length;o++){var a=r[o];if(a)for(var s in a)(a.hasOwnProperty(s)&&!e||e(s))&&(t[s]=a[s])}return t}Object.defineProperty(t,"__esModule",{value:!0});var o="__currentId__",r="undefined"!=typeof window&&window||process;void 0===r[o]&&(r[o]=0);t.shallowCompare=function(e,t){return n(e,t)&&n(t,e)};t.assign=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return i.apply(this,[null,e].concat(t))};t.filteredAssign=i;t.getId=function(e){var t=r[o]++;return(e||"")+t}});define("@uifabric/utilities/lib/overflow",["require","exports"],function(e,t){"use strict";function n(e){return e.clientWidth<e.scrollWidth}function i(e){return e.clientHeight<e.scrollHeight}Object.defineProperty(t,"__esModule",{value:!0});t.hasHorizontalOverflow=n;t.hasVerticalOverflow=i;t.hasOverflow=function(e){return n(e)||i(e)}});define("@uifabric/utilities/lib/properties",["require","exports","./object"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.baseElementEvents=["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel"];t.baseElementProperties=["defaultChecked","defaultValue","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","capture","cellPadding","cellSpacing","charSet","challenge","checked","children","classID","className","cols","colSpan","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","download","draggable","encType","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","height","hidden","high","hrefLang","htmlFor","httpEquiv","icon","id","inputMode","integrity","is","keyParams","keyType","kind","lang","list","loop","low","manifest","marginHeight","marginWidth","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","placeholder","poster","preload","radioGroup","readOnly","rel","required","role","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","spellCheck","src","srcDoc","srcLang","srcSet","start","step","style","summary","tabIndex","title","type","useMap","value","width","wmode","wrap"];t.htmlElementProperties=t.baseElementProperties.concat(t.baseElementEvents);t.anchorProperties=t.htmlElementProperties.concat(["href","target"]);t.buttonProperties=t.htmlElementProperties.concat(["disabled"]);t.divProperties=t.htmlElementProperties.concat(["align","noWrap"]);t.inputProperties=t.buttonProperties;t.textAreaProperties=t.buttonProperties;t.imageProperties=t.divProperties;t.getNativeProps=function(e,t,i){return n.filteredAssign(function(e){return(!i||i.indexOf(e)<0)&&(0===e.indexOf("data-")||0===e.indexOf("aria-")||t.indexOf(e)>=0)},{},e)}});define("@uifabric/utilities/lib/resources",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="";t.getResourceUrl=function(e){return n+e};t.setBaseUrl=function(e){n=e}});define("@uifabric/utilities/lib/rtl",["require","exports","./KeyCodes","./dom"],function(e,t,n,i){"use strict";function o(){if(void 0===a){var e=i.getDocument(),t=i.getWindow();if(t&&t.localStorage){var n=localStorage.getItem("isRTL");null!==n&&(a="1"===n)}void 0===a&&e&&(a="rtl"===e.documentElement.getAttribute("dir"));if(void 0===a)throw new Error("getRTL was called in a server environment without setRTL being called first. Call setRTL to set the correct direction first.");r(a,!0)}return a}function r(e,t){void 0===t&&(t=!1);var n=i.getDocument();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr");var o=i.getWindow();if(o&&o.localStorage&&!t)try{localStorage.setItem("isRTL",e?"1":"0")}catch(e){}a=e}Object.defineProperty(t,"__esModule",{value:!0});var a;t.getRTL=o;t.setRTL=r;t.getRTLSafeKeyCode=function(e){o()&&(e===n.KeyCodes.left?e=n.KeyCodes.right:e===n.KeyCodes.right&&(e=n.KeyCodes.left));return e}});define("@uifabric/utilities/lib/string",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/[\{\}]/g,i=/\{\d+\}/g;t.format=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r=t;return e.replace(i,function(e){var t=r[e.replace(n,"")];null!==t&&void 0!==t||(t="");return t})}});define("@uifabric/utilities/lib/memoize",["require","exports"],function(e,t){"use strict";function n(e,t){void 0===t&&(t=100);var n,r=0;return s?function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var l=n;if(void 0===n||t>0&&r>t){n=o();r=0}l=n;for(var u=0;u<a.length;u++){var c=i(a[u]);l.map.has(c)||l.map.set(c,o());l=l.map.get(c)}if(!l.hasOwnProperty("value")){l.value=e.apply(void 0,a);r++}return l.value}:e}function i(e){if(!e)return r;if("object"==typeof e)return e;a[e]||(a[e]={val:e});return a[e]}function o(){return{map:s?new s:null}}Object.defineProperty(t,"__esModule",{value:!0});var r={empty:!0},a={},s="undefined"==typeof WeakMap?null:WeakMap;t.setMemoizeWeakMap=function(e){s=e};t.memoize=function(e,t,i){var o=n(i.value&&i.value.bind(null));return{configurable:!0,get:function(){return o}}};t.memoizeFunction=n});define("@uifabric/styling/lib/styles/DefaultPalette",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DefaultPalette={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d7",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#212121",neutralPrimary:"#333333",neutralPrimaryAlt:"#3c3c3c",neutralSecondary:"#666666",neutralTertiary:"#a6a6a6",neutralTertiaryAlt:"#c8c8c8",neutralQuaternary:"#d0d0d0",neutralQuaternaryAlt:"#dadada",neutralLight:"#eaeaea",neutralLighter:"#f4f4f4",neutralLighterAlt:"#f8f8f8",white:"#ffffff",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a80000",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d7",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"}});define("odsp-next/providers/theming/ThemeProviderFactory",["require","exports","../../utilities/features/Features","./WebThemeProvider"],function(e,t,n,i){"use strict";function o(){var e,t=window._spPageContextInfo;n.isFeatureEnabled(n.SpListNextTheming)&&t&&(t.themedCssFolderUrl||t.groupColor)&&(e=new i.default);return e}Object.defineProperty(t,"__esModule",{value:!0});var r;t.default=function(){r||(r=o());return r}});define("odsp-next/providers/theming/WebThemeProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/theming/ThemeProvider"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function t(){this._pageContext=window._spPageContextInfo;this._themeProvider=new i.default(this._loadData.bind(this))}t.prototype.loadThemeTokenMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):n.default.wrap()};t.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();if(t)return this._themeProvider.loadThemeData(t,e);return n.default.wrap(void 0)};t.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=t.groupColor?t.groupColor+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||n||null}return e};t.prototype._loadData=function(t){var i=this;return!!this._getThemeCacheToken()&&e.specified("odsp-next/dataSources/theming/spList/WebThemeDataSource")?new n.default(function(n,o){e(["odsp-next/dataSources/theming/spList/WebThemeDataSource"],function(e){new e.default(i._pageContext).loadData(t).then(n,o)})}):n.default.wrap()};return t}();t.default=o});define("@ms/odsp-utilities/lib/theming/ThemeProvider",["require","exports","./RgbaColor","./ThemeCache","../async/Promise","../logging/events/Engagement.event","../logging/events/Qos.event"],function(e,t,n,i,o,r,a){"use strict";var s=function(){function e(e){this._loadData=e}e._makeCssUrl=function(t){var n="none";t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")');return n};e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]}));return n};e.prototype.loadThemeTokenMap=function(t,i){return this.loadThemeData(t,i).then(function(t){var i;if(t&&t.palette){i={};var o=t.palette;for(var r in o){var a=o[r];i[r]=a?n.default.toHtmlString(a):null}i.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return i},function(e){return null})};e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,s=null,l=a.ResultTypeEnum.Failure;this._dataPromise=a.Qos.instrumentPromise({name:"ThemeProvider.LoadData"},function(){return new o.default(function(u,c){var d=null;t||(d=i.default.getCachedTheme(e));if(d){r.Engagement.logData({name:"ThemeProvider.DataFromCache"});u(d)}else{t&&r.Engagement.logData({name:"ThemeProvider.ForceUpdateData"});r.Engagement.logData({name:"ThemeProvider.DataFromServer"});n._loadData(t).done(function(t){if(t)if(t.cacheToken){i.default.updateThemeCache(t,e);u(t)}else{s="NoCacheToken";c&&c("Theme data with no CacheToken returned")}else{s="NoData";c&&c("No model returned")}},function(e){if(o.default.isCanceled(c)){s="Canceled";l=a.ResultTypeEnum.ExpectedFailure}else s="ServerLoadFailure";c&&c(e)})}})},null,function(e){if(o.default.isCanceled(e)){l=a.ResultTypeEnum.ExpectedFailure;s="Canceled"}return{resultType:l,resultCode:s||"Other",error:e}});return this._dataPromise};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=s});define("@ms/odsp-utilities/lib/theming/RgbaColor",["require","exports"],function(e,t){"use strict";var n=function(){function e(){this.R=0;this.G=0;this.B=0;this.A=e.maxComponent}e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)};e.equals=function(e,t){var n=!e,i=!t;return n||i?n&&i:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A};e.fromRgba=function(t,n,i,o){var r=new e;r.R=Math.round(t);r.G=Math.round(n);r.B=Math.round(i);r.A=null!=o?Math.round(o):e.maxComponent;return r};e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var i=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:i.A=n(t,1,2);i.R=n(t,3,4);i.G=n(t,5,6);i.B=n(t,7,8);break;case 7:i.R=n(t,1,2);i.G=n(t,3,4);i.B=n(t,5,6);break;case 4:i.R=n(t,1,1);i.G=n(t,2,2);i.B=n(t,3,3)}return i};e.toHtmlString=function(t,n){function i(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var i=n.toString(16);n<16&&(i="0"+i);return i}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?i(t.A):"")+i(t.R)+i(t.G)+i(t.B)};return e}();n.maxComponent=255;Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("@ms/odsp-utilities/lib/theming/ThemeCache",["require","exports","../models/store/BaseDataStore","../models/store/DataStoreCachingType"],function(e,t,n,i){"use strict";var o=function(){function e(){}e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove("Data");t.remove("CacheToken");t.remove("CacheVersion")};e.getCachedTheme=function(t){var n,i=e.getThemeDataStore();try{t===i.getValue("CacheToken")&&"1.7"===i.getValue("CacheVersion")&&(n=i.getValue("Data"))}catch(e){}return n};e.updateThemeCache=function(t,n){var i=e.getThemeDataStore();i.setValue("Data",t);i.setValue("CacheToken",n||t.cacheToken);i.setValue("CacheVersion","1.7")};e.getThemeDataStore=function(){return new n.default("odTheme",i.default.local)};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("@ms/odsp-utilities/lib/logging/events/Engagement.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";t.Engagement=n.createSingleEvent({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:1},isIntentional:{isPrefixingDisabled:!0,type:3},scenario:{isPrefixingDisabled:!0,type:1},location:{isPrefixingDisabled:!0,type:1},usageType:{isPrefixingDisabled:!0,type:1},currentPage:{isPrefixingDisabled:!0,type:1},previousPage:{isPrefixingDisabled:!0,type:1},experiment:{isPrefixingDisabled:!0,type:4},siteId:{isPrefixingDisabled:!0,type:1},webId:{isPrefixingDisabled:!0,type:1},listId:{isPrefixingDisabled:!0,type:1},groupId:{isPrefixingDisabled:!0,type:1},docId:{isPrefixingDisabled:!0,type:1},webTemplateId:{isPrefixingDisabled:!0,type:1},listTemplateId:{isPrefixingDisabled:!0,type:1},extraData:4});Object.defineProperty(t,"__esModule",{value:!0});t.default=t.Engagement});define("@ms/odsp-utilities/lib/logging/events/Qos.event",["require","exports","../PairedEventBase","./ResultTypeEnum"],function(e,t,n,i){"use strict";t.ResultTypeEnum=i.ResultTypeEnum;t.Qos=n.createPairedEvent({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:1},resultCode:{isPrefixingDisabled:!0,type:1},resultType:{typeRef:i.ResultTypeEnum,isPrefixingDisabled:!0,type:6},error:{isPrefixingDisabled:!0,type:1},extraData:4,extraMetrics:{isPrefixingDisabled:!0,type:4}});Object.defineProperty(t,"__esModule",{value:!0});t.default=t.Qos});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define("@ms/odsp-utilities/lib/logging/PairedEventBase",["require","exports","./EventBase","./Manager","./events/ResultTypeEnum","./ErrorHelper","../async/Async","../object/ObjectUtil"],function(e,t,n,i,o,r,a,s){"use strict";function l(e,t,n){var i={resultType:e};t&&(i.resultCode=t);n&&(i.error=n);return i}t.createPairedEvent=function(e,t,i){var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}__extends(t,e);return t}(u);n.addEventProps(o.prototype,e,t,i);return o};var u=function(e){function t(t,i){return e.call(this,t,n.ClonedEventType.Start,i)||this}__extends(t,e);t.instrumentPromise=function(e,t,n,i,r,a,u){var c,d=new this(e,u);r&&d.setTimeout(r,a);try{c=t()}catch(e){d.end(l(o.ResultTypeEnum.Failure,"PromiseCreationFailed",e.toString()));throw e}c.then(function(e){var t;if(n)try{t=n(e)}catch(e){t=l(o.ResultTypeEnum.Failure,"GetSchemaException",e.toString())}else t=l(o.ResultTypeEnum.Success);d.end(t)},function(e){var t;if(i)try{t=i(e)}catch(e){t=l(o.ResultTypeEnum.Failure,"GetSchemaException",e.toString())}else if(e){var n=e instanceof Error&&"Canceled"===e.name?o.ResultTypeEnum.ExpectedFailure:o.ResultTypeEnum.Failure;t=l(n,null,s.safeSerialize(e))}else t=l(o.ResultTypeEnum.Failure);d.end(t)});return c};t.prototype.setTimeout=function(e,t){this.async||(this.async=new a.default(this));this._clearTimeout();t||(t=l(o.ResultTypeEnum.Failure,"Timeout"));this.async.setTimeout(this.end.bind(this,t),e)};t.prototype.verbose=function(e){if(!this.endTime&&this._isQosEvent()){var t=this.data;r.default.verbose(e,t.name)}};t.prototype.end=function(e){if(!this.endTime){e&&this._setData(e);this.endTime=i.Manager.getTime();this._logEvent(n.ClonedEventType.End);if(this._isQosEvent()){var t=this.data;t.error&&r.default.log(t.error,t.name,t.resultCode,t.resultType)}this._clearTimeout()}};t.prototype._clearTimeout=function(){if(this.async&&this.timeoutId){this.async.clearTimeout(this.timeoutId);this.timeoutId=null}};t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0};return t}(n.EventBase)});define("odsp-next/providers/theming/FabricConfig",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fabricConfig=window.FabricConfig=window.FabricConfig||{};t.fabricConfig.fontBaseUrl=""});define("odsp-next/controls/overlays/host/OverlayHost.html",[],function(){return"\x3c!--ko focusTrap: {\r\n invert: true,\r\n isEnabled: hasOverlays\r\n}--\x3e<div class=od-OverlayHost data-bind=\"clientRect: { size: clientRect, includePosition: true }, component: { name: 'od-transclusion-host', params: { provider: overlayProvider, useCustomTemplate: true } }\">\x3c!--ko template: {\r\n foreach: getOverlaysInDomOrder.call($component, $host.contexts()),\r\n if: isReady,\r\n afterAdd: $component.onAddOverlayElement.bind($component),\r\n beforeRemove: $component.onRemoveOverlayElement.bind($component)\r\n }--\x3e<div class=od-OverlayHost-overlay data-bind=\"css: { 'od-OverlayHost-overlay--positioned': $component.isPositioned(options), 'od-OverlayHost-overlay--initial': $component.isInitial.peek(), 'od-OverlayHost-overlay--opened': options.animation && options.animation.isOpen && options.animation.isOpen(), 'od-OverlayHost-overlay--closed': options.animation && options.animation.isOpen && !options.animation.isOpen() }, style: $component.getOverlayStyle(options, parentElement)\">\x3c!--ko focusTrap: {\r\n before: options.topTab,\r\n after: options.bottomTab\r\n }--\x3e<div class=od-OverlayHost-content data-bind=\"transclusionHost: $data\"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e"});define("odsp-next/controls/transclusion/host/TransclusionHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TransclusionHostViewModel","./templates/TransclusionHostTemplates","./TransclusionHost.html","./templates/TransclusionHostDefault.html","./templates/TransclusionHostCustom.html"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n.registerComponent({tagName:"od-transclusion-host",template:e("./TransclusionHost.html"),viewModel:i.default,synchronous:!0});n.registerTemplate(o.DEFAULT,e("./templates/TransclusionHostDefault.html"));n.registerTemplate(o.CUSTOM,e("./templates/TransclusionHostCustom.html"));t.default=r});define("odsp-next/controls/transclusion/host/TransclusionHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/transclusion/host/TransclusionHostBinding","./templates/TransclusionHostTemplates","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({host:o,transclusionHost:r.default});n._provider=t.provider;n._renderCount=t.renderCount;n.contexts=n._provider.contexts;n.currentContext=n.createPureComputed(n._computeCurrentContext);n.currentContext.equalityComparer=s.objectStrictEquality;var i;i=t.useCustomTemplate?a.CUSTOM:a.DEFAULT;n.templateName=i;n._renderCount&&n.createComputed(n._computeSetRenderCount);return n}n.__extends(t,e);t.prototype._computeCurrentContext=function(){return this.contexts()[this.contexts().length-1]||null};t.prototype._computeSetRenderCount=function(){this._renderCount(this.contexts().length)};return t}(i.default);t.default=l});define("odsp-next/bindings/host/HostBinding",["require","exports","tslib","../BaseBinding","../component/ComponentContextBinding","knockout"],function(e,t,n,i,o,r){"use strict";function a(e){return"object"==typeof e}var s=function(e){function t(t){var n=e.call(this,t)||this;n._componentContextBinding=new(n.managed(o.default))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var i=n._componentParentContent,s=n.valueAccessor(),l=a(s)?s:{},u=l.data,c=void 0===u?n.bindingContext.$data:u,d=l.afterRender;r.applyBindingsToNode(n.element,{template:{nodes:i.templateNodes,afterRender:d}},i.bindingContext.extend({$host:c,$hostContext:n.bindingContext}));n.controlsDescendantBindings=!0;return n}n.__extends(t,e);t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e};return t}(i);s.supportsVirtualElements=!0;return s});define("odsp-next/bindings/component/ComponentContextBinding",["require","exports","tslib","../BaseBinding","knockout"],function(e,t,n,i,o){"use strict";function r(e){return"function"==typeof e}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor(),a=n._getComponentBindingContext(),s=a.$parentContext;if(r(i))i({bindingContext:s,templateNodes:n.bindingContext.$componentTemplateNodes});else{o.applyBindingsToDescendants(n.bindingContext.extend({$componentParentContext:a}),n.element);n.controlsDescendantBindings=!0}return n}n.__extends(t,e);t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t};return t}(i);a.supportsVirtualElements=!0;t.default=a});define("odsp-next/controls/transclusion/host/templates/TransclusionHostTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT="od-transclusion-host-default";t.CUSTOM="od-transclusion-host-custom"});define("@ms/odsp-shared/lib/utilities/object/EqualityComparers",["require","exports"],function(e,t){"use strict";t.objectStrictEquality=function(e,t){return e===t};t.objectShallowEquality=function(e,t){if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;for(var n in e)if(e[n]!==t[n])return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0};t.arrayStrictEquality=function(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}});define("odsp-next/controls/transclusion/host/TransclusionHost.html",[],function(){return"\x3c!--ko template: templateName--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/transclusion/host/templates/TransclusionHostDefault.html",[],function(){return"\x3c!--ko with: currentContext--\x3e\x3c!--ko transclusionHost: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/transclusion/host/templates/TransclusionHostCustom.html",[],function(){return"\x3c!--ko host: {\r\n data: {\r\n contexts: contexts\r\n }\r\n}--\x3e\x3c!--/ko--\x3e"});define("odsp-next/controls/dialogHost/DialogHost",["require","exports","./DialogHostViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DialogHost.html","./DialogHost.css","../overlays/Overlay"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-dialog-host",template:e("./DialogHost.html"),viewModel:n,synchronous:!0});t.default=o});define("odsp-next/controls/dialogHost/DialogHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../overlays/dialog/DialogOverlay","../../providers/dialog/DialogProvider","../standardDialog/StandardDialog"],function(e,t,n,i,o,r,a){"use strict";return function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.dialog=n.resources.consume(r.resourceKey).currentDialog;n.dialogOverlayTagName=o.default.tagName;n.standardDialogTagName=a.default.tagName;n.isStandard=n.createPureComputed(n._computeIsStandard);n.hasDialog=n.createPureComputed(n._computeHasDialog);return n}n.__extends(t,e);t.prototype._computeIsStandard=function(){var e=this.dialog();return e&&1===e.template};t.prototype._computeHasDialog=function(){return!!this.dialog()};return t}(i.default)});define("odsp-next/controls/overlays/dialog/DialogOverlay",["require","exports","./DialogOverlayViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DialogOverlay.html","./DialogOverlay.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-dialog-overlay",template:e("./DialogOverlay.html"),viewModel:n.default,synchronous:!0});t.default=o});define("odsp-next/controls/overlays/dialog/DialogOverlayViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-shared/lib/base/ViewModel","../../../models/dialog/DialogStyle","../Overlay","../../../bindings/host/HostBinding","../../../bindings/dismiss/DismissBinding","../../../utilities/browser/ResponsiveUI","../../../bindings/focus/FocusTrapBinding","../../../bindings/element/ElementBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/focus/PreserveFocusBinding","@ms/odsp-shared/lib/bindings/automation/AutomationBinding","../../../bindings/interactionScope/InteractionScopeBinding"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:d.default,automation:v,element:f,focusTrap:m.default,interactionScope:b.default,preserveFocus:g.default,recoverFocus:h.default,host:c});n.dialog=t.dialog;n.overlayComponent=n.createPureComputed(n._computeOverlayComponent);n.contentRoot=i.observable();n._launchPoint=new o.default(-1,-1);n.isVisible=i.observable(!1);n.title=n.createObservable(n.dialog().title());n.dialogStyle=n.createComputed(n._computeDialogStyle);n.sizeClass=n.createComputed(n._computeSizeClass);n.styleClass=n.createComputed(n._computeStyleClass);return n}n.__extends(t,e);t.prototype.dismiss=function(){var e=this.dialog();if(e&&e.isDismissable){e.dismiss();return!1}return!0};t.prototype._computeOverlayComponent=function(){var e=this.dialog();return{name:u.tagName,params:{animation:{beforeRemove:500},alignToParent:e.isCallout}}};t.prototype._computeDialogStyle=function(){var e=this.dialog(),t={};if(e){if(this.unwrapObservable(e.calloutHeight)&&e.isCallout){this.ensureLaunchPointCalculated();t.left=this._launchPoint.x+"px";t.top=this._launchPoint.y+"px"}}else{t.left="-1000px";t.top="-1000px"}e.isCallout&&!this.unwrapObservable(e.calloutHeight)||this.isVisible(!0);return t};t.prototype.ensureLaunchPointCalculated=function(){var e=this.dialog.peek().invokerEvent;if(Boolean(e)&&Boolean(this.contentRoot())){var t=this.contentRoot().getBoundingClientRect(),n=e.clientX,i=e.clientY;if(n<=0&&i<=0||!Boolean(n)&&!Boolean(i)){var o=e.target.getBoundingClientRect();n=o.left;i=o.bottom}var s=r.default.isRightToLeft?n-t.width:n,l=i,u=new a.default(s,l,t.width,t.height),c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,p=new a.default(0,0,c,d),m=u.nudge(p);this._launchPoint.x=m.getLeft();this._launchPoint.y=m.getTop()}};t.prototype._computeSizeClass=function(){return p.default.determineCssClass(this.dialog().size)};t.prototype._computeStyleClass=function(){return l.default[this.dialog().style]};return t}(s.default);t.default=y});define("odsp-next/models/dialog/DialogStyle",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.normal=0]="normal";e[e.blocker=1]="blocker"}(n||(n={}));t.default=n});define("odsp-next/controls/overlays/Overlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OverlayViewModel","./Overlay.html","./Overlay.css","../transclusion/content/TransclusionContent"],function(e,t,n,i){"use strict";return n.registerComponent({tagName:"od-overlay",template:e("./Overlay.html"),viewModel:i,synchronous:!0})});define("odsp-next/controls/overlays/OverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ProviderResourceKeys","../../bindings/element/ElementBinding","../../bindings/host/HostBinding","../../models/overlay/Overlay"],function(e,t,n,i,o,r,a,s){"use strict";return function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,i=t.animation,l=t.alignToParent,u=void 0!==l&&l,c=t.parentElement;n.addBindingHandlers({host:a,element:r});n.overlayProvider=n.resources.consume(o.overlay);n.topTab=n.createObservable(null);n.bottomTab=n.createObservable(null);n.isOpen=n.createObservable(!1);n.overlay=new s({alignToParent:n.wrapObservable(u),parentElement:c,animation:i,topTab:n.topTab,bottomTab:n.bottomTab,isOpen:n.isOpen});return n}n.__extends(t,e);return t}(i.default)});define("odsp-next/bindings/element/ElementBinding",["require","exports"],function(e,t){"use strict";return function(){function e(){}e.init=function(e,t,n,i,o){t()(e)};return e}()});define("odsp-next/models/overlay/Overlay",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","knockout"],function(e,t,n,i,o){"use strict";return function(e){function t(t){var n=e.call(this,t)||this,i=t.topTab,r=t.bottomTab,a=t.animation,s=void 0===a?{}:a,l=t.alignToParent,u=void 0===l?o.observable(!0):l,c=t.parentElement,d=t.isOpen;n.topTab=i;n.bottomTab=r;n.animation=s;n.alignToParent=u;n.parentElement=c;n.isOpen=d;return n}n.__extends(t,e);return t}(i.default)});define("odsp-next/controls/overlays/Overlay.html",[],function(){return'<a href=javascript:; class=ms-accessible tabindex=-1 aria-hidden=true data-bind="element: topTab"></a> <a href=javascript:; class=ms-accessible tabindex=-1 aria-hidden=true data-bind="element: bottomTab"></a><div class="od-Overlay ms-accessible" data-bind="component: { name: \'od-transclusion-content\', params: { provider: overlayProvider, parentElement: $element.parentElement, options: overlay } }">\x3c!--ko host: {}--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/overlays/Overlay.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Overlay{height:0;width:0;overflow:hidden}"}])});define("odsp-next/controls/transclusion/content/TransclusionContent",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TransclusionContentViewModel","./TransclusionContent.html"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.registerComponent({tagName:"od-transclusion-content",template:e("./TransclusionContent.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/transclusion/content/TransclusionContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/transclusion/content/TransclusionContentBinding","knockout"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({transclusionContent:o.default});n._provider=t.provider;n.bindingParams={context:r.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options};n.createComputed(function(){var e=n.bindingParams.context();if(n._transclusion){n._transclusion.dispose();n._transclusion=null}e&&(n._transclusion=n.addDisposable(n._provider.transclude(e)))});return n}n.__extends(t,e);return t}(i.default);t.default=a});define("odsp-next/bindings/transclusion/content/TransclusionContentBinding",["require","exports","tslib","../../BaseBinding","../../../models/transclusion/TransclusionContext","../../component/ComponentContextBinding"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;n._componentContextBinding=new(n.managed(r.default))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});n.controlsDescendantBindings=!0;return n}n.__extends(t,e);t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),n=new o.default({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(n)};return t}(i);a.supportsVirtualElements=!0;t.default=a});define("odsp-next/models/transclusion/TransclusionContext",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e){this.templateNodes=e.templateNodes;this.bindingContext=e.bindingContext;this.renderCount=e.renderCount||n.observable(0);this.parentElement=e.parentElement||null;this.options=e.options||null}}();t.default=i});define("odsp-next/controls/transclusion/content/TransclusionContent.html",[],function(){return"\x3c!--ko transclusionContent: bindingParams--\x3e\x3c!--/ko--\x3e"});define("odsp-next/bindings/dismiss/DismissBinding",["require","exports","tslib","../BaseBinding","@uifabric/utilities/lib/dom","../keyboard/KeyboardBinding"],function(e,t,n,i,o,r){"use strict";function a(e){return"object"==typeof e}function s(e,t){try{for(var n=t.target;n!==e&&o.getParent(n);)n=o.getParent(n);return n===e}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0});var l=1e3,u=function(e){function t(t){var n,i=e.call(this,t)||this,o=t.valueAccessor(),s=(n=a(o)?o:{close:o}).timeout,u=void 0===s?l:s,c=n.close,d=n.isAutomatic,p=void 0!==d&&d,m=n.isOpen,f=n.dismissOnResize,h=void 0!==f&&f,g=n.dismissOnScroll,v=void 0!==g&&g,b=n.useLocalEvents,y=void 0!==b&&b;i._options={timeout:u,close:c,isAutomatic:p,isOpen:m,dismissOnResize:h,dismissOnScroll:v,useLocalEvents:y};i._isActive=i.createObservable(!0);i._options.isAutomatic&&i.createBackgroundComputed(i._dismiss).extend({rateLimit:{timeout:i._options.timeout,method:"notifyWhenChangesStop"}});i._options.isOpen&&i.createBackgroundComputed(i._computeDeactivateIfOpen);i.events.on(document,"click, mousemove, touchmove, pointermove, MSPointerMove, keydown",i._onEvent,!0);i.events.on(document,"click",i._onClick,!0);i._keyboardBinding=new(i.managed(r))({element:i.element,bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor,valueAccessor:function(){return{mappings:{Esc:function(e,t){return i._onEscape(t)}},target:i._options.useLocalEvents?void 0:document,useCapture:!i._options.useLocalEvents,allowInputEvents:!0,allowButtonEvents:!0,context:i.bindingContext.$data}}});i._options.dismissOnResize&&i.events.on(window,"resize",i._onResizeOrScroll,!0);i._options.dismissOnScroll&&i.events.on(window,"scroll",i._onResizeOrScroll,!0);return i}n.__extends(t,e);t.prototype._dismiss=function(){var e=this._options,t=e.isOpen,n=e.close;if(this._isOpenAndNotActive()){t&&t(!1);if(n){var i=this.bindingContext.$data;if(!1===n.call(i,i))return!1}}return!0};t.prototype._isOpenAndNotActive=function(){var e=this._isActive(),t=this._options.isOpen;return(!t||t())&&!e};t.prototype._onClick=function(e){if(!s(this.element,e)){this._isActive(!1);this._dismiss()}return!0};t.prototype._onEscape=function(e){if(s(this.element,e)){this._isActive(!1);if(this._isOpenAndNotActive()){e.stopImmediatePropagation();e.stopPropagation();this._dismiss();return!1}}return!0};t.prototype._onEvent=function(e){s(this.element,e)?this._isActive(!0):this._isActive(!1);return!0};t.prototype._onResizeOrScroll=function(e){if(!s(this.element,e)){this._isActive(!1);this._dismiss()}return!0};t.prototype._computeDeactivateIfOpen=function(){this._options.isOpen()&&this._isActive(!1)};return t}(i);t.default=u});define("odsp-next/bindings/keyboard/KeyboardBinding",["require","exports","tslib","../BaseBinding","knockout","@ms/odsp-utilities/lib/events/EventGroup","../interactionScope/InteractionScopeBinding","@ms/odsp-utilities/lib/locale/Locale","../../utilities/events/EventTargetFilters"],function(e,t,n,i,o,r,a,s,l){"use strict";function u(e,t){var n=!!e.useRtlMappings&&s.default.isRightToLeft&&p[t]||t;return e.mappings[n]}function c(e){var t;t=d(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t}function d(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t}var p={Left:"Right",Right:"Left"},m={Esc:!0};return function(e){function t(n){var i=e.call(this,n)||this,r=i.valueAccessor();if(r instanceof Array){r;for(var s=0,l=r;s<l.length;s++){var u=l[s];new(i.managed(t))({element:i.element,valueAccessor:function(e){return function(){return e}}(u),bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor})}}else{if("object"!=typeof r)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var c=r.mappings&&r||{mappings:r},d=c.target||i.element,p=c.useCapture,m=void 0!==p&&p;i._options=c;i.events.on(d,"keydown",i._onKeyDown,m);i._isActive=o.observable(!1);i._interactionScopeBinding=new(i.managed(a.default))({element:i.element,bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor,valueAccessor:function(){return{isActive:i._isActive}}})}return i}n.__extends(t,e);t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,i=t.allowButtonEvents,o=t.context,a=void 0===o?this.bindingContext.$data:o,s=t.preventDefault,d=e.target,p=c(e),f=!i&&d!==this.element&&l.isButtonElement(d),h=!m[p]&&!n&&d!==this.element&&l.isInputElement(d),g=t.target===document&&!this._isActive.peek();if(f||h||g)return!0;var v=u(t,p);if(v){s&&e.preventDefault&&e.preventDefault();for(var b=void 0,y=0,x=b=v instanceof Array?v:[v];y<x.length;y++)if(!1===x[y].call(a,a,e)){r.default.stopPropagation(e);return!1}}return!0};return t}(i)});define("odsp-next/bindings/interactionScope/InteractionScopeBinding",["require","exports","tslib","../BaseBinding","../focus/ChildFocusBinding","knockout","@uifabric/utilities/lib/dom"],function(e,t,n,i,o,r,a){"use strict";function s(e){for(var n,i=e;!(n=r.utils.domData.get(i,t.INTERACTION_SCOPE_KEY))&&i!==document.body&&a.getParent(i);)i=a.getParent(i);return i!==document.body&&n||void 0}Object.defineProperty(t,"__esModule",{value:!0});t.INTERACTION_SCOPE_KEY="InteractionScopeBinding_scope";var l=function(e){function i(n,i){void 0===i&&(i={});var a=e.call(this,n)||this;a._parentScope=s(a.element);var l=a.valueAccessor(),u=l.isScope,c=void 0!==u&&u,d=l.isRoot,p=void 0!==d&&d;if(c){a._childScopes=r.observableArray();a._hasFocus=r.observable(!1);a._isRoot=p;a._isActive=a.createPureComputed(a._computeIsActive,{deferEvaluation:!0});a._isDescendantActive=a.createPureComputed(a._computeIsDescendantActive,{deferEvaluation:!0});a._scope={isActive:a._isActive,isDescendantActive:a._isDescendantActive,isDescendantOrSelfActive:a.createComputed(a._computeIsDescendantOrSelfActive),register:function(e){return a._registerScope(e)},_owner:a};r.utils.domData.set(a.element,t.INTERACTION_SCOPE_KEY,a._scope);var m=i.ChildFocusBinding,f=void 0===m?o.default:m;a._childFocusBinding=new(a.managed(f))({element:a.element,bindingContext:a.bindingContext,allBindingsAccessor:a.allBindingsAccessor,valueAccessor:function(){return a._hasFocus}});a._parentScope&&a.addDisposable(a._parentScope.register(a._scope))}else if(a._parentScope){a._isActive=a._parentScope.isActive;a._isDescendantActive=a._parentScope.isDescendantActive}else{a._isActive=r.observable(!0);a._isDescendantActive=r.observable(!1)}l.isActive&&a.createComputed(function(){return l.isActive(a._isActive())});l.isDescendantActive&&a.createComputed(function(){return l.isDescendantActive(a._isDescendantActive())});return a}n.__extends(i,e);i.prototype._registerScope=function(e){var t=this;this._childScopes.push(e);return{dispose:function(){t._childScopes.remove(e)}}};i.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t};i.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t};i.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++)n[t].isDescendantOrSelfActive()&&(e=!0);return e};return i}(i);t.default=l;t.getCurrentInteractionScope=s});define("odsp-next/bindings/focus/ChildFocusBinding",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../BaseBinding","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@uifabric/utilities/lib/dom"],function(e,t,n,i,o,r,a){"use strict";function s(){if(0===--d){u.dispose();u=void 0}}function l(e){return"object"==typeof e}Object.defineProperty(t,"__esModule",{value:!0});var u,c=function(e){function t(){var t=e.call(this)||this,n=t.observables;t._activeElement=n.create(document.activeElement);t._activeElement.equalityComparer=r.objectStrictEquality;t.activeElement=n.pureCompute(t._computeActiveElement);t.activeElement.equalityComparer=r.objectStrictEquality;t.events.onAll(document.body,{focus:t._onDocumentFocus,blur:t._onDocumentBlur},!0);return t}n.__extends(t,e);t.prototype._computeActiveElement=function(){this._activeElement(document.activeElement);return this._activeElement()};t.prototype._onDocumentFocus=function(e){var t=document.activeElement;this.async.clearTimeout(this._blurTimeout);window.__debugFocus&&console.log("[focus] active:",!!t&&(t.className||t));this._activeElement(t)};t.prototype._onDocumentBlur=function(e){var t=this,n=document.activeElement;this.async.clearTimeout(this._blurTimeout);if(n&&n!==document.body){window.__debugFocus&&console.log("[focus] blur:",n);this._activeElement(n)}else{window.__debugFocus&&console.log("[focus] wait:",n);this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] blur:",n);t._activeElement(n)},0)}};return t}(i.default),d=0,p=function(e){function t(t){var n,i,o,r=e.call(this,t)||this,a=t.valueAccessor();if(l(a)){n=a.isBodyActive;i=a.activeElement;o=a.isDescendantOrSelfActive}else o=a;d++;u||(u=new c);r.addDisposable({dispose:s});var p=r.observables;if(o){var m=p.pureCompute(r._computeIsDescendantOrSelfActive);p.compute(function(){o(m())})}if(n){var f=p.pureCompute(r._computeIsBodyActive);p.compute(function(){n(f())})}if(i){var h=p.pureCompute(r._computeActiveElement);p.compute(function(){i(h())})}return r}n.__extends(t,e);t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=u.activeElement();return!!t&&(e===t||a.elementContains(e,t))};t.prototype._computeIsBodyActive=function(){var e=u.activeElement();return!e||e===document.body};t.prototype._computeActiveElement=function(){return u.activeElement()};return t}(o);t.default=p});define("odsp-next/utilities/events/EventTargetFilters",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={INPUT:!0,TEXTAREA:!0},i={A:!0,BUTTON:!0};t.isInputElement=function(e){var t=e;return t&&(t.tagName in n||t.isContentEditable)};t.isButtonElement=function(e){var t=e;return t&&t.tagName in i}});define("odsp-next/utilities/browser/ResponsiveUI",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},a={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},s=function(e){function t(t,n){var i=e.call(this,t,n)||this;i._containerElement=t.containerElement||window;i._breakpoints=t.breakpoints||a;i.events.on(i._containerElement,"resize, orientationchange",i._onContainerResize);var o=i.observables;i.formFactorSize=o.create("Medium");i.windowWidth=o.create(0);i.windowHeight=o.create(0);i.isHamburgerVisible=o.create(!1);i.showLabels=o.pureCompute(i._computeShowLabels,{deferEvaluation:!0});i._onContainerResize();i.cssClass=o.pureCompute(i._computeCssClass);return i}n.__extends(t,e);t.determineWindowSize=function(e,t){void 0===t&&(t=a);for(var n in a)if(e<t[n])return n};t.determineCssClass=function(e){return r[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var i=document.createElement("div");i.style.width="100%";e.appendChild(i);var o=i.offsetWidth;e.parentNode.removeChild(e);var r=n-o;this.getScrollbarWidth=function(){return r};return r};t.prototype.compareSize=function(e,t){var n=this._breakpoints;return n[e]-n[t]};t.prototype._onContainerResize=function(e){var n=this._containerElement,i=document.body,o=document.documentElement,r=n.clientWidth||o.clientWidth||n.innerWidth||i.clientWidth,a=n.clientHeight||o.clientHeight||n.innerHeight||i.clientHeight,s=this._breakpoints,l=n===window?t.determineWindowSize(r,s):"Medium";this.isHamburgerVisible(r<s.Large);this.formFactorSize(l);this.windowWidth(r);this.windowHeight(a)};t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())};t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0};return t}(i.default);s.DEFAULT_BREAKPOINTS=a;s.MAC_SCROLL_BAR_WIDTH=8;t.default=s;t.resourceKey=o.createDefaultResourceKey(e,s)});define("odsp-next/bindings/focus/RecoverFocusBinding",["require","exports","tslib","../BaseBinding","./ChildFocusBinding","../scrollContainer/ScrollContainerBinding","knockout"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n){void 0===n&&(n={});var i=e.call(this,t,n)||this;i._hasFocus=i.createObservable(!1);i._hasChildFocus=i.createObservable(!1);i._isBodyActive=i.createObservable(!1);i._value=i.createPureComputed(i._computeValue);i._isEnabled=i.createPureComputed(i._computeIsEnabled);i._onlyRecoverFromBody=i.createPureComputed(i._computeOnlyRecoverFromBody);var r=n.ChildFocusBinding,s=void 0===r?o.default:r,l=n.applyBindingsToNode,u=void 0===l?a.applyBindingsToNode:l,c=n.recoverFocusExtenders,d=void 0===c?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:c;i._childFocusBinding=new(i.managed(s))({element:i.element,bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:i._hasChildFocus,isBodyActive:i._isBodyActive}}});u(i.element,{hasFocus:i._hasFocus},i.bindingContext);i.createBackgroundComputed(i._computeRecoverFocus).extend(d);return i}n.__extends(t,e);t.prototype._computeValue=function(){return this.valueAccessor()||{}};t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)};t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)};t.prototype._computeRecoverFocus=function(){if(this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())){var e=r.getScrollContainer(this.element),t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0);e.scrollTop!==t&&(e.scrollTop=t);e.scrollLeft!==n&&(e.scrollLeft=n)}};return t}(i);t.default=s});define("odsp-next/bindings/scrollContainer/ScrollContainerBinding",["require","exports","tslib","../BaseBinding","knockout"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SCROLL_CONTAINER_KEY="ScrollContainerBinding_scrollContainer";var r=function(e){function i(n){var i=e.call(this,n)||this;if(!1!==n.valueAccessor()){o.utils.domData.set(i.element,t.SCROLL_CONTAINER_KEY,!0);i.element.setAttribute("data-is-scrollable","true")}return i}n.__extends(i,e);return i}(i);t.default=r;t.getScrollContainer=function(e){for(var n=e;n!==document.body&&!o.utils.domData.get(n,t.SCROLL_CONTAINER_KEY)&&(n.parentElement||n.parentNode);)n=n.parentElement||n.parentNode;return(n===document.body||o.utils.domData.get(n,t.SCROLL_CONTAINER_KEY))&&n||e.parentElement||n.parentNode}});define("odsp-next/bindings/focus/PreserveFocusBinding",["require","exports","tslib","../../utilities/accessibility/Accessibility","../BaseBinding","@uifabric/utilities/lib/dom"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor(),o=n.wrapObservable(void 0===i||i);n._shouldRestoreFocus=o;var a=null;try{a=document.activeElement}catch(e){}n._activeElement=a;n._preserveActiveElementAncestors=[];for(;a&&a!==document.body;){n._preserveActiveElementAncestors.push(a);a=r.getParent(a)}return n}n.__extends(t,e);t.prototype.dispose=function(){if(this._shouldRestoreFocus.peek()){var t=null;try{t=document.activeElement}catch(e){}if(!t||t===document.body||this._isAncestorOrSelf(t,this.element))for(var n=0,o=this._preserveActiveElementAncestors;n<o.length;n++){var r=o[n];if(r&&r.focus&&(i.isTabStop(r,!0)||r===this._activeElement)&&document.body.contains(r)){r.focus();break}}}this._preserveActiveElementAncestors=[];delete this._activeElement;e.prototype.dispose.call(this)};t.prototype._isAncestorOrSelf=function(e,t){for(;e;){if(e===t)return!0;e=r.getParent(e)}return!1};return t}(o);t.default=a});define("odsp-next/controls/overlays/dialog/DialogOverlay.html",[],function(){return"<div class=od-DialogOverlay data-bind=\"css: { 'is-active': dialog }\">\x3c!--ko with: dialog--\x3e\x3c!--ko component: $component.overlayComponent--\x3e<div class=od-Dialog data-bind=\"css: { 'od-Dialog--close': isDismissable }, focusTrap: {}\"><div class=ms-ModalOverlay data-bind=\"visible: !isCallout\"></div><div class=od-Dialog-main tabindex=-1 role=dialog data-bind=\"interactionScope: { isScope: true }, preserveFocus: shouldPreserveFocus, recoverFocus: { isEnabled: $host.isOpen }, dismiss: { close: isDismissable && $component.dismiss.bind($component), dismissOnScroll: isDismissableOnScroll, dismissOnResize: isDismissableOnResize }, class: 'od-Dialog-main--' + $component.sizeClass() + ' ' + 'od-Dialog-main-style--' + $component.styleClass(), css: { 'od-Dialog-main--allowPanel': !stayAsPopup, 'od-Dialog-main--callout': isCallout, 'od-Dialog-main--dialog': !isCallout, 'od-Dialog-main--visible': $component.isVisible() }, automation: automationId, style: $component.dialogStyle, attr: { 'aria-labelledby': 'od-Dialog-title', 'aria-describedby': 'od-Dialog-content' }, element: $parent.contentRoot\"><div class=od-Dialog-content data-bind=\"host: {}\"></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/overlays/dialog/DialogOverlay.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-DialogOverlay{display:none}.od-Dialog{background-color:transparent;position:absolute;top:50px;bottom:0;width:100%;display:block;font-size:0;line-height:100vh;text-align:center;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .od-Dialog{left:0}[dir=rtl] .od-Dialog{right:0}.od-Dialog::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.sm .od-Dialog{-ms-flex-align:start;align-items:flex-start;box-sizing:border-box;padding:0}.od-Dialog-main{vertical-align:middle;display:inline-block;box-shadow:0 0 16px 0 '},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;line-height:normal;width:100%;min-height:100px;outline:0;visibility:hidden}html[dir=ltr] .od-Dialog-main{text-align:left}html[dir=rtl] .od-Dialog-main{text-align:right}@media screen and (-ms-high-contrast:active){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.od-Dialog-main:focus{outline:0}.od-Dialog-main--dialog{margin:auto;position:relative}.od-Dialog-main--callout{position:absolute}.od-Dialog-main--visible{visibility:visible}.od-Dialog-main--sm{width:320px}.od-Dialog-main--sm.od-Dialog-main-style--blocker{width:340px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel{top:0;width:auto;position:absolute;bottom:0;left:0;right:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary{border:none}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled:before,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled:before{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label{display:inline-block;vertical-align:top;margin-top:6px;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog-main--md{max-width:480px}.od-Dialog-main--lg{max-width:640px}.od-Dialog-main--xlg{max-width:1024px}.od-Dialog-main--xxlg{max-width:1366px}.od-Dialog-main--xxxlg{max-width:1920px}.od-Dialog-button.od-Dialog-button--close{display:none}.sm .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{display:block;position:absolute;margin:0;padding:0;border:0;background:0 0;cursor:pointer;top:12px;padding:4px}[dir=ltr] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{right:12px}[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{left:12px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-size:16px}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px;line-height:20px}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:20px}.od-Dialog-subText{margin:0 0 20px 0;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-Dialog-subText.od-Dialog-subText--s{font-size:12px}.od-Dialog-subText.od-Dialog-subText--m{font-size:14px}.od-Dialog-subText.od-Dialog-subText--l{font-size:17px}.od-Dialog-content{position:relative;width:100%}.od-Dialog-content .od-Button.od-Button--compound:not(:last-child){margin-bottom:20px}.ms-ModalOverlay{display:block;position:absolute;cursor:pointer;left:0;right:0;top:0;bottom:0;background-color:"},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-ModalOverlay{display:none}}.od-Dialog--multiline{width:95%}[dir=ltr] .od-Dialog-button--close{right:14px}[dir=rtl] .od-Dialog-button--close{left:14px}[dir=ltr] .od-Dialog-button--close{left:auto}[dir=rtl] .od-Dialog-button--close{right:auto}.od-Dialog-content{font-size:12px}.od-OverlayHost-overlay .ms-ModalOverlay{animation-duration:167ms;animation-name:ms-fadeIn;animation-fill-mode:both}.od-OverlayHost-overlay .od-Dialog-main{animation-name:ms-fadeIn,ms-slideDownIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation-duration:167ms;animation-name:ms-fadeOut;animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation-name:ms-fadeOut,ms-slideUpOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog{visibility:hidden;transition:visibility 0s linear 267ms}"}])});define("odsp-next/providers/dialog/DialogProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../models/dialog/Dialog"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t,n){var i=e.call(this,t,n)||this;i._dialogs=[];i.currentDialog=i.observables.create();return i}n.__extends(t,e);t.prototype.requestDialog=function(e){var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,i=new r(e);t.unshift(i);n(i);var o=function(){var e=t.indexOf(i);if(e>=0){t.splice(e,1);n(t[0])}i.dispose()};i.wait().then(o,o);return i};return t}(i.default);t.default=a;t.resourceKey=o.createDefaultResourceKey(e,a)});define("odsp-next/models/dialog/Dialog",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/BaseModel","./DialogStyle"],function(e,t,n,i,o,r,a,s){"use strict";var l=function(){return function(){this.icon=null;this.isAvailable=i.observable(!0);this.isVisible=i.observable(!0);this.isDefault=!1;this.automationId="";this.instrumentationId="";this.isExecuting=i.observable(!1);this.isLink=!1;this.execute=function(){return o.default.wrap(1)}}}();return function(e){function t(t){var n=e.call(this,t)||this;n.state=i.observable(1);var o=t.title,a=t.titleAction,u=void 0===a?null:a,c=t.actions,d=void 0===c?[]:c,p=t.component,m=void 0===p?null:p,f=t.isDismissable,h=void 0===f||f,g=t.isDismissableOnResize,v=void 0!==g&&g,b=t.isDismissableOnScroll,y=void 0!==b&&b,x=t.size,_=void 0===x?"Small":x,w=t.automationId,I=t.executeDefaultAction,C=void 0===I||I,k=t.isCallout,S=t.invokerEvent,T=t.calloutHeight,P=t.instrumentationId,E=void 0===P?"":P,A=t.shouldPreserveFocus,L=void 0===A||A,B=t.stayAsPopup,O=void 0!==B&&B,D=t.template,M=void 0===D?1:D,R=t.style,N=void 0===R?s.default.normal:R;n.title=i.isObservable(o)?o:i.observable(o);n.titleAction=u;n.actions=d;n.component=m;n.isDismissable=h;n.isDismissableOnResize=v;n.isDismissableOnScroll=y;n.size=_;n.automationId=w||"";n.executeDefaultAction=C;n.isCallout=!!k&&!!S;n.invokerEvent=S;n.calloutHeight=T;n.instrumentationId=E;n.shouldPreserveFocus=i.isObservable(L)?L:i.observable(L);n.stayAsPopup=O;n.template=M;n.style=N;n.actions=n.actions.map(function(e){return i.utils.extend(new l,e)});n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,i=n.actions;t<i.length;t++)i[t].isVisible()&&(e=!0);return e},{disposeWhen:function(){return 1!==n.state()}});var F=new r.default;n.createComputed(function(){var e=n.state();1!==e&&(2===e?F.complete():F.cancel())});n._promise=F.getPromise();return n}n.__extends(t,e);t.prototype.complete=function(){this.state(2)};t.prototype.dismiss=function(){this.state(3)};t.prototype.wait=function(){return this._promise};return t}(a.default)});define("odsp-next/controls/standardDialog/StandardDialog",["require","exports","./StandardDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./StandardDialog.html","./StandardDialog.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-standard-dialog",template:e("./StandardDialog.html"),viewModel:n.default});t.default=o});define("odsp-next/controls/standardDialog/StandardDialogViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding","../../bindings/keyboard/KeyboardBinding","../../providers/dialog/DialogProvider","@ms/odsp-shared/lib/bindings/automation/AutomationBinding","./events/DialogAction.event","../overlays/dialog/DialogOverlay.resx"],function(e,t,n,i,o,r,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({keyboard:a,automation:l,host:r});n.closeLabel=c.strings.closeLabel;n.dialog=n.resources.consume(s.resourceKey).currentDialog;return n}n.__extends(t,e);t.prototype.dismiss=function(){var e=this.dialog();if(e&&e.isDismissable){e.dismiss();return!1}return!0};t.prototype.executeDefaultAction=function(){var e=this.dialog();if(e&&e.executeDefaultAction){var t=i.utils.arrayFirst(e.actions,function(e){return e.isDefault});if(t){this._logEvent(t);return this.execute(t)}}return!0};t.prototype.execute=function(e){var t=this.dialog();if(t&&e.isAvailable()){e.isExecuting(!0);this._logEvent(e);e.execute().done(function(n){e.isExecuting(!1);t.state(n)});return!1}return!0};t.prototype._logEvent=function(e){var t=this.dialog.peek();e.instrumentationId&&t.instrumentationId&&u.default.logData({actionName:e.instrumentationId,dialogName:t.instrumentationId})};return t}(o.default);t.default=d});define("odsp-next/controls/standardDialog/events/DialogAction.event",["require","exports","@ms/odsp-utilities/lib/logging/SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DialogAction=n.createSingleEvent({eventName:"DialogAction,",shortEventName:"DialogAction"},{dialogName:1,actionName:1});t.default=t.DialogAction});define("odsp-next/controls/standardDialog/StandardDialog.html",[],function(){return'\x3c!--ko with: dialog--\x3e<div class=od-StandardDialog data-bind="keyboard: { allowInputEvents: true, allowButtonEvents: false, mappings: { Enter: $component.executeDefaultAction.bind($component) } }"><div class="od-Dialog-header od-Dialog-header--s"><p class=od-Dialog-title id=od-Dialog-title data-bind="attr: { \'aria-label\': title, title: title }">\x3c!--ko if: titleAction && titleAction.isVisible()--\x3e<button class="od-Dialog-button od-Dialog-button--back" data-bind="attr: {\'aria-label\': titleAction.name, title: titleAction.name}, click: titleAction.execute">\x3c!--ko if: titleAction.icon--\x3e<span data-bind="component: { name: \'od-icon-glyph\', params: { icon: titleAction.icon } }"></span>\x3c!--/ko--\x3e</button>\x3c!--/ko--\x3e\x3c!--ko text: title--\x3e\x3c!--/ko--\x3e</p></div><div class=od-Dialog-inner><div class=od-Dialog-content id=od-Dialog-content data-bind="host: {}"></div>\x3c!--ko if: actions.length && actionsVisible--\x3e<div class=od-Dialog-actions data-bind="automation: \'actionsSection\'"><div class=od-Dialog-actionsRight data-bind="foreach: actions">\x3c!--ko if: isVisible--\x3e<button class=od-Dialog-action data-bind="css: { \'od-Button--primary\': isDefault, \'od-Button\': !isLink, \'od-Dialog-action--link\': isLink }, click: $component.execute.bind($component), enable: isAvailable, automation: automationId">\x3c!--ko if: icon--\x3e<span class=od-Button-icon data-bind="component: { name: \'od-icon-glyph\', params: { icon: icon } }"></span>\x3c!--/ko--\x3e<span class=od-Button-label data-bind="text: name"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: isVisible() && isExecuting()--\x3e<div class=od-Dialog-actionsLoading data-bind="component: { name: \'ms-loadingSpinner\', params: { loadingText: \'\' } }"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr: {\'aria-label\': $component.closeLabel, title: $component.closeLabel}, click: isDismissable && $component.dismiss.bind($component)"><i class="ms-Icon ms-Icon--Cancel"></i></button></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/standardDialog/StandardDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.ms-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";text-decoration:none;cursor:pointer;outline:0}.ms-Link:focus,.ms-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.ms-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-Dialog-actionsLoading{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-Dialog-actionsLoading{padding-right:5px}[dir=rtl] .od-Dialog-actionsLoading{padding-left:5px}.od-Dialog-main--callout .od-Dialog-inner{padding:0}.od-Dialog-main--callout .od-Dialog-header{padding:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{position:absolute;top:0;left:0;right:0;margin-top:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:0 10px 0 0;height:44px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{padding:0 0 0 10px}html[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:left}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:right}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save{font-size:20px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{background:0 0;height:44px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon{display:inline-block;margin-top:5px;margin-right:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label{font-weight:400;font-size:14px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action:hover,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-inner,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-inner{padding:16px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 10px 5px 0;background:0 0;border:0;cursor:pointer}html[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 0 5px 10px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back .ms-Icon.ms-Icon--Back{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-size:16px}.ms-Dialog-button--close{position:absolute;right:8px;top:12px;background:0 0;border:none;cursor:pointer}.ms-Dialog-button--close .ms-Icon{font-size:16px}.od-Dialog-header{position:relative;width:100%;box-sizing:border-box;padding:24px 32px 0;word-wrap:break-word}.od-Dialog-header .od-Dialog-title{margin:0;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:inline}.od-Dialog-header.od-Dialog-header--large{padding:30px 20px;margin-bottom:10px;background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:'}.od-Dialog-header.od-Dialog-header--large .od-Dialog-title{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:28px;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Dialog-inner{height:100%;padding:16px 32px 20px}.od-Dialog-actions{position:relative;width:100%;height:32px;margin-top:24px}.od-Dialog-actions::after,.od-Dialog-actions::before{display:table;content:'';line-height:0}.od-Dialog-actions::after{clear:both}.od-Dialog-action .od-Button-icon{display:none}.od-Dialog-action.od-Dialog-action--link{border:0;cursor:pointer;box-sizing:border-box;box-shadow:none;margin:0;padding:0;color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";text-decoration:none;cursor:pointer;outline:0;padding:0 0 0 4px;background:0 0}.od-Dialog-action.od-Dialog-action--link:focus,.od-Dialog-action.od-Dialog-action--link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}html[dir=rtl] .od-Dialog-action.od-Dialog-action--link{padding:0 4px 0 0}.od-Dialog-action.od-Dialog-action--link .od-Button-label{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:hover .od-Button-label{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.sm .od-Dialog-action .od-Button-label{font-size:12px}html[dir=ltr] .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:5px}[dir=rtl] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:5px}html[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:15px}[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:15px}"}])});define("odsp-next/controls/dialogHost/DialogHost.html",[],function(){return"<div class=od-DialogHost>\x3c!--ko with: dialog--\x3e\x3c!--ko component: { \r\n name: $component.dialogOverlayTagName,\r\n params: { dialog: $component.dialog }\r\n }--\x3e\x3c!--ko if: $component.isStandard--\x3e\x3c!--ko component: {\r\n name: $component.standardDialogTagName,\r\n params: {}\r\n }--\x3e\x3c!--ko with: component--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: $component.isStandard--\x3e\x3c!--ko with: component--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/dialogHost/DialogHost.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DialogHost{display:none}"}])});define("odsp-next/controls/panelHost/PanelHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PanelHostViewModel","./PanelHost.html","./PanelHost.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.registerComponent({tagName:"ms-panel-host",template:e("./PanelHost.html"),viewModel:i,synchronous:!0});t.default=o});define("odsp-next/controls/panelHost/PanelHostViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../models/panel/IPanelOptions","../../providers/panel/PanelProvider","../../bindings/dismiss/DismissBinding","../../utilities/browser/ResponsiveUI","../../bindings/element/ElementBinding","../../bindings/focus/FocusTrapBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/focus/RecoverFocusBinding","../../bindings/clientRect/ClientRectBinding","../../bindings/scrollContainer/ScrollContainerBinding","./PanelHost.resx","../../bindings/interactionScope/InteractionScopeBinding","../overlays/Overlay"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b){"use strict";return function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.closePanelLabel=g.strings.closePanelLabel;n.overlayTagName=b.tagName;n.addBindingHandlers({scrollContainer:h.default,dismiss:s.default,element:u,focusTrap:c.default,keyboard:d,interactionScope:v.default,preserveFocus:p.default,recoverFocus:m.default,clientRect:f.default});n.contentRoot=i.observable();n._panelProvider=n.resources.consume(a.resourceKey);n.panels=n._panelProvider.currentPanels;return n}n.__extends(t,e);t.prototype.onEnter=function(e,t){this.closePanel(e);t.stopPropagation();return!1};t.prototype.closePanel=function(e){e.state(1);return!1};t.prototype.determinePanelCssClass=function(e){return"od-Panel--"+l.default.determineCssClass(e.size)};t.prototype.getScrollBarMode=function(e){return"od-Panel--"+r.PanelScrollbarMode[e.scrollMode]+"Scroll"};return t}(o.default)});define("odsp-next/models/panel/IPanelOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.auto=0]="auto";e[e.always=1]="always";e[e.hidden=2]="hidden"}(t.PanelScrollbarMode||(t.PanelScrollbarMode={}))});define("odsp-next/providers/panel/PanelProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../models/panel/Panel"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.currentPanels=i.observables.createArray();return i}n.__extends(t,e);t.prototype.requestPanel=function(e){var t=new r(e),n=this.currentPanels;n.push(t);var i=function(){return n.remove(t)};t.wait().then(i,i);return t};return t}(i.default);t.default=a;t.resourceKey=o.createDefaultResourceKey(e,a)});define("odsp-next/models/panel/Panel",["require","exports","./IPanelOptions","@ms/odsp-utilities/lib/async/Promise","knockout"],function(e,t,n,i,o){"use strict";return function(){function e(e){var t=this,r=e.noTitle,a=void 0!==r&&r,s=e.title,l=void 0===s?o.observable(""):s,u=e.hasCommandBar,c=void 0!==u&&u,d=e.size,p=void 0===d?"Small":d,m=e.scrollMode,f=void 0===m?n.PanelScrollbarMode.auto:m,h=e.showCloseButton,g=void 0===h||h,v=e.includePadding,b=void 0===v||v,y=e.preserveLightDismiss,x=void 0!==y&&y,_=e.stickyCloseButton,w=void 0!==_&&_,I=e.component,C=void 0===I?null:I,k=e.maximizePanelContent,S=void 0!==k&&k,T=e.panelContentSize,P=void 0===T?o.observable({width:0,height:0}):T;this.size=p;this.title=o.isObservable(l)?l:o.observable(l);this.maximizePanelContent=S;this.panelContentSize=P;this.noTitle=a;this.hasCommandBar=c;this.component=C;this.scrollMode=f;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=x;this.stickyCloseButton=w;this.state=o.observable(0);this._promise=new i.default(function(e){var n=o.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e}()});define("odsp-next/controls/panelHost/PanelHost.html",[],function(){return"<div class=od-PanelHost data-bind=\"foreach: panels\">\x3c!--ko component: {\r\n name: $parent.overlayTagName,\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500\r\n },\r\n alignToParent: false\r\n }\r\n }--\x3e\x3c!--ko focusTrap: {}--\x3e<div class=\"ms-ModalOverlay od-PanelOverlay\"></div><div class=od-Panel role=dialog tabindex=-1 data-bind=\"interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: $host.isOpen }, scrollContainer, dismiss: { close: $component.closePanel.bind($component) }, class: $component.determinePanelCssClass($data) + ' ' + $component.getScrollBarMode($data), css: { 'od-Panel--hasCommandBar': hasCommandBar, 'od-Panel--hasPadding': includePadding, 'od-Panel--lightDismiss': preserveLightDismiss, 'od-Panel--stickyCloseButton': stickyCloseButton }, attr: { 'aria-label': title }, element: $parent.contentRoot\">\x3c!--ko ifnot: noTitle--\x3e<div class=\"od-Panel-title ms-font-xl ms-fontWeight-semilight\" data-bind=\"text: title\"></div>\x3c!--/ko--\x3e<div class=od-Panel-content data-bind=\"component: component, css: { 'od-Panel--hasPadding': stickyCloseButton && includePadding, 'od-Panel-content--noTitleFill': maximizePanelContent && noTitle, 'od-Panel-content--titleFill': maximizePanelContent && !noTitle }, clientRect: { size: panelContentSize }\"></div>\x3c!--ko if: showCloseButton--\x3e<button class=\"od-Panel-button od-Panel-button--close\" tabindex=0 data-bind=\"click: $component.closePanel.bind($component), attr: { 'aria-label': $component.closePanelLabel }, keyboard: { mappings: { Enter: $component.onEnter.bind($component) } }\"><i class=\"ms-Icon ms-Icon--Cancel\"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("odsp-next/controls/panelHost/PanelHost.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-PanelHost{display:none}.od-Panel{outline:1px solid transparent;position:absolute;top:50px;bottom:0;width:100%;max-width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;transition:width .3s ease-out;box-shadow:-30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}[dir=ltr] .od-Panel{right:0}[dir=rtl] .od-Panel{left:0}html[dir=rtl] .od-Panel{box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}.lg .od-Panel,.md .od-Panel,.xlg .od-Panel,.xxlg .od-Panel,.xxxlg .od-Panel,.xxxxlg .od-Panel{width:340px}.od-Panel.ms-Panel--sm{width:100%}.lg .od-Panel.ms-Panel--sm,.md .od-Panel.ms-Panel--sm,.xlg .od-Panel.ms-Panel--sm,.xxlg .od-Panel.ms-Panel--sm,.xxxlg .od-Panel.ms-Panel--sm,.xxxxlg .od-Panel.ms-Panel--sm{width:340px}.lg .od-Panel.od-Panel--lg,.lg .od-Panel.od-Panel--md,.lg .od-Panel.od-Panel--xlg,.xlg .od-Panel.od-Panel--lg,.xlg .od-Panel.od-Panel--md,.xlg .od-Panel.od-Panel--xlg,.xxlg .od-Panel.od-Panel--lg,.xxlg .od-Panel.od-Panel--md,.xxlg .od-Panel.od-Panel--xlg,.xxxlg .od-Panel.od-Panel--lg,.xxxlg .od-Panel.od-Panel--md,.xxxlg .od-Panel.od-Panel--xlg,.xxxxlg .od-Panel.od-Panel--lg,.xxxxlg .od-Panel.od-Panel--md,.xxxxlg .od-Panel.od-Panel--xlg{width:auto}[dir=ltr] .lg .od-Panel.od-Panel--lg,[dir=ltr] .lg .od-Panel.od-Panel--md,[dir=ltr] .lg .od-Panel.od-Panel--xlg,[dir=ltr] .xlg .od-Panel.od-Panel--lg,[dir=ltr] .xlg .od-Panel.od-Panel--md,[dir=ltr] .xlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxlg .od-Panel.od-Panel--md,[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:48px}[dir=rtl] .lg .od-Panel.od-Panel--lg,[dir=rtl] .lg .od-Panel.od-Panel--md,[dir=rtl] .lg .od-Panel.od-Panel--xlg,[dir=rtl] .xlg .od-Panel.od-Panel--lg,[dir=rtl] .xlg .od-Panel.od-Panel--md,[dir=rtl] .xlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxlg .od-Panel.od-Panel--md,[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:48px}.xlg .od-Panel.od-Panel--md,.xxlg .od-Panel.od-Panel--md,.xxxlg .od-Panel.od-Panel--md,.xxxxlg .od-Panel.od-Panel--md{width:643px}[dir=ltr] .xlg .od-Panel.od-Panel--md,[dir=ltr] .xxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxxlg .od-Panel.od-Panel--md{left:auto}[dir=rtl] .xlg .od-Panel.od-Panel--md,[dir=rtl] .xxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxxlg .od-Panel.od-Panel--md{right:auto}[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:428px}[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:428px}[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:980px}[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:980px}[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:1620px}[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:1620px}[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:176px}[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:176px}.lg .od-Panel.od-Panel--fullScreen,.md .od-Panel.od-Panel--fullScreen,.xlg .od-Panel.od-Panel--fullScreen,.xxlg .od-Panel.od-Panel--fullScreen,.xxxlg .od-Panel.od-Panel--fullScreen,.xxxxlg .od-Panel.od-Panel--fullScreen{width:100%}.sm .od-Panel.od-Panel--lightDismiss{width:272px}.od-Panel--hasPadding{padding:40px 16px 20px}.lg .od-Panel--hasPadding,.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:40px 32px 20px}.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding-top:70px}.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:70px 40px 20px}.od-Panel--autoScroll{overflow:auto}.od-Panel--hiddenScroll{overflow:hidden}.od-Panel--alwaysScroll{overflow-y:scroll}.od-Panel-title{margin-bottom:8px}.lg .od-Panel-title,.md .od-Panel-title,.sm .od-Panel-title{line-height:48px}.od-Panel--hidden{visibility:hidden}.od-Panel-content--titleFill{width:100%;height:calc(100% - 48px - 8px)}.od-Panel-content--noTitleFill{width:100%;height:100%}.od-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;top:0;padding:16px}[dir=ltr] .od-Panel-button--close{right:0}[dir=rtl] .od-Panel-button--close{left:0}.od-Panel-button--close .ms-Icon--Cancel{margin-top:1px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:16px}.md .od-Panel-button--close .ms-Icon--Cancel,.sm .od-Panel-button--close .ms-Icon--Cancel{font-size:20px}.od-Panel--hasCommandBar .od-Panel-button--close{z-index:600;padding:11px 16px}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-button--close{right:20px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-button--close{left:20px}[dir=ltr] .md .od-Panel-button--close,[dir=ltr] .sm .od-Panel-button--close{right:4px}[dir=rtl] .md .od-Panel-button--close,[dir=rtl] .sm .od-Panel-button--close{left:4px}.od-Panel--stickyCloseButton .od-Panel-content{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-content{padding-right:40px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-content{padding-left:40px}.od-OverlayHost-overlay .od-Panel{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{opacity:1;animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}.od-PanelOverlay.ms-ModalOverlay{top:50px}[dir=ltr] .od--hasFlexPane .od-Panel{right:320px}[dir=rtl] .od--hasFlexPane .od-Panel{left:320px}"}])});define("odsp-next/controls/leftNavExpander/LeftNavExpander",["require","exports","./LeftNavExpanderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./LeftNavExpander.html","./LeftNavExpander.css"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"od-left-nav-expander",template:e("./LeftNavExpander.html"),viewModel:n.default,synchronous:!0})});define("odsp-next/controls/leftNavExpander/LeftNavExpanderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../commandBar/CommandBar","./commandSets/LeftNavExpanderCommandSet"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.commandBarTagName=o.tagName;n.commandBarParams={commandSet:new(n.managed(r.default))};return n}n.__extends(t,e);return t}(i.default);t.default=a});define("odsp-next/controls/commandBar/CommandBar",["require","exports","./CommandBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CommandBar.html","./CommandBar.css","../commandBarItem/CommandBarItem","../contextualMenu/ContextualMenu"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"ms-command-bar",template:e("./CommandBar.html"),viewModel:n,synchronous:!0})});define("odsp-next/controls/commandBar/CommandBarViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../bindings/overflow/OverflowBinding","../../bindings/element/ElementBinding","@ms/odsp-shared/lib/utilities/knockout/Translators","../../utilities/browser/ResponsiveUI"],function(e,t,n,i,o,r,a,s,l,u,c){"use strict";function d(e){return 0!=(7&e.location)}function p(e){return 3==(3&e.location)}function m(e){return 4==(4&e.location)}function f(e){return 2==(3&e.location)}return function(e){function t(t){var n=e.call(this,t)||this;n._allCommands=i.observableArray();n.overflowCommands=i.observableArray();n.focusedCommand=i.observable();n.fixedCommands=[];n._overflowCommandsSubscription=null;n._commandSetCommandsReplicationSubscription=null;n.responsiveUI=n.resources.consume(c.resourceKey);n.addBindingHandlers({selection:a.default,overflow:s,keyboard:r,element:l});n._mainCommandsFirstTimeRendered=i.observable(!1);n._skipFocus=!1;n.keyboardOptions=[{mappings:{Down:n.onNavigateDown,Enter:n.onEnter,ShiftTab:n.onShiftTab}},{target:document,mappings:{},allowButtonEvents:!0}];n._initializeCommandsObservables();n._initializeFocusLogic(!!t.focusOnFirstCommand||!1);n._commandSet=n.wrapObservable(t.commandSet);n._initializeCommandSet(n._commandSet.peek());n.subscribe(n._commandSet,function(e){n._initializeCommandSet(e)});return n}n.__extends(t,e);t.prototype.getCommandBarItemParams=function(e,t){var n=this;return{command:e,index:4&e.location?this.observables.pureCompute(function(){return t()+n.mainCommands().length}):t}};t.prototype.onNavigateDown=function(e,t){var n=this.focusedCommand();n&&n.openMenu()&&t.preventDefault();return!1};t.prototype.onEnter=function(e,t){var n=this.focusedCommand();if(!n)return!0;var i=t.target.getElementsByTagName("input");if(!i||!i.length)return n.onClick(n,t);i[0].click();t.stopPropagation();t.preventDefault()};t.prototype.onShiftTab=function(e,t){this._skipFocus=!0;this.topTab()&&this.topTab().focus();return!0};t.prototype.onMousedown=function(){this._skipFocus=!0};t.prototype.animateIn=function(e,t,n){if(n.hasAnimation&&1===e.nodeType){i.utils.toggleDomNodeCssClass(e,"is-animatingIn",!0);this.async.setTimeout(function(){i.utils.toggleDomNodeCssClass(e,"is-animatingIn",!1)},1e3)}};t.prototype.animateOut=function(e,t,n){if(n.hasAnimation&&1===e.nodeType){i.utils.toggleDomNodeCssClass(e,"is-animatingOut",!0);this.async.setTimeout(function(){i.removeNode(e)},1e3)}else i.removeNode(e)};t.prototype._updateCommandKeyboardShortcuts=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(i.keys)for(var o=i.onClick.bind(i),r=0;r<i.keys.length;r++){var a=i.keys[r];e[a]||(e[a]=[]);e[a].push(o)}var s=i.children();s.length&&this._updateCommandKeyboardShortcuts(e,s)}};t.prototype._initializeCommandSet=function(e){var t=this;if(this._overflowCommandsSubscription){this._overflowCommandsSubscription.dispose();this._overflowCommandsSubscription=null}if(this._commandSetCommandsReplicationSubscription){this._commandSetCommandsReplicationSubscription.dispose();this._commandSetCommandsReplicationSubscription=null}this._allCommands([]);this.fixedCommands=[];this.keyboardOptions[1].mappings={};if(e){this._commandSetCommandsReplicationSubscription=u.replicateArray(e.commands,this._allCommands);this.addDisposable(this._commandSetCommandsReplicationSubscription);if(e.overflowHostCommand){this.fixedCommands.push(e.overflowHostCommand);this._overflowCommandsSubscription=this.createBackgroundComputed(function(){var n=t.overflowCommands().concat(t._overflowOnlyCommands());e.overflowHostCommand.children(n)})}this._mainCommandsFirstTimeRendered.peek()||this._mainCommandsFirstTimeRendered(!0)}};t.prototype._initializeCommandsObservables=function(){var e=this,t=this._allCommands,n=this._visibleCommands=this.addDisposable(t.filter(function(e){return e.isVisible()&&d(e)}));this.mainCommands=this.addDisposable(n.filter(p));this._overflowOnlyCommands=this.addDisposable(t.filter(f));this.sideCommands=this.addDisposable(n.filter(m));this.selectableCommands=this.addDisposable(n.filter(function(t){return!(f(t)||e._isOverflowEnabled()&&e.overflowCommands.indexOf(t)>=0)&&!t.isDisabled()}));this.subscribe(t,function(t){var n={};e._updateCommandKeyboardShortcuts(n,t);e.keyboardOptions[1].mappings=n})};t.prototype._initializeFocusLogic=function(e){var t=this,n=this.addDisposable(this._visibleCommands.filter(function(e){return e.isOpen()})),o=this.createComputed(function(){return n().length>0});this.createComputed(function(){o()||i.computedContext.isInitial()||document.activeElement&&document.activeElement!==document.body||!t.topTab.peek()||t.topTab.peek().focus()}).extend({rateLimit:0});this._isFocusInEventRegistered=!1;this.topTab=i.observable(null);this.createComputed(function(){if(t.topTab()&&!t._isFocusInEventRegistered){t.events.on(t.topTab(),"focusin",function(e){!t._skipFocus&&t.topTab()&&e.target===t.topTab()&&t._focusOnFirstCommand();t._skipFocus=!1});t._isFocusInEventRegistered=!0}});this.subscribe(this._mainCommandsFirstTimeRendered,function(n){t.async.setImmediate(function(){n&&e&&t._focusOnFirstCommand()})})};t.prototype._isOverflowEnabled=function(){return!!this._commandSet.peek()&&!!this._commandSet.peek().overflowHostCommand};t.prototype._focusOnFirstCommand=function(){if(this._visibleCommands()&&this._visibleCommands().length>0){var e=this._visibleCommands()[0];e.focused(!0);this.focusedCommand(e)}};return t}(o.default)});define("odsp-next/bindings/selection/SelectionBinding",["require","exports","knockout","../../models/selection/SelectionModel","../../utilities/events/EventMatcher","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}e.init=function(t,o,a,s,l){var u,c=n.utils.unwrapObservable(o()),d=a(),p=new r.default(null),m={mode:"multi",direction:"custom",properties:{selected:"selected",focused:"focused",activeClass:"selection-active"}},f=c.selectionModel||new i;u=c.data?c.data:d.foreach&&d.foreach.data||d.foreach||d.template&&d.template.foreach;f.items=n.isObservable(u)?u:n.observableArray(u);f.rootElement=n.observable(t);if(c){f.focused=c.focused||n.observable(null);f.anchor=c.anchor||n.observable(null);f.layout=c.layout||n.observable(null);f.toggleClass=f.layout()?f.layout().getToggleClass():c.toggleClass||null;f.clearSelectionOnRemoval=c.clearSelectionOnRemoval;f.selectFirstItemOnActivate="boolean"!=typeof c.selectFirstItemOnActivate||c.selectFirstItemOnActivate;n.isObservable(c.mode)?f.mode=c.mode:f.mode=n.observable(c.mode||m.mode);n.isObservable(c.direction)?f.direction=c.direction:f.direction=n.observable(c.direction||m.direction);n.utils.extend(m.properties,c.properties)}else{f.selection=n.observableArray(c.data);f.focused=n.observable(null);f.anchor=n.observable(null);f.mode=n.observable(m.mode);f.direction=n.observable(m.direction);f.layout=null}f.init(m);var h=e.getMode(f.mode())(f,c.isReadyToBeSelected);e._registerEventHandlers(p,t,f,h,c.isDefaultSelection,c.isActive,c.allowInputEvents);n.utils.domNodeDisposal.addDisposeCallback(t,function(){f.clearSelectionOnRemoval&&f.clear();p.dispose()})};e.getMode=function(t){var n=e.modes[t];if(!n)throw new Error('Unknown mode: "'+t+'"');return n};e._registerEventHandlers=function(e,t,n,i,o,r,a){function s(e){var t=e.target,o=t&&"A"===t.tagName,r=n.findItemData(e.target);e.hasItem=!!r;e.isClickOnToggleElement=n.isClickOnToggleElement(this,e.target);o||i.match(e,r)}e.on(t,"touchstart",s);e.on(t,"touchend",s);e.on(t,"touchmove",s);e.on(t,"click",s);e.on(t,"focusin",function(e){if(!n.isActive()){if(e.target===t&&0===n.selection().length&&!n.focused()&&n.selectFirstItemOnActivate){var i=n.firstItem();n.focused(i);n.anchor(i)}n.activate()}});e.on(t,"focusout",function(e){n.deactivate()});e.on(o?document:t,"keydown",function(e){var t=e.target,o=t&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName);if(!a&&o||r&&!r())return!0;var s=n.focused();e.hasItem=!!s;if(i.match(e,s)){e.stopPropagation();e.preventDefault()}})};e._isItemReadyToBeSelected=function(e,t){var n=!1;!e||t&&!t(e)||(n=!0);return n};e._getSingleMatchers=function(t,n){t.focused()?t.selection([t.focused()]):t.selection.splice(1);var i=new o;i.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n);t.anchor(n)});i.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.selectItem(n);t.anchor(n)});i.register({type:"keydown",which:35},function(e,n){var i=t.lastItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:36},function(e,n){var i=t.firstItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:32,hasItem:!0},function(e,t){});if(t.hasVertical()||t.hasCustom()){i.register({type:"keydown",which:38,hasItem:!1},{type:"keydown",which:40,hasItem:!1},function(e,n){var i=t.firstItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:38,hasItem:!0},function(i,o){var r=t.aboveItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}});i.register({type:"keydown",which:40,hasItem:!0},function(i,o){var r=t.belowItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}})}if(t.hasHorizontal()||t.hasCustom()){i.register({type:"keydown",which:37,hasItem:!1},{type:"keydown",which:39,hasItem:!1},function(e,n){var i=t.firstItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:37,hasItem:!0},function(i,o){var r=t.leftItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}});i.register({type:"keydown",which:39,hasItem:!0},function(i,o){var r=t.rightItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}})}return i};e._getMultiMatchers=function(t,n){var i=new o;i.register({type:"click",which:1,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)});i.register({type:"click",which:1,ctrlKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,hasItem:!0},function(e,n){t.toggleSelection(n);t.anchor(n)});i.register({type:"click",which:1,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)});i.register({type:"click",which:1,hasItem:!1},function(e,n){t.removeSelection()});i.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n);t.anchor(n)});i.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.toggleSelection(n);t.anchor(n)});i.register({type:"keydown",which:32,hasItem:!0},function(e,n){t.toggleSelection(n);t.anchor(n)});i.register({type:"keydown",which:35,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:35,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.lastItem())});i.register({type:"keydown",which:35,ctrlKey:!0},{type:"keydown",which:35,metaKey:!0},function(e,n){var i=t.lastItem();t.focused(i);t.anchor(i)});i.register({type:"keydown",which:35,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.lastItem())});i.register({type:"keydown",which:35},function(e,n){var i=t.lastItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:36,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:36,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.firstItem())});i.register({type:"keydown",which:36,ctrlKey:!0},{type:"keydown",which:36,metaKey:!0},function(e,n){var i=t.firstItem();t.focused(i);t.anchor(i)});i.register({type:"keydown",which:36,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.firstItem())});i.register({type:"keydown",which:36},function(e,n){var i=t.firstItem();t.selectItem(i);t.anchor(i)});if(t.hasVertical()||t.hasCustom()){i.register({type:"keydown",which:38,ctrlKey:!1,shiftKey:!1,hasItem:!1},{type:"keydown",which:38,metaKey:!1,shiftKey:!1,hasItem:!1},{type:"keydown",which:40,ctrlKey:!1,shiftKey:!1,hasItem:!1},{type:"keydown",which:40,metaKey:!1,shiftKey:!1,hasItem:!1},function(e,n){var i=t.firstItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:38,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"keydown",which:38,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(t.aboveItem(n))});i.register({type:"keydown",which:38,ctrlKey:!0,hasItem:!0},{type:"keydown",which:38,metaKey:!0,hasItem:!0},function(i,o){var r=t.aboveItem(o);if(e._isItemReadyToBeSelected(r,n)){t.focused(r);t.anchor(r)}});i.register({type:"keydown",which:38,shiftKey:!0,hasItem:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.aboveItem(n))});i.register({type:"keydown",which:38,hasItem:!0},function(i,o){var r=t.aboveItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}});i.register({type:"keydown",which:40,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"keydown",which:40,metaKey:!0,shiftKey:!0,hasItem:!0},function(i,o){var r=t.belowItem(o);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)});i.register({type:"keydown",which:40,ctrlKey:!0,hasItem:!0},{type:"keydown",which:40,metaKey:!0,hasItem:!0},function(i,o){var r=t.belowItem(o);if(e._isItemReadyToBeSelected(r,n)){t.focused(r);t.anchor(r)}});i.register({type:"keydown",which:40,shiftKey:!0,hasItem:!0},function(i,o){var r=t.belowItem(o);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)});i.register({type:"keydown",which:40,hasItem:!0},function(i,o){var r=t.belowItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}})}if(t.hasHorizontal()||t.hasCustom()){i.register({type:"keydown",which:37,ctrlKey:!1,shiftKey:!1,hasItem:!1},{type:"keydown",which:37,metaKey:!1,shiftKey:!1,hasItem:!1},{type:"keydown",which:39,ctrlKey:!1,shiftKey:!1,hasItem:!1},{type:"keydown",which:39,metaKey:!1,shiftKey:!1,hasItem:!1},function(e,n){var i=t.firstItem();t.selectItem(i);t.anchor(i)});i.register({type:"keydown",which:37,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"keydown",which:37,metaKey:!0,shiftKey:!0,hasItem:!0},function(i,o){var r=t.leftItem(o);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)});i.register({type:"keydown",which:37,ctrlKey:!0,hasItem:!0},{type:"keydown",which:37,metaKey:!0,hasItem:!0},function(i,o){var r=t.leftItem(o);if(e._isItemReadyToBeSelected(r,n)){t.focused(r);t.anchor(r)}});i.register({type:"keydown",which:37,shiftKey:!0,hasItem:!0},function(i,o){var r=t.leftItem(o);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)});i.register({type:"keydown",which:37,hasItem:!0},function(i,o){var r=t.leftItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}});i.register({type:"keydown",which:39,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"keydown",which:39,metaKey:!0,shiftKey:!0,hasItem:!0},function(i,o){var r=t.rightItem(o);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)});i.register({type:"keydown",which:39,ctrlKey:!0,hasItem:!0},{type:"keydown",which:39,metaKey:!0,hasItem:!0},function(i,o){var r=t.rightItem(o);if(e._isItemReadyToBeSelected(r,n)){t.focused(r);t.anchor(r)}});i.register({type:"keydown",which:39,shiftKey:!0,hasItem:!0},function(i,o){var r=t.rightItem(o);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)});i.register({type:"keydown",which:39,hasItem:!0},function(i,o){var r=t.rightItem(o);if(e._isItemReadyToBeSelected(r,n)){t.selectItem(r);t.anchor(r)}})}i.register({type:"keydown",which:65,ctrlKey:!0},{type:"keydown",which:65,metaKey:!0},function(e,n){t.selectAll()});return i};return e}();a.modes={single:a._getSingleMatchers,multi:a._getMultiMatchers};t.default=a});define("odsp-next/models/selection/SelectionModel",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","knockout","@uifabric/utilities/lib/dom"],function(e,t,n,i,o,r){"use strict";return function(e){function t(){var t=e.call(this)||this;t._focusedIndex=-1;t._subscriptions=[];t._selectItemKeyToModel={};t.keyToIndexHash={};t.indexToKeyHash={};t.unresolvedSelectedIndices={};t._focusedIndex=-1;t._subscriptions=[];t._selectItemKeyToModel={};t.itemSet=o.observable(null);t.layout=o.observable();t.selection=o.observableArray().extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}});t.selectionKeyHash=o.observable({});t.focused=o.observable().extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}});t.items=o.observableArray();t.focusedKeyHash=o.observable({});t.isAllSelected=o.observable(!1);t.isActive=o.observable(!1);t.clearSelectionOnRemoval=!1;t.selectFirstItemOnActivate=!0;return t}n.__extends(t,e);t._set=function(e,t,n,i){(e=o.utils.unwrapObservable(e))&&e.hasOwnProperty(t)&&o.isObservable(e[t])&&e[t](n);if(e&&e.key){i()[e.key]=n;i.valueHasMutated()}};t._setAll=function(e,n,i,o){for(var r=0;r<e.length;r++)t._set(e[r],n,i,o)};t._hasCssClass=function(e,t){return!!(e&&e.className&&-1!==e.className.indexOf(t)&&e.className.match("\\b"+t+"\\b"))};t._getParentElement=function(e){return e&&r.getParent(e)||null};t._insideElementWithClass=function(e,n,i){i=i||null;for(var o=e;o;){if(t._hasCssClass(o,n))return!0;if(o===i)return!1;o=t._getParentElement(o)}return!1};t.prototype.init=function(e){var n=this;if(!this.items)throw new Error("The selection binding can only be used together with `foreach`, `foreach: { data: ... }`, `template: { foreach: ... }` or like `selection: { data: ... }`.");if(!o.isObservable(this.selection))throw new Error("The selection binding should be bound to either an `observableArray` or a object containing a `selection` `observableArray`.");this.properties=e.properties;this._buildKeyIndexHash();this.async.setTimeout(function(){n.cleanup();n._updateFocused(e.properties.focused,!0)},0);this._subscriptions=[];this._subscriptions.push(this.focused.subscribe(function(e){var t;(t=(e=o.utils.unwrapObservable(e))?e.key:null)&&n._updateIsFocusedObservable(t,!1)},this,"beforeChange"));this._subscriptions.push(this.focused.subscribe(function(e){n._focusedIndex=e?n._findItemIndex(n.focused()):-1;n._focusedIndex>-1&&n._updateIsFocusedObservable(n.indexToKeyHash[n._focusedIndex],!0)}));this._subscriptions.push(this.selection.subscribe(function(i){t._setAll(n.selection(),e.properties.selected,!1,n.selectionKeyHash)},this,"beforeChange"));this._subscriptions.push(this.selection.subscribe(function(i){"single"===n.mode()&&i.length>1?n.selection([i.slice(-1)[0]]):t._setAll(i,e.properties.selected,!0,n.selectionKeyHash);var o=n.items().length,r=n.selection().length;n.isAllSelected(o>0&&o===r)}));this._subscriptions.push(this.items.subscribe(function(e){n._buildKeyIndexHash();n.cleanup()}));t._setAll(this.selection.peek(),e.properties.selected,!0,this.selectionKeyHash);this._subscriptions.push(this.focused.subscribe(function(i){t._set(i,e.properties.focused,!1,n.focusedKeyHash)},this,"beforeChange"));this._subscriptions.push(this.focused.subscribe(function(i){t._set(i,e.properties.focused,!0,n.focusedKeyHash)}));this.focused()&&t._set(this.focused(),e.properties.focused,!0,this.focusedKeyHash)};t.prototype.cleanup=function(){var e=this;if(!this.itemSet.peek()||!this.itemSet.peek().isPlaceholder){var t=[];if(this.focused.peek()){var n=this._findItemIndex(this.focused.peek());-1===n?this.focused(null):this._focusedIndex=n}this.anchor.peek()&&-1===this._findItemIndex(this.anchor.peek())&&this.anchor(null);if(this.isAllSelected())this.selectAll();else{o.utils.arrayForEach(this.selection.peek(),function(n){-1!==e._findItemIndex(n)&&t.push(n)});t.length!==this.selection.peek().length&&this.selection(t)}}};t.prototype.clear=function(){this.focused&&this.focused(null);this.anchor&&this.anchor(null);this._focusedIndex=-1;this.removeSelection()};t.prototype.hasHorizontal=function(){return"horizontal"===this.direction.peek()};t.prototype.hasVertical=function(){return"vertical"===this.direction.peek()};t.prototype.hasCustom=function(){return"custom"===this.direction.peek()};t.prototype.toggleAllSelected=function(){if(this.selection.peek().length===this.items.peek().length){this.selection([]);this._updateAllSelectItemViewModels(!1)}else this.selectAll()};t.prototype.selectAll=function(){var e=this.items.peek().slice();this.unresolvedSelectedIndices={};for(var t=0;t<e.length;t++)e[t]||(this.unresolvedSelectedIndices[t]=!0);this.selection(this.items().slice());this._updateAllSelectItemViewModels(!0)};t.prototype.selectItem=function(e){var t=[],n=o.utils.unwrapObservable(e);this._updateSelectItemViewModelInSelection(!1);if(e){t.push(e);this._updateIsSelectedObservable(n.key,!0)}this.selection(t);this.focused(e)};t.prototype.firstItem=function(){return this.items()[0]};t.prototype.lastItem=function(){return this.items()[this.items().length-1]};t.prototype.nextItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.min(t+1,this.items().length-1)]};t.prototype.previousItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.max(t-1,0)]};t.prototype.leftItem=function(e){var t=this._findItemIndex(e),n=this.layout();return Boolean(n)?this.items()[n.getItemIndexLeft(t)]:this.hasHorizontal()?this.previousItem(e):null};t.prototype.aboveItem=function(e){var t=this._findItemIndex(e),n=this.layout();return Boolean(n)?this.items()[n.getItemIndexAbove(t)]:this.hasVertical()?this.previousItem(e):null};t.prototype.rightItem=function(e){var t=this._findItemIndex(e),n=this.layout();return Boolean(n)?this.items()[n.getItemIndexRight(t)]:this.hasHorizontal()?this.nextItem(e):null};t.prototype.belowItem=function(e){var t=this._findItemIndex(e),n=this.layout();return Boolean(n)?this.items()[n.getItemIndexBelow(t)]:this.hasVertical()?this.nextItem(e):null};t.prototype.isAlreadySelected=function(e){var t=o.utils.unwrapObservable(e);return t.hasOwnProperty("key")?!0===this.selectionKeyHash()[t.key]:-1!==o.utils.arrayIndexOf(this.selection(),e)};t.prototype.toggleSelection=function(e,t){var n=o.utils.unwrapObservable(e);if(this.isAlreadySelected(e)){if(!t){this.selection.remove(e);this._updateIsSelectedObservable(n.key,!1)}}else if(!1!==t){this.selection.push(e);this._updateIsSelectedObservable(n.key,!0)}this.focused(e)};t.prototype.removeSelection=function(){this.unresolvedSelectedIndices={};this.selection([]);this._updateAllSelectItemViewModels(!1)};t.prototype.appendSelectionWithCurrentItem=function(e){if(e){this.anchor(e);if(!this.isAlreadySelected(e)){var t=o.utils.unwrapObservable(e);this.selection.push(e);this._updateIsSelectedObservable(t.key,!0)}this.focused(e)}};t.prototype.appendSelectionFromAnchor=function(e){if(e){var t=this.anchor.peek();t?this.selection.remove(t):this.anchor(e);this.selection.push.apply(this.selection,this._createRange(this.items,this.anchor(),e,!0));this._updateSelectItemViewModelInSelection(!0);this.focused(e)}};t.prototype.replaceSelectionWithRangeFromAnchor=function(e){if(e){this.anchor.peek()||this.anchor(e);this._updateSelectItemViewModelInSelection(!1);this.selection(this._createRange(this.items,this.anchor.peek(),e));this._updateSelectItemViewModelInSelection(!0);this.focused(e)}};t.prototype.findItemData=function(e){var t=o.contextFor(e);if(!t||!t.$data)return null;for(var n=this._getItemFromContext(t)||t.$data;t;){if(n&&this._findItemIndex(n)>=0)return n;t=t.$parentContext;n=this._getItemFromContext(t)}return null};t.prototype.isClickOnToggleElement=function(e,n){var i=this.toggleClass;return!!i&&t._insideElementWithClass(n,i,e)};t.prototype.activate=function(){o.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!0);this.isActive(!0)};t.prototype.deactivate=function(){o.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!1);this.isActive(!1)};t.prototype.subscribeSelectItemViewModel=function(e,t){this._selectItemKeyToModel[e]?this._selectItemKeyToModel[e].push(t):this._selectItemKeyToModel[e]=[t]};t.prototype.disposeSelectItemViewModel=function(e,t){var n=this._selectItemKeyToModel[e],i=-1;if(n){(i=n.indexOf(t))>-1&&n.splice(i,1);0===n.length&&delete this._selectItemKeyToModel[e]}};t.prototype.getFocusedItemKey=function(){var e=null;this._focusedIndex>-1&&(e=this.indexToKeyHash[this._focusedIndex]);return e};t.prototype.ensureFocusedItemViewModel=function(){var e=this.getFocusedItemKey();this._updateIsFocusedObservable(e,!0)};t.prototype.setFocusItemByKey=function(e){var t=this.keyToIndexHash[e];void 0!==t&&this.focused(this.items.peek()[t])};t.prototype.getViewModelsForKey=function(e){return this._selectItemKeyToModel[e]};t.prototype._findItemIndex=function(e){var t=-1,n=o.utils.unwrapObservable(e);if(n)if(n.hasOwnProperty("key")){var i=this.keyToIndexHash[n.key];void 0!==i&&(t=i)}else t=o.utils.arrayIndexOf(this.items.peek(),e);return t};t.prototype._getKeyForItem=function(e){var t,n=o.utils.unwrapObservable(e);n&&n.hasOwnProperty("key")&&(t=n.key);return t};t.prototype._createRange=function(e,t,n,i){var o=this.selectionKeyHash(),r=e(),a=this._findItemIndex(t),s=this._findItemIndex(n),l=[];if(a>s){var u=a;a=s;s=u}for(var c=a;c<=s;c+=1){var d=this._getKeyForItem(r[c]);d?i&&o[d]||l.push(r[c]):this.unresolvedSelectedIndices[c]=!0}return l};t.prototype._updateFocused=function(e,t){for(var n=this.items.peek(),i=0;i<n.length;i++){var r=n[i];if(r&&r.hasOwnProperty(e)&&o.isObservable(r[e])&&r[e]()===t){this.focused(r);break}}};t.prototype._updateIsSelectedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isSelected(t)})};t.prototype._updateIsFocusedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isFocused(t)})};t.prototype._updateAllSelectItemViewModels=function(e){for(var t in this._selectItemKeyToModel)this._selectItemKeyToModel[t].forEach(function(t){t.isSelected(e)})};t.prototype._updateSelectItemViewModelInSelection=function(e){for(var t,n,i=this.selection.peek(),r=0;r<i.length;r++)if(t=o.utils.unwrapObservable(i[r])){n=t.key;this._updateIsSelectedObservable(n,e)}};t.prototype._buildKeyIndexHash=function(){var e,t,n=this.items.peek();this.keyToIndexHash={};this.indexToKeyHash={};for(var i=0;i<n.length;i++)if((t=o.utils.unwrapObservable(n[i]))&&t.hasOwnProperty("key")){e=t.key;this.keyToIndexHash[e]=i;this.indexToKeyHash[i]=e}this._checkUnresolvedIndicies()};t.prototype._checkUnresolvedIndicies=function(){var e,t=this.items.peek();for(var n in this.unresolvedSelectedIndices)if(t[Number(n)]){delete this.unresolvedSelectedIndices[n];(e=e||{})[n]=!0}if(e){for(var i=[],o=this.selectionKeyHash.peek(),r=0;r<t.length;r++){var a=t[r];(o[this._getKeyForItem(a)]||e[r]||this.unresolvedSelectedIndices[r])&&i.push(a)}this.selection(i)}};t.prototype._getItemFromContext=function(e){return e&&e.$data?"function"==typeof e.$data.getItem?e.$data.getItem():e.$data.isSelectable?e.$data:null:null};return t}(i.default)});define("odsp-next/utilities/events/EventMatcher",["require","exports"],function(e,t){"use strict";return function(){function e(){this.handlers=[]}e.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length-1;n++)this.handlers.push({pattern:e[n],callback:e[e.length-1]})};e.prototype.match=function(e,t){for(var n=0;n<this.handlers.length;n++)if(this._compare(this.handlers[n].pattern,e)){this.handlers[n].callback.call(this,e,t);return!0}return!1};e.prototype._compare=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0};return e}()});define("odsp-next/bindings/overflow/OverflowBinding",["require","exports","knockout","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,n,i){"use strict";return function(){function e(){}e.init=function(t,o,r){var a=n.observable();n.computed(function(){a();var i=n.utils.unwrapObservable(o()),s=r(),l=null;l=i.data?i.data:s.foreach&&s.foreach.data||s.foreach||s.template&&s.template.foreach;var u=i.responsiveUI.formFactorSize(),c=n.utils.unwrapObservable(l),d=n.utils.unwrapObservable(i.alwaysVisibleItems);e._calculateElementVisibility(t,i,c,d,u)},null,{disposeWhenNodeIsRemoved:t}).extend({throttle:1});var s=new i.default(t);n.utils.domNodeDisposal.addDisposeCallback(t,function(){s.dispose()});s.on(t,"layoutChange",function(e){a.notifySubscribers()});s.on(window,"resize",function(e){a.notifySubscribers()});s.on(document,"transitionend",function(e){a.notifySubscribers()})};e._calculateElementVisibility=function(t,i,o,r,a){var s=t.getBoundingClientRect(),l=s.right-s.left,u=0,c=[],d=[];if(r&&o)for(var p=0,m=r.length;p<m;p++){var f=r[p],h=n.utils.arrayIndexOf(o,f);if(h>-1&&h<t.children.length){g=t.children[h];l-=e._measureElement(g).width}}for(var p=0,m=t.children.length;p<m;p++){var g=t.children[p],v="Small"===a&&p>0,b=void 0;o&&(b=o[p]);u+=e._measureElement(g).width;var y=r&&b&&n.utils.arrayIndexOf(r,b)>-1,x=!y&&(u>l||v);b&&n.isObservable(b.isClipped)&&b.isClipped(x);if(!y){var _="none"!==g.style.display;x||_?x&&_&&(g.style.display="none"):g.style.display=""}if(x){c.push(g);b&&d.push(b)}}if(i){n.isObservable(i.overflowElements)&&i.overflowElements(c);n.isObservable(i.overflowItems)&&i.overflowItems(d)}};e._measureElement=function(e){var t=e.style.display;e.style.display="";var n=e.getBoundingClientRect(),i=window.getComputedStyle(e),o=parseFloat(i.marginLeft),r=parseFloat(i.marginRight),a=parseFloat(i.marginTop),s=parseFloat(i.marginBottom);e.style.display=t;return{left:n.left-o,right:n.right+r,top:n.top-a,bottom:n.bottom+s,width:n.right-n.left+o+r,height:n.bottom-n.top+a+s}};return e}()});define("@ms/odsp-shared/lib/utilities/knockout/Translators",["require","exports"],function(e,t){"use strict";var n;!function(e){e.replicateArray=function(e,t){var n=function(n){var i=e.peek(),o=t.peek();t.valueWillMutate();o.splice.apply(o,[0,o.length].concat(i));t.valueHasMutated()},i=e.subscribe(n,null,"arrayChange");n();return i}}(n||(n={}));return n});define("odsp-next/controls/commandBar/CommandBar.html",[],function(){return"<div class=CommandBar tabindex=0 role=menubar data-bind=\"keyboard: keyboardOptions, selection: { data: selectableCommands, mode: 'single', direction: 'horizontal', focused: focusedCommand }, event: { mousedown: onMousedown }, element: topTab\"><div class=CommandBar-sideArea data-bind=\"template: { foreach: sideCommands, afterAdd: $component.animateIn.bind($component), beforeRemove: $component.animateOut.bind($component) }\">\x3c!--ko component: {\r\n name: 'ms-command-bar-item',\r\n params: $component.getCommandBarItemParams($data, $index)\r\n }--\x3e\x3c!--/ko--\x3e</div><div class=CommandBar-mainArea data-bind=\"template: { foreach: mainCommands }, overflow: { overflowItems: overflowCommands, alwaysVisibleItems: fixedCommands, responsiveUI: responsiveUI }\">\x3c!--ko component: {\r\n name: 'ms-command-bar-item',\r\n params: $component.getCommandBarItemParams($data, $index) }--\x3e\x3c!--/ko--\x3e</div></div>"});define("odsp-next/controls/commandBar/CommandBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".CommandBar{height:40px;white-space:nowrap;border:0}.CommandBar:focus{outline:0}.CommandBar .is-shadowed{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset}.CommandBar .is-animatingIn{animation-name:ms-fadeIn,ms-slideUpIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}.CommandBar .is-animatingOut{overflow:hidden;animation-name:ms-fadeOut,ms-slideDownOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}.md .CommandBar,.sm .CommandBar{height:44px}.CommandBar-mainArea{overflow:hidden}.md .CommandBar-mainArea,.sm .CommandBar-mainArea{height:44px}html[dir=ltr] .CommandBar-sideArea{float:right}html[dir=rtl] .CommandBar-sideArea{float:left}html[dir=ltr] .CommandBar-sideArea{text-align:right}html[dir=rtl] .CommandBar-sideArea{text-align:left}.md .CommandBar-sideArea,.sm .CommandBar-sideArea{min-width:128px}.lg .CommandBar-sideArea{min-width:260px}.xlg .CommandBar-sideArea,.xxlg .CommandBar-sideArea,.xxxlg .CommandBar-sideArea,.xxxxlg .CommandBar-sideArea{min-width:345px}.sm .CommandBar-sideArea{width:auto}"}])});define("odsp-next/controls/commandBarItem/CommandBarItem",["require","exports","./CommandBarItemViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CommandBarItem.html","./CommandBarItem.css","../overlays/anchor/AnchorOverlay","../icon/glyph/IconGlyph"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"ms-command-bar-item",template:e("./CommandBarItem.html"),viewModel:n,synchronous:!0})});define("odsp-next/controls/commandBarItem/CommandBarItemViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../commands/Commands.resx","../../utilities/features/Features"],function(e,t,n,i,o,r,a){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.command=t.command;n.index=t.index||n.createObservable(-1);n.automationId=t.command.automationId;n.accessibleLabel=n.createPureComputed(function(){var e=n.command.computedAccessibleLabel();return 0===n.index()?o.format(r.strings.firstCommandAccessibleLabelFormat,e):e});n.hasPayload=n.createPureComputed(n._computeHasPayload);n.useReactContextualMenu=a.isFeatureEnabled(a.UseReactContextualMenu);return n}n.__extends(t,e);t.prototype.dispose=function(){this.command.isOpen.peek()&&this.command.isOpen(!1);e.prototype.dispose.call(this)};t.prototype._computeHasPayload=function(){return!!this.unwrapObservable(this.command.payload)&&this.command.isOpen()&&(!this.command.action||!this.command.action.isToggled())};return t}(i.default)});define("odsp-next/controls/commandBarItem/CommandBarItem.html",[],function(){return"\x3c!--ko with: command--\x3e<div class=\"CommandBarItem beak-anchor command\" data-bind=\"css: { 'is-toggled': isOpen() || isToggled(), 'is-disabled': isDisabled, 'is-disabled-invisible': isInvisibleWhenDisabled, 'is-open': isOpen, 'is-focused': focused, 'CommandBarItem--hasPayload': $component.hasPayload, 'icon-only': hasIconOnly, 'is-current-view': isCurrentView, 'is-pivot': isCurrentView !== null, 'is-last-pivot': isLastPivot }, class: commandClass() ? 'od-Command--' + commandClass() : '', hasFocus: isActive, raiseEventOnChange: { eventName: 'layoutChange', bubbleEvent: true, data: layoutChanged }, dismiss: { isOpen: isOpen, isAutomatic: autoDismissPayload, timeout: payloadTimeout, dismissOnResize: !autoDismissPayload, dismissOnScroll: !autoDismissPayload }, with: targetCommand(), attr: { tabindex: tabindex, role: role, 'aria-label': $parent.accessibleLabel, 'aria-haspopup': visibleChildren().length > 0 || !!payload, 'aria-selected': isOpen(), 'aria-pressed': isToggled(), 'data-automationid': automationId, id: newFeatureExperienceAnchor }, teachingBubble: teachingBubble, tooltip: { content: $data.tooltip, isTooltipDisabled: isOpen }\"><div class=CommandBarItem-linkWrapper><div class=CommandBarItem-link data-bind=\"measure: { measure: $parent.measurementReady, async: true }, click: onClick, automation: 'link'\">\x3c!--ko if: $parent.icon--\x3e<span class=CommandBarItem-icon data-bind=\"component: { name: 'od-icon-glyph', params: { icon: $parent.icon, badge: $parent.iconBadge } }, attr: { 'is-flipped': $parent.positionIconRight }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: $parent.iconUrl--\x3e<span class=CommandBarItem-icon><i class=\"ms-Icon ms-Icon--custom\" data-bind=\"style: { backgroundImage: 'url(\\'' + $parent.iconUrl() + '\\')' }\"></i></span>\x3c!--/ko--\x3e\x3c!--ko if: $parent.label() && $parent.isLabelVisible()--\x3e<span class=CommandBarItem-commandText data-bind=\"text: $parent.label, attr: { 'is-flipped': $parent.positionIconRight, 'role': $parent.hasDynamicText ? 'status' : null, 'aria-live': $parent.hasDynamicText ? 'polite' : null }, css: { 'CommandBarItem-commandText--isStrong': $parent.isStrong }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: visibleChildren().length && !hidesMenuChevron && !isCollapsed() && $parent.isLabelVisible()--\x3e<i class=\"od-CommandBarItem-down ms-Icon ms-Icon--ChevronDown\"></i>\x3c!--/ko--\x3e</div>\x3c!--ko if: $data.inputType() === ActionInputType.htmlFileUpload--\x3e<div class=CommandBarItem-uploadInput data-bind=\"automation: 'fileInput', fileInput: { isFolderUpload: false, onInputChange: onInputChange, css: 'CommandBarItem-fileInput'}\"></div>\x3c!--/ko--\x3e\x3c!--ko if: $data.inputType() === ActionInputType.folderUpload--\x3e<div class=CommandBarItem-uploadInput data-bind=\"automation: 'fileInput', fileInput: { isFolderUpload: true, onInputChange: onInputChange, css: 'CommandBarItem-folderInput'}\"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: children().length && isOpen() && !isClipped()--\x3e\x3c!--ko if: !$component.useReactContextualMenu--\x3e<div data-bind=\"component: { name: 'ms-contextual-menu', params: { items: children, isOpen: isOpen, alignment: menuAlignment, offset: menuOffset, isBeakVisible: isMenuBeakVisible, focused: menuFocus, hasExplicitAlignment: true, allowVerticalMenuNudging: false, } }\"></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.useReactContextualMenu--\x3e<div data-bind=\"component: { name: 'ms-contextual-menu', params: { items: children, isOpen: isOpen, alignment: menuAlignment, offset: menuOffset, isBeakVisible: isMenuBeakVisible, focused: menuFocus, hasExplicitAlignment: true, allowVerticalMenuNudging: false, target: $element.parentElement, anchorElement: $element } }\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: $component.hasPayload--\x3e<div class=CommandBarItem-payload data-bind=\"component: { name: 'ms-anchor-overlay', params: { alignment: menuAlignment, offset: menuOffset, hasExplicitAlignment: true, allowMenuNudging: true, trigger: layoutChanged, enableRecoverFocusBinding: enableRecoverFocusBinding } }\">\x3c!--ko if: announcePayload--\x3e\x3c!--ko with: payload--\x3e<div role=alert aria-live=assertive class=CommandBarItem-payloadContent data-bind=\"control: $data\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !announcePayload--\x3e\x3c!--ko with: payload--\x3e<div class=CommandBarItem-payloadContent data-bind=\"control: $data\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e"});define("odsp-next/controls/commandBarItem/CommandBarItem.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.CommandBarItem{display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:40px;box-sizing:border-box;outline:0;vertical-align:top}[dir=ltr] .CommandBarItem{margin-right:8px}[dir=rtl] .CommandBarItem{margin-left:8px}.sm .CommandBarItem{height:44px}@media screen and (-ms-high-contrast:active){.CommandBarItem{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";height:38px;outline:0}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:38px;outline:0}}.CommandBarItem.od-Command--Word{background-color:#2b579a;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--Excel{background-color:#217346;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--PowerPoint{background-color:#d24726;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.od-Command--Excel.is-toggled,.CommandBarItem.od-Command--Excel.is-toggled:hover,.CommandBarItem.od-Command--Excel:hover,.CommandBarItem.od-Command--PDF.is-toggled,.CommandBarItem.od-Command--PDF.is-toggled:hover,.CommandBarItem.od-Command--PDF:hover,.CommandBarItem.od-Command--PowerPoint.is-toggled,.CommandBarItem.od-Command--PowerPoint.is-toggled:hover,.CommandBarItem.od-Command--PowerPoint:hover,.CommandBarItem.od-Command--Word.is-toggled,.CommandBarItem.od-Command--Word.is-toggled:hover,.CommandBarItem.od-Command--Word:hover{background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.is-hidden{display:none}.CommandBarItem.is-disabled:hover{background-color:transparent}.CommandBarItem.is-disabled .CommandBarItem-link{cursor:default}.CommandBarItem.is-disabled.is-disabled-invisible{visibility:hidden}.CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast:active){.CommandBarItem:hover{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem:hover{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.CommandBarItem.is-toggled{background-color:"},{theme:"cmdbarSelected",defaultValue:"#DADADA"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}@media screen and (-ms-high-contrast:active){.CommandBarItem.is-toggled{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem.is-toggled{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.CommandBarItem.is-toggled:hover{background-color:"},{theme:"cmdbarSelectedHover",defaultValue:"#D0D0D0"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}@media screen and (-ms-high-contrast:active){.CommandBarItem.is-toggled:hover{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.CommandBarItem.is-toggled:hover{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-theme--darkTransparent .CommandBarItem{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-theme--darkTransparent .CommandBarItem:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:#666}.od-theme--darkTransparent .CommandBarItem.is-toggled{background-color:#666}.od-theme--darkTransparent .CommandBarItem.is-toggled:hover{background-color:rgba(102,102,102,.6)}.od-theme--darkTransparent .CommandBarItem .ms-Icon--progress::before{-webkit-filter:brightness(0) invert(1);filter:brightness(0) invert(1)}.od-theme--darkTransparent .CommandBarItem.is-disabled:hover{background-color:transparent}.CommandBarItem .CommandBarItem-icon{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-theme--darkTransparent .CommandBarItem .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon,[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon,[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon,[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon,[dir=ltr] .xxxxlg .CommandBarItem .CommandBarItem-icon{padding-right:8px}[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon,[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon,[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon,[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon,[dir=rtl] .xxxxlg .CommandBarItem .CommandBarItem-icon{padding-left:8px}.CommandBarItem .CommandBarItem-icon .ms-Icon{vertical-align:top;margin-top:4px;line-height:16px}.md .CommandBarItem .CommandBarItem-icon .ms-Icon,.sm .CommandBarItem .CommandBarItem-icon .ms-Icon{font-size:20px;margin-top:0;line-height:20px}.CommandBarItem .CommandBarItem-icon .ms-Icon--More{font-size:18px}.lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,.xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,.xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,.xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,.xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel{margin-top:4px}[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=ltr] .xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=ltr] .xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload{margin-right:-4px}[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload,[dir=rtl] .xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Download,[dir=rtl] .xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Upload{margin-left:-4px}[dir=ltr] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=ltr] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=ltr] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=ltr] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=ltr] .xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete{margin-right:-3px}[dir=rtl] .lg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=rtl] .xlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=rtl] .xxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=rtl] .xxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete,[dir=rtl] .xxxxlg .CommandBarItem .CommandBarItem-icon .ms-Icon--Delete{margin-left:-3px}.CommandBarItem .CommandBarItem-icon .ms-Icon--progress{margin-left:8px}.CommandBarItem .CommandBarItem-icon .ms-Icon--progress:before{display:inline-block}.CommandBarItem .CommandBarItem-icon .ms-Icon--progress.is-active:before{animation:none;animation:rotate-progress 1.1s infinite linear}@keyframes rotate-progress{from{transform:rotate(0)}to{transform:rotate(360deg)}}.CommandBarItem .CommandBarItem-icon .ms-Icon--print{width:17px}.CommandBarItem .CommandBarItem-icon .ms-Icon--custom{vertical-align:middle}.md .CommandBarItem,.sm .CommandBarItem{height:44px}[dir=ltr] .lg .CommandBarItem:last-of-type,[dir=ltr] .md .CommandBarItem:last-of-type,[dir=ltr] .sm .CommandBarItem:last-of-type{margin-right:0}[dir=rtl] .lg .CommandBarItem:last-of-type,[dir=rtl] .md .CommandBarItem:last-of-type,[dir=rtl] .sm .CommandBarItem:last-of-type{margin-left:0}.lg .CommandBarItem.icon-only .CommandBarItem-link,.xlg .CommandBarItem.icon-only .CommandBarItem-link,.xxlg .CommandBarItem.icon-only .CommandBarItem-link,.xxxlg .CommandBarItem.icon-only .CommandBarItem-link,.xxxxlg .CommandBarItem.icon-only .CommandBarItem-link{padding:8px 6px 10px}[dir=ltr] .lg .CommandBarItem.icon-only .ms-Icon,[dir=ltr] .xlg .CommandBarItem.icon-only .ms-Icon,[dir=ltr] .xxlg .CommandBarItem.icon-only .ms-Icon,[dir=ltr] .xxxlg .CommandBarItem.icon-only .ms-Icon,[dir=ltr] .xxxxlg .CommandBarItem.icon-only .ms-Icon{padding-left:8px}[dir=rtl] .lg .CommandBarItem.icon-only .ms-Icon,[dir=rtl] .xlg .CommandBarItem.icon-only .ms-Icon,[dir=rtl] .xxlg .CommandBarItem.icon-only .ms-Icon,[dir=rtl] .xxxlg .CommandBarItem.icon-only .ms-Icon,[dir=rtl] .xxxxlg .CommandBarItem.icon-only .ms-Icon{padding-right:8px}.CommandBarItem.icon-only .ms-Icon--GlobalNavButton{font-size:20px}[dir=ltr] .CommandBarItem.icon-only .ms-Icon--GlobalNavButton{padding-right:2px}[dir=rtl] .CommandBarItem.icon-only .ms-Icon--GlobalNavButton{padding-left:2px}[dir=ltr] .lg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=ltr] .xlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=ltr] .xxlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=ltr] .xxxlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=ltr] .xxxxlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton{padding-left:9px}[dir=rtl] .lg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=rtl] .xlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=rtl] .xxlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=rtl] .xxxlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton,[dir=rtl] .xxxxlg .CommandBarItem.icon-only .ms-Icon--GlobalNavButton{padding-right:9px}.CommandBarItem .od-CommandBarItem-down{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od--hasSelection .CommandBarItem{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od--hasSelection .CommandBarItem:hover{background-color:"},{theme:"cmdbarSelected",defaultValue:"#DADADA"},{rawString:"}.od--hasSelection .CommandBarItem.is-toggled{background-color:"},{theme:"cmdbarSelectedHover",defaultValue:"#D0D0D0"},{rawString:"}.od--hasSelection .CommandBarItem.is-toggled:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-theme--darkTransparent .od--hasSelection .CommandBarItem{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-theme--darkTransparent .od--hasSelection .CommandBarItem.is-focused,.od-theme--darkTransparent .od--hasSelection .CommandBarItem.is-selected,.od-theme--darkTransparent .od--hasSelection .CommandBarItem.is-toggled,.od-theme--darkTransparent .od--hasSelection .CommandBarItem:hover{background-color:rgba(102,102,102,.6)}.od--hasSelection .CommandBarItem .od-CommandBarItem-down{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[is-flipped].CommandBarItem-icon{clear:both;padding:1px 0 0 8px}html[dir=ltr] [is-flipped].CommandBarItem-icon{float:right}html[dir=rtl] [is-flipped].CommandBarItem-icon{float:left}html[dir=rtl] [is-flipped].CommandBarItem-icon{padding:1px 8px 0 0}.md [is-flipped].CommandBarItem-icon,.sm [is-flipped].CommandBarItem-icon{padding-top:0}[is-flipped].CommandBarItem-commandText{padding-top:2px}[dir=ltr] [is-flipped].CommandBarItem-commandText{margin-left:0}[dir=rtl] [is-flipped].CommandBarItem-commandText{margin-right:0}html[dir=ltr] [is-flipped].CommandBarItem-commandText{float:right}html[dir=rtl] [is-flipped].CommandBarItem-commandText{float:left}.od-focus--enabled .CommandBarItem.is-focused:focus .CommandBarItem-link:before{content:'';border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";margin:4px;position:absolute;top:1px;left:1px;right:1px;bottom:1px}.od--hasSelection .od-focus--enabled .CommandBarItem.is-focused:focus .CommandBarItem-link:before{border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-focus--enabled .CommandBarItem.is-focused.icon-only:focus .CommandBarItem-link:before,.od-focus--enabled.md .CommandBarItem.is-focused:focus .CommandBarItem-link:before,.od-focus--enabled.sm .CommandBarItem.is-focused:focus .CommandBarItem-link:before{width:72%}.CommandBarItem-linkWrapper{position:relative}.CommandBarItem-link{cursor:pointer;min-width:22px;text-align:center;position:relative;display:table}.CommandBarItem-link .od-CommandBarItem-down{vertical-align:top;padding-bottom:3px;margin-top:6px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .CommandBarItem-link .od-CommandBarItem-down{padding-left:8px}[dir=rtl] .CommandBarItem-link .od-CommandBarItem-down{padding-right:8px}.CommandBarItem-link .od-CommandBarItem-down:before{height:10px;line-height:16px}.od-theme--darkTransparent .CommandBarItem-link .od-CommandBarItem-down:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.md .CommandBarItem-link .od-CommandBarItem-down,.sm .CommandBarItem-link .od-CommandBarItem-down{margin-top:4px;padding-bottom:0}.md .CommandBarItem-link,.sm .CommandBarItem-link{padding:12px 9px}.lg .CommandBarItem-link,.xlg .CommandBarItem-link,.xxlg .CommandBarItem-link,.xxxlg .CommandBarItem-link,.xxxxlg .CommandBarItem-link{padding:8px}[dir=ltr] .lg .CommandBarItem.icon-only .CommandBarItem-link,[dir=ltr] .xlg .CommandBarItem.icon-only .CommandBarItem-link,[dir=ltr] .xxlg .CommandBarItem.icon-only .CommandBarItem-link,[dir=ltr] .xxxlg .CommandBarItem.icon-only .CommandBarItem-link,[dir=ltr] .xxxxlg .CommandBarItem.icon-only .CommandBarItem-link{padding-right:6px}[dir=rtl] .lg .CommandBarItem.icon-only .CommandBarItem-link,[dir=rtl] .xlg .CommandBarItem.icon-only .CommandBarItem-link,[dir=rtl] .xxlg .CommandBarItem.icon-only .CommandBarItem-link,[dir=rtl] .xxxlg .CommandBarItem.icon-only .CommandBarItem-link,[dir=rtl] .xxxxlg .CommandBarItem.icon-only .CommandBarItem-link{padding-left:6px}[dir=ltr] .CommandBarItem.icon-only .CommandBarItem-link .CommandBarItem-icon{margin-right:0}[dir=rtl] .CommandBarItem.icon-only .CommandBarItem-link .CommandBarItem-icon{margin-left:0}.CommandBarItem-commandText{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;font-weight:400;color:inherit}.CommandBarItem-commandText.CommandBarItem-commandText--isStrong{font-weight:600}.md .CommandBarItem-commandText,.sm .CommandBarItem-commandText{vertical-align:top;padding-top:0;line-height:20px}[dir=ltr] .md .CommandBarItem-commandText,[dir=ltr] .sm .CommandBarItem-commandText{padding-left:8px}[dir=rtl] .md .CommandBarItem-commandText,[dir=rtl] .sm .CommandBarItem-commandText{padding-right:8px}.od-Browser--edge .CommandBarItem .ms-Icon--SortLines,.od-Browser--ie .CommandBarItem .ms-Icon--SortLines{margin-top:4px}.od-Browser--edge [is-flipped].CommandBarItem-commandText,.od-Browser--ie [is-flipped].CommandBarItem-commandText{line-height:normal}.CommandBarItem-uploadInput{position:absolute;height:40px;top:0;left:0;right:0;opacity:.0001;cursor:pointer;overflow:hidden;z-index:2}.sm .CommandBarItem-uploadInput{height:44px}.CommandBarItem-uploadInput input{position:absolute;top:0;font-size:200px;height:100px;cursor:pointer;margin:0;padding:0}[dir=ltr] .CommandBarItem-uploadInput input{right:0}[dir=rtl] .CommandBarItem-uploadInput input{left:0}.CommandBarItem-icon .ms-Icon--ExcelLogo:before{color:#217346}.od-theme--darkTransparent .CommandBarItem-icon .ms-Icon--ExcelLogo:before{color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem-icon .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-theme--darkTransparent .CommandBarItem-icon .ms-Icon--OneNoteLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem-icon .ms-Icon--PowerPointLogo:before{color:#d24726}.od-theme--darkTransparent .CommandBarItem-icon .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem-icon .ms-Icon--WordLogo:before{color:#2b579a}.od-theme--darkTransparent .CommandBarItem-icon .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem-icon .ms-Icon--PowerApps2Logo:before{color:#742774}.od-theme--darkTransparent .CommandBarItem-icon .ms-Icon--PowerApps2Logo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem-icon .ms-Icon--More:before{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-theme--darkTransparent .CommandBarItem-icon .ms-Icon--More:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.CommandBarItem.is-pivot.is-current-view,.CommandBarItem.is-pivot.is-toggled,.CommandBarItem.is-pivot:active,.CommandBarItem.is-pivot:hover{border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-theme--darkTransparent .CommandBarItem.is-pivot.is-current-view,.od-theme--darkTransparent .CommandBarItem.is-pivot.is-toggled,.od-theme--darkTransparent .CommandBarItem.is-pivot:active,.od-theme--darkTransparent .CommandBarItem.is-pivot:hover{border-bottom:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.CommandBarItem.is-pivot.is-current-view .CommandBarItem-commandText,.CommandBarItem.is-pivot.is-toggled .CommandBarItem-commandText{font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif}[dir=ltr] .CommandBarItem.is-pivot.is-last-pivot{margin-right:24px}[dir=rtl] .CommandBarItem.is-pivot.is-last-pivot{margin-left:24px}.od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel{color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .lg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=ltr] .xlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=ltr] .xxlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=ltr] .xxxlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=ltr] .xxxxlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel{padding-left:8px}[dir=rtl] .lg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=rtl] .xlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=rtl] .xxlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=rtl] .xxxlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel,[dir=rtl] .xxxxlg .od-Panel .CommandBarItem .CommandBarItem-icon .ms-Icon--Cancel{padding-right:8px}"}])});define("odsp-next/controls/overlays/anchor/AnchorOverlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AnchorOverlayViewModel","./AnchorOverlay.html","./AnchorOverlay.css"],function(e,t,n,i){"use strict";return n.registerComponent({tagName:"ms-anchor-overlay",template:e("./AnchorOverlay.html"),viewModel:i.default,synchronous:!0})});define("odsp-next/controls/overlays/anchor/AnchorOverlayViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/beakAdorner/BeakAdornerBinding","../../../bindings/measure/MeasureBinding","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/math/Rectangle","../../../bindings/contextMenu/ContextMenuAlignment","../../../base/ColorVariation","../Overlay","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({host:r,beakAdorner:a,measure:s,offset:l.default,recoverFocus:f.default,preserveFocus:m.default});var i=t.offset,o=void 0===i?n.createObservable(new l.default(0,a.size/2+4)):i,c=t.isBeakVisible,h=void 0===c?n.createObservable(!0):c,g=t.anchorElement,v=t.beakColorVariation,b=t.left,y=void 0===b?n.createObservable(""):b,x=t.top,_=void 0===x?n.createObservable(""):x,w=t.trigger,I=void 0===w?n.createObservable():w,C=t.enableRecoverFocusBinding,k=void 0!==C&&C;n.isBeakVisible=h;n.isBeakCurrentlyVisible=n.createPureComputed(n._computeIsBeakCurrentlyVisible);n.isBubble=!!t.isBubble;n.isAnimationComplete=n.createObservable(!n.isBubble);n.beak=n.createObservable();n.overlayTagName=p.tagName;n.renderedTemplate=n.createObservable();n._trigger=I;n._hasExplicitAlignment=!!t.hasExplicitAlignment;n._allowMenuNudging=!!t.allowMenuNudging;n.clientRect=n.createObservable(new u.default(0,0,0,0));n._offset=o;n.anchorElement=g;n.beakColorVariation=v;n._assignAlignment({alignment:t.alignment,hasExplicitAlignment:!!t.hasExplicitAlignment});n.colorVariationEnum=d.default;n.isScrollable=n.createObservable(!1);n._left=y;n._top=_;n.style=n.createObservable({});n.contentStyle=n.createObservable({});n.createComputed(n._computeStyles);n.measureTrigger=n.createComputed(function(){n.renderedTemplate();n._trigger();return{}});n.overlayParams={alignToParent:!0};n.enableRecoverFocusBinding=k;return n}n.__extends(t,e);t.prototype.onAnimationComplete=function(){this.isAnimationComplete(!0)};t.prototype._assignAlignment=function(e){e.alignment?"string"==typeof e.alignment?this._alignment=this.createObservable(c[e.alignment]):i.isObservable(e.alignment)?this._alignment=e.alignment:this._alignment=this.createObservable(e.alignment):this._alignment=this.createObservable(c.Left|c.Top)};t.prototype._computeStyles=function(){var e=new l.default(0,0),t=new u.default(0,0,document.body.clientWidth,document.body.clientHeight),n="",i="",o=!1;t=t.inflate(-4,-4);if(this.renderedTemplate()&&this.clientRect()){var r=this.clientRect().translate(-parseFloat(this.style().marginLeft),-parseFloat(this.style().marginTop));this._trigger();e=e.add(this._offset());var a=this._alignment();this._hasExplicitAlignment||(a=this._determineBestFitAlignment(r,a));e=this._transformMenuCoordinate(e,r,a);var s=r.translate(e),c=t.contains(s),d=t.contains(new l.default(s.x+s.width,s.y));if(!c||!d){var p=this._allowMenuNudging?s.nudge(t):s;if(!t.contains(p)){n=(p=p.clip(t)).width+"px";i=p.height+"px";o=!0}e=e.add(new l.default(p.x-s.x,p.y-s.y))}}this.style({left:this._left(),top:this._top(),marginLeft:Math.floor(e.x)+"px",marginTop:Math.floor(e.y)+"px"});this.contentStyle({width:n,height:i});this.isScrollable(o);this.beak({})};t.prototype._determineBestFitAlignment=function(e,t){var n=t,i=e.getPoint();if(e.width<=document.body.clientWidth&&e.height<=document.body.clientHeight){var o=this._transformMenuCoordinate(i,e,n);(o.x<0||o.x+e.width>document.body.clientWidth)&&(n^=c.Right);(o.y<0||o.y+e.height>document.body.clientHeight)&&(n^=c.Bottom)}return n};t.prototype._transformMenuCoordinate=function(e,t,n){var i=new l.default(e.x,e.y);n&c.Right?i.x-=t.width:n&c.Center&&(i.x-=t.width/2);n&c.Bottom?i.y-=t.height:n&c.VerticalCenter&&(i.y-=t.height/2);return i};t.prototype._computeIsBeakCurrentlyVisible=function(){return this.isAnimationComplete()&&this.isBeakVisible()};return t}(o.default);t.default=h});define("odsp-next/bindings/beakAdorner/BeakAdornerBinding",["require","exports","knockout","@ms/odsp-utilities/lib/domUtils/DomUtils","../../utilities/dom/Dom","@ms/odsp-utilities/lib/locale/Locale","../../base/ColorVariation","./BeakAdorner.css"],function(e,t,n,i,o,r,a){"use strict";var s=function(){function e(){}e.init=function(t,s){var l,u=n.utils.unwrapObservable(s())||{},c=n.utils.unwrapObservable(u.anchorElement),d=u.isVisible||n.observable(!0),p=u.beakColorVariation;(c||(c=o.findAncestor(t,"beak-anchor")))&&n.computed(function(){n.utils.unwrapObservable(u.trigger);l&&n.removeNode(l);var o=i.default.calculateRect(t),s=i.default.calculateRect(c),m=e.size,f=m/2,h=e.determineBeakDirection(o,s),g=0;if(0===h||1===h){g=s.getCenter().y-o.getTop();g=e.clamp(g,2*m,o.height-2*m)}else{g=r.default.isRightToLeft?o.getRight()-s.getCenter().x:s.getCenter().x-o.getLeft();g=e.clamp(g,2*m,o.width-2*m)}var v,b;switch(h){case 0:b=-f;v=g-m;break;case 1:b=o.width-m-f;v=g-m;break;case 2:b=g-m;v=-f;break;case 3:b=g-m;v=o.height-m-f}(l=document.createElement("div")).className="Beak-container";var y=document.createElement("div");y.className="Beak-arrow";y.style.top=v+"px";r.default.isRightToLeft?y.style.right=b+"px":y.style.left=b+"px";y.className+=p&&p===a.default.themePrimary?" Beak--themePrimary":" Beak--white";l.appendChild(y);t.insertBefore(l,t.firstChild);l.style.display=d()?"":"none"},null,{disposeWhenNodeIsRemoved:t})};e.clamp=function(e,t,n){return Math.max(Math.min(e,n),t)};e.determineBeakDirection=function(e,t){var n=e.getCenter(),i=t.getCenter();return i.y>=e.getTop()&&i.y<e.getBottom()?i.x<n.x?0:1:i.y<n.y?2:3};return e}();s.after=["component"];s.size=10;return s});define("odsp-next/utilities/dom/Dom",["require","exports","@uifabric/utilities/lib/dom","@ms/odsp-utilities/lib/domUtils/DomUtils"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.findAncestor=function(e,t,o){void 0===o&&(o=!0);for(;e&&e!==document.body;){if(i.default.hasClass(e,t))return e;e=n.getParent(e,o)}return null}});define("odsp-next/base/ColorVariation",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.white=1]="white";e[e.themePrimary=2]="themePrimary"}(n||(n={}));t.default=n});define("odsp-next/bindings/beakAdorner/BeakAdorner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".Beak-container{position:absolute}.Beak-container .Beak-arrow.Beak--themePrimary{background:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.Beak-container .Beak-arrow.Beak--white{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.Beak-arrow{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:20px;position:relative;-ms-transform:rotate(45deg);transform:rotate(45deg);height:20px}"}])});define("odsp-next/bindings/measure/MeasureBinding",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/domUtils/DomUtils","../BaseBinding"],function(e,t,n,i,o,r){"use strict";return function(e){function t(t){var n=e.call(this,t)||this,o=t.valueAccessor();if(o){n._measureCallback=o.measure||o;n._parentRelative=o.parentRelative}n.createComputed(function(){if(n._measureCallback){i.utils.unwrapObservable(o.trigger);o.async?n.async.setImmediate(function(){n._updateMeasurement()}):n._updateMeasurement()}});return n}n.__extends(t,e);t.prototype._updateMeasurement=function(){var e=o.default.calculateRect(this.element);if(this._parentRelative&&this.element.parentElement){var t=o.default.calculateRect(this.element.parentElement);e=e.translate(t.getPoint().negate())}this._measureCallback(e)};return t}(r)});define("odsp-next/bindings/contextMenu/ContextMenuAlignment",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.Left=0]="Left";e[e.Top=0]="Top";e[e.Right=1]="Right";e[e.Bottom=2]="Bottom";e[e.Center=4]="Center";e[e.VerticalCenter=8]="VerticalCenter";e[e.BottomCenter=6]="BottomCenter";e[e.BottomRight=3]="BottomRight";e[e.RightVerticalCenter=9]="RightVerticalCenter"}(n||(n={}));return n});define("odsp-next/controls/overlays/anchor/AnchorOverlay.html",[],function(){return"\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: overlayParams\r\n}--\x3e<div class=AnchorOverlay data-bind=\"beakAdorner: { trigger: beak, isVisible: isBeakCurrentlyVisible, anchorElement: anchorElement, beakColorVariation: beakColorVariation}, style: style, measure: { measure: clientRect, trigger: measureTrigger }, css: { 'AnchorOverlay--bubble' : isBubble }, event: { animationend: onAnimationComplete }\"><div class=AnchorOverlay-content tabindex=-1 data-bind=\"style: contentStyle, css: { 'is-scrollable': isScrollable, 'AnchorOverlay-content--themePrimary': beakColorVariation === colorVariationEnum.themePrimary }, preserveFocus, recoverFocus: { isEnabled: enableRecoverFocusBinding }, host: { afterRender: $component.renderedTemplate }\"></div></div>\x3c!--/ko--\x3e"});define("odsp-next/controls/overlays/anchor/AnchorOverlay.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.AnchorOverlay{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:block;position:absolute;box-shadow:0 0 5px 0 '},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.AnchorOverlay-content{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative;outline:0}.AnchorOverlay-content.AnchorOverlay-content--themePrimary{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.od-OverlayHost-overlay .AnchorOverlay--bubble{-ms-transform:scaleY(0);transform:scaleY(0)}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .AnchorOverlay--bubble{animation:AnchorOverlayPartyAnimationOne 2s linear both}@keyframes AnchorOverlayPartyAnimationOne{0%{transform:matrix3d(1,0,0,0,0,.1,0,0,0,0,1,0,0,0,0,1);opacity:0;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9)}2.08%{transform:matrix3d(1,0,0,0,0,.277,0,0,0,0,1,0,0,-20.376,0,1)}4.16%{transform:matrix3d(1,0,0,0,0,.485,0,0,0,0,1,0,0,-26.476,0,1)}4.7%{transform:matrix3d(1,0,0,0,0,.53,0,0,0,0,1,0,0,-26.254,0,1)}8.25%{transform:matrix3d(1,0,0,0,0,.748,0,0,0,0,1,0,0,-14.165,0,1)}9.41%{transform:matrix3d(1,0,0,0,0,.797,0,0,0,0,1,0,0,-8.36,0,1)}12.41%{transform:matrix3d(1,0,0,0,0,.888,0,0,0,0,1,0,0,5.689,0,1)}14.11%{transform:matrix3d(1,0,0,0,0,.921,0,0,0,0,1,0,0,11.685,0,1)}16.5%{transform:matrix3d(1,0,0,0,0,.954,0,0,0,0,1,0,0,16.912,0,1)}18.72%{transform:matrix3d(1,0,0,0,0,.974,0,0,0,0,1,0,0,18.592,0,1)}24.32%{transform:matrix3d(1,0,0,0,0,.997,0,0,0,0,1,0,0,13.503,0,1)}24.74%{transform:matrix3d(1,0,0,0,0,.997,0,0,0,0,1,0,0,12.828,0,1)}29.93%{transform:matrix3d(1,0,0,0,0,1.002,0,0,0,0,1,0,0,4.292,0,1)}32.99%{transform:matrix3d(1,0,0,0,0,1.002,0,0,0,0,1,0,0,.354,0,1)}35.54%{transform:matrix3d(1,0,0,0,0,1.002,0,0,0,0,1,0,0,-1.856,0,1)}41.04%{transform:matrix3d(1,0,0,0,0,1.001,0,0,0,0,1,0,0,-3.531,0,1);opacity:1}52.15%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,-.791,0,1)}63.26%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,.651,0,1)}80%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,-.064,0,1)}85.49%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,-.12,0,1)}100%{transform:matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}}"}])});define("odsp-next/controls/icon/glyph/IconGlyph",["require","exports","./IconGlyphViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IconGlyph.html","./IconGlyph.css"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"od-icon-glyph",template:e("./IconGlyph.html"),viewModel:n,synchronous:!0})});define("odsp-next/controls/icon/glyph/IconGlyphViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout"],function(e,t,n,i,o){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.icon=o.isObservable(t.icon)?t.icon:o.observable(t.icon);n.badge=o.isObservable(t.badge)?t.badge:o.observable(t.badge);n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""});n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""});return n}n.__extends(t,e);return t}(i.default)});define("odsp-next/controls/icon/glyph/IconGlyph.html",[],function(){return'<i class="od-IconGlyph ms-Icon" data-bind="class: iconClasses, css: { \'od-IconGlyph--badged\': badge, \'od-IconGlyph--visible\': icon }, with: badge"><i class="od-IconGlyph-badge ms-Icon ms-Icon--badge" data-bind="class: $component.badgeClasses"></i></i>'});define("odsp-next/controls/icon/glyph/IconGlyph.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--badge.ms-Icon--StatusErrorFull{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--badge.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"}])});define("odsp-next/controls/contextualMenu/ContextualMenu",["require","exports","./ContextualMenuViewModel","knockout","../reactHost/ReactHost","../../utilities/features/Features","./ContextualMenu.html","./ContextualMenu.css","./react/ReactContextualMenu.html"],function(e,t,n,i,o,r){"use strict";var a=r.isFeatureEnabled(r.UseReactContextualMenu)?o.createComponent("ms-contextual-menu","odsp-next/controls/contextualMenu/react/ReactContextualMenu"):{tagName:"ms-contextual-menu",template:e("./ContextualMenu.html"),viewModel:n};r.isFeatureEnabled(r.UseReactContextualMenu)&&(a.template=e("./react/ReactContextualMenu.html"));i.components.isRegistered(a.tagName)||i.components.register(a.tagName,a);return a});define("odsp-next/controls/contextualMenu/ContextualMenuViewModel",["require","exports","tslib","knockout","../commands/CommandViewModel","@ms/odsp-shared/lib/base/ViewModel","../../bindings/measure/MeasureBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../bindings/beakAdorner/BeakAdornerBinding","../../bindings/contextMenu/ContextMenuAlignment","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-utilities/lib/locale/Locale","../overlays/Overlay","../../bindings/focus/PreserveFocusBinding"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h){"use strict";function g(e,t,n){var i=t,o=e.getPoint();if(e.width<=n.width&&e.height<=n.height){var r=v(o,e,i);(r.x<n.x||r.x+e.width>n.getRight())&&(i^=c.Right);(r.y<n.y||r.y+e.height>n.getBottom())&&(i^=c.Bottom)}return i}function v(e,t,n){var i=new d.default(e.x,e.y);n&c.Right?i.x-=t.width:n&c.Center&&(i.x-=t.width/2);m.default.isRightToLeft&&(i.x=-i.x);n&c.Bottom?i.y-=t.height:n&c.VerticalCenter&&(i.y-=t.height/2);return i}var b=new d.default(1,-1),y=16;return function(e){function t(n){var r=e.call(this,n)||this;r.overlayTagName=f.tagName;r.addBindingHandlers({selection:l.default,measure:a,keyboard:s,beakAdorner:u,preserveFocus:h.default});r.anchorElement=n.anchorElement;r.shouldHideIcons=!!n.hideIcons;var x=i.isObservable(n.items)?n.items:i.observableArray(n.items);r.items=r.addDisposable(x.filter(function(e){return e.isVisible()}));r.isOpen=n.isOpen||i.observable(!0);r.isSubMenu=n.isSubMenu||!1;r.isBeakVisible=n.isBeakVisible||i.observable(!0);r.isScrollable=i.observable(!1);r.offset=n.offset||i.observable(new d.default);r.menuRect=i.observable();r.scrollOffset=i.observable(0);r._left=n.left||"auto";r._top=n.top||"auto";r.width=i.observable("auto");r.height=i.observable("auto");var _=n.allowHorizontalMenuNudging,w=void 0===_||_,I=n.allowVerticalMenuNudging,C=void 0===I||I,k=n.mouseOverTrigger,S=void 0===k?r.createObservable(!1):k;r._allowHorizontalMenuNudging=w;r._allowVerticalMenuNudging=C;r._hasExplicitAlignment=!!n.alignment;r.isActive=i.observable(!1);r.focusedItem=i.observable();r.selectedItems=i.observableArray();r.subMenuItems=i.observable(i.observableArray());r.subMenuIsOpen=i.observable(!1);r.subMenuIsBeakVisible=i.observable(!1);r.subMenuOffset=i.observable(new d.default);r._target=n.target;r._contextualMenuLaunchEvent=n.launchEvent;r.launchedViaKeyboard=!!n.fromKeyboardEvent;r._bounds=n.bounds;r.displayInputElements=i.observable(!1);r._ignoreFirstContextMenuEvent=n.fromKeyboardEvent;r._ignoreMouseOut=n.fromKeyboardEvent;r._mouseOverTrigger=S;n.alignment?"string"==typeof n.alignment?r.alignment=i.observable(c[n.alignment]):i.isObservable(n.alignment)?r.alignment=n.alignment:r.alignment=i.observable(n.alignment):r.alignment=i.observable(c.Left|c.Top);var T=new(r.managed(o))({children:r.items});r.addDisposable(r.items.map({mappingWithDisposeCallback:function(e){e.parentCommand=T;return{mappedValue:e,dispose:function(){e.parentCommand=null}}}}));T.isOpen(!0);r.createComputed(function(){T.isOpen()||t.activeMenu&&t.activeMenu.isOpen(!1)});r.computedOffset=r.createComputed(function(){var e=new d.default(0,0);r._finalBounds=r._bounds||new p.default(0,0,document.body.clientWidth,document.body.clientHeight);var t="auto",n="auto",o=!1;i.utils.unwrapObservable(r.items);r._finalBounds=r._finalBounds.inflate(-y,-y);if(r.menuRect()){e=e.add(r.offset());var a=r.alignment();r._hasExplicitAlignment||(a=g(r.menuRect().translate(e),a,r._finalBounds));e=v(e,r.menuRect(),a);var s=r.menuRect().translate(e);if(!r._finalBounds.contains(s)){var l=s;if(r._allowHorizontalMenuNudging||r._allowVerticalMenuNudging){var u=s.nudge(r._finalBounds);l=new p.default(r._allowHorizontalMenuNudging?u.x:s.x,r._allowVerticalMenuNudging?u.y:s.y,s.width,s.height)}if(!r._finalBounds.contains(l)){t=(l=l.clip(r._finalBounds)).width+"px";n=l.height+"px";o=!0}e=e.add(new d.default(l.x-s.x,l.y-s.y))}}r.width(t);r.height(n);r.isScrollable(o);return e});r.menuStyle=r.createPureComputed(function(){var e=r.computedOffset();return{transform:"translate("+e.x+"px,"+e.y+"px)",left:i.utils.unwrapObservable(r._left),top:i.utils.unwrapObservable(r._top)}});r.measurementReady=function(e){r.async.setImmediate(function(){return r.displayInputElements(!0)});r.menuRect(e)};r.scrolled=function(e,t){r._closeAnySubMenus();r.scrollOffset(t.target.scrollTop)};r.hasItemWithCheckbox=r.createComputed(function(){return r.items().some(function(e){return e.isVisible()&&e.isToggleable})});r.hasItemWithIcon=r.createComputed(function(){return!r.shouldHideIcons&&r.items().some(function(e){return e.isVisible()&&(Boolean(e.icon)&&Boolean(e.icon())||Boolean(e.iconUrl)&&Boolean(e.iconUrl()))})});r.createComputed(function(){if(r.isOpen()&&r.menuRect()){r.items.peek().forEach(function(e){e.isOpen(!1)});r.isActive(!0);var e=t.activeMenu;!r.isSubMenu&&e&&e.isOpen.peek()&&e.isOpen(!1);r.isSubMenu||(t.activeMenu=r)}else if(!r.isOpen()&&t.activeMenu===r){r._closeAnySubMenus();t.activeMenu=null}});r.addDisposable({dispose:function(){t.activeMenu===r&&(t.activeMenu=null);r._closeAnySubMenus()}});var P=r.createComputed(function(){for(var e=r.items(),t=0,n=e.length;t<n;t++){var i=e[t];if(i.isOpen())return i}return null});r.addDisposable(P.subscribe(function(e){if(e){r.subMenuItems(e.children);var t=r.menuRect().translate(r.offset()),n=e.bounds()||new p.default,i=new d.default(0,n.y-r.scrollOffset()+b.y);r.subMenuAlignment=c.Top;if(m.default.isRightToLeft){r.subMenuAlignment|=c.Right;i.x-=b.x}else if((r._finalBounds&&r._finalBounds.width-t.x-t.width-b.x)<t.width){r.subMenuAlignment|=c.Right;i.x-=b.x}else{r.subMenuAlignment|=c.Left;i.x+=t.width;i.x+=b.x}r.subMenuBounds=r._bounds;r.subMenuOffset(i);r.subMenuIsOpen(!0)}else r.subMenuIsOpen(!1)}));r.subscribe(r.focusedItem,function(e){e&&!e.hasVisibleChildren()&&e.hasDeferredChildren&&e.isOpen(!1)},!0);if(n.close){var E=n.close;r.subscribe(r.isOpen,function(e){e||E()})}return r}n.__extends(t,e);t.prototype.onEnter=function(e,t){this.launchedViaKeyboard=!0;var n=this.focusedItem();if(n){var i=t.target,o=i.getElementsByTagName("input");if(o&&o.length){o[0].click();t.stopPropagation();t.preventDefault()}else{for(var r,a=i.getElementsByClassName("od-ContextualMenu-item"),s=0;s<a.length&&(r=a[s]).textContent!==n.label();s++)r=null;if(r){r.click.apply(r);t.stopPropagation();t.preventDefault()}}}};t.prototype.onClick=function(e,t){e.targetCommand().hasVisibleOrDeferredChildren()||this.dismiss();e.onClick(e,this._contextualMenuLaunchEvent||t)};t.prototype.dismiss=function(){t.activeMenu&&t.activeMenu.isOpen(!1);this._target&&this._target.focus();return!1};t.prototype.itemHover=function(e){this.focusedItem(e);this.selectedItems([e])};t.prototype.onContextMenu=function(e,t){if(this._ignoreFirstContextMenuEvent){this._ignoreFirstContextMenuEvent=!1;return!1}return!0};t.prototype.itemLongHover=function(e){this.launchedViaKeyboard=!1;this._closeAnySubMenus();if(!e.isCollapsed()&&e.hasVisibleOrDeferredChildren()){e.callback&&e.callback();e.isOpen(!0)}};t.prototype.mouseOut=function(){if(this._ignoreMouseOut)this._ignoreMouseOut=!1;else{this.focusedItem(void 0);this.isActive(!0)}this._mouseOverTrigger(!1)};t.prototype.mouseOver=function(){this._mouseOverTrigger(!0)};t.prototype.navigateLeft=function(){m.default.isRightToLeft?this._navigateFar():this._navigateNear()};t.prototype.navigateRight=function(){this.launchedViaKeyboard=!0;m.default.isRightToLeft?this._navigateNear():this._navigateFar()};t.prototype._closeAnySubMenus=function(){this.items().forEach(function(e){e.isOpen(!1)})};t.prototype._navigateNear=function(){t.activeMenu?t.activeMenu.isOpen(!1):this.isOpen(!1)};t.prototype._navigateFar=function(){var e=this.focusedItem();e&&e.hasVisibleOrDeferredChildren()?e.isOpen(!0):this.isOpen(!1)};return t}(r.default)});define("odsp-next/controls/commands/CommandViewModel",["require","exports","tslib","./CommandState","@ms/odsp-shared/lib/base/ViewModel","../../bindings/beakAdorner/BeakAdornerBinding","../../bindings/dismiss/DismissBinding","../../bindings/element/ElementBinding","../../bindings/longHover/LongHoverBinding","../../bindings/measure/MeasureBinding","../../bindings/tooltip/TooltipBinding","../../bindings/raiseEventOnChange/RaiseEventOnChangeBinding","../../bindings/teachingBubble/TeachingBubbleBinding","../../resources/UtilityResourceKeys","../../utilities/icons/Icon","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","@ms/odsp-utilities/lib/math/Point","../../bindings/fileInput/FileInputBinding","@ms/odsp-shared/lib/base/ActionInputType","../../utilities/logging/LoggingContextHelper","../../bindings/component/ControlBinding","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b,y,x,_,w,I,C){"use strict";var k=function(e){function t(t,n){void 0===n&&(n={});var o=e.call(this,t,n)||this;o.ActionInputType=_.default;o._defaultMenuOffset=new y.default(0,r.size/2+4);o.addBindingHandlers({dismiss:a.default,raiseEventOnChange:d,measure:u,longHover:l,element:s,teachingBubble:p.default,fileInput:x.default,tooltip:c.default,control:I.default});var f=o,h=f.observables,g=f.resources,b=n.newFeatureExperienceEnabler,w=void 0===b?g&&g.consume(m.newFeatureExperienceEnabler.optional):b,k=n.engagement,S=void 0===k?g&&g.consume(v.resourceKey.optional):k,T=n.responsiveUI,P=void 0===T?g&&g.consume(C.resourceKey.optional):T;o._isOpenRequested=o.createObservable(!1);o.isActive=o.createObservable(!1);o.isToggled=o.createObservable(!1);o.focused=o.createObservable(!1);o.menuFocus=o.createObservable(!1);o.newFeatureExperienceAnchor=o.createObservable(null);o.fileInputElement=o.createObservable();var E=t.text,A=void 0===E?"":E,L=t.subtext,B=void 0===L?"":L,O=t.classSuffix,D=void 0===O?o.createObservable():O,M=t.collapsedText,R=void 0===M?o.createObservable():M,N=t.location,F=void 0===N?11:N,U=t.renderLabel,H=void 0===U?1:U,V=t.isCurrentView,K=void 0===V?null:V,j=t.hasIconOnly,q=void 0!==j&&j,z=t.positionIconRight,W=void 0!==z&&z,G=t.icon,$=t.iconUrl,X=t.keys,Y=void 0===X?[]:X,Q=t.isToggleable,J=void 0!==Q&&Q,Z=t.isHidden,ee=void 0===Z?o.createObservable():Z,te=t.isDisabled,ne=t.isInvisibleWhenDisabled,ie=void 0!==ne&&ne,oe=t.tooltip,re=void 0===oe?"":oe,ae=t.accessibleLabel,se=void 0===ae?"":ae,le=t.prependTextToAccessibleLabel,ue=void 0===le||le,ce=t.sectionAccessibleLabel,de=void 0===ce?"":ce,pe=t.role,me=void 0===pe?"":pe,fe=t.newFeatureAnchorName,he=t.teachingBubble,ge=t.iconBadge,ve=t.isPermanent,be=void 0!==ve&&ve,ye=t.state,xe=void 0===ye?o.createObservable(i.default.initialized):ye,_e=t.requiredChildren,we=void 0===_e?0:_e,Ie=t.collapseSingleChildCommands,Ce=void 0===Ie||Ie,ke=t.hasLineBreakBefore,Se=void 0!==ke&&ke,Te=t.hasLineBreakAfter,Pe=void 0!==Te&&Te,Ee=t.action,Ae=t.callback,Le=t.menuAlignment,Be=void 0===Le?o.createObservable(0):Le,Oe=t.menuOffset,De=void 0===Oe?o.createObservable(o._defaultMenuOffset):Oe,Me=t.isMenuBeakVisible,Re=void 0===Me?o.createObservable(!0):Me,Ne=t.payload,Fe=void 0===Ne?o.createObservable():Ne,Ue=t.payloadTimeout,He=void 0===Ue?4e3:Ue,Ve=t.autoDismissPayload,Ke=void 0!==Ve&&Ve,je=t.announcePayload,qe=void 0===je||je,ze=t.enableRecoverFocusBinding,We=void 0!==ze&&ze,Ge=t.engagementName,$e=t.experiment,Xe=t.isLastPivot,Ye=void 0!==Xe&&Xe,Qe=t.hasAnimation,Je=void 0!==Qe&&Qe,Ze=t.hidesMenuChevron,et=void 0!==Ze&&Ze,tt=t.children,nt=void 0===tt?o.observables.createArray():tt,it=t.isStrong,ot=void 0===it?o.createObservable(!1):it,rt=t.hasDeferredChildren,at=void 0!==rt&&rt,st=t.hasDynamicText,lt=void 0!==st&&st,ut=t.reportClickingTime;o.text=o.wrapObservable(A);o.subtext=o.wrapObservable(B);o.commandClass=o.wrapObservable(D);o.collapsedText=R;o.isLabelVisible=2===H?P.showLabels:h.create(1===H);o.isToggleable=J;o.location=F;o.isPermanent=o.wrapObservable(be);o.requiredChildren=we;o.collapseSingleChildCommands=Ce;o.hasLineBreakAfter=o.wrapObservable(Pe);o.hasLineBreakBefore=o.wrapObservable(Se);o.action=Ee;o.callback=Ae;o.hidesMenuChevron=et;o.isStrong=ot;o.isClipped=o.createObservable(!1);o.hasDynamicText=lt;o._reportClickingTime=ut;o._engagement=S;o.action&&o.action.inputType?o.inputType=o.createPureComputed(o._computeInputType):o.inputType=o.createObservable(_.default.none);var ct=o.wrapObservable(G);o.icon=o.createPureComputed(function(){return o.isCollapsed()?o.targetCommand().icon()||ct():ct()});var dt=o.wrapObservable($);o.iconUrl=o.createPureComputed(function(){return o.isCollapsed()?o.targetCommand().iconUrl()||dt():dt()});var pt=o.wrapObservable(ge);o.iconBadge=o.createPureComputed(function(){return o.isCollapsed()?o.targetCommand().iconBadge()||pt():pt()});o.tooltip=o.wrapObservable(re);o.accessibleLabel=o.wrapObservable(se);o.prependTextToAccessibleLabel=ue;o.sectionAccessibleLabel=o.wrapObservable(de);o.role=me||J?"menuitemcheckbox":"menuitem";fe&&w&&w.anchorToName(fe,function(e){o.newFeatureExperienceAnchor(e)});o.teachingBubble=o.createObservable({campaign:o.wrapObservable(he),isVisible:o.createObservable(!0)});te&&(o.isDisabled=te);o.isInvisibleWhenDisabled=ie;o._isHidden=o.wrapObservable(ee);o.bounds=o.createObservable();o.measurementReady=function(e){o.onMeasurementReady(e)};o.payload=Fe;o.payloadTimeout=He;o.autoDismissPayload=Ke;o.announcePayload=qe;o.enableRecoverFocusBinding=We;o.keys=Y;o.children=nt instanceof Array?o.observables.createArray(nt):nt;o.addDisposable(o.children.map({mappingWithDisposeCallback:function(e){e.parentCommand=o;return{mappedValue:e,dispose:function(){e.parentCommand=null}}}}));o.visibleChildren=o.addDisposable(o.children.filter(function(e){return e.isVisible()}));o.hasDeferredChildren=at;o.isToggled=o.createComputed(o._computeIsToggled);o.hasAnimation=Je;o.isVisible=o.createComputed(o._computeIsVisible);o.state=o.wrapObservable(xe);o.isCurrentView=K;o.isLastPivot=Ye;o.isCollapsed=o.createComputed(function(){return o.collapseSingleChildCommands&&1===o.visibleChildren().length});o.menuAlignment=o.wrapObservable(Be);o.menuOffset=o.wrapObservable(De);o.isMenuBeakVisible=o.wrapObservable(Re);o.targetCommand=o.createComputed(function(){return o.isCollapsed()?o.visibleChildren()[0]:o});o.label=o.createComputed(o._computeLabel);o.computedAccessibleLabel=o.createPureComputed(function(){return o._computeAccessibleLabel()});o.hasIconOnly=q;o.positionIconRight=W;o.isOpen=o.createComputed({read:function(){return o._isOpenRequested()&&(o.visibleChildren().length>0||!!o.payload())},write:function(e){o._isOpenRequested(e)},pure:!0});o.subscribe(o.isOpen,function(e){e||o.children().forEach(function(e){e.children().length>0&&e.isOpen(!1)})});var mt=o.addDisposable(o.visibleChildren.filter(function(e){return e.isOpen()})),ft=o.createComputed(function(){return mt().length>0});o.subscribe(ft,function(e){e||o.async.setImmediate(function(){document.activeElement&&document.activeElement!==document.body||o.focused(!0)})});o.createComputed(function(){!o.isOpen()&&o.focused()?o.isActive(!0):o.isActive(!1)});o.isDisabled||(o.isDisabled=o.createComputed(function(){if(o.targetCommand()!==o)return o.targetCommand().isDisabled();return o.requiredChildren>0?o.visibleChildren().length<o.requiredChildren:!(o.visibleChildren().length||o.action&&(o.action.isAvailable()||o.isToggleable&&o.action.isToggled())||o.callback)}));o.layoutChanged=o.createObservable();o.createComputed(function(){o.isLabelVisible();o.text();o.layoutChanged.notifySubscribers()});o.tabindex=o.createPureComputed(function(){return o.focused()?0:-1});o.engagementName=Ge;o.experiment=$e;return o}n.__extends(t,e);t.prototype.hasVisibleChildren=function(){return this.visibleChildren().length>0};t.prototype.hasVisibleOrDeferredChildren=function(){return this.hasVisibleChildren()||this.hasDeferredChildren};t.prototype.onMeasurementReady=function(e){this.bounds(e)};t.prototype.onClick=function(e,t){var o,r=this,a=["CommandView",b.capitalizeFirstLetter(t.type)],s=!1;this._reportClickingTime&&this._reportClickingTime();if((0===this.location||this.isVisible.peek())&&!this.isDisabled.peek()){e.engagementName&&(o=(a=[e.engagementName,b.ClickName]).join("."));var l=this.isCollapsed.peek()?this.visibleChildren.peek()[0]:this;l.payload.peek()&&l.isOpen.peek()&&l.isOpen(!1);if(l.visibleChildren.peek().length&&(l.icon||l.text)){l.closeSiblingCommands();var u=l.icon&&l.icon(),c=u?u.toString():l.text.peek();if(!e.engagementName){a.splice(1,0,"Parent"+b.capitalizeFirstLetter(c));o=a.join(".")}l.parentCommand?l.isOpen(!0):l.isOpen(!l.isOpen.peek());l.isOpen.peek()&&l.focused(!0);l.callback&&l.callback();s=!0}else if(l.action&&l.action.isAvailable.peek()){if(!e.engagementName){a.splice(1,0,b.capitalizeFirstLetter(l.action.name));o=a.join(".")}l.closeParentCommands();if(!e.isDisabled||!e.isDisabled.peek()){if(l.fileInputElement.peek()&&l.action.isAvailable.peek())l.fileInputElement.peek().click();else{this.state(i.default.executed);l.action.execute(t).done(function(){r.state(i.default.initialized)},function(e){r.state(i.default.failed)})}"MoveCopy"===l.action.name&&e.isDisabled(!0)}s=!0}else if(l.callback){l.callback();s=!0}if(o){var d=this._engagement;d?d.logData({name:o,experiment:e.experiment,extraData:n.__assign({action:b.capitalizeFirstLetter(t.type)},w.LoggingContextHelper.getLoggingContextData(this.resources))}):g.Engagement.logData({name:o,experiment:e.experiment,extraData:n.__assign({action:b.capitalizeFirstLetter(t.type)},w.LoggingContextHelper.getLoggingContextData(this.resources))})}}if(s){t.preventDefault();t.stopPropagation()}return!s};t.prototype.onDismiss=function(){var e=this.visibleChildren.peek();(this.payload.peek()||e&&e.length)&&this.isOpen(!1)};t.prototype.onInputChange=function(e){var t=this.targetCommand();if(t&&t.action){t.action.execute(e);this.closeParentCommands()}};t.prototype.openMenu=function(){var e=this.visibleChildren();if(e&&e.length){this.isOpen(!0);return!0}return!1};t.prototype.getIcon=function(e){var t=e;this.icon&&this.icon()&&(t+=" "+this.icon().getClass());return t};t.prototype.getChevron=function(e){var t=e;return t+=" "+new f(h.default.isRightToLeft?"ChevronLeft":"ChevronRight").getClass()};t.prototype.closeParentCommands=function(){for(var e=this.parentCommand;e;){e.isOpen(!1);e=e.parentCommand}};t.prototype.closeSiblingCommands=function(){var e=this;this.parentCommand&&this.parentCommand.children().forEach(function(t){t!==e&&t.isOpen(!1)})};t.prototype._computeIsToggled=function(){return this.isCurrentView?this.isCurrentView():!!this.action&&this.action.isToggled()};t.prototype._computeIsVisible=function(){return 0!==this.location&&(!this._isHidden()&&(this.requiredChildren>0?this.visibleChildren().length>=this.requiredChildren:!this.action||(this.isPermanent()||this.action.isAvailable()||this.isToggleable&&this.action.isToggled())))};t.prototype._computeLabel=function(){return this.isCollapsed()?this.targetCommand().collapsedText()||this.targetCommand().text():this.text()};t.prototype._computeAccessibleLabel=function(){var e,t=this.accessibleLabel(),n=this.sectionAccessibleLabel()||"",i=this.tooltip(),o=this.label(),r=t||i;e=r&&o&&r!==o&&this.prependTextToAccessibleLabel?o+". "+r:r||o||"";return n&&e?n+". "+e:e||n};t.prototype._computeInputType=function(){return this.action&&this.action.inputType&&this.action.inputType()||_.default.none};return t}(o.default);k.dependencies=n.__assign({},o.default.dependencies,{newFeatureExperienceEnabler:m.newFeatureExperienceEnabler.optional,engagement:v.resourceKey,responsiveUI:C.resourceKey.optional});return k});define("odsp-next/controls/commands/CommandState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.initialized=0]="initialized";e[e.executed=1]="executed";e[e.failed=2]="failed"}(n||(n={}));t.default=n});define("odsp-next/bindings/longHover/LongHoverBinding",["require","exports","tslib","../BaseBinding"],function(e,t,n,i){"use strict";return function(e){function t(t){var n=e.call(this,t)||this,i=t.valueAccessor();n._callback=i.callback;n._delay=i.delay||400;n.events.on(n.element,"mouseenter",n._onMouseEnter);n.events.on(n.element,"mouseleave",n._onMouseLeave);return n}n.__extends(t,e);t.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}};t.prototype._onMouseEnter=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onHoverTimer,this._delay)};t.prototype._onMouseLeave=function(e){this._clearTimer()};t.prototype._onHoverTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t}(i)});define("odsp-next/bindings/tooltip/TooltipBinding",["require","exports","tslib","knockout","../BaseBinding","../../controls/tooltip/Tooltip"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n.createComputed(function(){n.unwrapObservable(i.isTooltipDisabled);n._removeTooltip()});n.events.onAll(n.element,{mouseenter:n._insertTooltip,mouseleave:n._removeTooltip,focus:n._insertTooltip,blur:n._removeTooltip,click:n._removeTooltip});n.addDisposable({dispose:function(){n._removeTooltip()}});return n}n.__extends(t,e);t.prototype._insertTooltip=function(){this._removeTooltip();var e=this.valueAccessor();if(e&&e.content&&!this.peekUnwrapObservable(e.isTooltipDisabled)&&this.peekUnwrapObservable(e.content)){t._tooltip=this._createTooltip(e);this.element.appendChild(t._tooltip)}};t.prototype._createTooltip=function(e){var t=document.createElement("span"),n={content:this.peekUnwrapObservable(e.content),targetElement:this.element},o={component:{name:r.tagName,params:n}};i.applyBindingsToNode(t,o);return t};t.prototype._removeTooltip=function(){if(t._tooltip){i.removeNode(t._tooltip);t._tooltip=null}};return t}(o);t.default=a});define("odsp-next/controls/tooltip/Tooltip",["require","exports","knockout","../reactHost/ReactHost"],function(e,t,n,i){"use strict";var o=i.createComponent("ms-react-tooltip","odsp-next/controls/tooltip/TooltipContainer",{calloutProps:{gapSpace:0}});n.components.isRegistered(o.tagName)||n.components.register(o.tagName,o);return o});define("odsp-next/controls/reactHost/ReactHost",["require","exports","knockout","./ReactHostViewModel","./ReactHost.html"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createComponent=function(t,o,r){return{tagName:t,template:e("./ReactHost.html"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))({component:o,props:n.utils.extend(r||{},e)},t)}},synchronous:!0}}});define("odsp-next/controls/reactHost/ReactHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/react/ReactBinding"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,i){var r=e.call(this,t,i)||this,a=n.__assign({},t.props||{},{hostViewModel:r});r.addBindingHandlers({react:o.default});r.reactBindingParams="string"==typeof t.component?{componentPath:t.component,props:a}:{componentType:t.component,props:a};return r}n.__extends(t,e);return t}(i.default);t.default=r});define("odsp-next/bindings/react/ReactBinding",["require","exports","tslib","../BaseBinding","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/performance/PerformanceCollection"],function(e,t,n,i,o,r,a,s){"use strict";function l(e){return!!e.componentType}Object.defineProperty(t,"__esModule",{value:!0});var u=new(function(){function t(){this._promises={}}t.prototype.load=function(t){var n=t.path,i=t.require,s=void 0===i?e:i,l=s,u=l.toUrl(n+"_unmapped"),c=this._promises,d=c[u];d||(d=c[u]=o.default.as(this._loadSync(n,l)||a.loadModule({path:n,require:s}))).done(void 0,function(e){delete c[u]});var p=new r.default;d.done(function(e){return p.complete(e)},function(e){return p.error(e)});return p.getPromise()};t.prototype._loadSync=function(e,t){var n;if(t.defined(e)){var i=t(e);if(i)if("object"==typeof i){if(Object.keys(i).length>0){var o=a.getDefaultExport(i);o&&(n=o)}}else n=i}return n};return t}()),c=function(t){function i(n){var i=t.call(this,n)||this;i.controlsDescendantBindings=!0;var r=i.valueAccessor(),a=r.props;i._renderDependencies=i.createObservable();i._componentProps=i.wrapObservable(a);var c;if(l(r)){i._componentNameForLogging=r.componentType.displayName;s.default.mark("EUPL.ReactBinding.LoadStart."+i._componentNameForLogging);c=o.default.wrap(r.componentType)}else{i._componentNameForLogging=r.componentPath;s.default.mark("EUPL.ReactBinding.LoadStart."+i._componentNameForLogging);c=u.load({path:r.componentPath,require:r.require})}i.trackPromise(o.default.all({react:u.load({path:"react",require:e}),reactDOM:u.load({path:"react-dom",require:e}),componentType:c}).then(function(e){s.default.mark("EUPL.ReactBinding.Loaded."+i._componentNameForLogging);i.addDisposable({dispose:function(){return e.reactDOM.unmountComponentAtNode(i.element)}});i._renderDependencies(e)}));i.createComputed(i._computeRenderComponent);return i}n.__extends(i,t);i.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.react,i=t.reactDOM,o=t.componentType,r=this._componentProps();s.default.mark("EUPL.ReactBinding.AsyncRender."+this._componentNameForLogging);this.observables.ignore(function(){i.render(n.createElement(o,r),e.element)})}};return i}(i);t.default=c});define("@ms/odsp-utilities/lib/modules/Modules",["require","exports","./ModuleLoader","./ModuleHelper"],function(e,t,n,i){"use strict";t.loadModule=n.loadModule;t.loadModuleExport=n.loadModuleExport;t.loadModuleIdentity=n.loadModuleIdentity;t.getDefaultExport=i.getDefaultExport;t.getIdentityExport=i.getIdentityExport});define("@ms/odsp-utilities/lib/modules/ModuleLoader",["require","exports","../logging/RequireJSErrorHandler","../performance/PerformanceCollection","../async/Signal","./ModuleHelper"],function(e,t,n,i,o,r){"use strict";function a(e){var t=e.path,n=e.require,i=e.getExport;return s(n,t).then(function(e){return i(e)})}function s(e,t){i.default.mark("Module_"+t,20);var r=new o.default;e([t],function(e){r.complete(e)},function(e){n.default.log(e);r.error(e)});return r.getPromise()}t.loadModule=function(e){return a({path:e.path,require:e.require,getExport:r.getDefaultExport})};t.loadModuleIdentity=function(e){var t=e.path;return s(e.require,t)};t.loadModuleExport=a});define("@ms/odsp-utilities/lib/logging/RequireJSErrorHandler",["require","exports","./events/RequireJSError.event","./ErrorHelper"],function(e,t,n,i){"use strict";var o=function(){function e(){}e.log=function(e){n.RequireJSError.logData(e);e&&("define"===e.requireType||"require"===e.requireType)&&e.stack&&e.requireModules&&i.default.log(e)};e.registerRequireOnError=function(){if(window.requirejs&&"function"==typeof window.requirejs){var t=window.requirejs.onError;window.requirejs.onError=function(n){e.log(n);t&&!n.isTest&&t(n)}}};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=o;o.registerRequireOnError()});define("@ms/odsp-utilities/lib/logging/events/RequireJSError.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";t.RequireJSError=n.createSingleEvent({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0,requiresParent:!1},{message:1,requireModules:5,requireType:1,stack:1});Object.defineProperty(t,"__esModule",{value:!0});t.default=t.RequireJSError});define("@ms/odsp-utilities/lib/performance/PerformanceCollection",["require","exports","../logging/events/PLT.event","../logging/events/PLTHttpRequest.event","../logging/events/Api.event","../logging/EventBase","../logging/ErrorHelper","../logging/Manager","./PerformanceMarker"],function(e,t,n,i,o,r,a,s,l){"use strict";t.HighResolutionTimingSupported=l.HighResolutionTimingSupported;var u=window.performance;t.AppStartMarkerName="EUPL.AppStart";t.DataFetchStartMarkerName="EUPL.DataManager.FirstDataFetch.GetItem.Start";t.DataFetchEndMarkerName="EUPL.DataManager.FirstDataFetch.GetItem.End";t.OnePageNavigationStartMarkerName="EUPL.OnePageNavigation.Start";var c=function(){function e(){}e.getResponseEnd=function(){return u&&u.timing?window.g_responseEnd&&(u.timing.responseEnd&&Number(window.g_responseEnd)<u.timing.responseEnd||!u.timing.responseEnd)?Number(window.g_responseEnd):u.timing.responseEnd:NaN};e.appStart=function(){try{if(u&&u.timing){e.mark(t.AppStartMarkerName);s.Manager.addLogHandler(this.eventLogHandler);this.summary.w3cResponseEnd=e.getResponseEnd()-u.timing.fetchStart;this._times.appStart=Date.now();this.summary.appStart=this._times.appStart-e.getResponseEnd();this.summary.prefetchStart=-1;this.summary.deferredListDataRender=-1}}catch(e){a.default.log(e)}};e.plt=function(o){try{if(u&&u.timing&&void 0===e._times.plt){var r=Date.now(),c=Math.round(u.now());s.Manager.removeLogHandler(this.eventLogHandler);var d=l.getMarkerTime(t.OnePageNavigationStartMarkerName);this._times.plt=isNaN(d)?r-u.timing.fetchStart:c-d;this.summary.preRender=l.getMarkerTime(t.DataFetchStartMarkerName)-l.getMarkerTime(t.AppStartMarkerName);this.summary.dataFetch=l.getMarkerTime(t.DataFetchEndMarkerName)-l.getMarkerTime(t.DataFetchStartMarkerName);this.summary.postRender=e.now()-l.getMarkerTime(t.DataFetchEndMarkerName);this.summary.render=this.summary.preRender+this.summary.postRender;this.summary.plt=this._times.plt;this.summary.pltWithUnload=r-u.timing.navigationStart;this.summary.name=o;this.summary.appCacheHit=this.summary.w3cResponseEnd<=40&&Boolean(window.applicationCache)&&Boolean(window.applicationCache.status!==window.applicationCache.UNCACHED);this.getHttpRequests();var p=n.PLT.logData(this.summary);if(this.httpRequestCollection)for(var m=0,f=this.httpRequestCollection;m<f.length;m++){var h=f[m];i.PLTHttpRequest.logData(h,p)}e.mark("EUPL.glass")}}catch(e){a.default.log(e)}};e.mark=function(e,t){l.mark(e,t)};e.pageLoaded=function(){return void 0!==this._times.plt};e.getMarkerTime=function(e){return l.getMarkerTime(e)};e.now=function(){return l.HighResolutionTimingSupported?Math.round(u.now()):Date.now()};e.eventLogHandler=function(t){o.Api.isTypeOf(t)&&(void 0===e._times.appDataFetchStart?e._times.appDataFetchStart=t.startTime:t.eventType!==r.ClonedEventType.End&&t.eventType!==r.ClonedEventType.Single||(e._times.appDataFetchEnd=e._times.appDataFetchEnd?Math.max(e._times.appDataFetchEnd,t.endTime):t.endTime))};e.getHttpRequests=function(){if(u&&u.getEntriesByType){for(var e=[],t=u.getEntriesByType("resource"),n=t.length,i=0;i<n;i++){var o={startTime:Math.round(t[i].startTime),url:t[i].name,duration:Math.round(t[i].duration)};e.push(o)}var r=document.getElementsByTagName("iframe");n+=r.length;for(var a=0;a<r.length;a++){try{t=r[a].contentWindow.performance.getEntriesByType("resource")}catch(e){t=null}if(t){var s=t.length;n+=s;for(i=0;i<s;i++){var l={startTime:Math.round(t[i].startTime),url:t[i].name,duration:Math.round(t[i].duration)};e.push(l)}}}this.summary.httpRequests=n;this.httpRequestCollection=e}};return e}();c.summary={};c._times={};Object.defineProperty(t,"__esModule",{value:!0});t.default=c});define("@ms/odsp-utilities/lib/logging/events/PLT.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";t.PLT=n.createSingleEvent({eventName:"PLT,",shortEventName:"PLT",samplingFeature:{ODB:!0,ODC:"PLTLoggingSampling",Fallback:!1}},{name:{isKey:!0,type:1},w3cResponseEnd:2,prefetchStart:2,deferredListDataRender:2,appStart:2,preRender:2,dataFetch:2,dataFetchServerTime:2,postRender:2,render:2,plt:2,pltWithUnload:2,httpRequests:2,appCacheHit:3});Object.defineProperty(t,"__esModule",{value:!0});t.default=t.PLT});define("@ms/odsp-utilities/lib/logging/events/PLTHttpRequest.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";t.PLTHttpRequest=n.createSingleEvent({eventName:"PLTHttpRequest,",shortEventName:"PLTHttpRequest",samplingFeature:{ODB:!0,ODC:"PLTHttpRequestSampling",Fallback:!1}},{startTime:2,url:1,duration:2});Object.defineProperty(t,"__esModule",{value:!0});t.default=t.PLTHttpRequest});define("@ms/odsp-utilities/lib/logging/events/Api.event",["require","exports","../PairedEventBase","./Qos.event","./ResultTypeEnum"],function(e,t,n,i,o){"use strict";t.ResultTypeEnum=o.ResultTypeEnum;t.Api=n.createPairedEvent({eventName:"Api,Qos,",shortEventName:"Api",samplingFeature:{ODB:!0,ODC:"ApiEventLogging",Fallback:!1}},{url:1},i.Qos);Object.defineProperty(t,"__esModule",{value:!0});t.default=t.Api});define("@ms/odsp-utilities/lib/performance/PerformanceMarker",["require","exports"],function(e,t){"use strict";var n=window.performance,i=!!n&&"function"==typeof n.mark&&"function"==typeof n.clearMarks&&"function"==typeof n.now;t.HighResolutionTimingSupported=i;t.MARKER_PREFIX="EUPL.";var o=0,r=window._perfMarks=window._perfMarks||[];t.mark=function(e,a){var s=0===e.lastIndexOf(t.MARKER_PREFIX,0)?e:t.MARKER_PREFIX+e;if(null===a||void 0===a||o<a){i?n.mark(s):r.push({name:s,startTime:Date.now()});o++}};t.getMarkerTime=function(e){var o=0===e.lastIndexOf(t.MARKER_PREFIX,0)?e:t.MARKER_PREFIX+e;if(i){var a=n.getEntriesByName(o);return a&&a.length>0?Math.round(a[0].startTime):NaN}var s=r.filter(function(e){return e.name===o})[0];return s&&s.startTime};t.clearMarks=function(){i?n.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(t.MARKER_PREFIX,0)}).forEach(function(e){n.clearMarks(e.name)}):r=[]};t.getAllMarks=function(){return i?n.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(t.MARKER_PREFIX,0)}):r}});define("@ms/odsp-utilities/lib/modules/ModuleHelper",["require","exports"],function(e,t){"use strict";function n(e){return!!e&&"object"==typeof e&&"default"in e}t.getDefaultExport=function(e){return n(e)?e.default:e};t.getIdentityExport=function(e){return e};t.isModuleWithDefault=n});define("odsp-next/controls/reactHost/ReactHost.html",[],function(){return'<div data-bind="react: reactBindingParams"></div>'});define("odsp-next/bindings/raiseEventOnChange/RaiseEventOnChangeBinding",["require","exports","knockout","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,n,i){"use strict";return function(){function e(){}e.init=function(e,t){var o=n.utils.unwrapObservable(t()),r=o.eventName||"dataChange",a=o.eventArgs,s=n.isObservable(o.data)?o.data:n.observable(),l=o.bubbleEvent||!1;s.subscribe(function(){i.default.raise(e,r,a,l)})};return e}()});define("odsp-next/bindings/teachingBubble/TeachingBubbleBinding",["require","exports","tslib","../../resources/ProviderResourceKeys","../BaseBinding","../../resources/ControlResourceKeys"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,o=n.resources.consume(i.teachingBubble.optional);if(!o)return n;n.teachingBubbleProvider=o;n._value=n.valueAccessor();n._isFirstRunExperienceVisible=n.resources.consume(r.isFirstRunExperienceVisible.optional);n.createBackgroundComputed(n._computeAddTeachingBubble);return n}n.__extends(t,e);t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value),t=this.unwrapObservable(e.campaign),n=this.wrapObservable(e.isVisible);if((!this._isFirstRunExperienceVisible||!this._isFirstRunExperienceVisible())&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.peek()&&this.teachingBubbleProvider.currentBubble.peek().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,isVisible:n,element:this.element})}};return t}(o);t.default=a});define("odsp-next/utilities/icons/Icon",["require","exports"],function(e,t){"use strict";return function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){return"ms-Icon--"+this.value+(this.extraClasses?" "+this.extraClasses:"")};e.prototype.toString=function(){return this.value};return e}()});define("odsp-next/providers/engagement/Engagement",["require","exports","tslib","@ms/odsp-utilities/lib/logging/engagement/EngagementPart","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","../../models/engagement/Engagement","../../resources/DataSourceResourceKeys","../../utilities/killSwitch/KillSwitch"],function(e,t,n,i,o,r,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.useEngagementSystemResourceKey=new r.ResourceKey({name:e("module").id+".useEngagementSystem",factory:new r.ConstantResourceFactory(function(t){return e.toUrl(t).lastIndexOf(t)<0}("@ms/odsp-utilities/lib/logging/engagement/Engagement")&&!u.default.isActivated("33E34986-33E0-4143-A531-B7E26429819D","5/3/2017","If activated, reverts to a straight logging of Engagement events."))});var c={engagementHandlers:l.engagementHandlers.optional};t.engagementHelperResourceKey=new r.ResourceKey({name:e("module").id+".engagementHelper",loader:{load:function(){return a.loadModuleExport({path:"@ms/odsp-utilities/lib/logging/engagement/Engagement",require:e,getExport:function(e){return e.EngagementHelper}}).then(function(e){return{dependencies:c,create:function(t){var n=t.engagementHandlers;return{instance:new e({},{handlers:n})}}}})}}});var d=function(e){function i(n,i){var o=e.call(this,n,i)||this;o._isEnabled=i.isEnabled;o._resources=i.resources;o._isEnabled&&o._resources.load({engagementHelper:t.engagementHelperResourceKey}).done();return o}n.__extends(i,e);i.prototype.logData=function(e){var n=this;void 0===e&&(e={});this._isEnabled?this._resources.consumeAsync(t.engagementHelperResourceKey).done(function(t){t.fromSource({contexts:n.contexts}).logData(e)},function(){}):e.name&&o.Engagement.logData(e)};i.prototype.clone=function(e){return new i({},{engagementSource:{contexts:e},resources:this._resources,isEnabled:this._isEnabled})};return i}(i.EngagementBuilder);d.dependencies={resources:r.resourceScopeKey,engagementSource:s.engagementSourceResourceKey,isEnabled:t.useEngagementSystemResourceKey};t.EngagementExecutor=d;t.resourceKey=r.createDefaultResourceKey(e,d)});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-utilities/lib/logging/engagement/EngagementPart",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t,n){void 0===n&&(n={});this.name=e;this.type=t;var i=n.getEngagementData;i&&(this.getEngagementData=i)}e.prototype.matches=function(e){return e.part===this};e.prototype.getEngagementData=function(e){return{}};return e}();t.EngagementPart=n;var i=function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var n=t.engagementSource,i=(void 0===n?{contexts:[]}:n).contexts.slice(0);this.contexts=i}e.prototype.fromSource=function(e){return e?this.clone(e.contexts.concat(this.contexts)):this};e.prototype.withPart=function(e,t){void 0===t&&(t={});if(e){var n=__assign({},t||{},{part:e});return this.clone(this.contexts.concat([n]))}return this};e.prototype.clone=function(t){return new e({},{engagementSource:{contexts:t}})};return e}();t.EngagementBuilder=i;t.ENGAGEMENT_ROOT=new i});define("odsp-next/models/engagement/Engagement",["require","exports","@ms/odsp-utilities/lib/logging/engagement/EngagementPart","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EngagementPart=n.EngagementPart;t.engagementSourceResourceKey=new i.ResourceKey({name:e("module").id+".engagementSource",factory:new i.ConstantResourceFactory(n.ENGAGEMENT_ROOT)})});define("odsp-next/utilities/killSwitch/KillSwitch",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.isActivated=function(e,t,n){var i=window._spPageContextInfo;return e&&i&&i.killSwitches&&i.killSwitches[e.toUpperCase()]};return e}();t.default=n});define("@ms/odsp-shared/lib/utilities/logging/LoggingHelper",["require","exports"],function(e,t){"use strict";t.ClickName="Click";t.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}});define("odsp-next/bindings/fileInput/FileInputBinding",["require","exports","tslib","knockout","../BaseBinding"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var n=e.call(this,t)||this;n._insertNewElement();n.controlsDescendantBindings=!0;return n}n.__extends(t,e);t.prototype.dispose=function(){if(this._previousElement){i.cleanNode(this._previousElement);delete this._previousElement}e.prototype.dispose.call(this)};t.prototype._insertNewElement=function(){var e=this.valueAccessor(),t=this._createInputElement(e.isFolderUpload);this._applyBindings(t,e);i.virtualElements.setDomNodeChildren(this.element,[t]);this._previousElement=t};t.prototype._createInputElement=function(e){var t=document.createElement("input");t.type="file";t.tabIndex=-1;if(e){t.webkitdirectory=!0;t.directory=!0}else t.multiple=!0;return t};t.prototype._applyBindings=function(e,t){var n=this;i.applyBindingsToNode(e,{class:t.class,css:t.css,style:t.style,event:{change:function(e,i){t.onInputChange.call(e,i);n._insertNewElement()}}},this.bindingContext)};return t}(o);r.supportsVirtualElements=!0;t.default=r});define("@ms/odsp-shared/lib/base/ActionInputType",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"}(n||(n={}));Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("odsp-next/utilities/logging/LoggingContextHelper",["require","exports","tslib","knockout","../../resources/SPOResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function(){}}();a.Search="Search";t.LoggingContextBuckets=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n.__extends(t,e);t.prototype.getBuckets=function(){return t.getBuckets(this.resources)};t.getBuckets=function(e){return e&&e.isExposed(o.loggingContextBuckets)?e.consume(o.loggingContextBuckets):i.observable([])};t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)};t.getLoggingContextData=function(e){var n=null;e&&e.isExposed(o.loggingContext)&&(n=e.consume(o.loggingContext));return n?n.get(t.getBuckets(e).peek()):{}};t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)};t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(o.loggingContextBuckets)&&(n=e.consume(o.loggingContextBuckets).peek());t.forEach(function(e){n.indexOf(e)<0&&n.push(e)});e.expose(o.loggingContextBuckets,i.observable(n))}};return t}(r.default);t.LoggingContextHelper=s});define("odsp-next/bindings/component/ControlBinding",["require","exports","tslib","../BaseBinding","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/knockout/AutomationHelper","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/logging/ErrorHelper","knockout"],function(e,t,n,i,o,r,a,s,l,u,c){"use strict";function d(e,t){return!e&&!t||e===t||!(!e||!t)&&(e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params)}function p(e){return!!e&&"object"==typeof e&&"specification"in e}function m(e){return!!e.definitionKey}Object.defineProperty(t,"__esModule",{value:!0});t.ResourceKey=o.ResourceKey;t.toSpecification=function(e,t){return{definitionKey:e,params:t}};var f=function(){function e(e){var t=e.viewModelType;this.dependencies=n.__assign({},t.dependencies||{},e.dependencies||{});this._automationName=e.automationName;this._viewModelType=e.viewModelType;this._template=e.template}e.prototype.create=function(e){var t=this,i=function(t){function i(i){return t.call(this,i,n.__assign({},e||{},{resources:new o.ResourceScope(e.resources)}))||this}n.__extends(i,t);return i}(this._viewModelType),r=function(){return t._getTemplateNodes()},a=this._automationName;return{instance:new(function(){function e(){}e.prototype.toSpecification=function(e){return{automationName:a,viewModelType:i,getTemplateNodes:r,params:e}};return e}())}};e.prototype._getTemplateNodes=function(){var e=c.utils.parseHtmlFragment(this._template);this._getTemplateNodes=function(){return e};return e};return e}();t.ResolvedControlDefinitionFactory=f;t.createDefaultControlDefinitionResourceKey=function(e){return new o.ResourceKey({name:e.require("module").id,factory:new f({template:e.template,automationName:e.automationName,viewModelType:e.viewModelType,dependencies:e.dependencies})})};var h=function(e){function t(t,n){void 0===n&&(n={});var i=e.call(this,t,n)||this;i.controlsDescendantBindings=!0;var o=i.element;i._transcludedTemplateNodes=Array.prototype.slice.call(c.virtualElements.childNodes(o));c.virtualElements.emptyNode(o);i._resolvedSpecification=i._getResolvedSpecification();i._initializeRenderComponent();return i}n.__extends(t,e);t.prototype._getResolvedSpecification=function(){var e=this,t=this,i=t.resources,o=t.observables,s=o.create();s.equalityComparer=d;var l=new r.default;o.compute(function(){var t,r,c=e.valueAccessor();if(p(c)){t=o.unwrap(c.specification);r=c.placeholder}else t=o.unwrap(c);e.observables.ignore(function(){var o;if(t)if(m(t)){var c=t.params,d=t.definitionKey.local,p=i.consume(d.optional);if(p)s(p.toSpecification(c));else{if(r)if(m(r)){var f=i.consume(r.definitionKey.optional.local);f&&s(n.__assign({},f.toSpecification(r.params),{isPlaceholder:!0}))}else s(n.__assign({},r,{isPlaceholder:!0}));o=i.consumeAsync(d).then(function(e){return e.toSpecification(c)})}}else s(t);else s(void 0);l.debounce(o?e.trackPromise(o.then(function(e){s(e)},function(e){u.default.log(e)})):a.default.wrap())})});return s};t.prototype._initializeRenderComponent=function(){var e,t=this,n=this,i=n.element,o=n.observables,r=this._transcludedTemplateNodes;o.compute(function(){var n=t._resolvedSpecification();t.observables.ignore(function(){if(e){e.dispose();c.virtualElements.emptyNode(i)}if(n){var o=n.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),a=(e=t.scope.attach(new l.default)).attach(new n.viewModelType(n.params));e.attach(new s.default({viewModel:a,element:i,bindingContext:t.bindingContext,name:n.automationName}));for(var u=t.bindingContext.createChildContext(a,void 0,function(e){e.$component=a;e.$componentTemplateNodes=r}),d=document.createDocumentFragment(),m=0,f=o;m<f.length;m++){var h=f[m];d.appendChild(h)}c.virtualElements.setDomNodeChildren(i,[d]);c.applyBindingsToDescendants(u,i);var g=t.valueAccessor();if(p(g)){var v=g.afterRender;v&&!n.isPlaceholder&&v()}}})})};return t}(i);h.supportsVirtualElements=!0;t.ControlBinding=h;t.default=h});define("@ms/odsp-utilities/lib/async/PromiseDebouncer",["require","exports","./Signal"],function(e,t,n){"use strict";var i=function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var i=new n.default(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);i.complete(e)},function(e){t._clear(!1);i.error(e)});return i.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("odsp-next/controls/contextualMenu/ContextualMenu.html",[],function(){return"\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n alignToParent: true\r\n }\r\n}--\x3e<div tabindex=0 role=menu class=\"ms-ContextualMenu ContextualMenu\" data-bind=\"css: { 'is-open': isOpen, 'has-icon': hasItemWithIcon, 'has-checkbox': hasItemWithCheckbox }, style: menuStyle, selection: { data: items, mode: 'single', direction: 'vertical', focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: true, selectFirstItemOnActivate: isSubMenu && launchedViaKeyboard }, hasFocus: isActive, preserveFocus: true, keyboard: { mappings: { Left: navigateLeft, Right: navigateRight, Enter: onEnter, Esc: dismiss }, preventDefault: true }, beakAdorner: { isVisible: isBeakVisible, trigger: computedOffset, anchorElement: anchorElement }, event: { mouseout: mouseOut, mouseover: mouseOver }, visible: items().length > 0\">\x3c!--ko if: subMenuIsOpen--\x3e\x3c!--ko component: { name: 'ms-contextual-menu', params: { items: subMenuItems(), isOpen: subMenuIsOpen, left: '0px', top: '0px', offset: subMenuOffset, isBeakVisible: subMenuIsBeakVisible, hasExplicitAlignment: true, alignment: subMenuAlignment, isSubMenu: true, bounds: subMenuBounds, hideIcons: shouldHideIcons, fromKeyboardEvent: launchedViaKeyboard } }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div data-bind=\"foreach: items, css: { 'ContextualMenu-scrollable': isScrollable }, style: { width: width, height: height }, measure: measurementReady, event: { scroll: scrolled }\">\x3c!--ko if: hasLineBreakBefore() && ($index() > 0)--\x3e<hr>\x3c!--/ko--\x3e<div class=\"od-ContextualMenu-itemContainer od-ContextualMenu-itemContainer command\" data-bind=\"event: { mouseover: $parent.itemHover.bind($parent, $data), contextmenu: $parent.onContextMenu.bind($parent) }, hasFocus: focused, longHover: { callback: $parent.itemLongHover.bind($parent, $data) }, measure: { measure: $data.measurementReady, parentRelative: true, async:true }, attr: { tabindex: tabindex, role: role, 'aria-label': computedAccessibleLabel, 'aria-checked': isToggled, 'aria-haspopup': (visibleChildren().length > 0) || !!payload() }\"><a tabindex=-1 class=\"od-ContextualMenu-item od-ContextualMenu-item\" data-bind=\"attr: { 'title': tooltip }, click: $parent.onClick.bind($parent), css: { 'is-focused': focused, 'isChecked': isToggleable && isToggled() }, automation: automationId + '-link'\">\x3c!--ko if: $parent.hasItemWithCheckbox--\x3e<span class=\"ContextualMenu-itemCheck ms-Icon\" data-bind=\"css: { 'isChecked': isToggled }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: $parent.hasItemWithIcon--\x3e\x3c!--ko if: $data.icon && $data.icon()--\x3e<i data-bind=\"css: getIcon('ContextualMenu-icon ms-Icon')\"></i>\x3c!--/ko--\x3e\x3c!--ko if: !($data.icon && $data.icon()) && $data.iconUrl && $data.iconUrl()--\x3e<i data-bind=\"css: 'ContextualMenu-icon ms-Icon ms-Icon--custom', style: { backgroundImage: 'url(\\'' + iconUrl() + '\\')' }\"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e<span class=ContextualMenu-text><span class=ContextualMenu-commandText data-bind=\"text: label\"></span>\x3c!--ko if: subtext--\x3e<br><span class=ContextualMenu-commandSubtext data-bind=\"text: subtext\"></span>\x3c!--/ko--\x3e</span>\x3c!--ko if: (visibleChildren().length || hasDeferredChildren) && !hidesMenuChevron && !isCollapsed()--\x3e<i data-bind=\"css: getChevron('ContextualMenu-chevron ms-Icon')\"></i>\x3c!--/ko--\x3e</a>\x3c!--ko if: $component.displayInputElements--\x3e\x3c!--ko if: targetCommand().inputType() === ActionInputType.htmlFileUpload--\x3e<div class=ContextualMenu-uploadInput data-bind=\"automation: 'fileInput' + $index(), fileInput: { isFolderUpload: false, onInputChange: onInputChange, css: 'ContextualMenu-fileInput'}\"></div>\x3c!--/ko--\x3e\x3c!--ko if: targetCommand().inputType() === ActionInputType.folderUpload--\x3e<div class=ContextualMenu-uploadInput data-bind=\"automation: 'fileInput' + $index(), fileInput: { isFolderUpload: true, onInputChange: onInputChange, css: 'ContextualMenu-folderInput'}\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: hasLineBreakAfter() && ($index() < ($parent.items().length - 1))--\x3e<hr>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e"});define("odsp-next/controls/contextualMenu/ContextualMenu.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.ContextualMenu.ContextualMenu{min-width:180px;width:auto}.ContextualMenu.ContextualMenu.is-open{width:auto}[dir=ltr] .ContextualMenu.ContextualMenu.has-icon .od-ContextualMenu-item{padding-left:40px}[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .od-ContextualMenu-item{padding-right:40px}.ContextualMenu.ContextualMenu.has-icon .ContextualMenu-commandText{display:inline-block;vertical-align:top}[dir=ltr] .ContextualMenu.ContextualMenu.has-icon .ContextualMenu-commandText{margin-left:8px}[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .ContextualMenu-commandText{margin-right:8px}[dir=ltr] .ContextualMenu.ContextualMenu.has-icon .ms-Icon{margin-left:-32px}[dir=rtl] .ContextualMenu.ContextualMenu.has-icon .ms-Icon{margin-right:-32px}[dir=ltr] .ContextualMenu.ContextualMenu.has-checkbox .od-ContextualMenu-item{padding-left:25px}[dir=rtl] .ContextualMenu.ContextualMenu.has-checkbox .od-ContextualMenu-item{padding-right:25px}[dir=ltr] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ms-Icon{margin-left:1px}[dir=rtl] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ms-Icon{margin-right:1px}[dir=ltr] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-commandText{margin-left:2px}[dir=rtl] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-commandText{margin-right:2px}.ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-icon{width:auto}[dir=ltr] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-icon{margin-right:8px}[dir=rtl] .ContextualMenu.ContextualMenu.has-icon.has-checkbox .ContextualMenu-icon{margin-left:8px}.ContextualMenu.ContextualMenu:focus{outline:1px solid transparent}.ContextualMenu-commandSubtext{font-size:12px;white-space:normal}.ContextualMenu-itemCheck:before{display:block;height:14px;position:absolute;top:12px;width:14px}[dir=ltr] .ContextualMenu-itemCheck:before{left:0}[dir=rtl] .ContextualMenu-itemCheck:before{right:0}[dir=ltr] .ContextualMenu-itemCheck:before{margin-left:20px}[dir=rtl] .ContextualMenu-itemCheck:before{margin-right:20px}.ContextualMenu-itemCheck.isChecked{background-color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}.ContextualMenu-itemCheck.isChecked:after{content:'\\e73e';color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;font-weight:800;line-height:12px;position:absolute;top:12px}[dir=ltr] .ContextualMenu-itemCheck.isChecked:after{left:8px}[dir=rtl] .ContextualMenu-itemCheck.isChecked:after{right:8px}[dir=ltr] .ContextualMenu-itemCheck.isChecked:after{left:8px}[dir=rtl] .ContextualMenu-itemCheck.isChecked:after{right:8px}.ContextualMenu-scrollable{overflow-y:auto}.od-ContextualMenu-itemContainer{position:relative}.od-ContextualMenu-itemContainer:focus{outline:1px solid transparent}.od-focus--enabled .selection-active .od-ContextualMenu-itemContainer:focus a.od-ContextualMenu-item:before{content:'';position:absolute;width:100%;height:34px;top:1%;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}[dir=ltr] .od-focus--enabled .selection-active .od-ContextualMenu-itemContainer:focus a.od-ContextualMenu-item:before{left:-1px}[dir=rtl] .od-focus--enabled .selection-active .od-ContextualMenu-itemContainer:focus a.od-ContextualMenu-item:before{right:-1px}a.od-ContextualMenu-item{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;display:block;overflow:visible;padding:8px 20px;text-decoration:none;white-space:nowrap;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";position:relative;height:36px}html[dir=ltr] a.od-ContextualMenu-item{text-align:left}html[dir=rtl] a.od-ContextualMenu-item{text-align:right}a.od-ContextualMenu-item:focus{outline:1px solid transparent}a.od-ContextualMenu-item:active,a.od-ContextualMenu-item:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}a.od-ContextualMenu-item:active .ContextualMenu-chevron,a.od-ContextualMenu-item:hover .ContextualMenu-chevron{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}a.od-ContextualMenu-item.isChecked{font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif}a.od-ContextualMenu-item.isChecked:active{background-color:'},{theme:"cmdbarSelected",defaultValue:"#DADADA"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}a.od-ContextualMenu-item.isChecked:active .ContextualMenu-itemCheck.isChecked:after{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}a.od-ContextualMenu-item .ContextualMenu-chevron{position:absolute;margin:0;top:14px;font-size:8px;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] a.od-ContextualMenu-item .ContextualMenu-chevron{right:0}[dir=rtl] a.od-ContextualMenu-item .ContextualMenu-chevron{left:0}[dir=ltr] a.od-ContextualMenu-item .ContextualMenu-chevron{margin-right:6px}[dir=rtl] a.od-ContextualMenu-item .ContextualMenu-chevron{margin-left:6px}a.od-ContextualMenu-item .ms-Icon--Info{margin-top:2px}a.od-ContextualMenu-item .ms-Icon--ExcelLogo:before{color:#217346;font-size:20px}a.od-ContextualMenu-item .ms-Icon--OneNoteLogo:before{color:#5c2d91;font-size:20px}a.od-ContextualMenu-item .ms-Icon--PowerPointLogo:before{color:#d24726;font-size:20px}a.od-ContextualMenu-item .ms-Icon--WordLogo:before{color:#2b579a;font-size:20px}a.od-ContextualMenu-item .ms-Icon--VisioLogo:before{color:#3854a2;font-size:20px}a.od-ContextualMenu-item .ms-Icon--PowerApps2Logo:before{color:#742774;font-size:20px}a.od-ContextualMenu-item .ms-Icon--ArrowDownRight8{font-size:12px;top:35%}.ContextualMenu-icon{position:relative;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";font-size:16px;width:20px;text-align:center}.ms-Icon--custom{width:20px;height:20px;background-size:cover}.selection-active .od-ContextualMenu-item.is-focused{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ContextualMenu hr{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin:0}.ContextualMenu-childMenuContainer{display:inline-block}.ContextualMenu-uploadInput{position:absolute;top:0;bottom:0;left:0;right:0;opacity:.0001;cursor:pointer;overflow:hidden;z-index:9999999}.ContextualMenu-uploadInput input{position:absolute;top:0;font-size:200px;height:100px;cursor:pointer;margin:0;padding:0}[dir=ltr] .ContextualMenu-uploadInput input{right:0}[dir=rtl] .ContextualMenu-uploadInput input{left:0}.ms-Callout.ms-ContextualMenu-Callout .ms-Callout-main{position:relative}.ms-Callout.ms-ContextualMenu-Callout .ms-Callout-main .ms-ContextualMenu-container.ms-HorizontalNav{position:relative}.ms-Callout.ms-ContextualMenu-Callout .ms-ContextualMenu.ms-FocusZone{position:relative}"}])});define("odsp-next/controls/contextualMenu/react/ReactContextualMenu.html",[],function(){return"\x3c!--ko component: {\r\n name: 'od-overlay',\r\n params: {\r\n alignToParent: false\r\n }\r\n}--\x3e<div role=application data-bind=\"react: reactBindingParams\"></div>\x3c!--/ko--\x3e"});define("odsp-next/controls/leftNavExpander/commandSets/LeftNavExpanderCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../actions/ToggleIsLeftNavUserExpandedAction","../../../utilities/icons/Icon","../../commands/Commands.resx"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.commands.push(new(n.managed(o.CommandViewModel))({action:new(n.managed(r.default)),icon:new a("GlobalNavButton"),tooltip:s.strings.ToggleLeftNavCommandTooltip,accessibleLabel:s.strings.ToggleLeftNavCommandAriaLabel,isToggleable:!0,renderLabel:0,hasIconOnly:!0}));return n}n.__extends(t,e);return t}(i.default);t.default=l});define("odsp-next/controls/commands/BaseCommandSet",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Command","./Commands.resx","../../utilities/browser/ResponsiveUI","../../utilities/icons/Icon"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.responsiveUI=n.resources.consume(a.resourceKey);n.commands=n.observables.createArray();t.disableOverflowHost||(n.overflowHostCommand=new(n.managed(o.CommandViewModel))({text:r.strings.OverflowCommandLabel,tooltip:r.strings.OverflowCommandTooltip,renderLabel:0,requiredChildren:1,hidesMenuChevron:!0,collapseSingleChildCommands:!1,icon:new s("More"),hasIconOnly:!0,children:n.observables.createArray(),location:3}));return n}n.__extends(t,e);return t}(i.default);t.BaseCommandSet=l;t.default=l});define("odsp-next/controls/commands/Command",["require","exports","./CommandViewModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CommandViewModel=n;t.typeResourceKey=i.createDefaultTypeResourceKey(e,n)});define("odsp-next/controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../resources/PagesResourceKeys"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ToggleIsLeftNavUserExpanded";n._isLeftNavUserExpanded=n.resources.consume(a.base.leftNav.isLeftNavUserExpanded);n._toggleIsLeftNavUserExpanded=n.resources.consume(a.base.leftNav.toggleIsLeftNavUserExpanded);return n}n.__extends(t,e);t.prototype.onExecute=function(e){this._toggleIsLeftNavUserExpanded();return o.default.wrap({resultType:r.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return this._isLeftNavUserExpanded()};return t}(i.default);t.default=s});define("odsp-next/base/BaseAction",["require","exports","tslib","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-shared/lib/base/BaseModel","../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/ErrorHelper","../dataSources/url/PageType","../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../providers/engagement/Engagement"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.name="BaseAction";var o=i,r=o.resources,s=o.observables,l=n.urlDataSource,u=void 0===l?r.consume(a.url.optional):l,c=n.instrumentationProvider,d=void 0===c?r.consume(p.instrumentation.optional):c;i._BaseAction_urlDataSource=u;i._BaseAction_instrumentationProvider=d;i.isQosLogged=!0;i.logStartEnd=!1;i._executingInstanceCount=s.create(0);i.isAvailable=s.pureCompute(i._computeIsAvailable);i.isToggled=s.pureCompute(i._computeIsToggled);i.isExecuting=s.pureCompute(i._computeIsExecuting);return i}n.__extends(t,e);t.prototype.execute=function(e){var t,n,i=this,o=this.isQosLogged?this.onCreateQosEvent(e):null;try{if(!(t=this.onExecute(e,o)))throw new Error("Action did not return a promise")}catch(e){l.default.log(e);n=e}if(n){o&&o.end(this.onCreateErrorEventArg(e,n,!0));t=s.default.wrapError(n)}else{this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.done(function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1);if(o){i._logEngagementEvent(o.data.extraData);o.end(e)}},function(t){i._executingInstanceCount(i._executingInstanceCount.peek()-1);t&&!s.default.isCanceled(t)&&l.default.log(t);if(o){i._logEngagementEvent(o.data.extraData);o.end(i.onCreateErrorEventArg(e,t,!1))}})}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.Action({name:this.name,pageType:t&&u[t.getPageType()]||"",queryType:t&&c[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&s.default.isCanceled(t)?{resultType:d.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.ResultTypeEnum.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed"}};t.prototype.onExecute=function(e,t){var n={resultType:d.ResultTypeEnum.Failure};return s.default.wrap(n)};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e){if(this.isQosLogged){var t=this._BaseAction_instrumentationProvider;this.resources.consume(m.resourceKey).logData({name:this.name,location:"NA",usageType:o.UsageType[o.UsageType.Click],currentPage:t&&t.currentPageName()||"NA",previousPage:t&&t.previousPageName()||"NA",extraData:n.__assign({},e||{},t&&t.getEngagementData()||{})})}};return t}(r.default);f.dependencies=n.__assign({},r.default.dependencies,{urlDataSource:a.url,instrumentationProvider:p.instrumentation});t.default=f});define("@ms/odsp-shared/lib/utilities/logging/events/Action.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,i,o){"use strict";t.ResultTypeEnum=o.ResultTypeEnum;t.Action=n.createPairedEvent({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},i.Qos);Object.defineProperty(t,"__esModule",{value:!0});t.default=t.Action});define("@ms/odsp-utilities/lib/logging/events/UsageType",["require","exports"],function(e,t){"use strict";!function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard"}(t.UsageType||(t.UsageType={}))});define("odsp-next/dataSources/url/PageType",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.Loading=0]="Loading";e[e.Files=1]="Files";e[e.FilePicker=2]="FilePicker";e[e.FolderPicker=3]="FolderPicker";e[e.Photos=4]="Photos";e[e.TextFileEditor=5]="TextFileEditor";e[e.AccountChooser=6]="AccountChooser";e[e.StorageInfo=7]="StorageInfo";e[e.StorageOptions=8]="StorageOptions";e[e.AppData=9]="AppData";e[e.Error=10]="Error";e[e.SyncOnboarding=11]="SyncOnboarding";e[e.Share=12]="Share";e[e.Wedcs=13]="Wedcs";e[e.OneUp=14]="OneUp";e[e.PhotoPreferences=15]="PhotoPreferences";e[e.Embed=16]="Embed"}(n||(n={}));return n});define("odsp-next/dataSources/url/QueryType",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.Files=0]="Files";e[e.Recent=1]="Recent";e[e.DocumentLibraries=2]="DocumentLibraries";e[e.SharedWithMe=3]="SharedWithMe";e[e.DocsInCommon=4]="DocsInCommon";e[e.RecycleBin=5]="RecycleBin";e[e.Photos=6]="Photos";e[e.Search=7]="Search";e[e.AllMyPhotos=8]="AllMyPhotos";e[e.AccountChooserPicker=9]="AccountChooserPicker";e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK";e[e.Popular=11]="Popular";e[e.RecentUnpopular=12]="RecentUnpopular";e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin";e[e.Apps=14]="Apps";e[e.Subsites=15]="Subsites";e[e.Discover=16]="Discover";e[e.Hashtag=17]="Hashtag";e[e.RecentActivity=18]="RecentActivity";e[e.ExternallyShared=19]="ExternallyShared"}(n||(n={}));return n});define("odsp-next/controls/leftNavExpander/LeftNavExpander.html",[],function(){return'<div class=od-LeftNavExpander-commandBar data-bind="component: { name: commandBarTagName, params: commandBarParams }"></div>'});define("odsp-next/controls/leftNavExpander/LeftNavExpander.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-LeftNavExpander-commandBar{position:relative}.od-LeftNavExpander-commandBar:after{content:"";display:block;width:0;position:absolute;top:0;bottom:0;margin-top:6px;margin-bottom:6px}[dir=ltr] .od-LeftNavExpander-commandBar:after{right:8px}[dir=rtl] .od-LeftNavExpander-commandBar:after{left:8px}[dir=ltr] .od-LeftNavExpander-commandBar .CommandBarItem:last-child{margin-right:0}[dir=rtl] .od-LeftNavExpander-commandBar .CommandBarItem:last-child{margin-left:0}.od-LeftNavExpander-commandBar .CommandBar-sideArea{display:none}'}])});define("odsp-next/controls/topBar/TopBar",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TopBarViewModel","./TopBar.html","./TopBar.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.registerComponent({tagName:"od-top-bar",template:e("./TopBar.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/topBar/TopBarViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.addBindingHandlers({host:o});var i=t.hasSelection,r=void 0===i?n.createObservable(!1):i,a=t.hasHeader,s=void 0===a?n.createObservable(!1):a;n.hasSelection=r;n.hasHeader=s;return n}n.__extends(t,e);return t}(i.default);t.default=r});define("odsp-next/controls/topBar/TopBar.html",[],function(){return"<div class=od-TopBar data-bind=\"css: { 'od-TopBar--hasSelection': hasSelection, 'od-TopBar--hasHeader': hasHeader, 'od--hasSelection': hasSelection }, host: {}\"></div>"});define("odsp-next/controls/topBar/TopBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-TopBar{position:relative}@media screen and (-ms-high-contrast:active){.od-TopBar{border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-TopBar{border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-bottom:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-TopBar-item{height:40px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}html[dir=ltr] .od-TopBar-item{float:left}html[dir=rtl] .od-TopBar-item{float:right}.md .od-TopBar-item,.sm .od-TopBar-item{height:44px}.od-theme--darkTransparent .od-TopBar-item{background-color:rgba(0,0,0,.7)}.od-TopBar-search{width:208px}[dir=ltr] .od-TopBar-search{margin-right:24px}[dir=rtl] .od-TopBar-search{margin-left:24px}.lg .od-TopBar-search,.md .od-TopBar-search,.sm .od-TopBar-search{width:auto}[dir=ltr] .lg .od-TopBar-search,[dir=ltr] .md .od-TopBar-search,[dir=ltr] .sm .od-TopBar-search{margin-right:0}[dir=rtl] .lg .od-TopBar-search,[dir=rtl] .md .od-TopBar-search,[dir=rtl] .sm .od-TopBar-search{margin-left:0}[dir=ltr] .md .od-TopBar-search,[dir=ltr] .sm .od-TopBar-search{margin-right:4px}[dir=rtl] .md .od-TopBar-search,[dir=rtl] .sm .od-TopBar-search{margin-left:4px}.od-TopBar-search .od-SearchBox{transition:width 367ms cubic-bezier(.1,.9,.2,1),background-color 0s cubic-bezier(.1,.9,.2,1) 0s}.od-TopBar-search .od-SearchBox .od-SearchBox--active{transition-delay:0s,0s}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox{transition-delay:0s,367ms}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active){overflow:hidden;border-width:0;width:50px;border-color:transparent}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active) .od-SearchBox-search:after{visibility:hidden}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox.od-SearchBox--active{transition-delay:0s,0s}.lg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox.od-SearchBox--active{width:165px}.md .od-TopBar-search.od-TopBar-search--isCollapsed,.sm .od-TopBar-search.od-TopBar-search--isCollapsed{width:50px}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search{position:absolute;z-index:1;visibility:hidden}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox{visibility:visible}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search--active,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search--active{left:0;right:0}.sm .od-TopBar-search{width:50px}.od-TopBar-search:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.xlg .od-TopBar-header,.xxlg .od-TopBar-header,.xxxlg .od-TopBar-header,.xxxxlg .od-TopBar-header{width:100%}html[dir=ltr] .xlg .od-TopBar-header,html[dir=ltr] .xxlg .od-TopBar-header,html[dir=ltr] .xxxlg .od-TopBar-header,html[dir=ltr] .xxxxlg .od-TopBar-header{float:right}html[dir=rtl] .xlg .od-TopBar-header,html[dir=rtl] .xxlg .od-TopBar-header,html[dir=rtl] .xxxlg .od-TopBar-header,html[dir=rtl] .xxxxlg .od-TopBar-header{float:left}.od-TopBar-header .ms-siteHeaderLogoActual img{z-index:1}html[dir=ltr] .od-TopBar-commandBar{float:none}html[dir=rtl] .od-TopBar-commandBar{float:none}html[dir=ltr] .od-TopBar-commandBar{clear:right}html[dir=rtl] .od-TopBar-commandBar{clear:left}[dir=ltr] .lg .od-TopBar-commandBar,[dir=ltr] .md .od-TopBar-commandBar,[dir=ltr] .sm .od-TopBar-commandBar{padding-right:4px}[dir=rtl] .lg .od-TopBar-commandBar,[dir=rtl] .md .od-TopBar-commandBar,[dir=rtl] .sm .od-TopBar-commandBar{padding-left:4px}[dir=ltr] .xlg .od-TopBar-commandBar,[dir=ltr] .xxlg .od-TopBar-commandBar,[dir=ltr] .xxxlg .od-TopBar-commandBar,[dir=ltr] .xxxxlg .od-TopBar-commandBar{padding-left:16px}[dir=rtl] .xlg .od-TopBar-commandBar,[dir=rtl] .xxlg .od-TopBar-commandBar,[dir=rtl] .xxxlg .od-TopBar-commandBar,[dir=rtl] .xxxxlg .od-TopBar-commandBar{padding-right:16px}[dir=ltr] .xlg .od-TopBar-commandBar,[dir=ltr] .xxlg .od-TopBar-commandBar,[dir=ltr] .xxxlg .od-TopBar-commandBar,[dir=ltr] .xxxxlg .od-TopBar-commandBar{padding-right:16px}[dir=rtl] .xlg .od-TopBar-commandBar,[dir=rtl] .xxlg .od-TopBar-commandBar,[dir=rtl] .xxxlg .od-TopBar-commandBar,[dir=rtl] .xxxxlg .od-TopBar-commandBar{padding-left:16px}.od--hasSelection .od-TopBar-item{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.od-theme--darkTransparent .od--hasSelection .od-TopBar-item{background-color:rgba(0,0,0,.7)}.od--hasSelection .od-TopBar-search:hover{background-color:"},{theme:"cmdbarSelected",defaultValue:"#DADADA"},{rawString:"}[dir=ltr] .xlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization,[dir=ltr] .xxlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization,[dir=ltr] .xxxlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization,[dir=ltr] .xxxxlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization{padding-left:140px}[dir=rtl] .xlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization,[dir=rtl] .xxlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization,[dir=rtl] .xxxlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization,[dir=rtl] .xxxxlg .od-TopBar--hasHeader .od-TopBar-commandBar.ms-siteHeader-commandBarCustomization{padding-right:140px}html[dir=ltr] .od-TopBar-leftNavExpander+.od-TopBar-search .od-SearchBox{border-right-width:0}html[dir=rtl] .od-TopBar-leftNavExpander+.od-TopBar-search .od-SearchBox{border-left-width:0}"}])});define("odsp-next/pages/files/splist/SPListDeferredResources",["require","exports","@ms/odsp-utilities/lib/modules/ModuleLoader","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,i){"use strict";function o(){return i.default.all({SearchProvider:n.loadModule({require:e,path:"odsp-next/providers/search/SearchProvider"}),SearchComponent:n.loadModule({require:e,path:"odsp-next/controls/search/Search"}),SharingDataSource:n.loadModule({require:e,path:"odsp-next/dataSources/sharing/odb/SharingDataSource"}),SharingDataDataSource:n.loadModule({require:e,path:"odsp-next/dataSources/sharing/odb/SharingDataDataSource"}),SharingProvider:n.loadModule({require:e,path:"odsp-next/providers/sharing/SharingProvider"}),PeoplePickerDataSource:n.loadModule({require:e,path:"odsp-next/dataSources/peoplePicker/odb/PeoplePickerDataSource"}),SuiteNavDataSource:n.loadModule({require:e,path:"odsp-next/dataSources/suiteNav/odb/SuiteNavDataSource"}),SuiteNavComponent:n.loadModule({require:e,path:"odsp-next/controls/suiteNav/SuiteNav"})})}function r(){return i.default.all({DragAndDropComponent:n.loadModule({require:e,path:"odsp-next/controls/dragAndDrop/DragAndDrop"}),SearchDataSource:n.loadModule({require:e,path:"odsp-next/dataSources/search/odb/SearchDataSource"}),PowerAppComponent:n.loadModule({require:e,path:"odsp-next/controls/powerApp/PowerApp"})})}function a(){return i.default.all({UserSettingsStore:n.loadModule({require:e,path:"odsp-next/models/store/UserSettingsStore"}),UserInfoStore:n.loadModule({require:e,path:"odsp-next/models/store/UserInfoStore"}),UserInfoDataSource:n.loadModule({require:e,path:"odsp-next/dataSources/userInfo/spo/UserInfoDataSource"}),UserInfoProvider:n.loadModule({require:e,path:"odsp-next/providers/userInfo/UserInfoProvider"}),TeachingBubbleComponent:n.loadModule({require:e,path:"odsp-next/controls/teachingBubble/TeachingBubble"}),TeachingBubbleCampaign:n.loadModule({require:e,path:"odsp-next/models/teachingBubble/TeachingBubbleCampaigns"})})}Object.defineProperty(t,"__esModule",{value:!0});t.loadResourcesWhenPLT=function(e,t){return i.default.all({basicResources:o(),listResources:e?i.default.wrap():r(),teachingBubbleResources:!t||e?i.default.wrap():a()})};t.loadBasicResourcesWhenPLT=o;t.loadListResourcesWhenPLT=r;t.loadTeachingBubbleResourcesWhenPLT=a});define("odsp-next/controls/leftPane/LeftPane",["require","exports","./LeftPaneViewModel","../../bindings/component/ControlBinding","./LeftPane.html","./LeftPane.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createDefaultControlDefinitionResourceKey({automationName:"ms-left-pane",require:e,template:e("./LeftPane.html"),viewModelType:n.default});t.default=t.resourceKey});define("odsp-next/controls/leftPane/LeftPaneViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../bindings/selection/SelectionBinding","../../resources/DataSourceResourceKeys","./LeftPane.resx","../leftNav/leftNavSublink/LeftNavSublink","../leftNav/LeftNav.key","../leftNav/ReactLeftNavComp","../../bindings/scrollContainer/ScrollContainerBinding","../../bindings/component/ControlBinding"],function(e,t,n,i,o,r,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.addBindingHandlers({scrollContainer:d.default,selection:r.default,control:p.default});var o=n.leftNavDataSource;i._viewParams=n.viewParams;i._leftNavDataSource=o;i._pageType=n.currentPageType;var a=t.isLeftNavVisible,m=void 0===a||a,f=i.observables,h=i._getHandlers(),g=i._getLinkGroups(h),v=i._getLinksForNotificationSection(),b=o.needsBottomPadding,y=void 0===b?f.create(!0):b,x=o.useReactLeftNav,_=void 0!==x&&x,w=o.isEditable,I=void 0===w?f.create(!1):w,C=o.navSettingsUrl;i.needsBottomPadding=y;i.useReactLeftNav=_;var k=f.wrap(m);i._notificationLinks={text:s.strings.notificationsSectionText,url:null,isActive:f.create(!1),isFocused:f.create(!1),links:v,isExpanded:f.create(!0),automationId:"LeftNav-NotificationsGrouping"};i.hasNotifications=f.pureCompute(i._computeHasNotifications);var S={isLeftNavVisible:k,linkGroups:g,isEditable:I,navSettingsUrl:C};i.reactLeftNavSpecification={name:c.tagName,params:S};var T={linkGroup:i._notificationLinks};i.notificationSublinkSpecification={name:l.default.tagName,params:T};i.leftNavSpecification=p.toSpecification(u.default,{isLeftNavVisible:k,linkGroups:g});return i}n.__extends(t,e);t.prototype._getLinkGroups=function(e){var t=this,n=this.observables,i=this._leftNavDataSource,o=n.pureCompute(function(){if(!i.getLinkGroups)return n.createArray();n.unwrap(t._pageType);return i.getLinkGroups(t._viewParams)}),r=n.createArray();n.backgroundCompute(function(){for(var t=o()().slice(),n=0,i=e;n<i.length;n++){var a=(0,i[n])();a&&t.push.apply(t,a.linkGroups())}r.splice.apply(r,[0,1/0].concat(t))});return r};t.prototype._getLinksForNotificationSection=function(){var e=this,t=this.observables,n=this._leftNavDataSource,i=t.pureCompute(function(){if(!n.getNotificationLinks)return t.createArray();t.unwrap(e._pageType);return n.getNotificationLinks()}),o=t.createArray();t.backgroundCompute(function(){o.splice.apply(o,[0,1/0].concat(i()()))});return o};t.prototype._getHandlers=function(){var e=this,t=[],n=this._leftNavDataSource;if(n.getHandlerTypeKeys)for(var i=this,o=0,r=n.getHandlerTypeKeys();o<r.length;o++)!function(n){var o=i.observables.create();t.push(o);i.trackPromise(i.resources.consumeAsync(n.local).then(function(t){var n=new(e.scope.attached(t));o(n)}))}(r[o]);return t};t.prototype._computeHasNotifications=function(){return this._notificationLinks.links().length>0};return t}(i.default);m.dependencies=n.__assign({},i.default.dependencies,{viewParams:o.viewParams,leftNavDataSource:a.leftNav,currentPageType:o.currentPage.optional});t.default=m});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink",["require","exports","./LeftNavSublinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./templates/LeftNavTemplates","./LeftNavSublink.html","../LeftNav.css","../../loadingSpinner/LoadingSpinner","../../siteIcon/SiteIcon"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.registerComponent({tagName:"ms-left-nav-sublink",template:e("./LeftNavSublink.html"),viewModel:n.default,synchronous:!0});i.registerTemplate(o.LINK_TEMPLATE,e("./templates/Link.html"));i.registerTemplate(o.INDENTED_TEMPLATE,e("./templates/IndentedLink.html"));i.registerTemplate(o.LOAD_TEMPLATE,e("./templates/Load.html"));i.registerTemplate(o.TEXT_TEMPLATE,e("./templates/Text.html"));i.registerTemplate(o.WARNING_TEXT_TEMPLATE,e("./templates/WarningText.html"));i.registerTemplate(o.GROUPLINK_TEMPLATE,e("./templates/GroupLink.html"));i.registerTemplate(o.MORE_TEMPLATE,e("./templates/More.html"));i.registerTemplate(o.NOTIFICATION_TEMPLATE,e("./templates/NotificationLink.html"));i.registerTemplate(o.BASIC_LINK_TEMPLATE,e("./templates/BasicLink.html"));i.registerTemplate(o.COMPONENT_TEMPLATE,e("./templates/Component.html"));t.default=r});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublinkViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","../LeftNav.resx","./templates/LeftNavTemplates","../../../bindings/teachingBubble/TeachingBubbleBinding","../../../resources/ProviderResourceKeys"],function(e,t,n,i,o,r,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({teachingBubble:l.default});var i=t.linkGroup,o=t.isLeftNavVisible,r=void 0===o?n.createObservable(!0):o;n.leftNavItems=i;n.isLeftNavVisible=r;n._linksTruncatedWithMore=n.createObservable(!1);void 0!==n.leftNavItems.hideLinksAfterFoldAfter&&n._linksTruncatedWithMore(!0);n.leftNavRenderedItems=n.createPureComputed(n._computeLeftNavRenderedItems);n._teachingBubbleProvider=n.resources.consume(u.teachingBubble.optional);n.shouldMoreBeRendered=n.createPureComputed(function(){return n._linksTruncatedWithMore()&&n.leftNavItems.hideLinksAfterFoldAfter<n.leftNavItems.links().length});n.addDisposable(n.leftNavItems.links.filter(function(e){return!!e.action&&e.action.isAvailable()}));return n}n.__extends(t,e);t.prototype.onClick=function(e,t){e.engagementName&&this.resources.consume(o.resourceKey).logData({name:e.engagementName+".LeftNav.Click",extraData:{action:r.capitalizeFirstLetter(t.type)}});if(e.teachingBubble&&this._teachingBubbleProvider){var n=this._teachingBubbleProvider.currentBubble.peek();if(n&&n.campaign&&e.teachingBubble.campaignGuid===n.campaign.campaignGuid){this._teachingBubbleProvider.clearCurrentBubble();this._teachingBubbleProvider.markBubbleAsDismissed(e.teachingBubble)}}if(e.action){e.action.isAvailable.peek()&&e.action.execute(t);return!1}return!0};t.prototype.toggleMore=function(){this._linksTruncatedWithMore(!1)};t.prototype.renderMode=function(e){var t=e.renderAs;switch(void 0===t?0:t){case 1:return s.TEXT_TEMPLATE;case 2:return s.WARNING_TEXT_TEMPLATE;case 3:return s.LOAD_TEMPLATE;case 4:return s.GROUPLINK_TEMPLATE;case 5:return s.MORE_TEMPLATE;case 6:return s.NOTIFICATION_TEMPLATE;case 7:return s.INDENTED_TEMPLATE;case 8:return s.BASIC_LINK_TEMPLATE;case 9:return s.BUTTON_TEMPLATE;case 10:return s.COMPONENT_TEMPLATE;default:case 0:return s.LINK_TEMPLATE}};t.prototype._computeLeftNavRenderedItems=function(){var e=this.leftNavItems.hideLinksAfterFoldAfter;if(this._linksTruncatedWithMore()&&void 0!==e&&e<this.leftNavItems.links().length){var t=this.leftNavItems.links().slice(0,this.leftNavItems.hideLinksAfterFoldAfter);t.push({text:a.strings.moreLabel,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:5});return t}return this.leftNavItems.links()};return t}(i.default);t.default=c});define("odsp-next/controls/leftNav/leftNavSublink/templates/LeftNavTemplates",["require","exports","./Link.html","./IndentedLink.html","./Load.html","./Text.html","./WarningText.html","./GroupLink.html","./NotificationLink.html","./More.html","./BasicLink.html","./Component.html"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LINK_TEMPLATE="ms-left-nav-link";t.BUTTON_TEMPLATE="ms-left-nav-button";t.LOAD_TEMPLATE="ms-left-nav-load";t.TEXT_TEMPLATE="ms-left-nav-text";t.WARNING_TEXT_TEMPLATE="ms-left-nav-warning-text";t.GROUPLINK_TEMPLATE="ms-left-nav-groupLink";t.MORE_TEMPLATE="ms-left-nav-more";t.NOTIFICATION_TEMPLATE="ms-left-nav-notificationLink";t.INDENTED_TEMPLATE="ms-left-nav-indentedlink";t.BASIC_LINK_TEMPLATE="ms-left-nav-basicLink";t.COMPONENT_TEMPLATE="ms-left-nav-component"});define("odsp-next/controls/leftNav/leftNavSublink/templates/Link.html",[],function(){return"\x3c!--ko if: !$data.isHidden--\x3e<a role=treeitem class=\"LeftNav-subLink ms-font-m\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $parent.onClick.bind($parent), automationType: 'Link'\">\x3c!--ko if: $data.icon--\x3e<i class=\"LeftNav-sublinks-icon ms-Icon\" data-bind=\"class: $data.icon.getClass()\">\x3c!--ko if: $data.iconOverlayImageUrl--\x3e<img onerror=\"this.style.display = 'none';\" data-bind=\"attr: { src: $data.iconOverlayImageUrl }\">\x3c!--/ko--\x3e</i>\x3c!--/ko--\x3e<span class=LeftNav-fadient><span class=LeftNav-linkText data-bind=\"text: $data.text, attr: { 'id': $data.domId ? $data.domId : '', 'title': $data.text }\"></span></span></a>\x3c!--/ko--\x3e"});define("odsp-next/controls/leftNav/leftNavSublink/templates/IndentedLink.html",[],function(){return"<a role=treeitem class=\"LeftNav-subLink LeftNav-subLinkIndent\" data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick.bind($component), automationType: 'Link'\"><span><span class=LeftNav-linkText data-bind=\"text: $data.text\"></span></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/Load.html",[],function(){return'<div class=LeftNav-loadingTemplate>\x3c!--ko component: { name: "ms-loadingSpinner", params: { "loadingText": text } }--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/leftNav/leftNavSublink/templates/Text.html",[],function(){return'<div class=LeftNav-subLinksAsText data-bind="html: $data.text"></div>'});define("odsp-next/controls/leftNav/leftNavSublink/templates/WarningText.html",[],function(){return'<div class=LeftNav-subLinkWarningText data-bind="html: $data.text"></div>'});define("odsp-next/controls/leftNav/leftNavSublink/templates/GroupLink.html",[],function(){return"<a role=treeitem tabindex=-1 class=\"LeftNav-groupLink ms-font-s ms-fontWeight-regular\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, 'aria-selected': isFocused, title: $data.text }, hasFocus: isFocused, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': $data.isFocused }, click: $component.onClick.bind($component), automationType: 'Link'\"><span class=LeftNav-fadient><span class=LeftNav-linkText><span class=od-LeftNav-sublink-siteIcon data-bind=\"component: { name: 'ms-site-icon', params: { iconUrl: $data.iconOverlayImageUrl, icon: $data.icon, acronym: $data.acronym, color: $data.color } }\"></span> <span data-bind=\"text: $data.text\"></span></span></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/NotificationLink.html",[],function(){return"<a role=treeitem class=\"LeftNav-notificationLink ms-font-s ms-fontWeight-regular ms-fontColor-themePrimary\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: $component.isLeftNavVisible() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, visible: !$data.show || $data.show(), hasFocus: isFocused, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick.bind($component), automation: $data.automationId, automationType: 'Link'\"><span class=LeftNav-linkText data-bind=\"text: $data.text\"></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/More.html",[],function(){return"<div class=LeftNav-subLinksAsText><a href=# data-bind=\"click: $parent.toggleMore.bind($parent), attr: { tabindex: isFocused() ? 0: -1, 'aria-selected': isFocused }, text: $data.text, title: $data.text\"></a></div>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/BasicLink.html",[],function(){return"<a class=LeftNav-basicLink role=treeitem data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : '', tabindex: $component.isLeftNavVisible() ? 0: -1, 'aria-selected': isFocused, 'aria-label': $data.altText }, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, hasFocus: isFocused, automation: $data.automationId, click: $component.onClick.bind($component)\"><span data-bind=\"text: text\"></span> <span class=LeftNav-bubbleAnchor data-bind=\"teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }\"></span></a>"});define("odsp-next/controls/leftNav/leftNavSublink/templates/Component.html",[],function(){return'<div class=LeftNav-subLinksAsComponent data-bind="component: $data.component"></div>'});define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.html",[],function(){return"<div class=LeftNav-subLinksClip><div tabindex=-1 class=LeftNav-subLinks data-bind=\"style: { marginTop: 0 }, template: { name: renderMode, foreach: leftNavRenderedItems, as: 'linkItem' }\"></div></div>"});define("odsp-next/controls/leftNav/LeftNav.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".LeftNav-expandButton.ms-Icon{position:absolute;height:40px;text-align:center;-ms-transform:rotate(0);transform:rotate(0);-ms-transform-origin:50% 50%;transform-origin:50% 50%;line-height:32px;height:32px}[dir=ltr] .LeftNav-expandButton.ms-Icon{left:17px}[dir=rtl] .LeftNav-expandButton.ms-Icon{right:17px}.lg .LeftNav-expandButton.ms-Icon,.md .LeftNav-expandButton.ms-Icon,.sm .LeftNav-expandButton.ms-Icon{height:40px;line-height:40px}.LeftNav-expandButton.is-link.ms-Icon{cursor:default}.LeftNav-linkGroup.is-expanded .LeftNav-expandButton{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.xlg .LeftNav-linkArea,.xxlg .LeftNav-linkArea,.xxxlg .LeftNav-linkArea,.xxxxlg .LeftNav-linkArea{padding-top:8px}.LeftNav-linkGroupContainer{position:relative;padding:8px 0 0 0}.LeftNav-linkGroupContainer .LeftNav-linkGroup-plusWrapper{top:8px}.LeftNav-linkGroupContainer:first-child{padding:24px 0 0 0}.LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:24px}.LeftNav-subLinksClip{overflow:hidden}.LeftNav-subLinks{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.LeftNav-subLinks:focus{outline:0}a.LeftNav-link{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}a.LeftNav-subLink{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.LeftNav-linkGroupHeader,a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{margin:0;display:block;padding:0 16px 0 16px;border:none;background:0 0;text-decoration:none;white-space:nowrap;overflow:hidden;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}html[dir=rtl] .LeftNav-linkGroupHeader,html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{padding:0 16px 0 16px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{height:32px;line-height:32px}.lg a.LeftNav-groupLink,.lg a.LeftNav-link,.lg a.LeftNav-subLink,.md a.LeftNav-groupLink,.md a.LeftNav-link,.md a.LeftNav-subLink,.sm a.LeftNav-groupLink,.sm a.LeftNav-link,.sm a.LeftNav-subLink{height:40px;line-height:40px}[dir=ltr] .LeftNav-linkGroupHeader--hasIcon{padding-left:56px}[dir=rtl] .LeftNav-linkGroupHeader--hasIcon{padding-right:56px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:32px;text-overflow:ellipsis;overflow:hidden}.lg .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:40px}.LeftNav-linkGroupHeader--hasSubText{padding-top:4px;padding-bottom:8px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px;font-size:14px}.lg .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderSubText{line-height:15px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{display:block;position:absolute;width:32px;height:32px}[dir=ltr] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-left:-40px}[dir=rtl] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-right:-40px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderSubText{display:block;font-size:12px;text-overflow:ellipsis;overflow:hidden}.od-focus--enabled a.LeftNav-groupLink.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-link.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-subLink.LeftNav-is-focused:after{content:'';box-shadow:0 0 0 1px #666 inset;width:100%;position:absolute;height:100%;left:0;top:0}.od-focus--enabled .LeftNav-linkGroupHeader:focus{box-shadow:0 0 0 1px #666 inset;outline:1px solid transparent}a.LeftNav-groupLink:hover,a.LeftNav-link:hover,a.LeftNav-subLink:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.LeftNav-linkGroupHeader{cursor:default;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";outline:0}[dir=ltr] .LeftNav-linkGroupHeader--hasPlus{margin-right:20px}[dir=rtl] .LeftNav-linkGroupHeader--hasPlus{margin-left:20px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{cursor:pointer}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}a.LeftNav-groupLink:hover:not(.LeftNav-is-active),a.LeftNav-link:hover:not(.LeftNav-is-active),a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText{-ms-transform:scale(.95);transform:scale(.95);display:inline-block}a.LeftNav-groupLink.LeftNav-is-active:hover,a.LeftNav-link.LeftNav-is-active:hover,a.LeftNav-subLink.LeftNav-is-active:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:'}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #37006e}}a.LeftNav-groupLink.LeftNav-is-active,a.LeftNav-link.LeftNav-is-active,a.LeftNav-subLink.LeftNav-is-active{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding-left:14px}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:2px solid "},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:2px solid "},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #37006e}}a.LeftNav-groupLink>.LeftNav-fadient:after,a.LeftNav-link>.LeftNav-fadient:after,a.LeftNav-subLink>.LeftNav-fadient:after{content:'';position:absolute;top:0;width:24px;height:32px;pointer-events:none}[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{right:0}[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{left:0}html[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,.5) 25%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 80%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,.5) 25%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 80%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to right,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to left,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to right,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to left,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:linear-gradient(to right,rgba(234,234,234,0) 0,rgba(234,234,234,.5) 25%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 80%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:linear-gradient(to left,rgba(234,234,234,0) 0,rgba(234,234,234,.5) 25%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 80%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to right,rgba(244,244,244,0) 0,rgba(244,244,244,.5) 25%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 80%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to left,rgba(244,244,244,0) 0,rgba(244,244,244,.5) 25%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 80%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:' 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:none}}a.LeftNav-subLink{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;text-overflow:ellipsis}[dir=ltr] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-left:56px}[dir=rtl] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-right:56px}.LeftNav-loadingTemplate,.LeftNav-subLinksAsText{color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:8px 16px 8px 16px}html[dir=rtl] .LeftNav-loadingTemplate,html[dir=rtl] .LeftNav-subLinksAsText{padding:8px 16px 8px 16px}.lg .LeftNav-loadingTemplate,.lg .LeftNav-subLinksAsText,.md .LeftNav-loadingTemplate,.md .LeftNav-subLinksAsText,.sm .LeftNav-loadingTemplate,.sm .LeftNav-subLinksAsText{font-size:14px}.xlg .LeftNav-loadingTemplate,.xlg .LeftNav-subLinksAsText,.xxlg .LeftNav-loadingTemplate,.xxlg .LeftNav-subLinksAsText,.xxxlg .LeftNav-loadingTemplate,.xxxlg .LeftNav-subLinksAsText,.xxxxlg .LeftNav-loadingTemplate,.xxxxlg .LeftNav-subLinksAsText{font-size:12px}a.LeftNav-link.is-defaultCursor:hover{cursor:default}.LeftNav-link .ms-Icon--ChevronDown:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.LeftNav-linkGroup-plusWrapper{cursor:pointer;margin:auto;position:absolute;top:0;width:30px;height:32px;font-size:14px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .LeftNav-linkGroup-plusWrapper{right:8px}[dir=rtl] .LeftNav-linkGroup-plusWrapper{left:8px}.LeftNav-linkGroup-plusWrapper:hover{background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.LeftNav-linkGroup-plusWrapper:active{-ms-transform:scale(.95);transform:scale(.95)}.LeftNav-linkGroup-plus{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:";width:14px;height:14px;margin:auto;position:absolute;top:0;bottom:0;right:0;left:0}.LeftNav-sublinks-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d7"},{rawString:"}[dir=ltr] .LeftNav-sublinks-icon{margin-right:10px}[dir=rtl] .LeftNav-sublinks-icon{margin-left:10px}.LeftNav-sublinks-portrait.has-iconOverlayImage{background-color:initial}.LeftNav-sublinks-portrait{overflow:hidden;width:28px;height:28px;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";vertical-align:top;font-size:28px;margin-top:2px;position:relative;display:inline-block}[dir=ltr] .LeftNav-sublinks-portrait{margin-right:8px}[dir=rtl] .LeftNav-sublinks-portrait{margin-left:8px}.lg .LeftNav-sublinks-portrait,.md .LeftNav-sublinks-portrait,.sm .LeftNav-sublinks-portrait{height:28px;width:28px;margin-top:6px}.LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:24px;display:inline-block;margin-top:7px;vertical-align:top;width:39px}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-6px}.lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,.md .LeftNav-sublinks-portrait.ms-Icon--Group:before,.sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:28px;margin-top:8px;vertical-align:top;width:46px}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-7px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-7px}.LeftNav-sublinks-portrait img{max-width:28px;max-height:28px;position:absolute;top:0}[dir=ltr] .LeftNav-sublinks-portrait img{left:0}[dir=rtl] .LeftNav-sublinks-portrait img{right:0}.lg .LeftNav-sublinks-portrait img,.md .LeftNav-sublinks-portrait img,.sm .LeftNav-sublinks-portrait img{width:28px;height:28px}.od-LeftNav-sublink-siteIcon{position:relative;display:inline-block;margin-top:2px;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-LeftNav-sublink-siteIcon{margin-right:4px}[dir=rtl] .od-LeftNav-sublink-siteIcon{margin-left:4px}.lg .od-LeftNav-sublink-siteIcon,.md .od-LeftNav-sublink-siteIcon,.sm .od-LeftNav-sublink-siteIcon{margin-top:4px;width:28px;height:28px}.od-Browser--edge .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:36px}.lg.od-Browser--edge .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:42px}.lg.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:43px}.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:32px}.LeftNav-notificationLink,.LeftNav-subLinkWarningText{position:relative;display:block;margin:0;padding:8px 20px;height:auto;line-height:14px;font-size:12px}.LeftNav-notificationLink.LeftNav-is-active,.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:#fed9cc}.LeftNav-Button{display:block;height:auto;padding:4px 2px 6px;margin:8px 20px;width:calc(100% - 40px)}.LeftNav-Button.od-Button+.od-Button{margin:4px 20px}.LeftNav-subLinkWarningText{color:#e81123;font-weight:700}.LeftNav-basicLink{display:block;margin:0;padding:8px 16px;position:relative;height:auto;font-size:12px}.LeftNav-bubbleAnchor{position:absolute;top:0;bottom:0}[dir=ltr] .LeftNav-bubbleAnchor{right:0}[dir=rtl] .LeftNav-bubbleAnchor{left:0}"}])});define("odsp-next/controls/loadingSpinner/LoadingSpinner",["require","exports","./LoadingSpinnerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./LoadingSpinner.html","./LoadingSpinner.css"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"ms-loadingSpinner",template:e("./LoadingSpinner.html"),viewModel:n})});define("odsp-next/controls/loadingSpinner/LoadingSpinnerViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","../../bindings/imageLoader/ImageLoaderBinding","./LoadingSpinner","./LoadingSpinner.resx"],function(e,t,n,i,o,r,a,s,l){"use strict";return function(t){function o(n){var o=t.call(this,n)||this;o.LoadingSpinnerTagName=s.tagName;n&&void 0!==n.loadingText?o.loadingText=n.loadingText:o.loadingText=l.strings.LoadingText;o.addBindingHandlers({imageLoader:a.default});o.isVisible=i.observable(!0);o.isImageLoaded=i.observable(!1);o.loadingImageUrl=e.toUrl(o.resources.consume(r.settings).mediaBaseUrl+"/images/loading/loadingspinner.gif");return o}n.__extends(o,t);o.prototype.hideSpinner=function(){this.isVisible(!1)};return o}(o.default)});define("odsp-next/bindings/imageLoader/ImageLoaderBinding",["require","exports","tslib","../BaseBinding","../../utilities/images/ImageLoader","../../utilities/images/logging/ImageLoad.event","../../utilities/images/ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/PromiseDebouncer"],function(e,t,n,i,o,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t,n){void 0===n&&(n={});var i=e.call(this,t)||this;i._debouncer=new l.default;i._imageLoader=i.resources.consume(o.resourceKey);var r=i.valueAccessor(),a=r.src,s=r.image,u=r.error,c=r.isLoaded,d=r.isError,p=r.actualSize,m=r.scenarioName;i._src=i.wrapObservable(a);i._image=i.wrapObservable(s);i._error=i.wrapObservable(u);i._scenarioName=m;var f=n.outputExtenders,h=void 0===f?{deferred:!0}:f;i.createComputed(i._computeLoadImage);i.createBackgroundComputed(function(){var e=i._image();c&&c(!!e);if(p){var t=void 0;e&&(t={width:e.width,height:e.height});p(t)}s&&s(e)}).extend(h);i.createBackgroundComputed(function(){var e=i._error();u&&u(e);d&&d(!!e)}).extend(h);return i}n.__extends(t,e);t.prototype._computeLoadImage=function(){var e=this,t=this.unwrapObservable(this._src);this._image(void 0);var n;this._scenarioName&&(n=new r.default({name:this._scenarioName,loadType:a.default.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:t,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(t){e._image(t);e._error(void 0);n&&n.end({resultType:s.ResultTypeEnum.Success})},function(t){e._error(t);n&&n.end({resultType:s.ResultTypeEnum.Failure})})};return t}(i);t.default=u});define("odsp-next/utilities/images/ImageLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources","../auth/DomainAuthenticator","@ms/odsp-utilities/lib/async/Semaphore","./logging/ImageLoad.event","./ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","./ThumbnailCache"],function(e,t,n,i,o,r,a,s,l,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=16,m=function(e){function t(t,n){var i=e.call(this,t,n)||this;i._semaphore=new s.default(p);i._thumbnailCache=n.thumbnailCache;return i}n.__extends(t,e);t.prototype.loadImage=function(e){var t=this,n=e.url,i=e.imageElement,o=void 0===i?document.createElement("img"):i,r=e.scenarioName,s={url:n,width:0,height:0},l=this._thumbnailCache,u=function(){return a.default.authenticate(n).then(function(){return t._waitForImageLoad(o,n,r)}).then(function(e){l.record(s);if(o.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=o.naturalWidth||o.width,t=o.naturalHeight||o.height;return{url:n,width:e,height:t}})};return l.isLoaded(s)?u():this._semaphore.enqueue(u)};t.prototype._waitForImageLoad=function(e,t,n){var i,r,a,s=this,d=s.async,p=s.events,m=function(){a&&d.clearTimeout(a);p.off(e)},f=new o.default(function(){m();e.setAttribute("src","")});p.onAll(e,{load:function(){m();r&&r.end({resultType:c.ResultTypeEnum.Success});f.complete(i)},error:function(){m();r&&r.end({resultType:c.ResultTypeEnum.Failure});f.error(new Error("Image '"+t+"' failed to load"))}});a=d.setTimeout(function(){f.cancel()},3e4);n&&(r=new l.default({name:n,loadType:u.default.server}));e.setAttribute("src",t);i=!!e.complete;return this.trackPromise(f.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,i=new o.default(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){i.complete()},e);return i.getPromise()};return t}(i.default);m.dependencies=n.__assign({},i.default.dependencies,{thumbnailCache:d.resourceKey});t.default=m;t.resourceKey=r.createDefaultResourceKey(e,m)});define("odsp-next/utilities/auth/DomainAuthenticator",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=[new RegExp("^http(?:s)?://(?:[A-Za-z0-9]*[.])*livefilestore(?:-int)?[.]com/","i"),new RegExp("^http(?:s)?://(?:[A-Za-z0-9-]*[.])*1drv(?:-int)?[.]com/","i")],r=window.$Config&&"UnAuth"!==window.$Config.cid?window.cookieToss:null,a=[],s=function(){function e(e,t,n){this.complete=!r;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=n}e.authenticate=function(e){for(var t,i=0;i<a.length;i++){var o=a[i];if(o.requiresAuth(e)){t=o.authenticate(e);break}}for(var r=[t||n.default.wrap(!0)],s=0,l=this._cookieCheckers;s<l.length;s++){var u=l[s];u.isApplicable(e)&&r.push(u.check(e))}return n.default.all(r).then(function(e){return e.reduce(function(e,t){return e&&t})})};e.registerCookieChecker=function(e){this._cookieCheckers.push(e)};e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new i.default;var n=document.createElement("IFRAME");n.src=this.iframeSrc;n.style.display="none";document.body.appendChild(n)}return this._authPromise.getPromise()};e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};return e}();s._cookieCheckers=[];t.default=s;if(r){for(var l=r.s,u=r.r,c=0;l&&c<l.length;c++)a.push(new s(o[c],l[c],!u[c]));r.c=function(e){a[e].onAuthComplete()};s.authenticate("https://livefilestore.com/");s.authenticate("https://1drv.com/")}});define("@ms/odsp-utilities/lib/async/Semaphore",["require","exports","./Signal"],function(e,t,n){"use strict";var i=function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).done(this._promiseComplete,this._promiseComplete)}else{var i={callback:e,signal:null,canceled:!1,result:null};i.signal=new n.default(function(){i.canceled=!0;i.result&&i.result.cancel()});this._queue.push(i);t=i.signal.getPromise()}return t};e.prototype._promiseComplete=function(){var e=this;if(--this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.done(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("odsp-next/utilities/images/logging/ImageLoad.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../ImageLoadType","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ImageLoadType=o.ImageLoadType;t.ResultTypeEnum=r.ResultTypeEnum;t.ImageLoad=n.createPairedEvent({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:o.ImageLoadType,type:6}},i.Qos);t.default=t.ImageLoad});define("odsp-next/utilities/images/ImageLoadType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"}(n=t.ImageLoadType||(t.ImageLoadType={}));t.default=n});define("odsp-next/utilities/images/ThumbnailCache",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o){"use strict";function r(e){var t=e.url,n=e.width,i=e.height;return JSON.stringify({url:t,width:n,height:i})}function a(e){return Math.floor(Math.log(e)/Math.log(2)*d)}function s(e){return e.width*e.height}function l(e,t){for(var n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];t-e[o].lastAccessed.getTime()>u&&delete e[o]}}Object.defineProperty(t,"__esModule",{value:!0});var u=432e5,c=6e5,d=4,p=function(e){function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i._recordsByThumbnailKey={};i._bucketsByImageKey={};var o=i.observables;i.lastAccessedDate=o.create(new Date);var r=n.pruneThumbnailsExtenders,a=void 0===r?{rateLimit:{timeout:c}}:r;o.backgroundCompute(i._pruneThumbnails).extend(a);return i}n.__extends(t,e);t.prototype.getCoveragePercent=function(e,t){var n=s(e),i=s(t);return Math.sqrt(i/n)};t.prototype.register=function(e,t,n,i){void 0===n&&(n=t);void 0===i&&(i=!0);var o=this.lastAccessedDate;o(new Date);var s=a(this.getCoveragePercent(e,n)),l=r(e),u=r(t),c=this._recordsByThumbnailKey,d=this._bucketsByImageKey,p=c[l]||{lastAccessed:void 0,buckets:{}};p.lastAccessed=o.peek();var m=p.buckets[s];if(!m||this.getCoveragePercent(m.size,n)>1){m&&delete d[m.key];m=p.buckets[s]={key:u,size:n,image:t,isLoaded:i,lastAccessed:o.peek()}}d[u]=m;c[l]=p};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=r(e),i=this._bucketsByImageKey,o=i[n];o?o.isLoaded=!0:i[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=r(e),i=this._bucketsByImageKey[n];i&&(i.lastAccessed=t.peek());return!!i&&i.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var i=r(e),o=this._recordsByThumbnailKey[i],s=this.lastAccessedDate;s(new Date);if(o){var l=o.buckets;o.lastAccessed=s.peek();var u=a(t),c=a(n),d=-1/0,p=!1;for(var m in l){var f=Number(m);if(f<=u&&f>=c&&l[f].isLoaded){d=Math.max(d,f);p=!0}}var h=p&&l[d];return h&&h.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();l(this._recordsByThumbnailKey,e);l(this._bucketsByImageKey,e)};return t}(i.default);t.default=p;t.resourceKey=o.createDefaultResourceKey(e,p)});define("odsp-next/controls/loadingSpinner/LoadingSpinner.html",[],function(){return'<div class=od-LoadingSpinner><img class=od-LoadingSpinner-loadingGif data-bind="click: hideSpinner, visible: isVisible, attr: { text: loadingText, alt: loadingText }, imageLoader: { src: loadingImageUrl, isLoaded: isImageLoaded }"> <span class=od-LoadingSpinner-loadingText data-bind="text: loadingText"></span></div>'});define("odsp-next/controls/loadingSpinner/LoadingSpinner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}])});define("odsp-next/controls/siteIcon/SiteIcon",["require","exports","./SiteIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SiteIcon.html","./SiteIcon.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-site-icon",template:e("./SiteIcon.html"),viewModel:n.default,synchronous:!0});t.default=o});define("odsp-next/controls/siteIcon/SiteIconViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../image/tile/ImageTile","../icon/glyph/IconGlyph","@ms/odsp-shared/lib/models/image/Alignments"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var n=e.call(this,t)||this;n.imageTileTagName=o.default.tagName;n.iconGlyphTagName=r.tagName;var i=t.acronym,s=t.color,l=t.icon,u=t.iconUrl,c=t.size,d=void 0===c?{width:28,height:28}:c,p=t.mode,m=void 0===p?"site":p;n._size=n.wrapObservable(d);n.iconUrl=n.wrapObservable(u);n.icon=n.wrapObservable(l);n.acronym=n.wrapObservable(i);n.color=n.wrapObservable(s);n.mode=m;n.acronymStyle=n.createPureComputed(n._computeAcronymStyle);n.isImageLoaded=n.createObservable(!1);n.imageTileParams={image:n.createPureComputed(n._computeImage),isLoaded:n.isImageLoaded,desiredSize:n._size,alignment:a.AlignmentType.fit};n.iconGlyphParams={icon:n.icon};return n}n.__extends(t,e);t.prototype._computeImage=function(){return{url:this.unwrapObservable(this.iconUrl),width:0,height:0}};t.prototype._computeAcronymStyle=function(){var e=.4*this._size().height,t=.72*e;return{height:Math.ceil(e)+"px","font-size":Math.ceil(t)+"px","line-height":Math.ceil(e)+"px"}};return t}(i.default);t.default=s});define("odsp-next/controls/image/tile/ImageTile",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageTileViewModel","./ImageTile.html","./ImageTile.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.registerComponent({tagName:"od-image-tile",template:e("./ImageTile.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/image/tile/ImageTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","../../../bindings/imageLoader/ImageLoaderBinding","../../../bindings/imageRecycler/ImageRecyclerBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-shared/lib/models/image/Alignments","../../../utilities/images/ThumbnailCache","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,i,o,r,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.addBindingHandlers({imageLoader:r.default,imageRecycler:a.default});var s=t.image,l=t.rotation,u=void 0===l?o.none:l,m=t.desiredSize,f=t.scale,h=void 0===f?1:f,g=t.isLoaded,v=void 0===g?i.createObservable(!1):g,b=t.position,y=t.loadedImage,x=t.error,_=n.thumbnailCache,w=void 0===_?i.resources.consume(d.resourceKey):_,I=n.outputExtenders,C=void 0===I?{deferred:!0}:I;i._image=i.wrapObservable(s);i._rotation=i.wrapObservable(u);i._scale=i.wrapObservable(h);i._desiredSize=i.wrapObservable(m);i._alignment=c.createAlignment(t.alignment);i._thumbnailCache=w;i._loadedImage=i.wrapObservable(y);i._error=i.wrapObservable(x);i.isRotating=i._getIsRotating();i.alignmentName=i.createPureComputed(i._computeAlignmentName);i.actualSize=i.createPureComputed(i._computeActualSize);i.actualSize.equalityComparer=p.deepCompare;i.isLoaded=i.createPureComputed(i._computeIsLoaded);i._imageUrl=i.createPureComputed(i._computeImageUrl);i._finalSize=i.createPureComputed(i._computeFinalSize);i._finalSize.equalityComparer=p.deepCompare;i._position=i.createPureComputed(i._computePosition);i._position.equalityComparer=p.deepCompare;i.imageElementStyle=i.createPureComputed(i._computeImageElementStyle);i.imageElementStyle.equalityComparer=p.deepCompare;i.imageBackgroundStyle=i.createPureComputed(i._computeImageBackgroundStyle);i.imageBackgroundStyle.equalityComparer=p.deepCompare;i.createBackgroundComputed(i._computeRecordImage);i.imageLoaderParams={src:i._imageUrl,image:i._loadedImage,error:i._error};b&&i.createBackgroundComputed(function(){return b(i._position())}).extend(C);v&&i.createBackgroundComputed(function(){return v(i.isLoaded())}).extend(C);return i}n.__extends(t,e);t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&s.format(e.url,e.width,e.height)||""};t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var i=this.actualSize(),o=window.devicePixelRatio||1;e=i&&{width:i.width*n/o,height:i.height*n/o}}else e=t&&{width:t.width*n,height:t.height*n};return e};t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),i=this._rotation();if(n){var o=void 0;o=t&&t.width&&t.height?t:n;var r=this._alignment.getTransform(n,o),a=r.translate.x/o.width,s=r.translate.y/o.height,u=r.scale*n.width/o.width,c=void 0;if(i){var d=void 0;if(i%2==1){var p={width:n.height,height:n.width};d=this._alignment.getTransform(p,o).multiply(r.invert())}else d=l.default.IDENTITY;c="rotate("+90*i+"deg) scale("+d.scale.toFixed(6)+")"}else c="";e={left:(100*a).toFixed(2)+"%",top:(100*s).toFixed(2)+"%",width:(100*u).toFixed(2)+"%","-webkit-transform":c,"-ms-transform":c,transform:c}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e};t.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?e.width.toFixed(2)+"px":"","max-height":e?e.height.toFixed(2)+"px":"","background-image":'url("'+t+'")'}};t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),i=this.createPureComputed(function(){var i=t._rotation();e&&t.async.clearTimeout(e);e=t.async.setTimeout(function(){return n(i)},300);return n()});return this.createPureComputed(function(){return t._rotation()!==i()})};t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)};t.prototype._computeIsLoaded=function(){return!!this._loadedImage()};t.prototype._computeActualSize=function(){var e,t=this._loadedImage();t&&(e={width:t.width,height:t.height});return e};t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),i=this._rotation();if(n){var o=void 0;o=t&&t.width&&t.height?t:n;var r=void 0;r=i%2==1?{width:n.height,height:n.width}:n;var a=this._alignment.getTransform(r,o),s=a.translate.x,l=a.translate.y,c=a.scale*r.width,d=a.scale*r.height;e=new u.default(s,l,c,d)}return e};t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e};return t}(i.default);t.default=m});define("@ms/odsp-shared/lib/base/Rotation",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"}(n||(n={}));return n});define("odsp-next/bindings/imageRecycler/ImageRecyclerBinding",["require","exports","tslib","../BaseBinding","../imageLoader/ImageLoaderBinding","../../utilities/images/ImageRecycler","knockout"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var n=e.call(this,t)||this,i=n.resources.consume(r.resourceKey),s=n.valueAccessor(),l=i.checkOutImage(),u=n.bindingContext,c=s.style,d=s.css,p=s.class;c&&a.applyBindingsToNode(l,{style:c},u);d&&a.applyBindingsToNode(l,{css:d},u);p&&a.applyBindingsToNode(l,{class:p},u);new(n.managed(o.default))({element:l,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return s.imageLoader},bindingContext:u});a.virtualElements.setDomNodeChildren(n.element,[l]);n.addDisposable({dispose:function(){if(l){a.cleanNode(l);i.checkInImage(l).done()}}});n.controlsDescendantBindings=!0;return n}n.__extends(t,e);return t}(i);s.supportsVirtualElements=!0;t.default=s});define("odsp-next/utilities/images/ImageRecycler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=300;t.EMPTY_IMAGE="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";var s=function(e){function i(t,n){var i=e.call(this,t,n)||this,o=i._images=[];i.async.setInterval(function(){o.length>a&&o.splice(a,1/0)},6e4);return i}n.__extends(i,e);i.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")};i.prototype.checkInImage=function(e){var n=this,i=new o.default,r=this.async;r.setTimeout(function(){e.setAttribute("src",t.EMPTY_IMAGE);e.removeAttribute("style");e.removeAttribute("class");r.setTimeout(function(){e.removeAttribute("src");n._images.push(e);i.complete()},1e3)},0);return i.getPromise()};return i}(i.default);t.default=s;t.resourceKey=r.createDefaultResourceKey(e,s)});define("@ms/odsp-utilities/lib/math/Transform",["require","exports","./Point","./Rectangle"],function(e,t,n,i){"use strict";var o=function(){function e(e,t){void 0===e&&(e=new n.default);void 0===t&&(t=1);this.translate=e;this.scale=t}e.areEqual=function(e,t,i){void 0===i&&(i=1e-6);return n.default.areEqual(e.translate,t.translate,i)&&Math.abs(Math.log(e.scale/t.scale))<i};e.zoom=function(t,n,i){return new e(t.subtract(n).scale(i-1),i)};e.centerWithinBounds=function(t,o,r){return new e(new i.default(n.default.ORIGIN,t).getCenter().subtract(n.default.getCenter([o,r])))};e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)};e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)};return e}();o.IDENTITY=new o;Object.defineProperty(t,"__esModule",{value:!0});t.default=o});define("@ms/odsp-shared/lib/models/image/Alignments",["require","exports","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Point"],function(e,t,n,i){"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new l(e.map(function(e){return e.name}).join("-"),function(t,i){for(var o=n.default.IDENTITY,r=0,a=e;r<a.length;r++){var s=a[r],l={width:t.width*o.scale,height:t.height*o.scale};o=s.getTransform(l,i).multiply(o)}return o})}function r(e){return"object"==typeof e}function a(e){var n;if("string"==typeof e)n=s[e];else{if(r(e))return e;n=e}var i;switch(n){case s.top:i=t.top;break;case s.fitHeight:i=t.fitHeight;break;case s.fitWidth:i=t.fitWidth;break;case s.fit:i=t.fitCenter;break;case s.center:i=t.center;break;default:i=t.coverCenter}return i}var s;!function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitWidth=3]="fitWidth";e[e.fitHeight=4]="fitHeight";e[e.top=5]="top"}(s=t.AlignmentType||(t.AlignmentType={}));var l=function(){return function(e,t){this.name=e;this.getTransform=t}}();t.center=new l(s[s.center],function(e,t){var o=new i.default((t.width-e.width)/2,(t.height-e.height)/2);return new n.default(o)});t.top=new l(s[s.top],function(e,t){var o=new i.default((t.width-e.width)/2,0);return new n.default(o)});t.fitWidth=new l(s[s.fitWidth],function(e,t){var o=t.width/e.width;return new n.default(i.default.ORIGIN,Math.min(o,1))});t.fitHeight=new l(s[s.fitHeight],function(e,t){var o=t.height/e.height;return new n.default(i.default.ORIGIN,Math.min(o,1))});t.fit=new l(s[s.fit],function(e,n){return(e.width/e.height>n.width/n.height?t.fitWidth:t.fitHeight).getTransform(e,n)});t.cover=new l(s[s.cover],function(e,n){return(e.width/e.height>n.width/n.height?t.fitHeight:t.fitWidth).getTransform(e,n)});t.fitCenter=o(t.fit,t.center);t.coverCenter=o(t.cover,t.center);t.getAlignment=a;t.createAlignment=function(e){var t;t=e instanceof Array?e:[e];return o.apply(void 0,t.map(a))}});define("odsp-next/controls/image/tile/ImageTile.html",[],function(){return"<span class=od-ImageTile data-bind=\"css: { 'od-ImageTile--isLoaded': isLoaded, 'od-ImageTile--isDimensioned': !!actualSize(), 'od-ImageTile--isRotating': isRotating, 'od-ImageTile--isAligned': !!alignmentName(), 'od-ImageTile--isCustom': !alignmentName() }, class: (alignmentName() ? 'od-ImageTile--' + alignmentName() : '')\">\x3c!--ko imageRecycler: {\r\n imageLoader: imageLoaderParams,\r\n class: 'od-ImageTile-image',\r\n style: imageElementStyle\r\n }--\x3e\x3c!--/ko--\x3e<span class=od-ImageTile-background data-bind=\"style: imageBackgroundStyle\"></span></span>"});define("odsp-next/controls/image/tile/ImageTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}"}])});define("odsp-next/controls/siteIcon/SiteIcon.html",[],function(){return"<span class=od-SiteIcon data-bind=\"css: { 'od-SiteIcon--hasIcon': !!icon, 'od-SiteIcon--hasAcronym': !!acronym, 'od-SiteIcon--hasImage': isImageLoaded }, class: 'od-SiteIcon--' + mode, style: { 'background-color': color }\">\x3c!--ko if: !!icon()--\x3e<span class=od-SiteIcon-icon data-bind=\"component: { name: iconGlyphTagName, params: iconGlyphParams }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: !!acronym()--\x3e<span class=od-SiteIcon-acronym role=img data-bind=\"style: acronymStyle, text: acronym, attr: { alt: acronym }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: !!iconUrl()--\x3e<span class=od-SiteIcon-image data-bind=\"component: { name: imageTileTagName, params: imageTileParams }\"></span>\x3c!--/ko--\x3e</span>"});define("odsp-next/controls/siteIcon/SiteIcon.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SiteIcon{position:absolute;top:0;left:0;bottom:0;right:0;display:block;overflow:hidden;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-SiteIcon--person{border-radius:50%}.od-SiteIcon-icon{position:absolute;top:0;left:0;right:0;bottom:0}.od-SiteIcon-icon .od-IconGlyph.ms-Icon{position:absolute;margin:auto;top:0;left:0;bottom:0;right:0;width:100%}.od-SiteIcon-acronym{position:absolute;top:0;left:0;bottom:0;right:0;height:18px;margin:auto;text-align:center;white-space:nowrap;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:13px;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-SiteIcon-image{position:absolute;top:0;left:0;right:0;bottom:0;visibility:hidden}.od-SiteIcon--site .od-SiteIcon-image:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.od-SiteIcon--hasImage .od-SiteIcon-image{visibility:inherit;background-color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/controls/leftNav/LeftNav.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"./LeftNav",require:e,getExport:function(e){return e.resourceKey.local}})})});t.default=t.resourceKey});define("odsp-next/controls/leftNav/ReactLeftNavComp",["require","exports","knockout","../reactHost/ReactHost"],function(e,t,n,i){"use strict";var o=i.createComponent("ms-react-leftnav","odsp-next/controls/leftNav/react/ReactLeftNav");n.components.isRegistered(o.tagName)||n.components.register(o.tagName,o);return o});define("odsp-next/controls/leftPane/LeftPane.html",[],function(){return'<div class=LeftPane data-bind="scrollContainer, css: { \'LeftPane--hasNotifications\': hasNotifications }"><div class=LeftPane-sections>\x3c!--ko if: useReactLeftNav--\x3e\x3c!--ko component: reactLeftNavSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: useReactLeftNav--\x3e\x3c!--ko control: leftNavSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: hasNotifications--\x3e<div class=LeftPane-notifications data-bind="css: { \'LeftPane-notifications--needsPadding\': needsBottomPadding }"><div class=LeftPane-notificationArea data-bind="component: notificationSublinkSpecification"></div>\x3c!--ko if: needsBottomPadding--\x3e<div class=LeftPane-bottom-padding role=presentation></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("odsp-next/controls/leftPane/LeftPane.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".LeftPane{height:100%;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.LeftPane-notifications{margin-top:auto}.LeftPane-bottom-padding{height:12px}"}])});define("odsp-next/providers/suiteNav/SuiteNavProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/AsyncResources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createDefaultAliasResourceKey(e,"./SuiteNavProvider")});define("@ms/odsp-utilities/lib/resources/AsyncResources",["require","exports","../modules/Modules","./Resources"],function(e,t,n,i){"use strict";function o(e){return e.resourceKey}t.getResourceKeyExport=o;t.createDefaultAliasResourceKey=function(e,t){return new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({require:e,path:t,getExport:o})})})}});define("odsp-next/utilities/suiteExtensions/SuiteExtensionsHelper",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/logging/events/Engagement.event","../features/Features","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/events/EventGroup","../icons/Icon","../../models/task/Task"],function(e,t,n,i,o,r,a,s,l,u){"use strict";var c=function(){function e(){this._events=new s.default(this)}e.getInstance=function(){return e._instance};e.prototype.initializeSuiteExtensions=function(e){var t=this;if((o.isFeatureEnabled(o.ODBNextFileHandler)||o.isFeatureEnabled(o.ODBNextFileCreation))&&"undefined"!=typeof SuiteExtensions&&e){var s=new r.Qos({name:"FileHandlerOneDrive.Initialize"});try{this._webAbsoluteUrl=e.webAbsoluteUrl;var l=new SuiteExtensions.HostConfig(String(e.userId),function(t,i,o){var s=new r.Qos({name:"FileHandlerOneDrive.CallAzureDataPipe"});try{var l=new XMLHttpRequest,u=new Error;if(null===l){n.default.log("XmlHttpRequest object is null","FileHandlerOneDrive.CallAzureDataPipe");s.end({resultType:a.ResultTypeEnum.Failure});return}l.onreadystatechange=function(){if(4===l.readyState)if(200===l.status){var e=JSON.parse(l.responseText);n.default.verbose("Successfully fetched add-in data from Azure, will try to set local storage now","FileHandlerOneDrive.CallAzureDataPipe");s.end({resultType:a.ResultTypeEnum.Success});var r=(JSON.parse(e.value)||[]).filter(function(e){return!e.properties.version&&!e.properties.actions&&!e.properties.fileTypeName});i(t,JSON.stringify(r))}else{n.default.log("Correlation id is "+l.getResponseHeader("SPRequestGuid"),"FileHandlerOneDrive.CallAzureDataPipe");u.description=l.responseText;if(503===l.status||500===l.status){n.default.log("Failed to fetch add-in data, xmlhttp status is "+l.status.toString(),"FileHandlerOneDrive.CallAzureDataPipe");u.message="Failed to fetch add-in data, xmlhttp status is "+l.status.toString()+", xmlhttp responsetext is "+l.responseText;s.end({resultCode:l.status.toString(),resultType:a.ResultTypeEnum.ExpectedFailure})}else{u.message="Failed to fetch add-in data, looks like an unknown failure, xmlhttp status is "+l.status.toString()+", xmlhttp responsetext is "+l.responseText;s.end({resultType:a.ResultTypeEnum.Failure})}o(u)}};var c=e.webAbsoluteUrl+"/_api/apps/GetByType('"+t+"')";l.open("GET",c,!0);l.setRequestHeader("Accept","application/json;odata=nometadata");n.default.verbose("Trying to fetch add-in data from Azure, webAbsoluteUrl is - "+e.webAbsoluteUrl+", fileHandlerEndPoint is - "+c,"FileHandlerOneDrive.CallAzureDataPipe");try{l.send("")}catch(e){n.default.log("Correlation id is "+l.getResponseHeader("SPRequestGuid"),"FileHandlerOneDrive.CallAzureDataPipe");s.end({resultType:a.ResultTypeEnum.Failure});o(e)}}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.CallAzureDataPipe");s.end({resultType:a.ResultTypeEnum.Failure})}});l.host="OneDrive";l.set_logging(n.default,i.Engagement);l.cultureName=e.currentUICultureName;l.resourceId=window.location.protocol+"//"+window.location.hostname;l.controlsScriptPath=e.webAbsoluteUrl+"/"+e.layoutsUrl+"/online/scripts/SuiteExtensionsControls.js";l.controlsScriptLoadCallback=function(){t._events.raise("dataReady")};o.isFeatureEnabled(o.FileExtensionDataPipe)&&l.addFlight(SuiteExtensions.AddInsFlights.AzureDataPipe);o.isFeatureEnabled(o.FileHandlerAddInPicker)&&l.addFlight(SuiteExtensions.AddInsFlights.FileHandlerAddInPicker);o.isFeatureEnabled(o.ODBNextFileCreation)&&l.addFlight(SuiteExtensions.AddInsFlights.FileHandlerFileCreation);SuiteExtensions.SuiteExtensionsDataStore.Initialize(l);s.end({resultType:a.ResultTypeEnum.Success})}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.Initialize");s.end({resultType:a.ResultTypeEnum.Failure})}}};e.prototype.updateItem=function(e,t){var n=this,i=this._tryUpdateItem(e,t,!0);if(!i){var o=0;this._events.on(this,"dataReady",function(){o++;n._tryUpdateItem(e,t,!1);o>=2&&n._events.off(n,"dataReady")})}return i};e.prototype.updateCommand=function(e,t,i){var s=this,u=null,c=function(){if(o.isFeatureEnabled(o.ODBNextFileCreation)&&"undefined"!=typeof SuiteExtensionsControls&&"undefined"!=typeof SuiteExtensions&&e&&t&&i){var s=new r.Qos({name:"FileHandlerOneDrive.TryUpdateNewFileMenu"});try{if(u){e.children.removeAll(u);u=null}var c=SuiteExtensions.ControlFactory.CreateControl("",SuiteExtensions.ControlType.FileCreation);if(null!=c){var d=c.get_fileCreationEntries();if(d.length>0){var p=new r.Qos({name:"FileHandlerOneDrive.UpdateNewFileMenu"});u=[];p.end({resultType:a.ResultTypeEnum.Success})}for(var m=0;m<d.length&&d[m].displayName;m++)d[m].imageUrl?u.push(new t({text:d[m].displayName,iconUrl:d[m].imageUrl,action:new i({entryIndex:m,fileCreationMenu:c})})):u.push(new t({text:d[m].displayName,icon:new l("Page"),action:new i({entryIndex:m,fileCreationMenu:c})}));e.children.push.apply(e.children,u);s.end({resultType:a.ResultTypeEnum.Success});return!0}s.end({resultType:a.ResultTypeEnum.Success});return!1}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.TryUpdateNewFileMenu");s.end({resultType:a.ResultTypeEnum.Failure})}}return!1};c()||this._events.on(this,"dataReady",c);return{dispose:function(){s._events.off(s,"dataReady",c);if(u){e.children.removeAll(u);u=null}}}};e.prototype._tryUpdateItem=function(e,t,i){var s;if(o.isFeatureEnabled(o.ODBNextFileHandler)&&"undefined"!=typeof SuiteExtensionsControls&&"undefined"!=typeof SuiteExtensions&&e&&t){var l=new r.Qos({name:"FileHandlerOneDrive.TryUpdateItem"});try{var c=!1,d=this._getFileHandlerFileIcon(t);d&&(c=!0);var p=this._getFileHandlerPreviewRedirectUrl(t);p&&(c=!0);var m=this._getFileHandlerEditRedirectUrl(t);m&&(c=!0);if(c){s={key:t.key};if(d){var f=new r.Qos({name:"FileHandlerOneDrive.UpdateIcon"});s.iconUrl=d;f.end({resultType:a.ResultTypeEnum.Success})}if(p){var h=new r.Qos({name:"FileHandlerOneDrive.UpdatePreview"});s.previewIFrameUrl=p;h.end({resultType:a.ResultTypeEnum.Success})}if(m){var g=new r.Qos({name:"FileHandlerOneDrive.UpdateEdit"});s.openUrl=m;g.end({resultType:a.ResultTypeEnum.Success})}if(!i){e.update([new u.default(t.key).succeed({item:s})]);e.flush();e.dispose()}}l.end({resultType:a.ResultTypeEnum.Success})}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.TryUpdateItem");l.end({resultType:a.ResultTypeEnum.Failure})}}return s};e.prototype._getFileHandlerFileIcon=function(e){var t=new r.Qos({name:"FileHandlerOneDrive.GetIcon"});try{if(e&&e.extension&&"genericfile"===e.iconName){var i=SuiteExtensions.ControlFactory.CreateControl(e.extension.replace(".",""),SuiteExtensions.ControlType.Icon);if(null!=i){var o=i.getFileIcon();t.end({resultType:a.ResultTypeEnum.Success});return o}}t.end({resultType:a.ResultTypeEnum.Success});return null}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.GetIcon");t.end({resultType:a.ResultTypeEnum.Failure})}};e.prototype._getFileHandlerPreviewRedirectUrl=function(e){var t=new r.Qos({name:"FileHandlerOneDrive.GetPreview"});try{if(e&&e.extension&&!e.previewIFrameUrl&&this._webAbsoluteUrl){var i=SuiteExtensions.ControlFactory.CreateControl(e.extension.replace(".",""),SuiteExtensions.ControlType.Preview);if(null!=i){i.set_itemUrl(e.id);i.set_httpRoot(this._webAbsoluteUrl);var o=i.getRedirectUrl();t.end({resultType:a.ResultTypeEnum.Success});return o}}t.end({resultType:a.ResultTypeEnum.Success});return null}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.GetPreview");t.end({resultType:a.ResultTypeEnum.Failure})}};e.prototype._getFileHandlerEditRedirectUrl=function(e){var t=new r.Qos({name:"FileHandlerOneDrive.GetEdit"});try{if(e&&e.extension&&e.id&&e.openUrl&&e.id===e.openUrl&&this._webAbsoluteUrl){var i=SuiteExtensions.ControlFactory.CreateControl(e.extension.replace(".",""),SuiteExtensions.ControlType.Edit);if(null!=i){i.set_itemUrl(e.id);i.set_httpRoot(this._webAbsoluteUrl);var o=i.getRedirectUrl();t.end({resultType:a.ResultTypeEnum.Success});return o}}t.end({resultType:a.ResultTypeEnum.Success});return null}catch(e){n.default.log("Unexpected exception "+e.toString(),"FileHandlerOneDrive.GetEdit");t.end({resultType:a.ResultTypeEnum.Failure})}};return e}();c._instance=new c;return c});define("odsp-next/models/task/Task",["require","exports"],function(e,t){"use strict";function n(e){return!!e&&"object"==typeof e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){if(n(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),i=new e(this.key,n);i.output=this.output;i.status=this.status;i.error=this.error;return i};e.prototype.changeOutput=function(t){var n=t(this.output),i=new e(this.key,this.input);i.output=n;i.status=this.status;i.error=this.error;return i};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e}();t.default=i});define("@ms/odsp-utilities/lib/require/RequireConfigInjector",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}e.addConfig=function(e){requirejs.config(e)};e.addPaths=function(e){requirejs.config({paths:e})};e.addShims=function(e){requirejs.config({shim:e})};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("odsp-next/providers/transclusion/TransclusionProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.contexts=i.observables.createArray();i._additions=[];i._removals=[];return i}n.__extends(t,e);t.prototype.transclude=function(e){var t=this;this._transclude(e);return{dispose:function(){t._dispose(e)}}};t.prototype._transclude=function(e){this._additions.push(e);this._updateContextsTimeoutId||this._updateContexts()};t.prototype._dispose=function(e){this._removals.push(e);this._updateContextsTimeoutId||this._updateContexts()};t.prototype._updateContexts=function(){this._updateContextsTimeoutId=this.async.requestAnimationFrame(this._onUpdateContextsTimeout);var e=this.contexts.peek(),t=this._additions.splice(0),n=this._removals.splice(0);this.contexts.valueWillMutate();e.push.apply(e,t);for(var i=0,o=n;i<o.length;i++){var r=o[i],a=e.indexOf(r);a>-1&&e.splice(a,1)}this.contexts.valueHasMutated()};t.prototype._onUpdateContextsTimeout=function(){this.contexts.valueHasMutated();this._updateContextsTimeoutId=void 0;(this._additions.length||this._removals.length)&&this._updateContexts()};return t}(i.default);t.default=r;t.factory=new o.SimpleResourceFactory(r)});define("odsp-next/models/item/ItemParentHelper",["require","exports","../store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getFacetedAncestorOrSelf=function(e,t){return this.getAncestorOrSelf(e,function(e){return!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n;e;){var i=this._itemsStore.getItem(e.key),o=i&&i.peek();if(!o)break;if(t(o)){n=i;break}e=e.parent}return n};return e}();o.dependencies={itemsStore:n.resourceKey};t.default=o;t.resourceKey=i.createDefaultResourceKey(e,o)});define("odsp-next/models/store/ItemsStore",["require","exports","tslib","../item/OneDriveItem","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../item/ItemType","../../utilities/array/ArrayHelper","../../utilities/graft/Graft"],function(e,t,n,i,o,r,a,s,l,u,c,d){"use strict";function p(e){return e&&e.item&&e.item.peek().key}function m(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new r.default(t);window.odstore=t;return t}n.__extends(t,e);t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,[e,"item="].concat(t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var i=(t=this.getValue(n)).content&&t.content.peek(),o=i&&i.items;if(o)for(var r=0,a=o;r<a.length;r++){var s=a[r];if(s&&s.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var i="token="+t;n?this.setValue(i,n):this.remove(i)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e){return this._handleItemInvalidation(e,this.getItem(e))};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&m(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&m(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var i=p(t=this.getValue(n));if(i){var o=s.deserializeQuery(i),r=o&&o.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var i=p(t=this.getValue(n));if(i){var o=s.deserializeQuery(i);o&&o.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype._handleItemInvalidation=function(e,t){if(t){var n=t.peek(),i=!1,o=[];if(n){o.push(n);switch(n.type){case u.Folder:case u.Media:i=!0}}for(var r in this._itemSetsKeys){var a=this.getValue(r),s=a.item&&a.item.peek(),l=s&&s.key;if(l&&(l===e||i&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(s);a.isExpired=!0}}o.forEach(this._invalidateItem,this)}};t.prototype._invalidateItem=function(e){var t=new i(e.key);d.default(t,e);d.default(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var o=[],r=0,a=c.removeDuplicates([e.key].concat(n));r<a.length;r++){var s=""+t+a[r],u=this.getValue(s);if(u)u(e);else{(u=this._observables.create(e)).equalityComparer=l.objectStrictEquality;this.setValue(s,u)}o.push(u)}return o[0]};return t}(o.default);t.ItemsStore=f;t.resourceKey=new a.ResourceKey({name:e("module").id,factory:new a.SimpleResourceFactory(f)});t.default=f});define("odsp-next/models/item/OneDriveItem",["require","exports","../../dataSources/url/QueryType"],function(e,t,n){"use strict";return function(){return function(e){this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=n.Files;this.displayType=n.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}}}()});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};define("@ms/odsp-shared/lib/utilities/navigation/NavigationHelper",["require","exports","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/navigation/AddressParser"],function(e,t,n,i){"use strict";t.replaceQuery=function(e,t,n){var i="([?|&])"+t+"=([^&]+)",o=new RegExp(i,"i");return e.replace(o,"$1"+t+"="+n)};t.serializeQuery=function(e,t,i){var o="",r=!0;t&&(e=__assign({},t,e));for(var a in e){var s=e[a];if(!i||"object"!=typeof s&&s||"object"==typeof s&&s&&s.uriValue||"number"==typeof s||"boolean"==typeof s){r?r=!1:o+="&";o+=a+"="+("object"==typeof s&&s&&s.uriValue?s.uriValue:n.default.encodeURIComponent(""+s))}}return o};t.deserializeQuery=i.deserializeQuery});define("odsp-next/models/item/ItemType",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"}(n||(n={}));return n});define("odsp-next/utilities/array/ArrayHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeDuplicates=function(e){var t;t={};for(var n=[],i=0,o=e;i<o.length;i++){var r=o[i],a=""+r;if(!t[a]){t[a]=!0;n.push(r)}}return n}});define("odsp-next/utilities/graft/Graft",["require","exports"],function(e,t){"use strict";function n(e,t){if(!i(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!i(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var d=0,p=Object.keys(t);d<p.length;d++){var m=p[d],f=t[m],h=e[m];if(f!==h){var g=f;if(a(g))if(c(g)){h=void 0;f=v=g.value}else if(s(g)){var v=g.value;if(void 0!==e[m])continue;f=v}else{if(!u(g)){if(l(g)){delete e[m];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(v=g.value))continue;f=v}var b=void 0;if(o(f))b=new Date(f.getTime());else if(r(f)){var y=h;r(y)||(y=[]);y.splice.apply(y,[0,y.length].concat(f));b=y}else if(i(f)){var x=h;i(x)||(x={});n(x,f);b=x}else b=f;e[m]=b}}return e}function i(e){return"object"==typeof e&&!!e}function o(e){return e instanceof Date}function r(e){return Array.isArray(e)}function a(e){return i(e)&&!!e.graftOperationType}function s(e){return 4===e.graftOperationType}function l(e){return 3===e.graftOperationType}function u(e){return 2===e.graftOperationType}function c(e){return 1===e.graftOperationType}Object.defineProperty(t,"__esModule",{value:!0});t.remove=function(){return{graftOperationType:3}};t.optional=function(e){return{graftOperationType:2,value:e}};t.backup=function(e){return{graftOperationType:4,value:e}};t.replace=function(e){return{graftOperationType:1,value:e}};t.default=n});define("odsp-next/bindings/dragAndResize/DragAndResizeBinding",["require","exports","tslib","../BaseBinding","knockout","@ms/odsp-utilities/lib/locale/Locale"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,i=t.valueAccessor();n._left=i.left;n._right=i.right;n._skipResizeOnMouseMove=i.skipResizeOnMouseMove;n._onMouseUpCallback=i.onMouseUpCallback;n._isResizing=i.isResizing||o.observable(!1);n._resize=n.async.throttle(function(){o.utils.triggerEvent(document.body,"resize")},350);n._initEvents();return n}n.__extends(t,e);t.prototype._onMouseDown=function(e){if(0===e.button){this._isDragged=!1;this._initialLeft=this._left?this._left.peek():null;this._initialRight=this._right?this._right.peek():null;this._initialMouseX=e.clientX;this._isResizing(!0);this.events.on(window,"mousemove",this._onMouseMove,!0);this.events.on(window,"mouseup",this._onMouseUp,!0)}};t.prototype._onMouseUp=function(e){this.events.off(window,"mousemove",this._onMouseMove,!0);this.events.off(window,"mouseup",this._onMouseUp,!0);this._isResizing(!1);this._onMouseUpCallback&&this._onMouseUpCallback(this._isDragged)};t.prototype._onMouseMove=function(e){var t=e.clientX-this._initialMouseX;if(0!==t){this._isDragged=!0;if(r.default.isRightToLeft){this._left&&this._left(this._initialLeft-t);this._right&&this._right(this._initialRight+t)}else{this._left&&this._left(this._initialLeft+t);this._right&&this._right(this._initialRight-t)}this._skipResizeOnMouseMove||this._resize()}else this._isDragged=!1;e.stopImmediatePropagation();e.preventDefault()};t.prototype._initEvents=function(){var e=this.element;this.events.on(e,"mousedown",this._onMouseDown)};return t}(i);t.default=a});define("odsp-next/bindings/dragAndDrop/DragAndDropBinding",["require","exports","tslib","../BaseBinding"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n._isDragging=i.isDragging;n._mayReceiveDrop=i.mayReceiveDrop;n._receiveDrop=i.receiveDrop;n._dragOutWindow=i.dragOutWindow;var o=n.observables;n._state=o.create({isWithinElement:!1,data:void 0}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});n._isDragging&&o.compute(function(){n._isDragging.call(n.bindingContext.$data,n._state().isWithinElement,n._state().data)});n.events.onAll(n.element,{"od-dragEnter":n._onDragEnter,"od-dragLeave":n._onDragLeave,"od-processDrop":n._onProcessDrop,"od-dragOutWindow":n._onDragOutWindow});return n}n.__extends(t,e);t.prototype._onDragEnter=function(e){var t=e.args;if(!t||!t.dragData||!t.dropSourceElement)return!0;this._state({isWithinElement:!0,data:{dragData:t.dragData,dropTargetData:t.dropTargetData}});!t.dropTargetData&&this._mayReceiveDrop&&(t.dropTargetData=this._mayReceiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement));return!0};t.prototype._onDragLeave=function(e){this._state({isWithinElement:!1,data:void 0});return!0};t.prototype._onProcessDrop=function(e){var t=e.args;if(!t||!t.dragData||!t.dropSourceElement)return!0;if(!t.isHandled&&this._receiveDrop&&this._receiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)){t.isHandled=!0;return!1}this._state({isWithinElement:!1,data:void 0});return!0};t.prototype._onDragOutWindow=function(e){this._state({isWithinElement:!1,data:void 0});return!0};return t}(i);t.default=o});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define("@ms/odsp-shared/lib/models/store/KnockoutDataStore",["require","exports","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/models/store/BaseDataStore","../../base/BaseModel"],function(e,t,n,i,o){"use strict";var r=function(e){function t(t,o){void 0===o&&(o=n.default.none);var r=e.call(this)||this;r.dataStore=new i.default(t,o);return r}__extends(t,e);t.prototype.persistBoolean=function(e,t){var n=this,i=this.getValue(t);void 0!==i&&e("true"===i);this.subscribe(e,function(e){return n.setValue(t,String(e))})};t.prototype.persistNumber=function(e,t){var n=this,i=this.getValue(t);void 0!==i&&e(Number(i));this.subscribe(e,function(e){return n.setValue(t,String(e))})};t.prototype.persistString=function(e,t){var n=this,i=this.getValue(t);void 0!==i&&e(i);this.subscribe(e,function(e){return n.setValue(t,e)})};t.prototype.setValue=function(e,t,n){this.dataStore.setValue(e,t,n)};t.prototype.getValue=function(e,t){return this.dataStore.getValue(e,t)};t.prototype.remove=function(e,t){this.dataStore.remove(e,t)};return t}(o.default);Object.defineProperty(t,"__esModule",{value:!0});t.default=r});define("@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.invalidType=-1]="invalidType";e[e.noListTemplate=0]="noListTemplate";e[e.genericList=100]="genericList";e[e.documentLibrary=101]="documentLibrary";e[e.survey=102]="survey";e[e.links=103]="links";e[e.announcements=104]="announcements";e[e.contacts=105]="contacts";e[e.events=106]="events";e[e.tasks=107]="tasks";e[e.pictureLibrary=109]="pictureLibrary";e[e.webTemplateCatalog=111]="webTemplateCatalog";e[e.webPartCatalog=113]="webPartCatalog";e[e.listTemplateCatalog=114]="listTemplateCatalog";e[e.xmlFormLibrary=115]="xmlFormLibrary";e[e.masterPageCatalog=116]="masterPageCatalog";e[e.webPageLibrary=119]="webPageLibrary";e[e.solutionCatalog=121]="solutionCatalog";e[e.themeCatalog=123]="themeCatalog";e[e.designCatalog=124]="designCatalog";e[e.appDataCatalog=125]="appDataCatalog";e[e.ganttTasks=150]="ganttTasks";e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy";e[e.meetings=200]="meetings";e[e.externalList=600]="externalList";e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary"}(n=t.ListTemplateType||(t.ListTemplateType={}));var i=[n.mySiteDocumentLibrary,n.documentLibrary,n.pictureLibrary,n.xmlFormLibrary,n.webPageLibrary];t.isDocumentLibrary=function(e){var t=Number(e);return-1!==i.indexOf(t)};t.isGenericList=function(e){return e===n.genericList||e===n.announcements};t.default=n});define("odsp-next/dataSources/url/odb/UrlQueryKeys",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e.idParamKey="id";e.parentIdParamKey="parent";e.queryTypeParamKey="view";e.pageParamKey="p";e.parentQueryTypeParamKey="parentview";e.windowNameJsonKey="ODBParams";e.queryParamKey="q";e.conversationIdParamKey="cvid";e.uniqueParamKey="u";e.dateFilterKey="dateFilter";e.typeFiltersKey="typeFilters";e.userFiltersKey="userFilters";e.viewIdKey="viewid";e.viewPathKey="viewpath";e.listIdKey="listid";e.listUrlKey="listurl";e.sortFieldKey="sortField";e.isAscendingKey="isAscending";e.policyTipKey="policyTipForListItemId";e.sharingKey="sharingDialogForListItemId";e.pseudoPolicyTipKey="showpolicytips";e.groupByKey="groupBy";e.sortGroupKeyRegex=/^(sortField|isAscending|groupBy)$/;e.filterKeyRegex=/^Filter(Field|Value|Type)(s?)([1-9]|10)$/;e.useFiltersInViewXmlKey="useFiltersInViewXml";e.pickerLinkTypeKey="link_type";e.pickerAADClientIdKey="aad_client_id";e.pickerMSAClientIdKey="msa_client_id";e.pickerSelectionModeKey="selection_mode";e.pickerViewTypeKey="view_type";e.pickerAccessLevelKey="access";e.pickerReturnUrlKey="ru";e.stateParamKey="state";e.listItemIdKey="ID";e.rootFolderParamKey="RootFolder";e.sourceKey="Source";e.isDialogKey="IsDlg";e.contentTypeId="ContentTypeId";e.newTargetListUrlKey="newTargetListUrl"}(n||(n={}));t.default=n});define("@ms/odsp-datasources/lib/Permissions",["require","exports","./utilities/permissions/Identity","./utilities/permissions/PermissionMask"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Identity=n.Identity;t.IdentityType=n.IdentityType;t.PermissionMask=i.PermissionMask});define("@ms/odsp-datasources/lib/utilities/permissions/Identity",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.anonymous=1]="anonymous";e[e.msa=2]="msa";e[e.aad=3]="aad"}(t.IdentityType||(t.IdentityType={}));var n=function(){return function(){}}();t.Identity=n;t.default=n});define("@ms/odsp-datasources/lib/utilities/permissions/PermissionMask",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)};e.hasPermission=function(e,t){return t&&e&&(t.Low&e.Low)===t.Low&&(t.High&e.High)===t.High};e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})};e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)};return e}();n.insertListItems={High:0,Low:2};n.editListItems={High:0,Low:4};n.deleteListItems={High:0,Low:8};n.approveItems={High:0,Low:16};n.openItems={High:0,Low:32};n.viewVersions={High:0,Low:64};n.deleteVersions={High:0,Low:128};n.cancelCheckout={High:0,Low:256};n.manageLists={High:0,Low:2048};n.viewFormPages={High:0,Low:4096};n.viewPages={High:0,Low:131072};n.layoutsPage={High:0,Low:135168};n.addAndCustomizePages={High:0,Low:262144};n.applyThemeAndBorder={High:0,Low:524288};n.viewUsageData={High:0,Low:2097152};n.manageSubwebs={High:0,Low:8388608};n.managePermissions={High:0,Low:33554432};n.browseDirectories={High:0,Low:67108864};n.manageWeb={High:0,Low:1073741824};n.useClientIntegration={High:16,Low:0};n.manageAlerts={High:64,Low:0};n.createAlerts={High:128,Low:0};n.enumeratePermissions={High:1073741824,Low:0};n.fullMask={High:2147483647,Low:4294967295};t.PermissionMask=n;t.default=n});define("odsp-next/actions/odb/ActionMap",["require","exports","tslib","../BaseActionMap","../DeferredAction","../../utilities/features/Features","./CreateCustomDocumentAction","./DefaultClickAction","../fileHandler/FileHandlerOpenAction","../navigateToItem/NavigateToItemAction","../NavigationAction","./OpenAction","../openInExplorer/odb/OpenInExplorerAction","./OpenInOfficeClientAction","./OpenInOfficeOnlineAction","../OpenPdfInBrowserAction","../openInTextEditor/OpenInTextEditorAction","./OpenShortcutAction","../SelectAction","../SelectAllAction","../SetFocusAction","../showOperations/ShowOperationsAction","../toggleSelectionMode/ToggleSelectionModeAction"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b,y,x,_,w){"use strict";return function(t){function i(){var n=t.call(this)||this;n.CreateCustomDocumentAction=a;n.DefaultClickAction=s.default;n.FileHandlerOpenAction=l.default;n.OpenAction=d.default;n.OpenInExplorerAction=p.default;n.OpenInOfficeClientAction=m.default;n.OpenInOfficeOnlineAction=f.default;n.OpenPdfInBrowserAction=h.default;n.OpenInTextEditorAction=g.default;n.OpenShortcutAction=v;n.NavigateToItemAction=u.default;n.NavigationAction=c;n.SelectAction=b.default;n.SelectAllAction=y;n.SetFocusAction=x;n.ShowOperationsAction=_.default;n.ToggleSelectionModeAction=w.default;n.AlertAction=o.create(e,"./AlertAction");n.AuthenticationPolicyWarningAction=o.create(e,"./AuthenticationPolicyWarningAction");n.CheckInAction=o.create(e,"./CheckInAction");n.CheckOutAction=o.create(e,"./CheckOutAction");n.ClearFilterAction=o.create(e,"../ClearFilterAction");n.ClearSelectionAction=o.create(e,"../ClearSelectionAction");n.ContentTypeNavigationAction=o.create(e,"./ContentTypeNavigationAction");n.CreateDocumentAction=o.create(e,"./CreateDocumentAction");n.CreateFolderAction=o.create(e,"../createFolder/odb/CreateFolderAction");n.CreateNewFolderAction=o.create(e,"../createNewFolder/CreateNewFolderAction");n.CustomActionNavigationAction=o.create(e,"./CustomActionNavigationAction");n.DeleteAction=o.create(e,"../delete/odb/DeleteAction");n.DownloadAction=o.create(e,"../download/odb/DownloadAction");n.EditAction=o.create(e,"./EditAction");n.EmptyRecycleBinAction=o.create(e,"../emptyRecycleBin/odb/EmptyRecycleBinAction");n.FilterAction=o.create(e,"../FilterAction");n.GetLinkAction=o.create(e,"odsp-next/actions/getLink/odb/GetLinkAction");n.GroupItemsAction=o.create(e,"../groupItems/GroupItemsAction");n.LaunchCreateGroupPanelAction=o.create(e,"../LaunchCreateGroupPanelAction");n.LaunchCreateShortcutPanel=o.create(e,"./LaunchCreateShortcutPanel");n.LaunchMoveCopyPanelAction=o.create(e,"../launchMoveCopyPanel/odb/LaunchMoveCopyPanelAction");n.MoveCopyAction=o.create(e,"../moveCopy/odb/MoveCopyAction");n.NavigateToSharePointHomeAction=o.create(e,"../navigateToSharePointHome/NavigateToSharePointHomeAction");n.OpenSiteAction=o.create(e,"../openSite/OpenSiteAction");n.PolicyTipAction=o.create(e,"../PolicyTipAction");n.PrintPdfAction=o.create(e,"../printPdf/odb/PrintPdfAction");n.RemoveFromSharedListAction=o.create(e,"./RemoveFromSharedListAction");n.RemoveTagAction=o.create(e,"../RemoveTagAction");n.RenameAction=o.create(e,"../rename/odb/RenameAction");n.RestoreAction=o.create(e,"../restore/RestoreAction");n.SaveAction=o.create(e,"../save/odb/SaveAction");n.ShareAction=o.create(e,"../share/odb/ShareAction");n.ShareByLinkAction=o.create(e,"../shareByLink/odb/ShareByLinkAction");n.ShowPermissionsAction=o.create(e,"../showPermissions/ShowPermissionsAction");n.ShowItemAnalyticsAction=o.create(e,"../showItemAnalytics/ShowItemAnalyticsAction");n.ShowShareAction=o.create(e,"../showShare/ShowShareAction");n.ShowKeyboardMapAction=o.create(e,"../showKeyboardMap/ShowKeyboardMapAction");n.ShowFiltersAction=o.create(e,"../showFilters/odb/ShowFiltersAction");n.ShowPropertiesAction=o.create(e,"../ShowPropertiesAction");n.ShowHashtagsAction=o.create(e,"./ShowHashtagsAction");n.ShowSelectionAction=o.create(e,"../ShowSelectionAction");n.ShowVersionHistoryAction=r.isFeatureEnabled(r.UseNewVersionHistory)?o.create(e,"../showVersionHistoryAction/ShowReactVersionHistoryAction"):o.create(e,"./ShowVersionHistoryAction");n.ViewInFolderAction=o.create(e,"../viewInFolder/ViewInFolderAction");n.OneDriveSortAction=o.create(e,"../sort/od/OneDriveSortAction");n.SortAction=o.create(e,"../sort/SortAction");n.SyncAction=o.create(e,"./SyncAction");n.ToggleListLayoutAction=o.create(e,"../toggleListLayout/odb/ToggleListLayoutAction");n.UndoCheckOutAction=o.create(e,"./UndoCheckOutAction");n.UpdatePermissionsAction=o.create(e,"../UpdatePermissionsAction");n.UploadAction=o.create(e,"./UploadAction");return n}n.__extends(i,t);return i}(i)});define("odsp-next/actions/BaseActionMap",["require","exports","./UnsupportedAction"],function(e,t,n){"use strict";return function(){return function(){this.AuthenticationPolicyWarningAction=n;this.AddCoverPhotoAction=n;this.AddExistingAppViewAction=n;this.AddFlowAction=n;this.AddPhotosToAlbumAction=n;this.AddToAlbumAction=n;this.AddToBundleAction=n;this.AddToQuickLaunchAction=n;this.AddToSharedListAction=n;this.AddToSpotlightAction=n;this.AlertAction=n;this.ApplyOfficeLensAction=n;this.ApproveRejectAction=n;this.AutoExecuteAction=n;this.CancelEditAction=n;this.ChangeAppViewVisibilityAction=n;this.ChangeFolderTypeAction=n;this.CheckInAction=n;this.CheckOutAction=n;this.ClearFilterAction=n;this.ClearSelectionAction=n;this.ComplianceDetailsAction=n;this.ContentTypeNavigationAction=n;this.CopyFieldAction=n;this.CreateAlbumAction=n;this.CreateAlbumFromFolderAction=n;this.CreateAppViewAction=n;this.CreateColumnAction=n;this.CreateCustomDocumentAction=n;this.CreateDocumentAction=n;this.CreateFolderAction=n;this.CreateItemAction=n;this.CreateMountPointAction=n;this.CreateNewFolderAction=n;this.CreateSitePageAction=n;this.CustomActionNavigationAction=n;this.CustomizeFormsNavigationAction=n;this.CustomizeViewAction=n;this.DefaultClickAction=n;this.DeleteAction=n;this.DeleteAppAction=n;this.DeleteViewAction=n;this.DownloadAction=n;this.EditAction=n;this.EditItemAction=n;this.EditItemCancelAction=n;this.EditItemSaveAction=n;this.EditNewAppViewAction=n;this.EditTagsAction=n;this.EmbedAction=n;this.EmptyRecycleBinAction=n;this.ExportListAction=n;this.ExtractItemsFromPhotoBurstAction=n;this.FeedbackAction=n;this.FileHandlerOpenAction=n;this.FilterAction=n;this.FilterSearchAction=n;this.FilterSearchByDateAction=n;this.GetLinkAction=n;this.GroupItemsAction=n;this.InvokeFirstRunExperienceAction=n;this.KeepOnlySelectedPhotoBurstItemsAction=n;this.LanguagePickerAction=n;this.LaunchChangeTheLookPanelAction=n;this.LaunchCreateAppViewPanelAction=n;this.LaunchColumnManagementPanelAction=n;this.LaunchCreateGroupPanelAction=n;this.LaunchCreateShortcutPanel=n;this.LaunchFilterPanelAction=n;this.LaunchFullReportPanelAction=n;this.LaunchGroupMembershipPanelAction=n;this.LaunchListCreationPanelAction=n;this.LaunchListFormAction=n;this.LaunchMoveCopyPanelAction=n;this.LaunchFlowPanelAction=n;this.LaunchSitePermissionsPanelAction=n;this.LaunchSiteSettingsPanelAction=n;this.MakeHomepageAction=n;this.ModifyColumnAction=n;this.ModifyShowInFiltersPaneAction=n;this.MoveCopyAction=n;this.MoveLeftSpotlightAction=n;this.MoveRightSpotlightAction=n;this.NavigateToItemAction=n;this.NavigateToSharePointHomeAction=n;this.NavigationAction=n;this.OpenAction=n;this.OpenAppAction=n;this.OpenInExplorerAction=n;this.OpenInOfficeClientAction=n;this.OpenInOfficeOnlineAction=n;this.OpenInTextEditorAction=n;this.OpenNavLinkAction=n;this.OpenPdfInBrowserAction=n;this.OpenShortcutAction=n;this.OpenSiteAction=n;this.OrderPrintsAction=n;this.PinToFiltersPaneAction=n;this.PlayAudioAction=n;this.PlaySlideShowAction=n;this.PolicyTipAction=n;this.PrintPdfAction=n;this.PublishAction=n;this.RearrangeAction=n;this.RedeemAction=n;this.RedeemCodeAction=n;this.RemoveCoverPhotoAction=n;this.RemoveFromAlbumAction=n;this.RemoveFromBundleAction=n;this.RemoveFromRecentAction=n;this.RemoveFromSharedListAction=n;this.RemoveFromSpotlightAction=n;this.RemoveMountPointAction=n;this.RemoveOfficeLensAction=n;this.RemoveTagAction=n;this.RemoveTagFromItemAction=n;this.RenameAction=n;this.RenameColumnAction=n;this.ReportAbuseAction=n;this.RequestReviewAction=n;this.RestoreAction=n;this.RestoreAllAction=n;this.RotateAction=n;this.SaveAction=n;this.SaveAutoAlbumAction=n;this.SaveSortOrderAction=n;this.SaveViewAction=n;this.SelectAction=n;this.SelectAllAction=n;this.SetAlbumCoverPhotoAction=n;this.SetDefaultViewAction=n;this.SetFocusAction=n;this.SetPhotoBurstWinnerAction=n;this.SetPhotosRootAction=n;this.ShareAction=n;this.ShowPermissionsAction=n;this.ShowItemAnalyticsAction=n;this.ShareByLinkAction=n;this.ShowExistingFlowsAction=n;this.ShowFiltersAction=n;this.ShowKeyboardMapAction=n;this.ShowOperationsAction=n;this.ShowPropertiesAction=n;this.ShowHashtagsAction=n;this.ShowSelectionAction=n;this.ShowVersionHistoryAction=n;this.SignOutAction=n;this.OneDriveSortAction=n;this.StopSlideShowAction=n;this.SurveyAction=n;this.SwitchPhotoFolderLayoutTypeAction=n;this.SwitchSharingLinkAction=n;this.SwitchViewAction=n;this.SyncAction=n;this.SynchronizeAppViewAction=n;this.ToggleAction=n;this.ToggleDebugWindowAction=n;this.ToggleListLayoutAction=n;this.ToggleSelectionModeAction=n;this.TriggerFlowAction=n;this.UndoCheckOutAction=n;this.UnPublishAction=n;this.UpdateCaptionAction=n;this.UpdatePermissionsAction=n;this.UploadAction=n;this.UploadBlockAction=n;this.ViewInFolderAction=n;this.ViewItemAction=n;this.ViewOriginalAction=n;this.WorkflowAction=n}}()});define("odsp-next/actions/UnsupportedAction",["require","exports","tslib","../base/BaseAction"],function(e,t,n,i){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="Unsupported";return t}n.__extends(t,e);t.prototype.onIsAvailable=function(){return!1};return t}(i.default)});define("odsp-next/actions/DeferredAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared/lib/base/ActionInputType"],function(e,t,n,i,o,r){"use strict";return function(e){function t(t){var n=this,i=t.sourceRequire,r=t.modulePath,a=t.actionParams;(n=e.call(this,a)||this)._sourceRequire=i;n._modulePath=r;n.isQosLogged=!1;n.name="Deferred"+n._modulePath;n.name=n.name.replace(/Action|\.|\//g,"");n._action=n.createObservable();n._getActionPromise=n.trackPromise(o.loadModule({path:n._modulePath,require:i}).then(function(e){return new(n.managed(e))(a)}));n._getActionPromise.done(function(e){return n._action(e)});n.inputType=n.createPureComputed(n._computeInputType);return n}n.__extends(t,e);t.create=function(e,i){return function(t){function o(n){return t.call(this,{modulePath:i,sourceRequire:e,actionParams:n})||this}n.__extends(o,t);return o}(t)};t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()};t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()};t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})};t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():r.default.none};return t}(i.default)});define("odsp-next/actions/odb/CreateCustomDocumentAction",["require","exports","tslib","../../base/BaseItemAction","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../../dataSources/url/QueryType","../../providers/item/ItemProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,i,o,r,a,s,l,u){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.name="CreateCustomDocument";n.openInNewTab=!1;n.fileCreationMenu=t.fileCreationMenu;n.entryIndex=t.entryIndex;n.navigation=n.resources.consume(u.navigation);n.itemProvider=n.resources.consume(l.resourceKey);return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){return this.item().queryType===s.Files};t.prototype.onExecute=function(e,t){var n=this.item.peek();return this._createCustomDocument(n)};t.prototype._createCustomDocument=function(e,t){var n=this,i=null,s=this.fileCreationMenu.createNewFileControl(this.entryIndex),l=s.get_fileExtension(),u=this.itemProvider.createCustomDocument(e.key,l,t).then(function(e){if(e){i=e.id;return a.default.wrap({resultType:r.ResultTypeEnum.Success})}return a.default.wrap({resultType:r.ResultTypeEnum.Failure})});u.done(function(e){if(i&&null!=s){var t=n.resources.consume(o.pageContext);s.set_itemUrl(i);s.set_httpRoot(t.webAbsoluteUrl);var r=s.getRedirectUrl();null!=r&&n.async.setImmediate(function(){return n.navigation.navigateTo({url:r,frameId:n.openInNewTab?"_blank":null})})}});return u};return t}(i.default)});define("odsp-next/base/BaseItemAction",["require","exports","tslib","./BaseAction","../resources/ControlResourceKeys","../models/item/ItemParentHelper"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this,a=t.item;i.isItemSpecified=!!a;i.item=a||n.currentItem||i.resources.consume(o.currentItem);i.itemParentHelper=n.itemParentHelper||i.resources.consume(r.resourceKey);return i}n.__extends(t,e);t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var i=this.itemParentHelper.getFacetedAncestorOrSelf(e,"list");return n?this.peekUnwrapObservable(i):this.unwrapObservable(i)};return t}(i.default);a.dependencies=n.__assign({},i.default.dependencies,{currentItem:o.currentItem.optional,itemParentHelper:r.resourceKey});t.default=a});define("odsp-next/providers/item/ItemProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../operation/OperationProvider","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ModelResourceKeys","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../models/operation/OperationError","../../models/itemSet/ItemSet","../ProviderHelpers","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources","../../models/task/Task","@ms/odsp-utilities/lib/async/Signal","../quota/UserStateProvider.key","./ItemSetGrouper","../../utilities/features/Features","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v,b,y,x,_,w,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(e){function t(t,n){var i=e.call(this,t,n)||this;i._registeredProjections={};i._pendingGetItemRequests={};i._store=n.itemsStore;i._operationProvider=n.operationProvider;i._itemDataSource=n.itemDataSource;i._updateQuota=n.updateQuota;I.isFeatureEnabled(I.GroupThrottleSupport)&&(i._groupThrottle=n.groupThrottle);i._smartFiltersStore=n.smartFiltersStore;return i}n.__extends(t,e);t.prototype.getCapabilities=function(){return this._itemDataSource.getCapabilities()};t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){function n(e,t){t&&(i+="&"+e+"="+t)}var i="";i+="parentKey="+e.parentKey;n("ownerId",e.ownerId);n("groupingType",e.groupingType);i+="&sortField="+(e.sortField||"");i+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var o=e.filters;if(o)for(var r in o)i+="&"+r+"="+o[r];n("groupBy",e.groupBy);n("viewId",e.baseViewId);n("viewXml",e.viewXml);n("additionalFiltersXml",e.additionalFiltersXml);var a=!t&&e.itemSetProjections;if(a){var s="";for(var l in a)s+=l+"_"+a[l];i+="&projection="+s}n("hashtag",e.hashtag);e.supportsNestedGroups&&(i+="&ng=1");return i};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._itemDataSource.getSpecifiedItems(e)};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,i=this._store.getItem(n),o=this._getItemSet(t,e);if(!i){var a=new r(n);a.queryType=e.queryType;this._store.setItem(a);i=this._store.getItem(n)}if(!o){var s=i.peek(),l=s&&s.folder,u=l&&l.childCount||0;(o=new h(t,e,u)).item=i;var c=e.needSchema;if(void 0===c||c){var d=this._itemDataSource.getColumns(s);d&&d.length>0&&o.schema(d)}this._store.setItemSet(t,o)}return o};t.prototype.invalidateItem=function(e,t){var i=void 0===t?{}:t,o=i.triggerFetch,r=void 0!==o&&o,a=i.emptyAllOtherSets,s=void 0!==a&&a,l=i.refreshSchema,u=void 0!==l&&l;s&&this._store.emptyAllOtherSets([e]);u&&(c=this._store.getItemSetFromItemKey(e))&&c.schema([]);this._store.invalidateItem(e);this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(r){var c=this._store.getItemSetFromItemKey(e),d=n.__assign({parentKey:e},c&&c.context||{},{skipCache:!0});this._getItem(d,!0)}};t.prototype.removeFromRecent=function(e){var t=this;return this._itemDataSource.removeFromRecent(e).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._itemDataSource.removeMountPoint(e).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._itemDataSource.createMountPoint(e).then(function(e){return e},function(e){return s.default.wrapError(e)})};t.prototype.createDocument=function(e,t,n,i){var o=this;return this._itemDataSource.createDocument(e,t,n,i).then(function(t){o.invalidateItem(e);o._updateQuota(!0);return t})};t.prototype.createCustomDocument=function(e,t,n){var i=this;return this._itemDataSource.createCustomDocument(e,t,n).then(function(t){if(!t)return s.default.wrapError();i.invalidateItem(e);i._updateQuota(!0);return i.getItem({parentKey:e}).then(function(e){return i.peekUnwrapObservable(i._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,i=[new y.default(e.item.key,e.item)];t.update(i);return this._itemDataSource.updateBundle(e).then(function(){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);i=i.map(function(e){return e.succeed()});t.update(i)},function(o){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);var r=new Error(o);i=i.map(function(e){return e.fail(r)});t.update(i);return s.default.wrapError(r)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._itemDataSource.removeFromSharedList(e).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._itemDataSource.updateViewCount(e)};t.prototype.reportAbuse=function(e){var t=new p,n=this._operationProvider.register({name:e.item.name,type:m.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),i=this._itemDataSource.reportAbuse(e);n.state(d.started);n.progress.maximum(1);return i.then(function(e){n.state(d.completed);n.progress.current(1);return e},function(e){n.state(d.failed);n.error(new f({message:e}));return s.default.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new p,i=e.items.map(function(e){var i=t._operationProvider.register({name:e.name,type:m.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});i.progress.maximum(1);i.progress.current(0);return i}),o=this._itemDataSource.requestReview(e),r=0,a=i;r<a.length;r++)a[r].state(d.started);return o.then(function(n){for(var o=0,r=i;o<r.length;o++){var a=r[o];a.progress.current(1);a.state(d.completed)}t.invalidateItem(e.items[0].parent.key);return n},function(e){for(var t=0,n=i;t<n.length;t++){var o=n[t];o.error(new f({message:e}));o.state(d.failed)}return s.default.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._itemDataSource.saveSortOrder(e).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._itemDataSource.changeFolderType(e).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._itemDataSource.updateItemProperty(e).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._itemDataSource.getOpenInClientDetails(e).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._itemDataSource.getWorkProgress(e)};t.prototype.processReferral=function(e,t){return this._itemDataSource.processReferral(e,t)};t.prototype.getItemOcrTextContent=function(e){return this._itemDataSource.getItemOcrTextContent(e)};t.prototype.updateItemOcrInfo=function(e,t,n){var i=this;return this._itemDataSource.updateItemOcrInfo(e,t,n).then(function(t){i.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,i={},o=e.items.map(function(e){return i[e.key]=new y.default(e.key,e)});t.update(o);return this._itemDataSource.rotateItems(e).then(function(){o=o.map(function(e){return e.succeed()});t.update(o)},function(e){var r=e.data||[];o=[];for(var a=0,s=r;a<s.length;a++){var l=s[a],u=i[l.key];n._store.setItem(u.input);delete i[l.key];o.push(u.fail(l.error))}for(var c in i){u=i[c];delete i[c];o.push(u.succeed())}t.update(o)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,i){var o=n.itemSetProjections,r=i?null:this._store.getItemSet(e);if(!r||r.isPlaceholder||r.isExpired||r.version!==t.version){if(!r){(r=new h(e,n)).item=t.item;r.isTokenBasedApi=t.isTokenBasedApi;r.isPlaceholder=t.isPlaceholder;r.isExpired=t.isExpired;r.version=t.version}for(var a in o){var s=this._registeredProjections[a];s&&s.projectItemSet(r,t,o[a])}i||this._store.setItemSet(e,r)}return r};t.prototype.redeemPermissionToken=function(e){return this._itemDataSource.redeemPermissionToken(e)};t.prototype._getItem=function(e,n){var i,o=this,r=v.deepCopy(e),a=this._store;if(e.keyAlias){i=a.getItem(e.keyAlias);e.parentKey=i.peek().key}else i=a.getItem(e.parentKey);n=!(!n&&!e.skipCache);var l=this.getItemSetKey(e),u=e.itemSetProjections?this.getItemSetKey(e,!0):l,c=this._getItemSet(l,e),d=c&&c.content.peek().items,p=e.isTokenBasedApi||c&&c.isTokenBasedApi,m=!n&&i&&!i.peek().revision&&c&&!c.isExpired&&!c.isPlaceholder&&(!e.requestAllChildren||g.resultSetHasData(d,{start:0,end:d.length})),f=e.startIndex,b=void 0===f?0:f,y=e.pageSize,_=void 0===y?100:y,C=e.endIndex||b+_;C=d&&d.length>0&&!p?Math.min(d.length,C):C;b=Math.max(0,Math.min(C,b));var k=a.getNextRequestToken(u);e.requestToken="end"===k?"":k;var S=new w.default(e,a,p,t.TOKEN_BASED_API_EXTRA_ITEMS);S.initialize(c,b);var T=!1,P=c&&c.content.peek();if(I.isFeatureEnabled(I.RenderLargeListPartialResult)&&P&&(1===P.partialResultStatus||2===P.partialResultStatus)){T=!0;1===P.partialResultStatus&&c.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(m&&!T&&S.isResultSetValid(d,{start:b,end:C}))return s.default.wrap(c);if(i&&i.peek().isStub){var E=e.startKey;if(E&&a.getItem(E)){c.content.peek().items=[a.getItem(E)];c.isPlaceholder=!0;c.isExpired=!1;var A=this._itemDataSource.getColumns(i.peek());A&&A.length>0&&c.schema(A);c.content.valueHasMutated()}return s.default.wrap(c)}this._normalizeContext(e,d,b,C,!m);var L=this._getRequestKey(e),B=this._pendingGetItemRequests[L];if(B)return e.itemSetProjections?B.getPromise().then(function(t){return o.computeProjectedItemSet(l,t,e)}):B.getPromise();p&&!k&&(e.startIndex=0);this._pendingGetItemRequests[L]=B=new x.default;this._itemDataSource.getItem(e).then(function(t){if(r.updateContextBasedOnResult&&e.updateContextBasedOnResult){r.updateContextBasedOnResult(r,t);e.updateContextBasedOnResult(e,t);l=o.getItemSetKey(r)}var n=e.itemSetProjections?o.getItemSetKey(e,!0):l;i=a.getItem(e.parentKey);var s=a.getItemSet(n);m=!(!i||!s);var u=S.computeNewChildren(t,e,s,n,!!m),c=u.allChildren,d=u.hasNextRequestToken;d&&(p=d);if(t.item&&!e.ignoreChildren){if(!m){(s=new h(n,e)).item=a.getItem(e.parentKey);s.isTokenBasedApi=p;a.setItemSet(n,s)}var f=s.isExpired;s.sortField=t.sortField;s.isAscending=t.isAscending;s.isPlaceholder=!1;s.isExpired=!1;var b=e.needSchema;(void 0===b||b)&&s.schema(t.schema&&(t.schema.length>0?t.schema:[]));var y=t.groupings;p&&e.mergeGroupings&&(y=S.computeNewGroupings(s.content.peek().groupings,t.groupings,c,e,f));t.contentTypes&&s.contentTypes(t.contentTypes);var x=s.content.peek(),_=x.partialResultStatus,w=x.partialResultRequestCount;if(I.isFeatureEnabled(I.RenderLargeListPartialResult)){if(d&&(t.children&&t.children.length<30||!t.children)){var C=w+1;C<=3?w=C:_=1}else void 0!==_&&0!==_&&(_=3)}s.content({items:c,groupings:y,partialResultRequestCount:w,partialResultStatus:_});s.version++}delete o._pendingGetItemRequests[L];if(e.requestAllChildren&&!g.resultSetHasData(c,{start:0,end:t.totalChildren})){var k=v.deepCopy(e);k.startIndex+=100;return o._getItem(k)}if(t.isFromBrowserCache){r.skipCache=!0;return o._getItem(r)}e.itemSetProjections&&(s=o.computeProjectedItemSet(l,s,e));return s},function(e){delete o._pendingGetItemRequests[L];return s.default.wrapError(e)}).then(function(e){B.complete(e)},function(e){o._groupThrottle&&!o._groupThrottle()&&e&&e.errorCode===Number(-2147024860)?o._groupThrottle(!0):B.error(e)});return B.getPromise()};t.prototype._normalizeContext=function(e,t,n,i,o){var r=e.pageSize||100;if(!e.avoidSeamSnapping){var a=n-n%r==i-i%r;if(!o&&!a&&t)for(;n<i&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=100);for(;i-e.startIndex>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,i=n.getItemSet(e);if(t.itemSetProjections){var o=this.getItemSetKey(t,!0),r=n.getItemSet(o);r&&(i=this.computeProjectedItemSet(e,r,t))}return i};t.prototype._updateCoverPhotos=function(e,t,n){for(var i=this,o=new p,r=e.target,a=e.items.map(function(e){var n=i._operationProvider.register({name:e.name,type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:o});n.progress.maximum(1);n.progress.current(0);return n}),s=n.call(this,e),l=0,u=a;l<u.length;l++)u[l].state(d.started);return s.then(function(e){i.invalidateItem(r.key);for(var t=0,n=a;t<n.length;t++){var o=n[t];o.progress.current(1);o.state(d.completed)}return e},function(){for(var e=0,t=a;e<t.length;e++)t[e].state(d.failed)})};t.prototype._addCoverPhotos=function(e){return this._itemDataSource.addCoverPhotos(e)};t.prototype._removeCoverPhotos=function(e){return this._itemDataSource.removeCoverPhotos(e)};return t}(i.default);C.dependencies={groupThrottle:l.groupThrottle.optional,itemDataSource:u.items,itemsStore:a.resourceKey,operationProvider:o.resourceKey,smartFiltersStore:c.smartFiltersStore.optional,updateQuota:_.resourceKey};C.TOKEN_BASED_API_EXTRA_ITEMS=I.isFeatureEnabled(I.RenderLargeListPartialResult)?2:5;t.default=C;t.resourceKey=b.createDefaultResourceKey(e,C)});define("odsp-next/providers/operation/OperationProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/operation/Operation","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/GroupOperation","@ms/odsp-shared/lib/utilities/knockout/GroupProjection","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o,r,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t,n){void 0===t&&(t={});var i=e.call(this,t,n)||this,o=i.observables,r=new a;i._observers=o.createArray();var u=i.operations=o.createArray(),c=i.scope.attached(s),d=i.groups=i.addDisposable(l.group(u,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new c({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));i.overall=new(i.managed(s))({batch:r,operations:d});i.isLocked=i.createPureComputed(i._computeIsLocked);i.createBackgroundComputed(i._computeRemoveAllWhenUnlocked).extend({deferred:!0});return i}n.__extends(t,e);t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new o(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=e.operations.peek().slice();this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,i=this.groups.peek();n<i.length;n++){var o=i[n],a=o.state.peek();if(a===r.completed||!e&&(a===r.expired||a===r.canceled||a===r.failed))for(var s=o.operations.peek(),l=void 0,u=0;u<s.length;u++){l=!0;var c=s[u];if(a===r.failed&&c.actions)for(var d=c.actions.peek(),p=Object.keys(d),m=0;m<p.length;m++)if("cancel"!==p[m]&&d[p[m]].isAvailable.peek()){l=!1;break}l&&t.push(s[u])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t}(i.default);t.OperationProvider=c;t.resourceKey=u.createDefaultResourceKey(e,c);t.default=c});define("odsp-next/models/operation/Operation",["require","exports","tslib","knockout","./OperationState","./OperationBatch","./OperationType","./OperationAction","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,i,o,r,a,s,l){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.name=t.name;n.iconName=t.iconName;n.state=i.observable(o.created);n.error=i.observable();n.count=i.observable(1);var s={minimum:0,maximum:0,current:0};t.progress&&i.utils.extend(s,t.progress);n.progress={minimum:i.observable(s.minimum),maximum:i.observable(s.maximum),current:i.observable(s.current)};n.type=i.observable(t.type||a.multiple);n.batch=t.batch||new r;n._initializeActions(t.actions);n.payloads=i.observable(t.payloads||{});n.visibility=i.observable(t.visibility||0);return n}n.__extends(t,e);t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var o=e[n],r=this.addDisposable(new s({key:n,operation:this,isAvailable:o.isAvailable,onExecute:o.execute}));t[n]=r}this.actions=i.observable(t)};return t}(l.default)});define("odsp-next/models/operation/OperationState",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"}(n||(n={}));return n});define("odsp-next/models/operation/OperationBatch",["require","exports"],function(e,t){"use strict";var n=function(){function e(){this.id=++e._lastBatchId}return e}();n._lastBatchId=0;return n});define("odsp-next/models/operation/OperationType",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.restoreItems=3]="restoreItems";e[e.uploadItems=4]="uploadItems";e[e.moveItems=5]="moveItems";e[e.copyItems=6]="copyItems";e[e.rotateItems=7]="rotateItems";e[e.addItemsToAlbum=8]="addItemsToAlbum";e[e.addCoverPhotos=9]="addCoverPhotos";e[e.removeCoverPhotos=10]="removeCoverPhotos";e[e.createAlbumFromFolder=11]="createAlbumFromFolder";e[e.createColumn=12]="createColumn";e[e.editColumn=13]="editColumn";e[e.deleteColumn=14]="deleteColumn";e[e.checkInItem=15]="checkInItem";e[e.checkOutItem=16]="checkOutItem";e[e.undoCheckOutItem=17]="undoCheckOutItem";e[e.createFolder=18]="createFolder";e[e.updateBundle=19]="updateBundle";e[e.shareItem=20]="shareItem";e[e.reportAbuse=21]="reportAbuse";e[e.requestReview=22]="requestReview";e[e.setAlbumCoverPhoto=23]="setAlbumCoverPhoto";e[e.setPhotoBurstWinner=24]="setPhotoBurstWinner";e[e.extractItemsFromPhotoBurst=25]="extractItemsFromPhotoBurst";e[e.createAlbum=26]="createAlbum";e[e.uploadVideos=27]="uploadVideos";e[e.saveItem=28]="saveItem";e[e.createItem=29]="createItem";e[e.publishItem=30]="publishItem";e[e.unPublishItem=31]="unPublishItem";e[e.applyOfficeLens=32]="applyOfficeLens";e[e.removeOfficeLens=33]="removeOfficeLens";e[e.updateMetadata=34]="updateMetadata";e[e.makeHomepage=35]="makeHomepage";e[e.triggerFlow=36]="triggerFlow";e[e.downloadAsZip=37]="downloadAsZip";e[e.saveAutoAlbum=38]="saveAutoAlbum"}(n||(n={}));return n});define("odsp-next/models/operation/OperationAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","knockout"],function(e,t,n,i,o,r){"use strict";function a(){return o.default.wrap()}return function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var i=t.count,o=void 0===i?r.observable(1):i,s=t.isAvailable,l=void 0===s?r.observable(!0):s,u=t.onExecute,c=void 0===u?a:u;n.count=o;n.isAvailable=l;n._onExecute=c.bind(t.operation);return n}n.__extends(t,e);t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=a};t.prototype.execute=function(){return this._onExecute()};return t}(i.default)});define("odsp-next/models/operation/GroupOperation",["require","exports","tslib","./OperationType","./OperationState","./OperationAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/knockout/Aggregators","@ms/odsp-shared/lib/utilities/knockout/GroupProjection"],function(e,t,n,i,o,r,a,s,l,u){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}n.__extends(t,e);t.prototype._initializeType=function(){var e=this.addDisposable(u.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return o[t.state()]}),i=e.addDisposable(l.includeInSum(t.progress.minimum,e.progress.minimum)),r=e.addDisposable(l.includeInSum(t.progress.maximum,e.progress.maximum)),a=e.addDisposable(l.includeInSum(t.progress.current,e.progress.current)),s=e.addDisposable(l.includeInHistogram(n,e.states)),u=e.addDisposable(l.setFirst(t.error,e.error)),c=e.addDisposable(l.includeInSum(t.count,e.count)),d=e.createComputed(function(){var n=!1,i=e.actions.peek();for(var o in t.actions())if(!(o in i)){i[o]=e._initializeAction(o);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();i.dispose();r.dispose();a.dispose();s.dispose();d.dispose();u.dispose();c.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?o.started:e.created?o.created:e.failed?o.failed:e.completed?o.completed:e.canceled?o.canceled:o.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new r({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return a.default.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||a.default.wrap()}))}}))};return t}(s.default)});define("@ms/odsp-shared/lib/utilities/knockout/Aggregators",["require","exports","knockout"],function(e,t,n){"use strict";t.includeInSum=function(e,t){var n,i=function(e){t(t.peek()+e)},o=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){i(e.peek()-n)});i(e.peek());return{dispose:function(){o.dispose();r.dispose();i(-e.peek())}}};t.includeInHistogram=function(e,t){var n,i=function(e,n){var i=t.peek();void 0!==e&&i[e]--;void 0!==n&&(i[n]=(i[n]||0)+1);t.valueHasMutated()},o=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){i(n,e.peek())});i(void 0,e.peek());return{dispose:function(){o.dispose();r.dispose();i(e.peek(),void 0)}}};t.setFirst=function(e,t){var i=e.peek(),o=e.subscribe(function(){i=e.peek()},null,"beforeChange"),r=n.computed(function(){!t()&&e()&&t(e())}),a=e.subscribe(function(e){!e&&i&&t.peek()===i&&t(void 0)});return{dispose:function(){r.dispose();a.dispose();o.dispose()}}}});define("@ms/odsp-shared/lib/utilities/knockout/GroupProjection",["require","exports","@ms/odsp-utilities/lib/disposable/Disposable","knockout","./Projections"],function(e,t,n,i){"use strict";return function(){function e(e,t){var o=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();n.hook(this.groups,function(){o._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),o=JSON.stringify(n),r=e._groupsByKeyId[o];if(r)r.values.push(t);else{r={key:n,values:i.observableArray([t])};e._groupsByKeyId[o]=r;e.groups.push(r)}return{mappedValue:o,dispose:function(){if(r.values.peek().length>1)r.values.remove(t);else{delete e._groupsByKeyId[o];e.groups.remove(r)}}}}})};return e}()});define("odsp-next/models/operation/OperationError",["require","exports"],function(e,t){"use strict";return function(){return function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}}}()});define("odsp-next/models/itemSet/ItemSet",["require","exports","./ItemSetContent","knockout","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,i,o){"use strict";return function(){return function(e,t,r){this.key=e||"";this.content=i.observable(new n(r));this.content.equalityComparer=o.objectStrictEquality;this.schema=i.observableArray([]);this.schema.equalityComparer=o.arrayStrictEquality;this.context=i.utils.extend({},t);this.contentTypes=i.observableArray([]);this.isPlaceholder=!0;this.version=0}}()});define("odsp-next/models/itemSet/ItemSetContent",["require","exports"],function(e,t){"use strict";return function(){return function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0}}()});define("odsp-next/providers/ProviderHelpers",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resultSetHasData=function(e,t){for(var n=t.start,i=Math.min(t.end,e.length),o=n;o<i;o++)if(!e[o])return!1;return!0}});define("odsp-next/providers/quota/UserStateProvider.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id+".updateQuota",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});define("odsp-next/providers/item/ItemSetGrouper",["require","exports","knockout","../ProviderHelpers"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,n,i){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=i}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,i=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,i)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var o=e&&e.content.peek().groupings;this._isAllCollapsedQuery=o&&o.length>0&&o[0].isAllCollapsed&&o[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&i.resultSetHasData(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,i,o){var r,a=!1;this._context.groupReplace&&(this._isFetchingNextGroup=Boolean(e.nextRequestToken));r=o&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,i,e.nextRequestToken);a=!0;n&&(n.isTokenBasedApi=a)}else this._store.setNextRequestToken(t.parentKey,i,"end");if(t.requestToken){t.startIndex=r.length-this._tokenBasedExtraItemCount;e.totalChildren+=r.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,l=e.startIndex+s;e.nextRequestToken&&(l+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,l))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren);var u=void 0;u=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var c=0,d=0;c<r.length;c++)if(c>=u&&d<e.children.length){r[c]=this._store.getItem(e.children[d].key);d++}}return{allChildren:r,hasNextRequestToken:a}};e.prototype.computeNewGroupings=function(e,t,i,o,r){var a=this._isExpandingGroup?o.group:null,s=o.itemsPerGroup,l=e&&e.length>0?e[0].itemGroups:null,u=null;l&&l.length>0&&l[l.length-1].isPlaceholder&&(u=l.pop());var c=this._mergeGroupings(e,t,r);if(a&&c){c[0].isAllCollapsed(!1);a.state({isCollapsed:!1})}if(i&&i.length>0&&!i[i.length-1]&&(l=c&&c.length>0?c[0].itemGroups:null)&&l.length>0){var d=l[l.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(d.hasMoreData=!0);var p=i[d.startIndex+(-1!==s?Math.min(d.count,s):d.count)-1]&&!(this._context.groupReplace&&d.count<s),m=c[0].isAllCollapsed.peek();if(p||this._isFetchingNextGroup||m){var f=d.startIndex+d.count;u?u.startIndex=f:u={groupingId:"__next__",startIndex:f,count:1,isPlaceholder:!0,state:n.observable({isCollapsed:!1})};i.length<f&&(i.length=f+1);l.push(u)}}return c};e.prototype._mergeGroupings=function(e,t,n){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var o=0;o<t.length;o++){var r=i[o].isAllCollapsed.peek();i[o].itemGroups=n?this._retainItemGroupState(i[o].itemGroups,t[o].itemGroups):this._mergeItemGroups(i[o].itemGroups,t[o].itemGroups,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,i){var o=e;if(e&&e.length>0){if(t&&t.length>0)for(var r=this,a=0,s=t;a<s.length;a++)!function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var a=0;a<o.length&&"break"!==function(a){var s=o[a];if(e.groupingId===s.groupingId){if(r._context.noIndexBasedDataFetch||!r._context.isTokenBasedApi){if(r._context.groupReplace){s.count+=e.count;s.hasMoreData&&a<o.length-1&&(s.hasMoreData=!1)}else s.count=e.count;s.children=r._mergeItemGroups(s.children,e.children,n,s);if(0===a)s.startIndex=i?i.startIndex:0;else{var l=o[a-1],u=l.startIndex+l.count-s.startIndex;s.startIndex+=u;s.children&&s.children.forEach(function(e){e.startIndex+=u})}}else{var c=e.startIndex+r._context.startIndex,d=e.startIndex+r._context.startIndex+e.count;s.startIndex=Math.min(s.startIndex,c);s.count=Math.max(d,s.startIndex+s.count)-s.startIndex}t=!0;return"break"}}(a);a++);if(!t){var s=o[o.length-1],l=s.startIndex+s.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});o.push(e)}}(s[a])}else o=t;return o};e.prototype._retainItemGroupState=function(e,t,n){var i=t;if(t&&t.length>0&&e&&e.length>0){for(var o={},r=0,a=e;r<a.length;r++){var s=a[r];o[s.groupingId]=s}for(var l=0,u=i;l<u.length;l++){var c=u[l],d=o[c.groupingId];if(d){c.state(d.state.peek());c.children=this._retainItemGroupState(d.children,c.children,d)}}}return i};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var i=t[n];if(!(i&&i.startIndex<=e))break;var o=i.startIndex+i.count-1;if(i.children){if(o>=e)return this._getGroupStartingOnIndex(e,i.children)}else{if(i.startIndex===e)return i.state.peek().isCollapsed?null:i;if(o>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e}();t.default=o});define("@ms/odsp-shared/lib/utilities/navigation/Navigation.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";t.navigation=new n.ResourceKey("navigation")});define("odsp-next/actions/odb/DefaultClickAction",["require","exports","tslib","../DefaultClickAction","../../models/item/ItemParentHelper","../../models/item/ItemType","../../utilities/features/Features","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/list/ShortcutUtilities","../../providers/fileHandler/FileHandlerProvider"],function(e,t,n,i,o,r,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){var n=e.call(this,t)||this;n._pageContext=n.resources.consume(s.pageContext);n.itemParentHelper=n.resources.consume(o.resourceKey);n._defaultClickType=n.createPureComputed(n._computeDefaultClickType);n._fileHandlerProvider=n.resources.consume(u.resourceKey.optional);return n}n.__extends(t,e);t.prototype.onComputeAction=function(){var t;switch(this._defaultClickType()){case 1:t=new(this.managed(this.actionMap.OpenShortcutAction))({item:this.item});break;case 2:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,retryWithWac:!0});break;case 3:t=new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({useDefaultAction:!0,item:this.item});break;case 4:t=new(this.managed(this.actionMap.OpenSiteAction))({item:this.item});break;case 5:t=new(this.managed(this.actionMap.AuthenticationPolicyWarningAction));break;case 6:t=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,focusUrl:!0});break;case 7:t=new(this.managed(this.actionMap.FileHandlerOpenAction))({item:this.item});break;case 0:t=e.prototype.onComputeAction.call(this)}return t};t.prototype._computeDefaultClickType=function(){return this._openAsShortcut()?1:this._openAsSite()?4:this._blockedByConditionalAccess()?5:this._openInClient()?2:this._openInOfficeOnline()?3:this._preview()?6:this._openWithFileHandler()?7:0};t.prototype._openAsShortcut=function(){var e=this.item();return a.isFeatureEnabled(a.ShortcutLink)&&l.default.isShortcutItem(e)};t.prototype._openInClient=function(){if(!this._openInOffice())return!1;var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!!t&&(t.list.openInClient||"ms-project"===e.appMap)};t.prototype._openInOfficeOnline=function(){var e=this.item();return!(!e||e.officeBundle)&&this._openInOffice()&&!a.isFeatureEnabled(a.EnablePdfCoversionForAllTypes)};t.prototype._openInOffice=function(){var e=this.item();return!!(e&&e.openUrl&&e.appMap)};t.prototype._openAsSite=function(){var e=this.item();return!!e&&e.subsite&&this._pageContext.isNoScriptEnabled};t.prototype._blockedByConditionalAccess=function(){var e=this.item();return 3===e.itemStatus&&e.type!==r.Folder};t.prototype._preview=function(){var e=this.item();if(e.preview)return!0;var t=this._fileHandlerProvider;return!!t&&!!t.getDefaultPreviewHandler(e.extension)};t.prototype._openWithFileHandler=function(){var e=this._fileHandlerProvider;return!!e&&!!e.getDefaultOpenHandler(this.item().extension)};return t}(i.default);t.default=c});define("odsp-next/actions/DefaultClickAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../models/item/ItemType","../dataSources/url/QueryType","../resources/DataSourceResourceKeys","../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../dataSources/url/PageType","./base/ItemSelectionHelper","../models/item/engagement/ItemEngagementParts","@ms/odsp-utilities/lib/logging/engagement/parts/EventEngagementParts","../models/engagement/Engagement","../providers/engagement/Engagement"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f,h,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openEngagementPart=new g.EngagementPart("Open",2);var b=function(e){function i(n){var i=e.call(this,n)||this;i.name="DefaultClick";i.isQosLogged=!1;var o=n.item,a=n.userInvokedItem,s=void 0!==a&&a,c=n.hideIfDefaultIsDownload,p=void 0!==c&&c,f=n.sourceEngagement,h=void 0===f?"":f,v=i,b=v.resources,y=v.observables;b.expose(g.engagementSourceResourceKey,b.consume(g.engagementSourceResourceKey).withPart(t.openEngagementPart));i._itemSelectionHelper=new(i.managed(m.default))({overrideItem:o,allowMultiSelect:!1,canFallback:!1});i.item=i._itemSelectionHelper.firstItem;i.sourceEngagement=h;i.userInvokedItem=s;i.hideIfDefaultIsDownload=p;i.actionMap=b.consume(r.actionMap);i.urlDataSource=b.consume(l.url);i.viewParams=b.consume(r.viewParams);i._isFilePickerPage=y.pureCompute(i._computeIsFilePickerPage);i._action=y.pureCompute(i._computeAction);i._action.equalityComparer=d.objectStrictEquality;i.userInvokedItem&&(i._instrumentationProvider=b.consume(u.instrumentation));return i}n.__extends(i,e);i.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()};i.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);if(n&&this.userInvokedItem){var i=this._instrumentationProvider;i&&n&&i.userClickItem(n)}var r=t.peekUnwrap(this._action);return r&&r.execute(e)||c.default.wrap({resultType:o.ResultTypeEnum.ExpectedFailure})};i.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})};i.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===p.FilePicker};i.prototype._computeAction=function(){var e=this._lastAction;if(e){e.dispose();this._lastAction=void 0}var t;this._isFilePickerPage()&&this.item().type!==a.Folder||(t=this.onComputeAction());this._lastAction=t;return t};i.prototype._logEngagement=function(e,t){var n,i=t?t.type:"unknown",o=this,r=o.sourceEngagement,l=o.urlDataSource,u=this.resources.consume(v.resourceKey).withPart(h.clickEngagementPart);r&&(n=e&&e.type===a.File?"FileOpen."+r:e&&e.type===a.Folder?"FolderOpen."+r:e&&e.type===a.App?"AppOpen."+r:e&&e.type===a.Subsite?"SubsiteOpen."+r:"Open."+r);u.withPart(f.itemEngagementPart,{item:e}).logData({name:n,extraData:{action:i}});e&&l.getQueryType(l.getKeyParams(e.key))===s.Search&&u.logData({name:"ListItem.Search.Click",extraData:{listItemType:e.type,action:i}})};return i}(i.default);t.default=b});define("odsp-next/actions/base/ItemSelectionHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../utilities/selection/SelectionHelper"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,i=t.allowMultiSelect,o=void 0!==i&&i,s=t.canFallback,l=void 0!==s&&s,u=t.ignoreSelection,c=void 0!==u&&u,d=t.overrideItem,p=t.useCurrentSelectionGroup,m=void 0!==p&&p;n._canFallback=l;n._allowMultiSelect=o;n._overrideItem=d;n._ignoreSelection=c;n._useCurrentSelectionGroup=m;var f=n.resources;if(!d){n._selectionModel=f.consume(r.itemsSelection);n._selectionHelper=f.consume(a.resourceKey)}l&&(n._fallback=f.consume(r.currentItem));n.selection=n.createPureComputed(n._computeSelection);n.firstItem=n.createPureComputed(n._computeFirstItem);return n}n.__extends(t,e);Object.defineProperty(t.prototype,"currentItem",{get:function(){return this.resources.consume(r.currentItem)},enumerable:!0,configurable:!0});t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=0,i=t;n<i.length;n++){var o=i[n],r=this.unwrapObservable(o);if(!r)return!0;if(!e(r))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._canFallback){var n=e._fallback.peek();if(n)return[n]}})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._canFallback?e._fallback.peek():void 0})};t.prototype.clearSelection=function(){this._selectionModel&&this._selectionModel.clear()};t.prototype.selectAll=function(){this._selectionModel&&this._selectionModel.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e=this._selectionModel;if(this._useCurrentSelectionGroup&&this._selectionModel.getSelectionModelGroup()){var t=this._selectionModel.getSelectionModelGroup().currentSelection();t&&(e=t)}var n=e.selection();(0===n.length||this._ignoreSelection)&&this._canFallback&&(n=[this._fallback]);return n};t.prototype._resolveSelection=function(){return this._overrideItem?i.default.wrap([this._overrideItem.peek()]):this._ignoreSelection||!this.selection.peek().length?i.default.wrap([]):this._selectionHelper.resolveSelection()};return t}(o.default);t.default=s});define("odsp-next/utilities/selection/SelectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../controls/commands/Commands.resx","./SelectionHelper.resx","../../utilities/icons/Icon","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o,r,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t,n){var i=e.call(this,t,n)||this;i._dialogProvider=n.dialogProvider;i._promiseTracker=n.promiseTracker;i._itemSetSelectionModel=n.itemSetSelectionModel;return i}n.__extends(t,e);t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(l.strings.resolveDescription),i=this.createObservable(!0),o=this.createObservable(!1),r=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){r=!1;e&&e.state(2);return t},function(t){if(e){n(l.strings.resolveError);i(!1);o(!0)}return a.default.wrapError(t)});r&&(e=this._createDialog(n,i,o)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=a.default.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:l.strings.resolveTitle,isDismissable:!1,component:{name:r.tagName,params:{text:e}},actions:[{name:s.strings.cancelActionText,execute:function(){return a.default.wrap(3)},isVisible:t,icon:new u("Cancel"),isDefault:!0},{name:s.strings.ok,execute:function(){return a.default.wrap(3)},isVisible:n,icon:new u("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};return t}(i.default);m.dependencies=n.__assign({},i.default.dependencies,{dialogProvider:o.resourceKey,promiseTracker:c.promiseTracker.optional,itemSetSelectionModel:c.itemsSelection});t.default=m;t.getSelectedItemApp=function(e){var t=e.selection();if(1===t.length)return d.unwrap(t[0]).appMap};t.resourceKey=p.createDefaultResourceKey(e,m)});define("odsp-next/controls/textContainer/TextContainer",["require","exports","./TextContainerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TextContainer.html"],function(e,t,n,i){"use strict";return i.registerComponent({tagName:"ms-text-container",template:e("./TextContainer.html"),viewModel:n})});define("odsp-next/controls/textContainer/TextContainerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,i){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.text=t.text;return n}n.__extends(t,e);return t}(i.default)});define("odsp-next/controls/textContainer/TextContainer.html",[],function(){return'<div class=TextContainer data-bind="text: text"></div>'});define("odsp-next/models/item/engagement/ItemEngagementParts",["require","exports","../../engagement/Engagement"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEngagementPart=new n.EngagementPart("Item",1)});define("@ms/odsp-utilities/lib/logging/engagement/parts/EventEngagementParts",["require","exports","../EngagementPart"],function(e,t,n){"use strict";t.clickEngagementPart=new n.EngagementPart("Click",4);t.keyPressEngagementPart=new n.EngagementPart("KeyPress",4);t.dropEngagementPart=new n.EngagementPart("Drop",4)});define("@ms/odsp-utilities/lib/list/ShortcutUtilities",["require","exports","../features/Features"],function(e,t,n){"use strict";var i,o={ODB:563,ODC:null,Fallback:!1};!function(e){function t(e){return"url"===e||"website"===e}e.isShortcutItem=function(e){if(!e||!e.extension)return!1;return t("."!==e.extension[0]?e.extension:e.extension.slice(1))};e.isShortcutFileType=t;e.isShortcutEnabled=function(){return n.default.isFeatureEnabled(o)};!function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"}(e.ShortcutErrors||(e.ShortcutErrors={}))}(i||(i={}));Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("odsp-next/providers/fileHandler/FileHandlerProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/ErrorHelper","../../utilities/icons/OfficeFileNameHelper"],function(e,t,n,i,o,r,a,s,l,u){"use strict";function c(e,t){return e.preferences[t.toLowerCase()]}function d(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!u.OfficeIconFileTypeMap[e]||"pdf"===e}function p(e,t,n){var i=c(e,t);if(i)for(var o=0,r=i.preview.concat(i.open);o<r.length;o++){var a=r[o].handler[n];if(a)return a}}Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t,n){var i,a=e.call(this,t,n)||this,u=new o.default("FileHandlers",r.default.session);try{var c=u.getValue("data");i=c&&JSON.parse(c)}catch(e){}var d=a.observables,p=a.data=d.create(i);if(!i||3!==i.version){p({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:3});d.backgroundCompute(function(){a.trackPromise(a.resources.consumeAsync(s.fileHandler.optional).then(function(e){e&&e.getFileHandlerData().done(function(e){u.setValue("data",JSON.stringify(e));p(e)},function(e){l.default.logError(e)})}))})}return a}n.__extends(t,e);t.prototype.getFileTypeIconUrl=function(e,t){return d(e)&&p(this._getData(t),e||"","fileTypeIconUrl")};t.prototype.getFileTypeName=function(e,t){return d(e)&&p(this._getData(t),e||"","fileTypeDisplayName")};t.prototype.getDefaultOpenHandler=function(e,t){var n=c(this._getData(t),e||"");return n&&n.open[0]};t.prototype.getDefaultPreviewHandler=function(e,t){var n=c(this._getData(t),e||"");return n&&n.preview[0]};t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,i=n&&n.extensions;return n&&(!i||i.indexOf(t.toLowerCase())>=0||i.indexOf(".*")>=0)};t.prototype._getData=function(e){return e?this.data.peek():this.data()};return t}(i.default);t.default=m;t.resourceKey=a.createDefaultResourceKey(e,m)});define("odsp-next/utilities/icons/OfficeFileNameHelper",["require","exports","../../controls/commands/Commands.resx","./Icon","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(o);var r=n.strings,a="ms-word",s="onenote|UsePlain",l="ms-powerpoint",u="ms-excel",c="ms-visio",d="ms-publisher",p=(h={},h[a]=r.OpenInWordOnline,h[s]=r.OpenInOneNoteOnline,h[l]=r.OpenInPowerPointOnline,h[u]=r.OpenInExcelOnline,h[c]=r.OpenInVisioOnline,h);t.getOfficeOnlineStringMap=function(e){return p[e]||""};var m=(g={},g[a]=r.OpenInWord,g[s]=r.OpenInOneNote,g[l]=r.OpenInPowerPoint,g[u]=r.OpenInExcel,g[c]=r.OpenInVisio,g[d]=r.OpenInPublisher,g["ms-project"]=r.OpenInProject,g);t.getOfficeStringMap=function(e){return m[e]};var f=(v={},v[a]="WordLogo",v[s]="OneNoteLogo",v[l]="PowerPointLogo",v[u]="ExcelLogo",v[c]="VisioLogo",v[d]="Page",v);t.getOfficeIconMap=function(e){var t=f[e];return t&&new i(t)};var h,g,v});define("@ms/odsp-utilities/lib/icons/OfficeFileNameHelper",["require","exports"],function(e,t){"use strict";var n="ms-word",i="onenote|UsePlain",o="ms-powerpoint",r="ms-excel",a="ms-visio",s="ms-publisher",l="ms-project";t.wordType=n;t.onenoteType=i;t.powerpointType=o;t.excelType=r;t.visioType=a;t.OfficeAppToExtensionsMap={"ms-access":["accdb"],"ms-word":["doc","docm","docx","dot","dotm","dotx","odt"],"ms-project":["mpp"],"onenote|UsePlain":["one","onepkg","onetoc2","notebook"],"ms-powerpoint":["odp","pot","potm","potx","ppa","ppam","pps","ppsm","ppsx","ppt","pptm","pptx"],"ms-publisher":["pub"],"ms-excel":["ods","xla","xlam","xll","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],"ms-visio":["vdw","vsd","vsdm","vsdx","vsl","vss","vssm","vssx","vst","vstm","vstx"]};t.OfficeIconFileTypeMap={accdb:"ms-access",doc:n,docm:n,docx:n,dot:n,dotm:n,dotx:n,pdf:n,odp:o,ods:r,odt:n,one:i,onepkg:i,onetoc2:i,mpp:l,notebook:i,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:s,vdw:a,vsd:a,vsdm:a,vsdx:a,vsl:a,vss:a,vssm:a,vssx:a,vst:a,vstm:a,vstx:a,xla:r,xlam:r,xll:r,xls:r,xlsb:r,xlsm:r,xlsx:r,xlt:r,xltm:r,xltx:r};var u=(d={},d["ms-access"]="Access",d[n]="Word",d[i]="OneNote",d[o]="PowerPoint",d[r]="Excel",d[a]="Visio",d[s]="Publisher",d[l]="Project",d);t.getOfficeAppFriendlyName=function(e){return u[e]||e};var c=(p={},p[n]="Word",p[r]="Excel",p[o]="PowerPoint",p[i]="OneNote",p[a]="Visio",p);t.getApp=function(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":c[e.appMap]||"Word"};var d,p});define("odsp-next/actions/fileHandler/FileHandlerOpenAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../../providers/fileHandler/FileHandlerProvider","../../resources/UtilityResourceKeys"],function(e,t,n,i,o,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(s.resourceKey);n._itemSelectionHelper=new(n.managed(r.default))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,i=this._fileHandlerAction;return i?n.isActionForExtension(i,t):!!n.getDefaultOpenHandler(t)};t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank");return this._itemSelectionHelper.resolveFirst().then(function(e){return t.resources.consumeAsync(l.fileHandlerHelper).then(function(i){return i.invokeAction({items:[e],action:t._fileHandlerAction||t._fileHandlerProvider.getDefaultOpenHandler(e.extension,!0),document:n.document})})}).then(function(){return a.default.wrap({resultType:o.ResultTypeEnum.Success})},function(){n.close();return a.default.wrap({resultType:o.ResultTypeEnum.Failure})})};return t}(i.default);t.FileHandlerOpenAction=u;t.default=u});define("odsp-next/actions/navigateToItem/NavigateToItemAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../base/ItemSelectionHelper"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t)||this;i.name="NavigateToItem";i._urlDataSource=i.resources.consume(r.url);i._viewParams=i.resources.consume(o.viewParams);var s=t.item,l=t.itemSet,u=void 0===l?i.resources.consume(o.currentItemSet):l,c=t.forceAsFocusItem,d=void 0!==c&&c,p=t.isRedirect,m=void 0!==p&&p,f=t.forceInSameWindow,h=void 0!==f&&f,g=t.shouldPreserveAction,v=void 0!==g&&g;i._itemSet=u;i._forceAsFocusItem=i.wrapObservable(d);i._isRedirect=m;i._forceInSameWindow=i.wrapObservable(h);i._shouldPreserveAction=i.wrapObservable(v);var b=n.ItemSelectionHelper,y=void 0===b?a.default:b;i._itemSelectionHelper=new(i.managed(y))({overrideItem:s,allowMultiSelect:!1,canFallback:!0});i._url=i.createPureComputed(i._computeUrl);i._target=i.createPureComputed(i._computeTarget);var x=i.resources.consume(o.actionMap);i._navigationAction=new(i.managed(x.NavigationAction))({url:i._url,ignoreHistory:i._isRedirect,target:i._target});return i}n.__extends(t,e);t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{focusUrl:this._forceAsFocusItem(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet(),viewParams:this._viewParams()})||""};t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"};return t}(i.default);t.default=s});define("odsp-next/actions/NavigationAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,i,o,r,a,s,l,u){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.name="Navigation";var i=t.url,o=t.viewParams,r=t.target,l=void 0===r?"_top":r,u=t.forceNavigation,c=void 0!==u&&u,d=t.ignoreHistory,p=t.beforeNavigation,m=t.afterNavigation;n._navigation=n.resources.consume(a.navigation);n._viewParams=n.resources.consume(s.viewParams);n._url=n.wrapObservable(i);n._inputViewParams=n.wrapObservable(o);n._target=n.wrapObservable(l);n._forceNavigation=c;n._ignoreHistory=d;n._beforeNavigation=p;n._afterNavigation=m;return n}n.__extends(t,e);t.prototype.onExecute=function(e,t){var n=this._url.peek(),i=this._inputViewParams.peek(),a=this._beforeNavigation;a&&a(this._navigation);(this._forceNavigation||n)&&this._navigation.navigateTo({url:n,viewParams:i,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return o.default.wrap({resultType:r.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),i="#"+l.serializeQuery(n),o=t&&0===t.indexOf("#")?t.substring(1):"",r=0===e.indexOf("#")?e.substring(1):"",a=o+(o?"&":"")+r;if(a){var s=l.deserializeQuery(a);return!u.deepCompare(n,s)}return e!==i};return t}(i.default)});define("odsp-next/actions/odb/OpenAction",["require","exports","tslib","../OpenAction","@ms/odsp-datasources/lib/Permissions","../../resources/DataSourceResourceKeys"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;n._userIsAnonymous=n.resources.consume(r.identity).getIdentity().type===o.IdentityType.anonymous;return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){var t=this.item();return!!t&&(!(this._userIsAnonymous&&!o.PermissionMask.hasItemPermission(t,o.PermissionMask.openItems))&&e.prototype.onIsAvailable.call(this))};return t}(i.default);t.default=a});define("odsp-next/actions/OpenAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../resources/DataSourceResourceKeys","../models/item/ItemType","@ms/odsp-datasources/lib/Wopi","./base/ItemSelectionHelper","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,i,o,r,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="Open";var i=e.item,o=e.openRelation,r=void 0===o?0:o,l=e.ignoreHistory,u=void 0!==l&&l,d=e.itemSet,p=void 0===d?n.resources.consume(a.currentItemSet):d,m=e.openLocal,f=void 0!==m&&m,h=e.focusUrl,g=void 0!==h&&h,v=e.preserveAction,b=void 0!==v&&v;n._openRelation=r;n._focusUrl=n.wrapObservable(g);n._viewParams=n.resources.consume(a.viewParams);n._urlDataSource=n.resources.consume(s.url);n._itemSelectionHelper=new(n.managed(c.default))({overrideItem:2===r?i:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r});n.item=n.createComputed(n._computeItem,{deferEvaluation:!0,pure:!0});var y=n.resources.consume(a.actionMap);n._navigateToItemAction=new(n.managed(y.NavigateToItemAction))({item:n.item,itemSet:p,forceAsFocusItem:n.createPureComputed(n._computeForceAsFocusItem),forceInSameWindow:f,isRedirect:u,shouldPreserveAction:b});return n}n.__extends(i,t);i.prototype.onIsAvailable=function(){return this._navigateToItemAction.isAvailable()};i.prototype.onExecute=function(t,n){var i=this,a=this.item.peek();a.type===l.Folder&&n&&n.data&&(n.data.folder=!0);n.data.extraData||(n.data.extraData={});p.extend(n.data.extraData,{uniqueId:a.properties?a.properties.uniqueId:void 0});if(a.previewIFrameUrl&&-1!==a.previewIFrameUrl.toLowerCase().indexOf("wopiframe.aspx")){var s=(new Date).getTime();u.WopiHelper.AddWopiPerfMark(1,s,a.previewIFrameUrl)}this.trackPromise(d.loadModule({require:e,path:"odsp-next/utilities/optimizely/ExperimentsCommon"}).then(function(e){(new(i.managed(e))).fireReadEvent(a)}));return this._navigateToItemAction.execute(t).then(function(){var e={fileType:l[a.type],extension:a.extension||""};return o.default.wrap({resultType:r.ResultTypeEnum.Success,extraData:e})})};i.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e};i.prototype._computeForceAsFocusItem=function(){return this._focusUrl()};return i}(i.default);t.default=m});define("@ms/odsp-datasources/lib/Wopi",["require","exports","./utilities/wopi/WopiHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WopiHelper=n.WopiHelper});define("@ms/odsp-datasources/lib/utilities/wopi/WopiHelper",["require","exports","../permissions/PermissionMask","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.AddWopiPerfMark=function(e,t,n){try{if("sessionStorage"in window&&window.sessionStorage){if(n){var i=decodeURIComponent(n),o=i&&i.indexOf("sourcedoc=");if(-1!==o){var r=i.substring(o).indexOf("&"),a=-1===r?i.substring(o):i.substring(o,o+r);a=escape(a);window.sessionStorage["WOPIPerf_UserClick_"+a]=t}}window.sessionStorage.WOPIPerf_UserClickOrigin=e}}catch(e){}};e.GetWopiFrameEditUrl=function(t){if(t.properties["serverurl.progid"]){if(i.Killswitch.isActivated(e.wopiUrlKillSwitchId)){var o="action=interactivepreview",r=t.properties.ServerRedirectedEmbedUrl;r&&"ms-visio"!==t.appMap&&n.default.hasItemPermission(t,n.default.editListItems)&&(r=r.replace(o,"action=edit"));return r}o="action=interactivepreview";(r=t.properties.ServerRedirectedEmbedUrl)&&"ms-visio"!==t.appMap&&(r=n.default.hasItemPermission(t,n.default.editListItems)?r.replace(o,"action=edit"):r.replace(o,"action=default"));return r}return""};e.GetWopiDocEditUrl=function(e,t,i){if(e.properties["serverurl.progid"]){var r=e.properties.ServerRedirectedEmbedUrl;if(r)if(n.default.hasItemPermission(e,n.default.editListItems)){r=(r=r.replace("action=interactivepreview","action=edit")).replace("/WopiFrame.aspx?","/doc.aspx?");var a=new o.default(r);a.setQueryParameter("uid",e.properties.UniqueId);a.setQueryParameter("ListItemId",e.properties.ID);a.setQueryParameter("ListId",t);i&&i.length>0&&a.setQueryParameter("env",i);r=a.toString()}else r=r.replace("action=interactivepreview","action=default");return r}};return e}();r.wopiUrlKillSwitchId="95C4BD00-E9B8-4711-BCD3-E1B7A99A016B";t.WopiHelper=r;t.default=r});define("@ms/odsp-utilities/lib/killswitch/Killswitch",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}e.initKillSwitches=function(t){e._killSwitches=t||{}};e.isActivated=function(t,n,i){var o=window._spPageContextInfo;!e._killSwitches&&o&&o.killSwitches&&e.initKillSwitches(o.killSwitches);return t&&e._killSwitches&&e._killSwitches[t.toUpperCase()]};return e}();n._killSwitches=null;t.Killswitch=n});define("@ms/odsp-utilities/lib/uri/Uri",["require","exports","../object/ObjectUtil","../string/StringHelper"],function(e,t,n,i){"use strict";function o(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n].toLowerCase());return t}var r;!function(e){e[e.scheme=0]="scheme";e[e.authority=1]="authority";e[e.path=2]="path";e[e.query=3]="query"}(r=t.UriPartial||(t.UriPartial={}));var a=/[;\/?:@&=$,]/,s=/[\/?]/,l=function(){function e(e,t){this._scheme="";this._user="";this._host="";this._port="";this._path="";this._pathSegments=[];this._pathEncoded="";this._query={};this._fragment="";if(t){this._queryCaseInsensitive=!!t.queryCaseInsensitive;this._pathCaseInsensitive=!!t.pathCaseInsensitive}this._parseURI(e)}e.concatenate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i="",o=0;o<t.length;o++){var r=t[o];o>0&&(r=e.ensureNoPrecedingSlash(r));o<t.length-1&&(r=e.ensureTrailingSlash(r));i+=r}return i};e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e};e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e};e.prototype.getScheme=function(){return this._scheme};e.prototype.setScheme=function(e){this._scheme=e};e.prototype.getAuthority=function(){return this._getAuthority(!1)};e.prototype.setAuthority=function(e){this._parseAuthority(e)};e.prototype.getUser=function(){return this._user};e.prototype.getHost=function(){return this._host};e.prototype.getPort=function(){return this._port};e.prototype.getPath=function(e){var t=this._path;Boolean(e)&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1));return t};e.prototype.getLeftPart=function(e){var t=this._scheme+"://";e===r.authority&&(t+=this.getAuthority());e===r.path&&(t+=this.getPath());e===r.query&&(t+=this.getQuery());return t};e.prototype.setPath=function(e){e&&"/"!==e[0]&&(e="/"+e);this._parsePath(e)};e.prototype.getPathSegments=function(){return this._pathSegments};e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""};e.prototype.getQuery=function(e){return this._serializeQuery(e)};e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))};e.prototype.getQueryAsObject=function(){return this._query};e.prototype.setQueryFromObject=function(e){this._query={};for(var t in e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])};e.prototype.getQueryParameter=function(e){var t=null,n=this._query;if(this._queryCaseInsensitive){e=e.toLowerCase();for(var i in n)n.hasOwnProperty(i)&&i.toLowerCase()===e&&(t=n[i])}else t=n[e];return t||null};e.prototype.setQueryParameter=function(e,t,n){void 0===n&&(n=!0);var i=this._decodeQueryString(t);(i||n)&&(this._query[this._decodeQueryString(e)]=i)};e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]};e.prototype.getFragment=function(){return this._fragment};e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1));this._fragment=this._decodeQueryString(e)};e.prototype.equals=function(e){return i.equalsCaseInsensitive(this._scheme,e.getScheme())&&this._user===e.getUser()&&i.equalsCaseInsensitive(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)};e.prototype.equivalent=function(e){return i.equalsCaseInsensitive(this._scheme,e.getScheme())&&i.equalsCaseInsensitive(this._user,e.getUser())&&i.equalsCaseInsensitive(this._host,e.getHost())&&i.equalsCaseInsensitive(this._port,e.getPort())&&i.equalsCaseInsensitive(this.getPath(!0),e.getPath(!0))&&n.deepCompare(o(this.getQueryAsObject()),o(e.getQueryAsObject()))&&i.equalsCaseInsensitive(this._fragment,e.getFragment())};e.prototype.toString=function(e){return this._getStringInternal(!0,e)};e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)};e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)};e.prototype._equalsCaseAppropriate=function(e,t,n){return n?i.equalsCaseInsensitive(e,t):e===t};e.prototype._getStringInternal=function(e,t){var n=this._getStringWithoutQueryAndFragmentInternal(e,t),i=this.getQuery(e);i&&(n+="?"+i);this._fragment&&(n+="#"+(e?encodeURIComponent(this._fragment):this._fragment));return n};e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var n="";this._scheme&&(n+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var i=this._getAuthority(e,t);i&&(n+="//"+i);this._pathEncoded&&(n+=e?this._pathEncoded:this._path);return n};e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var n=0,i=e.split(/[;&]+/);n<i.length;n++){var o=i[n],r=o.indexOf("=");r<0&&(r=o.length);r>0&&(t[o.substr(0,r)]=o.substr(r+1))}return t};e.prototype._serializeQuery=function(e){var t="";for(var n in this._query)if(this._query.hasOwnProperty(n)){var i=n,o=this._query[n];if(e){i=encodeURIComponent(i);o=encodeURIComponent(o)}t+=null===o||""===o?i+"=&":i+"="+o+"&"}""!==t&&(t=t.slice(0,-1));return t};e.prototype._parseURI=function(e){var t=e,n=t.indexOf("#");if(n>=0){var i=t.substring(n+1);this.setFragment(i);t=t.substring(0,n)}var o=t.search(a);if(o>=0){if(":"===t[o]){this.setScheme(t.substring(0,o));t=t.substring(o+1)}var r="";if(0===t.indexOf("//")){var l=(t=t.substring(2)).search(s);if(l>=0){r=t.substring(0,l);t=t.substring(l)}else{r=t;t=""}this.setAuthority(r);if(!t){this.setPath("");return}}var u=t.indexOf("?");if(u>=0){this.setQuery(t.substring(u+1));t=t.substring(0,u)}this.setPath(t)}else this.setPath(t)};e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var n=this._host.indexOf(":");if(!(t<0&&n<0)){var i=e;if(t<0)this._host=i;else{this._user=i.substring(0,t);this._host=i.substring(t+1)}if(n>=0){this._port=this._host.substring(n+1);this._host=this._host.substring(0,n)}this._user=decodeURIComponent(this._user);this._host=decodeURIComponent(this._host)}};e.prototype._parsePath=function(e){this._path=decodeURIComponent(e);var t=this._pathSegments=[];this._pathEncoded=e;for(var n=e.split("/"),i=0;i<n.length;++i)t[i]=decodeURIComponent(n[i]);""===t[0]&&t.shift();""===t[t.length-1]&&t.pop()};e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var n,i,o,r=t&&t.doNotPercentEncodeHost,a="";if(e){n=encodeURIComponent(this._user).replace("%3A",":");i=r?this._host:encodeURIComponent(this._host);o=encodeURIComponent(this._port)}else{n=this._user;i=this._host;o=this._port}""!==n&&(a=n+"@");""!==this._host&&(a+=i);""!==this._port&&(a+=":"+o);return a};e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=l});define("odsp-next/actions/openInExplorer/odb/OpenInExplorerAction",["require","exports","tslib","cookies","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../OpenInExplorerHelper"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInExplorer";n._helper=new(n.managed(s.default));return n}n.__extends(t,e);t.prototype.onExecute=function(e,t){if(!this.onIsAvailable())return o.default.wrap({resultType:a.ResultTypeEnum.ExpectedFailure});i.set("odbnu","0");this._helper.navigateToClassic();return o.default.wrap({resultType:a.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()};t.prototype.onIsToggled=function(){return!1};return t}(r.default);t.default=l});!function(e,t){"use strict";var n=function(e){if("object"!=typeof e.document)throw Error("Cookies.js requires a `window` with a `document` object");var n=function(e,t,i){return 1===arguments.length?n.get(e):n.set(e,t,i)};n._document=e.document;n._cacheKeyPrefix="cookey.";n._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");n.defaults={path:"/",secure:!1};n.get=function(e){n._cachedDocumentCookie!==n._document.cookie&&n._renewCache();return n._cache[n._cacheKeyPrefix+e]};n.set=function(e,i,o){(o=n._getExtendedOptions(o)).expires=n._getExpiresDate(i===t?-1:o.expires);n._document.cookie=n._generateCookieString(e,i,o);return n};n.expire=function(e,i){return n.set(e,t,i)};n._getExtendedOptions=function(e){return{path:e&&e.path||n.defaults.path,domain:e&&e.domain||n.defaults.domain,expires:e&&e.expires||n.defaults.expires,secure:e&&e.secure!==t?e.secure:n.defaults.secure}};n._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())};n._getExpiresDate=function(e,t){t=t||new Date;"number"==typeof e?e=1/0===e?n._maxExpireDate:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e));if(e&&!n._isValidDate(e))throw Error("`expires` parameter cannot be converted to a valid Date instance");return e};n._generateCookieString=function(e,t,n){e=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent))+((n=n||{}).path?";path="+n.path:"");e+=n.domain?";domain="+n.domain:"";e+=n.expires?";expires="+n.expires.toUTCString():"";return e+=n.secure?";secure":""};n._getCacheFromString=function(e){var i={};e=e?e.split("; "):[];for(var o=0;o<e.length;o++){var r=n._getKeyValuePairFromCookieString(e[o]);i[n._cacheKeyPrefix+r.key]===t&&(i[n._cacheKeyPrefix+r.key]=r.value)}return i};n._getKeyValuePairFromCookieString=function(e){var t=0>(t=e.indexOf("="))?e.length:t;return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}};n._renewCache=function(){n._cache=n._getCacheFromString(n._document.cookie);n._cachedDocumentCookie=n._document.cookie};n._areEnabled=function(){var e="1"===n.set("cookies.js",1).get("cookies.js");n.expire("cookies.js");return e};n.enabled=n._areEnabled();return n},i="object"==typeof e.document?n(e):n;"function"==typeof define&&define.amd?define("cookies",[],function(){return i}):"object"==typeof exports?("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=i),exports.Cookies=i):e.Cookies=i}("undefined"==typeof window?this:window);define("odsp-next/actions/openInExplorer/OpenInExplorerHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/url/odb/UrlQueryKeys","../../resources/ControlResourceKeys","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../models/item/ItemParentHelper","../../dataSources/url/odb/ItemUrlHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../resources/DataSourceResourceKeys"],function(e,t,n,i,o,r,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t){var n=e.call(this,t)||this;n._navigation=n.resources.consume(s.navigation);n._platformDetection=n.resources.consume(l.platformDetection);n._urlDataSource=n.resources.consume(p.url);n._currentItem=n.resources.consume(r.currentItem);n._itemParentHelper=n.resources.consume(u.resourceKey);n._itemUrlHelper=n.resources.consume(c.resourceKey);return n}n.__extends(t,e);t.prototype.canOpenInExplorer=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem(),"list"));return!!e&&(!!e.list.isDocumentLibrary&&(e.list.templateType!==a.default.webPageLibrary&&(3!==e.itemStatus&&4!==e.itemStatus&&this._platformDetection.isIE)))};t.prototype.navigateToClassic=function(){var e=this._currentItem.peek(),t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=this._urlDataSource.getKeyParams(e.key)[o.default.idParamKey],i=this._itemUrlHelper.getItemUrlParts(t.key).fullItemUrl+"?"+d.serializeQuery({ExplorerWindowUrl:n});this._navigation.navigateTo({url:i,frameId:"_blank"})};return t}(i.default);t.default=m});define("@ms/odsp-utilities/lib/browser/PlatformDetection.key",["require","exports","../resources/Resources","./PlatformDetection"],function(e,t,n,i){"use strict";t.platformDetection=new n.ResourceKey({name:"platformDetection",factory:new n.SimpleResourceFactory(i.default)})});define("odsp-next/dataSources/url/odb/ItemUrlHelper",["require","exports","tslib","../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/Url","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","./UrlQueryKeys"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SiteRelation=o.SiteRelation;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n.__extends(t,e);t.prototype.getItemUrlParts=function(e){var t=a.deserializeQuery(e);return this.getUrlParts({path:t[s.default.idParamKey],listUrl:t[s.default.listUrlKey]})};return t}(o.ItemUrlHelper);t.ItemUrlHelper=l;t.resourceKey=r.createDefaultResourceKey(e,l,{pageContext:i.pageContext});t.default=l});define("@ms/odsp-datasources/lib/Url",["require","exports","./utilities/url/ItemUrlHelper","./utilities/url/ApiUrlHelper","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,i,o){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});r(n);r(i);t.SimpleUri=o.SimpleUri});define("@ms/odsp-datasources/lib/utilities/url/ItemUrlHelper",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.sameSite=0]="sameSite";e[e.crossSite=1]="crossSite";e[e.unknown=2]="unknown"}(r=t.SiteRelation||(t.SiteRelation={}));t.USE_LEGACY_BEHAVIOR=o.Killswitch.isActivated("8ECA8FD0-F9A5-469A-811E-DC7EF60F1759","4/28/2017","Reverts to a previous behavior of ApiUrlHelper in case of regressions.");var a=function(){function e(e,n){this._pageContext=n.pageContext;var i=n.useLegacyBehavior,o=void 0===i?t.USE_LEGACY_BEHAVIOR:i,r=n.itemUrlPartsType,a=void 0===r?o?l:s:r;this._itemUrlPartsType=a}e.prototype.getUrlParts=function(e){var t=this._pageContext;return new this._itemUrlPartsType({defaultFullWebUrl:t.webAbsoluteUrl,defaultListUrl:t.listUrl,options:e})};return e}();t.ItemUrlHelper=a;var s=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,i=e.options,o=void 0===i?{}:i,r=o.path,a=void 0===r?void 0:r,s=o.listUrl,l=void 0===s?void 0:s,u=o.webUrl,c=void 0===u?void 0:u,d=o.mayInferListUrl,p=void 0!==d&&d;this._defaultFullWebUrl=this._convertFromRootUrl(t);this._defaultListUrl=this._convertFromRootUrl(n);this._path=this._convertFromRootUrl(a);this._listUrl=this._convertFromRootUrl(l);this._webUrl=this._convertFromRootUrl(c);this._mayInferListUrl=p}Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return this._convertToRootUrl(this._getServerRelativeItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return this._convertToRootUrl(this._getServerRelativeListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return this._convertToRootUrl(this._getNormalizedListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return this._convertToRootUrl(this._getNormalizedItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!0,configurable:!0});e.prototype._getCurrentAuthority=function(){var e=new n.default(this._defaultFullWebUrl).authority;this._getCurrentAuthority=function(){return e};return e};e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!i.equalsCaseInsensitive(new n.default(this._getServerUrl()).authority,e);this._getIsCrossDomain=function(){return t};return t};e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!i.equalsCaseInsensitive(e,t);this._getIsCrossList=function(){return n};return n};e.prototype._getSiteRelation=function(){var e=r.unknown;if(this._getIsCrossDomain())e=r.crossSite;else if(void 0!==this._webUrl)e=i.equalsCaseInsensitive(this._defaultFullWebUrl,this._getFullWebUrl())?r.sameSite:r.crossSite;else{var t=new n.default(this._defaultFullWebUrl).path,o=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==o){var a=this._indexOf(o+"/",t+"/");e=0!==a?r.crossSite:new n.default(o).segments.length-1===new n.default(t).segments.length?r.sameSite:r.unknown}}this._getSiteRelation=function(){return e};return e};e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var o=new n.default(t);e=i.equalsCaseInsensitive(o.authority,this._getCurrentAuthority())?o.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),o=this._getDefaultListUrl();void 0===t||i.equalsCaseInsensitive(t,o)||(e=i.equalsCaseInsensitive(new n.default(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t);this._getNormalizedListUrl=function(){return e};return e};e.prototype._getServerUrl=function(){var e=this._path&&new n.default(this._path).authority||this._listUrl&&new n.default(this._listUrl).authority||this._webUrl&&new n.default(this._webUrl).authority||this._defaultListUrl&&new n.default(this._defaultListUrl).authority||new n.default(this._defaultFullWebUrl).authority;this._getServerUrl=function(){return e};return e};e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this._listUrl)e=new n.default(this._listUrl).path;else{var t=this._getDefaultListUrl(),i=this._mayInferListUrl;if(void 0!==t||i){var o=this._getServerRelativePath(),r=new n.default(t).path;if(void 0===o&&(void 0===this._webUrl||r&&0===this._indexOf(r+"/",this._getServerRelativeWebUrl()+"/"))||r&&0===this._indexOf(o+"/",r+"/"))e=r;else if(void 0!==o&&(""===this._defaultListUrl||i)){var a=this._getServerRelativeWebUrl();if(0===this._indexOf(o+"/",a+"/")){var s=new n.default(o).segments[new n.default(a).segments.length];e=a+"/"+s}}}}this._getServerRelativeListUrl=function(){return e};return e};e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();void 0!==n&&(e=""+t+n);this._getFullWebUrl=function(){return e};return e};e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();void 0!==n&&(e=""+t+n);return e};e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();void 0!==n&&(e=""+t+n);this._getFullItemUrl=function(){return e};return e};e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this._webUrl)e=new n.default(this._webUrl).path;else if(!this._defaultListUrl&&!this._listUrl||this._mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this._defaultFullWebUrl&&(e=new n.default(this._defaultFullWebUrl).path);else{var i=new n.default(t);e=""+i.segments.slice(0,-1).join("/")}this._getServerRelativeWebUrl=function(){return e};return e};e.prototype._getServerRelativePath=function(){var e;void 0!==this._path&&(e=new n.default(this._path).path);this._getServerRelativePath=function(){return e};return e};e.prototype._getServerRelativeItemUrl=function(){var e;this._path?e=this._getServerRelativePath():this._listUrl?e=this._getServerRelativeListUrl():this._webUrl?e=this._getServerRelativeWebUrl():this._defaultListUrl?e=this._getServerRelativeListUrl():this._defaultFullWebUrl&&(e=this._getServerRelativeWebUrl());this._getServerRelativeItemUrl=function(){return e};return e};e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),i=this._getServerRelativeListUrl();void 0!==this._path&&void 0!==i&&0===this._indexOf(n+"/",t=i+"/")&&(e=n.substring(t.length));this._getListRelativeItemUrl=function(){return e};return e};e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),i=this._getServerRelativeWebUrl();void 0!==this._path&&void 0!==i&&0===this._indexOf(n+"/",t=i+"/")&&(e=n.substring(t.length));this._getWebRelativeItemUrl=function(){return e};return e};e.prototype._getDefaultListUrl=function(){var e;void 0!==this._defaultListUrl&&(e=new n.default(this._defaultListUrl).authority?this._defaultListUrl:""+this._getCurrentAuthority()+this._defaultListUrl);this._getDefaultListUrl=function(){return e};return e};e.prototype._convertToRootUrl=function(e){return""===e?"/":e};e.prototype._convertFromRootUrl=function(e){return"/"===e?"/":e};e.prototype._indexOf=function(e,t){return e.toUpperCase().indexOf(t&&t.toUpperCase())};return e}();t.ItemUrlParts=s;var l=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,i=e.options,o=void 0===i?{path:void 0}:i,r=o.path,a=o.listUrl,s=void 0===a?void 0:a,l=o.webUrl,u=void 0===l?void 0:l;this._defaultFullWebUrl=this._convertFromRootUrl(t);this._defaultListUrl=this._convertFromRootUrl(n);this._path=this._convertFromRootUrl(r);this._listUrl=this._convertFromRootUrl(s);this._webUrl=this._convertFromRootUrl(u)}Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return this._convertToRootUrl(this._getServerRelativeItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return this._convertToRootUrl(this._getServerRelativeListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return this._convertToRootUrl(this._getNormalizedListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return this._convertToRootUrl(this._getNormalizedItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!0,configurable:!0});e.prototype._getCurrentAuthority=function(){var e=new n.default(this._defaultFullWebUrl).authority;this._getCurrentAuthority=function(){return e};return e};e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!i.equalsCaseInsensitive(new n.default(this._getServerUrl()).authority,e);this._getIsCrossDomain=function(){return t};return t};e.prototype._getIsCrossList=function(){var e=!!this._getNormalizedListUrl();this._getIsCrossList=function(){return e};return e};e.prototype._getSiteRelation=function(){var e=r.unknown;if(this._getIsCrossDomain())e=r.crossSite;else if(void 0!==this._webUrl)e=i.equalsCaseInsensitive(this._defaultFullWebUrl,this._getFullWebUrl())?r.sameSite:r.crossSite;else{var t=new n.default(this._defaultFullWebUrl).path,o=this._getServerRelativeListUrl()||this._getServerRelativeItemUrl();if(void 0!==o){var a=this._indexOf(o+"/",t+"/");e=0!==a?r.crossSite:new n.default(o).segments.length-1===new n.default(t).segments.length?r.sameSite:r.unknown}}this._getSiteRelation=function(){return e};return e};e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();void 0!==t&&(e=i.equalsCaseInsensitive(new n.default(t).authority,this._getCurrentAuthority())?this._getServerRelativeItemUrl():t);this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),o=this._getDefaultListUrl();void 0===t||i.equalsCaseInsensitive(t,o)||(e=i.equalsCaseInsensitive(new n.default(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t);this._getNormalizedListUrl=function(){return e};return e};e.prototype._getServerUrl=function(){var e=this._path&&new n.default(this._path).authority||this._listUrl&&new n.default(this._listUrl).authority||this._webUrl&&new n.default(this._webUrl).authority||this._defaultListUrl&&new n.default(this._defaultListUrl).authority||new n.default(this._defaultFullWebUrl).authority;this._getServerUrl=function(){return e};return e};e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this._listUrl)e=new n.default(this._listUrl).path;else{var t=this._getDefaultListUrl();if(void 0!==t){var i=this._getServerRelativeItemUrl(),o=new n.default(t).path;if(""===this._defaultListUrl){var r=this._getServerRelativeWebUrl();if(void 0!==i&&0===this._indexOf(i+"/",r+"/")){var a=new n.default(i).segments[new n.default(r).segments.length];e=r+"/"+a}}else void 0!==i&&0!==this._indexOf(i+"/",o+"/")||(e=o)}}this._getServerRelativeListUrl=function(){return e};return e};e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();void 0!==n&&(e=""+t+n);this._getFullWebUrl=function(){return e};return e};e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();void 0!==n&&(e=""+t+n);return e};e.prototype._getFullItemUrl=function(){var e,t=this._getServerRelativeItemUrl(),n=this._getServerUrl();if(void 0!==t)e=""+n+t;else{var i=this._getServerRelativeListUrl();void 0!==i&&(e=""+n+i)}this._getFullItemUrl=function(){return e};return e};e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this._webUrl)e=new n.default(this._webUrl).path;else if((this._defaultListUrl||this._listUrl)&&void 0!==(t=this._getServerRelativeListUrl())){var i=new n.default(t);e=""+i.segments.slice(0,-1).join("/")}else this._defaultFullWebUrl&&(e=new n.default(this._defaultFullWebUrl).path);this._getServerRelativeWebUrl=function(){return e};return e};e.prototype._getServerRelativeItemUrl=function(){var e;void 0!==this._path&&(e=new n.default(this._path).path);this._getServerRelativeItemUrl=function(){return e};return e};e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativeItemUrl(),i=this._getServerRelativeListUrl();void 0!==n&&void 0!==i&&0===this._indexOf(n+"/",t=i+"/")&&(e=n.substring(t.length));this._getListRelativeItemUrl=function(){return e};return e};e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativeItemUrl(),i=this._getServerRelativeWebUrl();void 0!==n&&void 0!==i&&0===this._indexOf(n+"/",t=i+"/")&&(e=n.substring(t.length));this._getWebRelativeItemUrl=function(){return e};return e};e.prototype._getDefaultListUrl=function(){var e;void 0!==this._defaultListUrl&&(e=new n.default(this._defaultListUrl).authority?this._defaultListUrl:""+this._getCurrentAuthority()+this._defaultListUrl);this._getDefaultListUrl=function(){return e};return e};e.prototype._convertToRootUrl=function(e){return""===e?"/":e};e.prototype._convertFromRootUrl=function(e){return"/"===e?"/":e};e.prototype._indexOf=function(e,t){return e.toUpperCase().indexOf(t&&t.toUpperCase())};return e}()});define("@ms/odsp-utilities/lib/uri/SimpleUri",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){void 0===e&&(e="");this._value=e}Object.defineProperty(e.prototype,"format",{get:function(){return this._getFormat()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"authority",{get:function(){return this._getAuthority()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"domain",{get:function(){return this._getDomain()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"segments",{get:function(){return this._getSegments()},enumerable:!0,configurable:!0});e.prototype._getFormat=function(){var e;if(this._getAuthority())e=0;else{var t=this._getPath();e=0===t.indexOf("/")?2:1}this._getFormat=function(){return e};return e};e.prototype._getAuthority=function(){var e,t=this._getEndIndexOfRootDelimeter();if(t>-1){var n=this._value.indexOf("/",t);e=n>-1?this._value.substring(0,n):this._value}else e="";this._getAuthority=function(){return e};return e};e.prototype._getDomain=function(){var e,t=this._getAuthority();if(t){var n=this._getEndIndexOfRootDelimeter();e=t.substring(n)}else e="";this._getDomain=function(){return e};return e};e.prototype._getPath=function(){var e,t=this._getEndIndexOfRootDelimeter();if(t>-1){var n=this._value.indexOf("/",t);e=n>-1?this._value.substring(n):""}else e=this._value;this._getPath=function(){return e};return e};e.prototype._getSegments=function(){var e=this._getPath().split("/");this._getSegments=function(){return e};return e};e.prototype._getEndIndexOfRootDelimeter=function(){var e,t=this._value.indexOf("//"),n=this._value.indexOf("/");e=t>-1&&t<=n?t+"//".length:-1;this._getEndIndexOfRootDelimeter=function(){return e};return e};return e}();t.SimpleUri=n;Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("@ms/odsp-datasources/lib/utilities/url/ApiUrlHelper",["require","exports","tslib","@ms/odsp-utilities/lib/encoding/UriEncoding","./ItemUrlHelper"],function(e,t,n,i,o){"use strict";function r(e){return!!e&&"object"==typeof e&&void 0!==e.guid}function a(e){return!!e&&"object"==typeof e&&void 0!==e.raw}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var i=t.itemUrlHelper,o=t.pageContext,r=t.apiUrlType,a=void 0===r?function(e){function t(){return e.call(this,{},{itemUrlHelper:i,pageContext:o})||this}n.__extends(t,e);return t}(l):r;this._apiUrlType=a}e.prototype.build=function(){return new this._apiUrlType};e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var i=e.lastIndexOf("/"),o=e.lastIndexOf(".");t=o>i?e.substring(0,o)+"_"+e.substring(o+1):e}return t+"/_api/contextinfo"};return e}();t.ApiUrlHelper=s;var l=function(){function e(e,t){this._itemUrlHelper=t.itemUrlHelper;this._pageContext=t.pageContext;this._segments=[];this._parameters=[];this._rawParameters=[];this._lastParameterId=0}e.prototype.toString=function(){var e=[];this._parameters.length&&e.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue}).join("&"));e.push.apply(e,this._rawParameters);var t;t=e.length?"?"+e.join("&"):"";var n=this._webUrl;return""+[void 0===n?this._pageContext.webAbsoluteUrl:n,"_api"].concat(this._segments).join("/")+t};e.prototype.segment=function(e){this._segments.push(e);return this};e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e;n<i.length;n++){var o=i[n];this.segment(o)}return this};e.prototype.methodWithAliases=function(e,t){var n=this,i=Object.keys(t).map(function(e){var i=t[e];return e+"="+n._autoParameter(i)});return this.segment(e+"("+i.join(",")+")")};e.prototype.method=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=n.map(function(e){return t._autoParameter(e)});return this.segment(e+"("+o.join(",")+")")};e.prototype.parameter=function(e,t){return this._parameter(e,t)};e.prototype.parameters=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t],o=e[i];this.parameter(i,o)}return this};e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})};e.prototype.rawParameter=function(e){this._rawParameters.push(e);return this};e.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};e.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,i=e.fullItemUrl;(n||t===o.SiteRelation.crossSite)&&this.method("SP.RemoteWeb",i);return this.segment("web")};e.prototype._autoParameter=function(e){var t="@a"+ ++this._lastParameterId;this._parameter(t,e);return t};e.prototype._parameter=function(e,t){var n;n=r(t)?"guid'"+t.guid+"'":a(t)?t.raw:"number"==typeof t?""+t:"boolean"==typeof t?""+t:"'"+i.default.encodeRestUriStringToken(t)+"'";this._parameters.push({name:e,serializedValue:n});return this};return e}();t.ApiUrl=l});define("odsp-next/actions/odb/OpenInOfficeClientAction",["require","exports","tslib","../OpenInOfficeClientAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../../utilities/sharepoint/SyncActiveXClient","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../dataSources/url/odb/ItemUrlHelper","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,i,o,r,a,s,l,u,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.isSingleSelectAction=!0;var i=t.retryWithWac,o=void 0!==i&&i,r=t.url,l=t.appMap,p=t.callback;n._platform=n.resources.consume(c.platformDetection);n._actionMap=n.resources.consume(s.actionMap);n._urlDataSource=n.resources.consume(a.url);n._userIsAnonymous=n.resources.consume(a.identity).getIdentity().type===u.IdentityType.anonymous;n._url=r;n._callback=p;n._appMap=l;n._currentItem=n.resources.consume(s.currentItem);n._itemUrlHelper=n.resources.consume(d.resourceKey);n.retryWithWac=o;return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){return!this._userIsAnonymous&&3!==this.item().itemStatus&&4!==this.item().itemStatus&&e.prototype.onIsAvailable.call(this)};t.prototype.onSelectionExecute=function(t,n,i){var a=this;e.prototype.onSelectionExecute.call(this,t,n,i);var s=function(){if(a._callback)a._callback();else{var e=a._actionMap;new(a.managed(e.OpenInOfficeOnlineAction))({item:a.isItemSpecified&&a.item||void 0}).execute(n)}},l=function(e){a._callback?a._callback():a._doNavigation(e)},u=this.isItemSpecified?this.item.peek():t[0];i.data.extraData||(i.data.extraData={});p.extend(i.data.extraData,{uniqueId:u.properties?u.properties.uniqueId:void 0,fileType:u.extension?u.extension.toLowerCase():void 0});var c=this._itemUrlHelper.getItemUrlParts(this._currentItem.peek().key).fullItemUrl,d=this._url?this._urlDataSource.getNewInOfficeClientUrl(this._appMap,this._url,c):this._urlDataSource.getOpenInOfficeClientUrl(u,this.navigation.viewParams);this.retryWithWac?this._isFireFoxWithoutPlugin()?s():"function"!=typeof navigator.msLaunchUri||this._platform.isWinPhone?l(d):navigator.msLaunchUri(d,null,s):l(d);return o.default.wrap({resultType:r.ResultTypeEnum.Success})};t.prototype.onSelectionIsAvailable=function(e,t){return!!(t&&t.openUrl&&t.appMap)};t.prototype._isFireFoxWithoutPlugin=function(){return this._platform.isFirefox&&!l.default.IsBrowserPluginInstalled(l.default.MAC_PLUGIN_MIME_TYPE)};t.prototype._doNavigation=function(e){this.navigation.navigateTo({url:e,frameId:null})};return t}(i.default);t.default=m});define("odsp-next/actions/OpenInOfficeClientAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="OpenInOfficeClient";n.isSingleSelectAction=!0;n.canFallbackToParent=!0;n.platform=n.resources.consume(a.platformDetection);n.navigation=n.resources.consume(r.navigation);return n}n.__extends(i,t);i.prototype.onIsAvailable=function(){return t.prototype.onIsAvailable.call(this)&&(this.platform.isMac||this.platform.isWindows||this.platform.isIOS||this.platform.isWinPhone||this.platform.isAndroid)};i.prototype.onSelectionIsAvailable=function(e,t){return!1};i.prototype.onSelectionExecute=function(t,n,i){var r=this;this.trackPromise(s.loadModule({require:e,path:"odsp-next/utilities/optimizely/ExperimentsCommon"}).then(function(e){(new(r.managed(e))).fireOpenInOfficeClientEvent()}));return o.default.wrap(null)};return i}(i.default);t.default=l});define("odsp-next/base/BaseSelectionAction",["require","exports","tslib","./BaseItemAction","../resources/ControlResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/selection/SelectionHelper"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.canFallbackToParent=!1;i.isSingleSelectAction=!1;if(!t||void 0===t.item){var r=n.itemSetSelectionModel,a=void 0===r?i.resources.consume(o.itemsSelection):r,l=n.selectionHelper,u=void 0===l?i.resources.consume(s.resourceKey):l;i.selectionModel=a;i._selectionHelper=u}return i}n.__extends(t,e);t.prototype.getCurrentSelection=function(){var e=this.selectionModel,t=e?e.selection():[];0===t.length&&(this.canFallbackToParent||this.isItemSpecified)&&(t=[this.item]);return t};t.prototype.onIsAvailable=function(){var t=this.getCurrentSelection(),n=this.isSingleSelectAction&&1===t.length||!this.isSingleSelectAction&&t.length>0;return e.prototype.onIsAvailable.call(this)&&n&&this._getIsAvailableFromSelection(t)};t.prototype.onSelectionIsAvailable=function(e,t){return!0};t.prototype.onExecute=function(e,t){var n=this;return(this.selectionModel?this._selectionHelper.resolveSelection():r.default.wrap([])).then(function(i){if(i){0===i.length&&(n.canFallbackToParent||n.isItemSpecified)&&(i=[n.item.peek()]);return n.onSelectionExecute(i,e,t)}})};t.prototype.onSelectionExecute=function(e,t,n){return r.default.wrap({resultType:a.ResultTypeEnum.Failure})};t.prototype._getIsAvailableFromSelection=function(e){for(var t=!0,n=0,i=e;n<i.length;n++){var o=i[n],r=this.unwrapObservable(o);if(!r)break;if(!this.onSelectionIsAvailable(e.length,r)){t=!1;break}}return t};return t}(i.default);l.resources=n.__assign({},i.default.dependencies,{itemSetSelectionModel:o.itemsSelection.optional,selectionHelper:s.resourceKey.optional});t.default=l});define("odsp-next/utilities/sharepoint/SyncActiveXClient",["require","exports","tslib","cookies","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../killSwitch/KillSwitch"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var n=e.call(this,t)||this;n._platform=n.resources.consume(r.platformDetection);return n}n.__extends(t,e);t.IsBrowserPluginInstalled=function(e){return!(!Boolean(navigator.mimeTypes)||!navigator.mimeTypes[e])&&!!navigator.mimeTypes[e].enabledPlugin};t.prototype.TryUseOfflineClient=function(e,t,n,i,o,r,a){if(this._initOfflineClient()){try{if(!this._isOfflineAllowedByClient(e,t,i,o))return!1;this._offlineClient.TakeOffline(e,t,n,i,o,r,a)}catch(e){return!1}return!0}return!1};t.prototype._isOfflineAllowedByClient=function(e,t,n,i){return this._offlineClient.IsOfflineAllowed(e,t,n,i)};t.prototype._initOfflineClient=function(){try{if(!a.default.isActivated("825ED7A2-2A3A-41E7-B7FF-C883A97D6E8E","09/14/2016","Sync ActiveX only for Win7.")&&!this._platform.isWindows7)return!1;if(!this._offlineClient)if(-1===document.cookie.indexOf("OfflineClientInstalled")){this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject("SharePoint.OfflineClient");i.set("OfflineClientInstalled","1")}else{if("1"!==i.get("OfflineClientInstalled"))return!1;this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject("SharePoint.OfflineClient")}if(this._offlineClient&&void 0!==this._offlineClient&&void 0!==this._offlineClient.IsOfflineAllowed&&void 0!==this._offlineClient.TakeOffline)return!0}catch(e){i.set("OfflineClientInstalled","0");this._offlineClient=null}return!1};t.prototype._isSupportedMacBrowser=function(){return this._platform.isMac&&(this._platform.isFirefox||this._platform.isSafari||this._platform.isChrome)};t.prototype._createMacPlugin=function(){var e=null;if(this._isSupportedMacBrowser()&&!this._platform.isChrome&&null===(e=document.getElementById("macSharePointPlugin"))&&this._isMacPluginInstalled()){var n=null;n=this._platform.isSafari&&t.IsBrowserPluginInstalled("application/x-sharepoint-webkit")?"application/x-sharepoint-webkit":t.MAC_PLUGIN_MIME_TYPE;var i=document.createElement("object");i.id="macSharePointPlugin";i.type=n;i.width="0";i.height="0";i.style.visibility="hidden";document.body.appendChild(i);e=document.getElementById("macSharePointPlugin")}return e};t.prototype._isMacPluginInstalled=function(){var e=t.IsBrowserPluginInstalled("application/x-sharepoint-webkit"),n=t.IsBrowserPluginInstalled(t.MAC_PLUGIN_MIME_TYPE);return!(!this._platform.isSafari||!e)||n};return t}(o.default);s.MAC_PLUGIN_MIME_TYPE="application/x-sharepoint";t.SyncActiveXClient=s;t.default=s});define("odsp-next/actions/odb/OpenInOfficeOnlineAction",["require","exports","tslib","../OpenInOfficeOnlineAction","@ms/odsp-datasources/lib/Wopi","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n.__extends(t,e);t.prototype.onExecute=function(t,n){var i=this.item.peek();n.data.extraData||(n.data.extraData={});r.extend(n.data.extraData,{uniqueId:i.properties?i.properties.uniqueId:void 0,fileType:i.extension?i.extension.toLowerCase():void 0});var a=(new Date).getTime();o.WopiHelper.AddWopiPerfMark(1,a,this._url.peek());return e.prototype.onExecute.call(this,t,n)};return t}(i.default);t.default=a});define("odsp-next/actions/OpenInOfficeOnlineAction",["require","exports","tslib","../base/BaseAction","../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/modules/Modules","./base/ItemSelectionHelper","../resources/ControlResourceKeys"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="OpenInOfficeOnline";var i=e.openLocal,r=void 0!==i&&i,l=e.forceReadOnly,u=void 0!==l&&l,c=e.useDefaultAction,d=void 0!==c&&c;n._forceReadOnly=u;n._useDefaultAction=d;n._urlDataSource=n.resources.consume(o.url);n._viewParams=n.resources.consume(s.viewParams);n._itemSelectionHelper=new(n.managed(a.default))({overrideItem:e.item});n.item=n._itemSelectionHelper.firstItem;n._url=n.createPureComputed(n._computeUrl);var p=n.resources.consume(s.actionMap);n._navigationAction=new(n.managed(p.NavigationAction))({url:n._url,target:r?void 0:"_blank"});return n}n.__extends(i,t);i.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._navigationAction.isAvailable()};i.prototype.onExecute=function(t,n){var i=this;this.trackPromise(r.loadModule({require:e,path:"odsp-next/utilities/optimizely/ExperimentsCommon"}).then(function(e){(new(i.managed(e))).fireOpenInOfficeOnlineEvent()}));return this._navigationAction.execute(t)};i.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return i}(i.default);t.default=l});define("odsp-next/actions/OpenPdfInBrowserAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";n.isSingleSelectAction=!0;n.urlDataSource=n.resources.consume(a.url);n.navigation=n.resources.consume(s.navigation);return n}n.__extends(t,e);t.prototype.onSelectionIsAvailable=function(e,t){return t&&t.extension&&".pdf"===t.extension.toLowerCase()&&!!t.openUrl&&!this.urlDataSource.isRecycleBin(t.queryType)&&4!==t.itemStatus&&3!==t.itemStatus};t.prototype.onSelectionExecute=function(e,t,n){var i=e[0];this.navigation.navigateTo({url:i.openUrl,frameId:"_blank"});return o.default.wrap({resultType:r.ResultTypeEnum.Success})};return t}(i.default);t.default=l});define("odsp-next/actions/openInTextEditor/OpenInTextEditorAction",["require","exports","tslib","../../base/BaseAction","../../resources/DataSourceResourceKeys","../../utilities/mime/MimeHelper","../../models/item/ItemType","../base/ItemSelectionHelper","../../resources/ControlResourceKeys"],function(e,t,n,i,o,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInTextEditor";n._urlDataSource=n.resources.consume(o.url);n._viewParams=n.resources.consume(l.viewParams);n._currentItemSet=n.resources.consume(l.currentItemSet);n._url=n.createPureComputed(n._computeUrl);n._itemSelectionHelper=new(n.managed(s.default))({overrideItem:t.item});var i=n.resources.consume(l.actionMap);n._navigationAction=new(n.managed(i.NavigationAction))({url:n._url,target:"_blank"});return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return this._navigationAction.isAvailable()&&e&&e.parent&&this._isTextEditorFile(e)&&!this._urlDataSource.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype._isTextEditorFile=function(e){return e&&(e.type===a.File||e.htmlConversion)&&r.canOpenInMonaco(e.extension)};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.parent?this._urlDataSource.getTextEditorItemUrl(e,{itemSet:this._currentItemSet(),viewParams:this._viewParams()}):""};return t}(i.default);t.default=u});define("odsp-next/utilities/mime/MimeHelper",["require","exports"],function(e,t){"use strict";function n(e){return e&&"."===e[0]?e.substring(1):e}Object.defineProperty(t,"__esModule",{value:!0});t.TEXT_MIME_TYPE="text/plain";var i={abap:t.TEXT_MIME_TYPE,ada:t.TEXT_MIME_TYPE,adp:t.TEXT_MIME_TYPE,ahk:t.TEXT_MIME_TYPE,as:t.TEXT_MIME_TYPE,as3:t.TEXT_MIME_TYPE,asc:t.TEXT_MIME_TYPE,ascx:"text/xml",asm:t.TEXT_MIME_TYPE,asp:t.TEXT_MIME_TYPE,awk:t.TEXT_MIME_TYPE,bash:t.TEXT_MIME_TYPE,bash_login:t.TEXT_MIME_TYPE,bash_logout:t.TEXT_MIME_TYPE,bash_profile:t.TEXT_MIME_TYPE,bashrc:t.TEXT_MIME_TYPE,bat:"text/x-bat",bib:t.TEXT_MIME_TYPE,bsh:"text/x-java",build:t.TEXT_MIME_TYPE,builder:t.TEXT_MIME_TYPE,c:"text/x-cpp","c++":"text/x-c++src",capfile:t.TEXT_MIME_TYPE,cc:"text/x-c++src",cfc:t.TEXT_MIME_TYPE,cfm:t.TEXT_MIME_TYPE,cfml:t.TEXT_MIME_TYPE,cl:t.TEXT_MIME_TYPE,clj:t.TEXT_MIME_TYPE,cls:t.TEXT_MIME_TYPE,cmake:t.TEXT_MIME_TYPE,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:t.TEXT_MIME_TYPE,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:t.TEXT_MIME_TYPE,db:t.TEXT_MIME_TYPE,ddl:t.TEXT_MIME_TYPE,di:t.TEXT_MIME_TYPE,dif:t.TEXT_MIME_TYPE,diff:t.TEXT_MIME_TYPE,disco:"text/xml",dml:t.TEXT_MIME_TYPE,dtd:"text/xml",dtml:"text/xml",el:t.TEXT_MIME_TYPE,emakefile:t.TEXT_MIME_TYPE,erb:t.TEXT_MIME_TYPE,erl:t.TEXT_MIME_TYPE,f:t.TEXT_MIME_TYPE,f90:t.TEXT_MIME_TYPE,f95:t.TEXT_MIME_TYPE,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:t.TEXT_MIME_TYPE,gemspec:"text/ruby",gitconfig:"text/x-ini",go:t.TEXT_MIME_TYPE,groovy:t.TEXT_MIME_TYPE,gvy:t.TEXT_MIME_TYPE,h:"text/x-cpp","h++":"text/x-c++hdr",haml:t.TEXT_MIME_TYPE,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:t.TEXT_MIME_TYPE,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:t.TEXT_MIME_TYPE,hs:t.TEXT_MIME_TYPE,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:t.TEXT_MIME_TYPE,inc:"text/html",inf:t.TEXT_MIME_TYPE,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:t.TEXT_MIME_TYPE,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:t.TEXT_MIME_TYPE,jsx:"text/javascript",l:t.TEXT_MIME_TYPE,less:"text/x-less",lhs:t.TEXT_MIME_TYPE,lisp:t.TEXT_MIME_TYPE,log:t.TEXT_MIME_TYPE,lst:t.TEXT_MIME_TYPE,ltx:t.TEXT_MIME_TYPE,lua:"text/x-lua",m:t.TEXT_MIME_TYPE,make:t.TEXT_MIME_TYPE,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:t.TEXT_MIME_TYPE,mli:t.TEXT_MIME_TYPE,mll:t.TEXT_MIME_TYPE,mly:t.TEXT_MIME_TYPE,mm:t.TEXT_MIME_TYPE,mud:t.TEXT_MIME_TYPE,nfo:t.TEXT_MIME_TYPE,opml:"text/xml",osascript:t.TEXT_MIME_TYPE,out:t.TEXT_MIME_TYPE,p:t.TEXT_MIME_TYPE,pas:t.TEXT_MIME_TYPE,patch:t.TEXT_MIME_TYPE,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:t.TEXT_MIME_TYPE,plist:t.TEXT_MIME_TYPE,pm:t.TEXT_MIME_TYPE,pod:t.TEXT_MIME_TYPE,pp:t.TEXT_MIME_TYPE,profile:t.TEXT_MIME_TYPE,properties:t.TEXT_MIME_TYPE,ps1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:t.TEXT_MIME_TYPE,r:t.TEXT_MIME_TYPE,rake:t.TEXT_MIME_TYPE,rb:"text/ruby",rbx:t.TEXT_MIME_TYPE,rc:t.TEXT_MIME_TYPE,re:t.TEXT_MIME_TYPE,reg:t.TEXT_MIME_TYPE,rest:t.TEXT_MIME_TYPE,resw:"text/xml",resx:"text/xml",rhtml:t.TEXT_MIME_TYPE,rjs:t.TEXT_MIME_TYPE,rprofile:t.TEXT_MIME_TYPE,rpy:t.TEXT_MIME_TYPE,rss:"text/xml",rst:t.TEXT_MIME_TYPE,rxml:t.TEXT_MIME_TYPE,s:t.TEXT_MIME_TYPE,sass:"text/scss",scala:t.TEXT_MIME_TYPE,scm:t.TEXT_MIME_TYPE,sconscript:t.TEXT_MIME_TYPE,sconstruct:t.TEXT_MIME_TYPE,script:t.TEXT_MIME_TYPE,scss:"text/scss",sgml:"text/xml",sh:t.TEXT_MIME_TYPE,shtml:"text/html",sml:"text/xml",sql:t.TEXT_MIME_TYPE,sty:t.TEXT_MIME_TYPE,t:t.TEXT_MIME_TYPE,tcl:t.TEXT_MIME_TYPE,tex:t.TEXT_MIME_TYPE,text:t.TEXT_MIME_TYPE,textile:t.TEXT_MIME_TYPE,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:t.TEXT_MIME_TYPE,vb:"text/x-vb",vi:t.TEXT_MIME_TYPE,vim:t.TEXT_MIME_TYPE,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:t.TEXT_MIME_TYPE,xslt:t.TEXT_MIME_TYPE,yaml:t.TEXT_MIME_TYPE,yaws:t.TEXT_MIME_TYPE,yml:t.TEXT_MIME_TYPE,zsh:t.TEXT_MIME_TYPE};t.canOpenInMonaco=function(e){return(e=n(e))in i};t.getMimeTypeForExtension=function(e){e=n(e);return i[e]}});define("odsp-next/actions/odb/OpenShortcutAction",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider","../../controls/commands/Commands.resx","../../controls/textContainer/TextContainer","../../utilities/icons/Icon","../../providers/item/ShortcutProvider","../../providers/engagement/Engagement","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../dataSources/url/odb/ItemUrlHelper"],function(e,t,n,i,o,r,a,s,l,u,c,d,p,m,f){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.name="OpenShortcut";n._shortcutProvider=n.resources.consume(c.resourceKey.optional);n._navigation=n.resources.consume(m.navigation);n._dialogProvider=n.resources.consume(a.resourceKey);n._urlDataSource=n.resources.consume(p.url);n._itemUrlHelper=n.resources.consume(f.resourceKey);return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){return!!this._shortcutProvider&&!!this.unwrapObservable(this.item)};t.prototype.onExecute=function(e){var t=this,n=this.item.peek();this.resources.consume(d.resourceKey).logData({name:"ShortcutLink.ItemRow.Click"});var o=this._urlDataSource.getDefaultClickUrl(n,{preferCurrentView:!0});if(n.shortcutInfo&&n.shortcutInfo.shortcutLinkRewritten){this._navigation.navigateTo({url:o,frameId:"_blank"});return r.default.wrap({resultType:i.ResultTypeEnum.Success})}var a=this._itemUrlHelper.getItemUrlParts(n.key),c=this._shortcutProvider;return c?c.getShortcutTargetData(a.fullItemUrl,!0).then(function(e){return(e.isInternal?r.default.wrap():t._dialogProvider.requestDialog({title:s.strings.confirmNavigateDialogTitle,component:{name:l.tagName,params:{text:s.strings.openShortcutNavigateToExternalWarning}},actions:[{name:s.strings.navigationDialogConfirmButtonLabel,execute:function(){return r.default.wrap(2)},isAvailable:t.observables.create(!0),icon:new u("Forward"),isDefault:!0}]}).wait()).then(function(){t._navigation.navigateTo({url:e.url,frameId:"_blank"});return{resultType:i.ResultTypeEnum.Success}})},function(e){t._navigation.navigateTo({url:o,frameId:"_blank"});return r.default.wrap({resultType:i.ResultTypeEnum.Failure})}):r.default.wrap({resultType:i.ResultTypeEnum.ExpectedFailure})};return t}(o.default)});define("odsp-next/providers/item/ShortcutProvider",["require","exports","../../resources/DataSourceResourceKeys","./ItemProvider","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._shortcutDataSource=t.shortcutDataSource;this._urlDataSource=t.urlDataSource;this._itemProvider=t.itemProvider}e.prototype.createShortcut=function(e,t,n){var i=this;return this._shortcutDataSource.createShortcut(e,t,n).then(function(t){i._itemProvider.invalidateItem(e);return t})};e.prototype.getShortcutTargetData=function(e,t){return this._shortcutDataSource.getShortcutTargetData(e,t)};e.prototype.getFileByUrl=function(e){return this._shortcutDataSource.getFileByUrl(e)};e.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(o.Recent),startIndex:0,endIndex:5,queryType:o.Recent};return this._itemProvider.getItem(e)};return e}();t.default=a;t.resourceKey=r.createDefaultResourceKey(e,a,{shortcutDataSource:n.shortcut,urlDataSource:n.url,itemProvider:i.resourceKey})});define("odsp-next/actions/SelectAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var n=e.call(this,t)||this;n.name="SelectAction";n._showProperties=!1;n._showProperties=t.showProperties;n._selectionModel=n.resources.consume(a.itemsSelection);n._actionMap=n.resources.consume(a.actionMap);return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){return 1===this._selectionModel.mode};t.prototype.onSelectionIsAvailable=function(e,t){return t&&!t.isPlaceholder};t.prototype.onExecute=function(e,t){if(this._selectionModel){this._selectionModel.clear();this._selectionModel.setItemSelected(this.item,!0);this._showProperties&&this._actionMap&&(new(this.managed(this._actionMap.ShowPropertiesAction))).execute(null)}return o.default.wrap({resultType:r.ResultTypeEnum.Success})};return t}(i.default);t.default=s});define("odsp-next/actions/SelectAllAction",["require","exports","tslib","../base/BaseSelectionAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys"],function(e,t,n,i,o,r,a){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.name="SelectAll";n._selectionModel=n.resources.consume(a.itemsSelection);return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode};t.prototype.onExecute=function(e,t){this._selectionModel.selectAll();return o.default.wrap({resultType:r.ResultTypeEnum.Success})};return t}(i.default)});define("odsp-next/actions/SetFocusAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,i,o,r,a){"use strict";return function(e){function t(t){var n=e.call(this,t)||this;n.name="SetFocus";n._selector=t.selector;n._shouldClick=t.shouldClick;return n}n.__extends(t,e);t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);if(n){n.focus();this._shouldClick&&r.default.clickElement(n)}return o.default.wrap({resultType:a.ResultTypeEnum.Success})};return t}(i.default)});define("odsp-next/actions/showOperations/ShowOperationsAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../../providers/operation/OperationProvider","../../models/operation/OperationState"],function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._operationProvider=n.resources.consume(r.resourceKey);n.state=n.createPureComputed(n._computeState);return n}n.__extends(t,e);t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==a.expired,isToggled:this._operationProvider.isLocked()}};return t}(i.default);t.ShowOperationsHandler=s;var l=o.create({name:"ShowOperations",source:{moduleDefinition:{require:e,path:"./ShowOperationsExecutor"}},handlerType:s});t.default=l});define("odsp-next/actions/base/ControlExecutorAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ControlExecutorLoader"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this,i=t.name,o=t.source,a=t.handlerType,s=t.actionParams,l=t.useToggleBehavior,u=void 0!==l&&l;n.name=i;var c=a?new(n.managed(a))(s):void 0,d=c&&c.state||n.createObservable({isAvailable:!0}),p=c&&c.getParams?function(){return c.getParams()}:function(){};n._controlExecutorLoader=new(n.managed(r.default))({source:o,state:d,useToggleBehavior:u,getParams:p});return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:o.ResultTypeEnum.Success}})};return t}(i.default);t.ControlExecutorAction=a;t.create=function(e){var t=e.name,i=e.source,o=e.useToggleBehavior,r=e.handlerType;return function(e){function a(n){return e.call(this,{name:t,source:i,useToggleBehavior:o,actionParams:n,handlerType:r})||this}n.__extends(a,e);return a}(a)}});define("odsp-next/actions/base/ControlExecutorLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/modules/Modules","../../providers/hiddenDom/HiddenDomProvider"],function(e,t,n,i,o,r,a,s){"use strict";function l(e){return!!e.moduleDefinition}Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var n=e.call(this,t)||this,i=t.state,r=t.source,u=t.useToggleBehavior,c=t.getParams;if(l(r)){var d=r.moduleDefinition;n._getComponentDefinition=function(){return a.loadModule(d)}}else{var p=r.component;n._getComponentDefinition=function(){return o.default.wrap(p)}}n._useToggleBehavior=u;n._state=i;n._getParams=c;n._action=n.createObservable();n._hiddenDomProvider=n.resources.consume(s.resourceKey);n.isAvailable=n.createPureComputed(n._computeIsAvailable);n.isToggled=n.createPureComputed(n._computeIsToggled);return n}n.__extends(t,e);t.prototype.execute=function(e){var t=this;if(this._useToggleBehavior){var i=this._action.peek();if(i){i.cancel();return o.default.wrap()}}var a,s=new r.default,l={complete:function(){s.complete()},fail:function(e){s.error(e)},cancel:function(){s.cancel()}};this._useToggleBehavior&&this._action(l);return this._getComponentDefinition().then(function(i){return o.default.as(t._getParams()).then(function(o){a={name:i.tagName,params:n.__assign({action:l,event:e},o||{},{resources:t.resources})};t._hiddenDomProvider.requestControl(a);return s.getPromise()})}).then(function(){a&&t._hiddenDomProvider.disposeControl(a);t._action.peek()===l&&t._action(void 0)},function(e){a&&t._hiddenDomProvider.disposeControl(a);t._action.peek()===l&&t._action(void 0);return o.default.wrapError(e)})};t.prototype._computeIsAvailable=function(){return this._state().isAvailable};t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return t}(i.default);t.default=u});define("odsp-next/providers/hiddenDom/HiddenDomProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t,n){var o=e.call(this,t,n)||this,r=o._controls=o.observables.createArray([]),a=document.createElement("div");a.style.display="none";var s=document.createElement("div");s.setAttribute("data-bind","component: $data");document.body.appendChild(a);i.applyBindingsToNode(a,{template:{nodes:[s],foreach:r}});return o}n.__extends(t,e);t.prototype.requestControl=function(e){this._controls.push(e);return e};t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)};return t}(o.default);t.default=a;t.resourceKey=r.createDefaultResourceKey(e,a)});define("odsp-next/actions/toggleSelectionMode/ToggleSelectionModeAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","../../resources/UtilityResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,i,o,r,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ToggleSelectionModeAction";n._platformDetection=n.resources.consume(u.platformDetection);n._mobile=n.resources.consume(s.mobile);n._useMobileList=!!n.resources.isExposed(a.useMobileList)&&n.resources.consume(a.useMobileList);n._selectionHelper=new(n.managed(o.default))({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});return n}n.__extends(t,e);t.prototype.onIsAvailable=function(){var e=this.resources.consume(a.currentItemSet),t=this._selectionHelper.selection();return!!e&&(this._platformDetection.isMobile&&0===t.length&&this._useMobileList&&e().content().items.length>0)};t.prototype.onExecute=function(e){var t=this._mobile.showItemCheck;t(!t.peek());return r.default.wrap({resultType:l.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._mobile.showItemCheck()};return t}(i.default);t.default=c});define("odsp-next/pages/files/spo/Files.html",[],function(){return'<div class="Files sp-App-root" data-automationid=ms-files data-bind="interactionScope: { isScope: true, isRoot: true, isActive: isActive }, css: { \'has-O365-flex-pane\': isO365FlexPaneVisible, \'has-footer\': _isFooterVisible, \'sp-App--hasLeftNav\': isLeftNavVisible, \'sp-App-leftNavClosing\': isLeftNavClosing, \'sp-App-has-header\': hasHeader, \'sp-App-rightPane-expanded\': _isRightPaneExpandedInUI, \'is-active\': isActive, \'od-userSelect--enabled\': isUserSelectEnabled }, dragAndDrop: { isDragging: onDragging }"><div class=od-SuiteNav>\x3c!--ko if: showSuiteNav()--\x3e\x3c!--ko component: { name: suiteNavComponentTagName(), params: { hamburgerCallback: hamburgerCallback, hamburgerIsUnavailable: suiteNavHamburgerIsUnavailable, suiteNavRenderedCallback: suiteNavRenderedCallback } }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><h1 class=ms-accessible data-bind="text: h1PageTitle"></h1>\x3c!--ko if: spfxClientSideExtensionEnabled()--\x3e<div class=os-Files-extensionPlaceHolder data-sp-placeholder=DialogContainer></div>\x3c!--/ko--\x3e<div class=sp-App-body><div class=sp-App-bodyMain><div id=crossSiteNavContainer></div>\x3c!--ko if: spfxClientSideExtensionEnabled()--\x3e<div class=os-Files-extensionPlaceHolder data-sp-placeholder=PageHeader></div>\x3c!--/ko--\x3e<div class=Files-main><div class=Files-leftNavOverlay data-bind="visible: isLeftNavVisible() && responsiveUI.isHamburgerVisible(), click: toggleIsLeftNavUserExpanded"></div><h2 class=ms-accessible data-bind="text: h2NavigationHeader"></h2>\x3c!--ko if: leftNavReadyToRender()--\x3e<div class=Files-leftNav role=navigation data-bind="control: leftPaneSpecification, attr: { \'aria-label\': navigationRegionLabel }, css: { \'Files-has-suiteNavHamburger\': isSuiteNavHamburgerVisible(), \'Files-has-fallbackHamburger\': isTopBarHamburgerVisible() }"></div>\x3c!--/ko--\x3e\x3c!--Main Column--\x3e<div class=Files-mainColumn>\x3c!--Top Bar--\x3e<div class=od-Files-topBar data-bind="component: { name: topBarTagName, params: { hasSelection: hasSelection, hasHeader: hasHeader } }">\x3c!--ko with: headerComponent--\x3e<div class="od-TopBar-header od-Files-header" data-bind="component: $data"></div>\x3c!--/ko--\x3e\x3c!--ko if: isTopBarHamburgerVisible--\x3e<div class="od-TopBar-item od-TopBar-leftNavExpander od-Files-leftNavExpander" data-bind="component: { name: leftNavExpanderTagName }"></div>\x3c!--/ko--\x3e<div class="od-TopBar-item od-TopBar-search od-Files-search" data-bind="css: { \'od-TopBar-search--isCollapsed\': isSearchCollapsed }">\x3c!--ko if: showSearch()--\x3e\x3c!--ko component: {\r\n name: searchComponentTagName,\r\n params: searchParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><h2 class=ms-accessible data-bind="text: h2CommandBarHeader"></h2><div class="od-TopBar-item od-TopBar-commandBar od-Files-commandBar" data-bind="component: { name: \'ms-command-bar\', params: { commandSet: topLevelCommandSet, isMobile: false, focusOnFirstCommand: true } }, css: commandBarCustomClass"></div></div>\x3c!--End of Top Bar--\x3e\x3c!--RightPane Interaction Container\r\n This <div> serves as the container that implements the RightPane interactions.\r\n It has two children:\r\n 1) The <div> that is pushed over when the RightPane expands, and\r\n 2) The RightPane itself--\x3e<div class=Files-rightPaneInteractionContainer><div class=Files-rightPanePushedContainer data-bind="style: _rightPanePushedContainerStyle">\x3c!--Main Content area--\x3e<h2 class=ms-accessible data-bind="text: h2ContentHeader"></h2><div class=Files-content data-bind="component: mainContentComponent"></div></div>\x3c!--Right Pane--\x3e<div class=Files-rightPane data-bind="style: rightPaneWidthStyle"><div class=od-Resize data-bind="dragAndResize: { right: rightPaneWidth }"></div><div class=Files-rightPaneContent data-bind="scrollContainer: {}, component: { name: \'od-transclusion-host\', params: rightPaneTransclusionHostParams }"></div></div></div></div>\x3c!--End of Main Column--\x3e</div>\x3c!--End of Files-main--\x3e\x3c!--ko if: spfxClientSideExtensionEnabled()--\x3e<div class=os-Files-extensionPlaceHolder data-sp-placeholder=PageFooter></div>\x3c!--/ko--\x3e</div>\x3c!--End of sp-App-bodyMain--\x3e</div>\x3c!--End of sp-App-body--\x3e\x3c!--ko with: firstRunComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isDragAndDropDecorationEnabled && isDroppingTarget()--\x3e\x3c!--ko component: {\r\n name: \'od-drag-and-drop-target-frame\',\r\n params: {}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !dragAndDropDisabled && !!dragAndDropTagName()--\x3e\x3c!--ko component: { name: dragAndDropTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e<div class=Files-hostContainer data-bind="css: { \'od--hasFlexPane\': isO365FlexPaneVisible }">\x3c!--ko component: { name: overlayHostTagName }--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: isUserFeedbackEnabled--\x3e\x3c!--ko component: {\r\n name: \'od-userFeedback\',\r\n params: { featureTitle: userFeedbackFeatureTitle }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: teachingBubbleEnabled && showTeachingBubble()--\x3e\x3c!--ko component: { name: teachingBubbleComponentTagName(), params: { teachingBubbleInstance: currentTeachingBubble } }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("odsp-next/pages/files/spo/Files.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".sp-App-root{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}input,textarea{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.sp-App-root{height:100%;overflow:hidden;min-width:319px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.sp-App-root .od-SuiteNav{position:static}.sp-App-body{-ms-flex-positive:1;flex-grow:1;display:-ms-flexbox;display:flex}.sp-App-bodyMain{position:relative;-ms-flex-positive:1;flex-grow:1;width:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.sp-App-root.has-O365-flex-pane .sp-App-body:after{content:'';width:320px;-ms-flex-negative:0;flex-shrink:0}[dir=ltr] .xlg .od-Files-topBar .od-TopBar-search,[dir=ltr] .xxlg .od-Files-topBar .od-TopBar-search,[dir=ltr] .xxxlg .od-Files-topBar .od-TopBar-search,[dir=ltr] .xxxxlg .od-Files-topBar .od-TopBar-search{margin-left:-208px}[dir=rtl] .xlg .od-Files-topBar .od-TopBar-search,[dir=rtl] .xxlg .od-Files-topBar .od-TopBar-search,[dir=rtl] .xxxlg .od-Files-topBar .od-TopBar-search,[dir=rtl] .xxxxlg .od-Files-topBar .od-TopBar-search{margin-right:-208px}[dir=ltr] .xlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search,[dir=ltr] .xxlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search,[dir=ltr] .xxxlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search,[dir=ltr] .xxxxlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search{margin-right:0}[dir=rtl] .xlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search,[dir=rtl] .xxlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search,[dir=rtl] .xxxlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search,[dir=rtl] .xxxxlg .od-Files-topBar .od-TopBar--hasHeader .od-TopBar-search{margin-left:0}.Files-main{position:relative;-ms-flex-positive:1;flex-grow:1}[dir=ltr] .sp-App--hasLeftNav .Files-mainColumn{left:208px}[dir=rtl] .sp-App--hasLeftNav .Files-mainColumn{right:208px}.Files-leftNav{position:absolute;bottom:0;top:40px;box-sizing:border-box;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:208px}html[dir=ltr] .Files-leftNav{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .Files-leftNav{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .Files-leftNav{left:-302px}[dir=rtl] .Files-leftNav{right:-302px}.lg .Files-leftNav,.md .Files-leftNav,.sm .Files-leftNav{z-index:298;box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:272px}[dir=ltr] .lg .Files-leftNav,[dir=ltr] .md .Files-leftNav,[dir=ltr] .sm .Files-leftNav{left:-302px}[dir=rtl] .lg .Files-leftNav,[dir=rtl] .md .Files-leftNav,[dir=rtl] .sm .Files-leftNav{right:-302px}.lg .Files-leftNav .LeftNav,.md .Files-leftNav .LeftNav,.sm .Files-leftNav .LeftNav{width:272px}.Files-leftNav.Files-has-suiteNavHamburger{top:0}.sp-App-has-header .Files-leftNav.Files-has-fallbackHamburger{top:151px}.md .sp-App-has-header .Files-leftNav.Files-has-fallbackHamburger,.sm .sp-App-has-header .Files-leftNav.Files-has-fallbackHamburger{top:130px}.sp-App--hasLeftNav .Files-leftNav{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}[dir=ltr] .sp-App--hasLeftNav .Files-leftNav{left:0}[dir=rtl] .sp-App--hasLeftNav .Files-leftNav{right:0}.sp-App-leftNavClosing .Files-leftNav{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}[dir=ltr] .sp-App-leftNavClosing .Files-leftNav{left:0}[dir=rtl] .sp-App-leftNavClosing .Files-leftNav{right:0}.Files-mainColumn{position:absolute;top:0;bottom:0;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}[dir=ltr] .Files-mainColumn{left:0}[dir=rtl] .Files-mainColumn{right:0}[dir=ltr] .Files-mainColumn{right:0}[dir=rtl] .Files-mainColumn{left:0}[dir=ltr] .lg .Files-mainColumn,[dir=ltr] .md .Files-mainColumn,[dir=ltr] .sm .Files-mainColumn{left:0}[dir=rtl] .lg .Files-mainColumn,[dir=rtl] .md .Files-mainColumn,[dir=rtl] .sm .Files-mainColumn{right:0}.Files-rightPaneInteractionContainer{-ms-flex-positive:1;flex-grow:1;position:relative}.Files-rightPanePushedContainer{position:absolute;top:0;bottom:0}[dir=ltr] .Files-rightPanePushedContainer{left:0}[dir=rtl] .Files-rightPanePushedContainer{right:0}.Files-content{position:absolute;width:100%;height:100%}.Files-rightPane{position:absolute;z-index:285;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";top:0;bottom:0;box-sizing:border-box;-webkit-overflow-scrolling:touch;transition:367ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .Files-rightPane{right:0}[dir=rtl] .Files-rightPane{left:0}html[dir=ltr] .Files-rightPane{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .Files-rightPane{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .Files-rightPane{transition-property:right}html[dir=rtl] .Files-rightPane{transition-property:left}.od-userSelect--enabled .Files-rightPane{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}[dir=ltr] .md .sp-App-rightPane-expanded .Files-content,[dir=ltr] .sm .sp-App-rightPane-expanded .Files-content{right:0}[dir=rtl] .md .sp-App-rightPane-expanded .Files-content,[dir=rtl] .sm .sp-App-rightPane-expanded .Files-content{left:0}.od-Resize{position:absolute;height:100%;width:2px;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:ew-resize}.Files-rightPaneContent{position:absolute;top:0;right:0;left:2px;bottom:0;-webkit-overflow-scrolling:touch;overflow:hidden}html[dir=ltr] .Files-rightPaneContent{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .Files-rightPaneContent{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.Files.is-active .Files-rightPaneContent{overflow-y:auto}.Files-leftNavOverlay{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(255,255,255,.4);cursor:pointer;z-index:297}.od-TeachingBubble-anchor{position:absolute;top:0}@media print{.Files-leftNav,.od-Files-topBar,.od-SuiteNav{display:none!important}.Files,.Files-content{overflow:visible!important;width:auto!important;height:auto!important}.Files-belowSuiteNav{top:0!important}[dir=ltr] .Files-mainColumn{left:0!important}[dir=rtl] .Files-mainColumn{right:0!important}}"}])});define("odsp-next/controls/suiteNav/SuiteNav.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SuiteNav{background:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:50px;position:absolute;width:100%}.od-userSelect--enabled div#o365cs-flexpane-overlay{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.pluginNoSize{width:0;height:0;padding:0;position:absolute}"}])});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DragAndDropTargetFrameViewModel","./DragAndDropTargetFrame.html","./DragAndDropTargetFrame.css"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n.registerComponent({tagName:"od-drag-and-drop-target-frame",template:e("./DragAndDropTargetFrame.html"),viewModel:i.default,synchronous:!0});t.default=o});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrameViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../overlays/Overlay","../DragAndDrop.resx"],function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,i=t.message,a=void 0===i?r.strings.TargetFrameMessage:i;n.message=a;n.overlayComponent={name:o.tagName,params:{animation:{afterAdd:1,beforeRemove:300}}};n.classes={"od-DragAndDropTargetFrame-hasError":t.isError};return n}n.__extends(t,e);return t}(i.default);t.default=a});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame.html",[],function(){return'\x3c!--ko component: overlayComponent--\x3e<div class=od-DragAndDropTargetFrame data-bind="css: classes"><div class=od-DragAndDropTargetFrame-header><div class=od-DragAndDropTargetFrame-message data-bind="text: message"></div></div></div>\x3c!--/ko--\x3e'});define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DragAndDropTargetFrame{position:absolute;box-sizing:border-box;top:0;left:0;right:0;bottom:0;border:3px solid "},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";border-top:none;pointer-events:none;transition:visibility 0s linear 167ms,opacity 167ms ease-out}.od-DragAndDropTargetFrame-hasError.od-DragAndDropTargetFrame{border:3px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-DragAndDropTargetFrame-header{height:50px;background-color:"},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}.od-DragAndDropTargetFrame-hasError .od-DragAndDropTargetFrame-header{background-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:'}.od-DragAndDropTargetFrame-message{text-align:center;line-height:45px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-OverlayHost-overlay .od-DragAndDropTargetFrame{opacity:0;visibility:hidden}.od-OverlayHost-overlay .od-DragAndDropTargetFrame-header{-ms-transform:translate(0,-20px);transform:translate(0,-20px)}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame{opacity:.9;visibility:inherit;transition-delay:0s,0s}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame-header{-ms-transform:none;transform:none;transition-timing-function:ease-out}"}])});define("odsp-next/controls/userFeedback/UserFeedback",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserFeedbackViewModel","./UserFeedback.html","./UserFeedback.css"],function(e,t,n,i){"use strict";return n.registerComponent({tagName:"od-userFeedback",template:e("./UserFeedback.html"),viewModel:i,synchronous:!0})});define("odsp-next/controls/userFeedback/UserFeedbackViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../utilities/features/Features","../../providers/engagement/Engagement","../../providers/panel/PanelProvider","../../actions/NavigationAction","../userVoiceFeedback/UserVoiceFeedback","./UserFeedback.resx"],function(e,t,n,i,o,r,a,s,l,u){"use strict";var c=function(e){function t(t){var n=e.call(this,t)||this;n._featureTitle=t.featureTitle;n.userFeedbackResx=u;return n}n.__extends(t,e);t.prototype.userFeedbackButtonClick=function(e,n){var i=this.resources.consume(r.resourceKey);if(o.isFeatureEnabled(o.ODBNextUserFeedbackViaYammer)){i.logData({name:"YammerFeedbackButton.UserFeedback.Click"});new(this.managed(s))({url:t._yammerGroupUrl,target:"_new"}).execute(n)}else{i.logData({name:"UservoiceFeedbackButton.UserFeedback.Click"});this.resources.consume(a.resourceKey).requestPanel({hasCommandBar:!1,noTitle:!0,component:{name:l.tagName,params:{featureTitle:this._featureTitle}}})}};return t}(i.default);c._yammerGroupUrl="https://www.yammer.com/microsoft.com/#/threads/inGroup?type=in_group&feedId=728275";return c});define("odsp-next/controls/userVoiceFeedback/UserVoiceFeedback",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserVoiceFeedbackViewModel","./UserVoiceFeedback.html","./UserVoiceFeedback.css"],function(e,t,n,i){"use strict";return n.registerComponent({tagName:"od-userVoiceFeedback",template:e("./UserVoiceFeedback.html"),viewModel:i.default,synchronous:!0})});define("odsp-next/controls/userVoiceFeedback/UserVoiceFeedbackViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","./UserVoiceFeedback.resx","../../resources/SPOResourceKeys","../../bindings/userVoice/UserVoiceBinding","@ms/odsp-shared/lib/controls/userVoice/UserVoiceButtonConfiguration","@ms/odsp-shared/lib/controls/userVoice/UserVoiceWidgetConfiguration","@ms/odsp-shared/lib/controls/userVoice/UserVoiceWidgetMode"],function(e,t,n,i,o,r,a,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d="Zk7XEDxnq7pRjaeN7z7Ehg",p="http://sharepoint.uservoice.com/forums/329214-sites-and-collaboration",m="329214",f=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({userVoice:s.default});var i=[new l.default(r.strings.userVoiceFeedbackButtonText,c.default.contact,"ms-Icon ms-fontColor-white ms-Icon--QuickNote userVoiceFeedbackIcon"),new l.default(r.strings.userVoiceSuggestionButtonText,c.default.feedback,"ms-Icon ms-fontColor-white ms-Icon--Lightbulb userVoiceSuggestionIcon")],o=n.resources.consume(a.pageContext),f=new u.default({buttons:i,workloadId:d,forumUrl:p,forumId:m,userEmail:o.userLoginName,locale:o.currentUICultureName});n.userVoiceConfig={strings:n._getUserVoiceStrings(t.featureTitle),config:f};return n}n.__extends(t,e);t.prototype._getUserVoiceStrings=function(e){return{panel_title:i.format(r.strings.userVoiceFeedbackTitleText,e||r.strings.userVoiceFeedbackSitesCollabFeatureName),uservoice_terms_of_service_link_caption:r.strings.userVoiceTermsOfServiceLinkText,uservoice_privacy_policy_link_caption:r.strings.userVoicePrivacyPolicyLinkText,fallback_line1:r.strings.userVoiceFallbackLine1Text,fallback_line2:r.strings.userVoiceFallbackLine2Text,fallback_line3:r.strings.userVoiceFallbackLine3Text,fallback_line4:r.strings.userVoiceFallbackLine4Text,fallback_line5:r.strings.userVoiceFallbackLine5Text,fallback_line6:r.strings.userVoiceFallbackLine6Text,contact_title:r.strings.userVoiceContactTitleText,contact_message_placeholder:r.strings.userVoiceContactMessagePlaceholderText,contact_skip_instant_answers_button:r.strings.userVoiceContactSkipInstantAnswersButtonText,contact_submit_button:r.strings.userVoiceContactSubmitButtonText,contact_success_title:r.strings.userVoiceContactSuccessTitleText,contact_success_body:r.strings.userVoiceContactSuccessBodyText,post_suggestion_body:r.strings.userVoiceSuggestionBodyText}};return t}(o.default);t.default=f});define("odsp-next/bindings/userVoice/UserVoiceBinding",["require","exports","tslib","../BaseBinding","@ms/odsp-shared/lib/controls/userVoice/UserVoiceWidget"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var n=e.call(this,t)||this,i=t.valueAccessor();new o.default(i.config,i.strings).renderIn(t.element,null,null);return n}n.__extends(t,e);return t}(i);t.default=r});define("@ms/odsp-shared/lib/controls/userVoice/UserVoiceWidget",["require","exports","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","./UserVoiceButtonConfiguration"],function(e,t,n,i,o,r,a){"use strict";var s=function(){function e(e,t){this.configuration=e;this.strings=t}e.prototype.renderIn=function(e,t,n){try{this.showButtons(e);t&&t()}catch(e){n&&n(e)}};e.prototype.ensureWidgetLoaded=function(e,t,n){var i=this;try{e||this.onUserVoiceError("ensureWidgetLoaded","onLoadCallback is undefined in ensureWidgetLoaded");if(!this.configuration.workloadId){this.errorCallback(t,"UserVoice control download failed; Incorrect workload id");n()}if(window.UserVoice)e();else{var o=document.createElement("script");o.type="text/javascript";o.async=!0;o.src="https://widget.uservoice.com/"+this.configuration.workloadId+".js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(o,r);o.addEventListener("load",function(o){if(window.UserVoice)e();else{i.errorCallback(t,"UserVoice control download failed; Incorrect workload id");n()}});o.addEventListener("error",function(e){i.errorCallback(t,"UserVoice control download failed; Incorrect url; Message: "+e.message);n()})}}catch(e){this.errorCallback(t,"UserVoice control initialization failed; Error: "+e)}};e.prototype.showButtons=function(t){var n=this;t||this.onUserVoiceError("showButtons","parentDiv is not found");t.innerHTML="";var i=document.createDocumentFragment(),o=this.createElementWrapper(i,"div","",{id:e.welcomePanelId,class:"uv-welcome-panel"});this.createElementWrapper(o,"div",this.strings.panel_title,{class:"ms-font-xl uv-welcome-title"});this.configuration.buttons.forEach(function(e){var t=n.createElementWrapper(o,"div","",{class:"uv-welcome-Button"}),i=n.createElementWrapper(t,"button","",{class:"ms-Button ms-Button--primary"});i.onclick=n.getButtonHandler(e.buttonWidgetMode);var r=n.createElementWrapper(i,"span","",{class:"ms-Button-icon"});n.createElementWrapper(r,"i","",{class:e.iconClass});n.createElementWrapper(i,"span",e.buttonText,{class:"ms-Button-label"})});var r=this.createElementWrapper(i,"div","",{class:"uv-widget-panel"});r.id=e.widgetPanelId;r.hidden=!0;this.createElementWrapper(r,"div","").id=e.uvWidgetId;var a=this.createElementWrapper(r,"div","",{class:"uv-widget-policy"});this.createElementWrapper(a,"a",this.strings.uservoice_terms_of_service_link_caption,{href:e.termsOfServiceUrl,class:"ms-font-s"});this.createElementWrapper(a,"span"," | ",{class:"ms-font-s"});this.createElementWrapper(a,"a",this.strings.uservoice_privacy_policy_link_caption,{href:e.privacyPolicyUrl,class:"ms-font-s"});t.appendChild(i)};e.prototype.getButtonHandler=function(e){var t=this;return function(){var n=a.default.getMode(e);t.startCallback(n);t.ensureWidgetLoaded(function(){return t.showUserVoice(n)},n,function(){return t.showFallbackWidgetUnavailableExperience()})}};e.prototype.showUserVoice=function(t){var n=window.UserVoice;try{document.getElementById(e.welcomePanelId).hidden=!0;document.getElementById(e.widgetPanelId).hidden=!1;n.push(["set",this.configuration.userVoiceConfiguration(this.strings)]);n.push(["identify",{email:this.configuration.userEmail}]);n.push(["embed","#"+e.uvWidgetId,{mode:t}]);this.successCallback(t)}catch(e){this.errorCallback(t,e)}};e.prototype.showFallbackWidgetUnavailableExperience=function(){document.getElementById(e.welcomePanelId).hidden=!0;document.getElementById(e.widgetPanelId).hidden=!1;var t=document.getElementById(e.widgetPanelId);if(!t)throw"parentDiv "+e.widgetPanelId+" is not found";t.innerHTML="";var n=document.createDocumentFragment(),r=this.createElementWrapper(n,"div","",{class:"uv-fallback-panel"});this.createElementWrapper(r,"div",this.strings.fallback_line1,{class:"ms-font-xl uv-fallback-title"});this.createElementWrapper(r,"div",this.strings.fallback_line2,{class:"ms-font-m uv-fallback-subtitle"});var a=this.createElementWrapper(r,"div",this.strings.fallback_line3,{class:"ms-font-m uv-fallback-options"}),s=this.createElementWrapper(a,"ul","",{class:"uv-fallback-ul"}),l=this.createElementWrapper(s,"li","",{}),u=o.format('<a href="{0}">',this.configuration.forumUrl);l.innerHTML=o.format(i.default.encodeText(this.strings.fallback_line4),u,"</a>");this.createElementWrapper(s,"li",this.strings.fallback_line5);this.createElementWrapper(s,"li",this.strings.fallback_line6);t.appendChild(n)};e.prototype.startCallback=function(e){this.configuration.onUserVoiceStart&&this.configuration.onUserVoiceStart(e)};e.prototype.successCallback=function(e){this.configuration.onUserVoiceSuccess&&this.configuration.onUserVoiceSuccess(e)};e.prototype.errorCallback=function(e,t){this.configuration.onUserVoiceFailure&&this.configuration.onUserVoiceFailure(e,t)};e.prototype.onUserVoiceError=function(e,t){new r.Qos({name:"UserVoice."+e}).end({resultType:r.ResultTypeEnum.Failure,error:t})};e.prototype.createElementWrapper=function(e,t,i,o){var r=n.default.ce(t,o);n.default.setText(r,i);e.appendChild(r);return r};return e}();s.welcomePanelId="welcomePanel";s.widgetPanelId="widgetPanel";s.uvWidgetId="uvwidget";s.termsOfServiceUrl="https://sharepoint.uservoice.com/tos";s.privacyPolicyUrl="https://sharepoint.uservoice.com/tos#privacy-policy";Object.defineProperty(t,"__esModule",{value:!0});t.default=s});define("@ms/odsp-utilities/lib/encoding/HtmlEncoding",["require","exports"],function(e,t){"use strict";function n(e){return o[e]}var i=/[<>&'"\\]/g,o={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"},r=function(){function e(){}e.encodeText=function(e){return e?e.replace(i,n):""};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=r});define("@ms/odsp-shared/lib/controls/userVoice/UserVoiceButtonConfiguration",["require","exports","./UserVoiceWidgetMode"],function(e,t,n){"use strict";var i=function(){function e(e,t,n){this.buttonText=e;this.buttonWidgetMode=t;this.iconClass=n}e.getMode=function(e){return n.default[e]};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-shared/lib/controls/userVoice/UserVoiceWidgetMode",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.contact=0]="contact";e[e.smartvote=1]="smartvote";e[e.satisfaction=2]="satisfaction";e[e.feedback=3]="feedback"}(n||(n={}));Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("@ms/odsp-shared/lib/controls/userVoice/UserVoiceWidgetConfiguration",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){this.target="self";this.position="automatic";this.height="400px";this.width="100%";this.accentColor="#458dd6";this.locale="en";this.smartvoteEnabled=!1;this.postSuggestionEnabled=!1;this.screenshotEnabled=!0;this.buttons=[];this.workloadId="workloadId_undefined";this.forumUrl="";this.buttons=e.buttons;this.workloadId=e.workloadId;this.forumUrl=e.forumUrl;this.forumId=e.forumId;this.userEmail=e.userEmail;this.locale=e.locale}e.prototype.userVoiceConfiguration=function(e){return{target:this.target,position:this.position,height:this.height,width:this.width,accent_color:this.accentColor,locale:this.getSupportedLocale(this.locale),forum_id:this.forumId,smartvote_enabled:this.smartvoteEnabled,post_suggestion_enabled:this.postSuggestionEnabled,screenshot_enabled:this.screenshotEnabled,strings:e,buttons:this.buttons,workloadId:this.workloadId,onUserVoiceStart:this.onUserVoiceStart,onUserVoiceSuccess:this.onUserVoiceSuccess,onUserVoiceFailure:this.onUserVoiceFailure,userEmail:this.userEmail}};e.prototype.getSupportedLocale=function(e){var t=this,n=["az-AZ","bg","ca","cn","zh-CN","zh-TW","hr","cs","da","nl","nl-informal","en-GB","et","fi","fr","fr-CA","de","de-AT","de-CH","de-informal","el","hu","id","it","ja","ko","lv","lt","mk","nb","pl","pt-PT","pt","pt-BR","ro","ru","sr","sr-Latn","sk","sl","es","es-AR","es-MX","sv-SE","tr","vi","cy"],i=this.locale;n.some(function(e){return 0===e.toLowerCase().localeCompare(t.locale.toLowerCase())})||(i=n.some(function(e){return 0===e.toLowerCase().localeCompare(t.locale.toLowerCase().substr(0,2))})?this.locale.substr(0,2):"en");0===i.toLowerCase().localeCompare("zh-cn")&&(i="cn");return i};return e}();t.UserVoiceWidgetConfiguration=n;Object.defineProperty(t,"__esModule",{value:!0});t.default=n});define("odsp-next/controls/userVoiceFeedback/UserVoiceFeedback.html",[],function(){return'<div data-bind="userVoice: userVoiceConfig"></div>'});define("odsp-next/controls/userVoiceFeedback/UserVoiceFeedback.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.uv-welcome-panel,.uv-widget-panel{margin:0 auto;width:100%}.md .uv-welcome-panel,.md .uv-widget-panel,.sm .uv-welcome-panel,.sm .uv-widget-panel{width:90%}.uv-welcome-panel .uv-welcome-title{margin:40px 0}.uv-widget-policy{text-align:center;margin-top:15px}.uv-welcome-Button{margin:20px auto}.uv-welcome-Button .od-Button{width:100%;height:auto;min-height:40px;white-space:nowrap}html[dir=ltr] .uv-welcome-Button .od-Button{text-align:left}html[dir=rtl] .uv-welcome-Button .od-Button{text-align:right}.uv-welcome-Button .od-Button-icon{display:inline-block;vertical-align:middle}.uv-welcome-Button .ms-Icon{font-size:19px;vertical-align:middle}[dir=ltr] .uv-welcome-Button .ms-Icon{margin-right:12px}[dir=rtl] .uv-welcome-Button .ms-Icon{margin-left:12px}.uv-welcome-Button .od-Button-label{font-size:17px;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;display:inline-block;width:85%;white-space:normal;vertical-align:middle}.uv-widget-policy a{text-decoration:none}.uv-fallback-title{margin-top:40px;margin-bottom:30px}.uv-fallback-panel{margin:30px auto;width:90%}.uv-fallback-ul{margin-top:5px}[dir=ltr] .uv-fallback-ul{padding-left:40px}[dir=rtl] .uv-fallback-ul{padding-right:40px}.uv-fallback-options{margin-top:17px}'}])});define("odsp-next/controls/userFeedback/UserFeedback.html",[],function(){return'<a class=od-UserFeedback-button href=javascript:; data-bind="text: userFeedbackResx.strings.UserFeedbackButtonText, click: userFeedbackButtonClick"></a>'});define("odsp-next/controls/userFeedback/UserFeedback.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-UserFeedback-button{position:fixed;bottom:20px;min-width:80px;padding:5px 15px;background:"},{theme:"primaryText",defaultValue:"#333333"},{rawString:';text-align:center;display:block;cursor:pointer;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif}[dir=ltr] .od-UserFeedback-button{right:20px}[dir=rtl] .od-UserFeedback-button{left:20px}.md .od-UserFeedback-button,.sm .od-UserFeedback-button{display:none}.od-UserFeedback-button,.od-UserFeedback-button:hover{color:'},{theme:"primaryBackground",defaultValue:"#ffffff"},{rawString:"}"}])});define("odsp-next/utilities/css/utilities.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-noList ol,.ms-noList ul,ol.ms-noList,ul.ms-noList{list-style-type:none;margin-top:0;margin-bottom:0}[dir=ltr] .ms-noList ol,[dir=ltr] .ms-noList ul,[dir=ltr] ol.ms-noList,[dir=ltr] ul.ms-noList{padding-left:0}[dir=rtl] .ms-noList ol,[dir=rtl] .ms-noList ul,[dir=rtl] ol.ms-noList,[dir=rtl] ul.ms-noList{padding-right:0}.ms-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}.ms-dotSeparatorAfter::after{content:'\\a0\\b7'}.ms-dotSeparatorBefore::before{content:'\\b7\\a0'}.ms-enquote::before{content:'\\93'}.ms-enquote::after{content:'\\94'}@media print{.ms-noPrint{display:none!important}}"}])});define("odsp-next/pages/files/spo/StringResource",["require","exports","../../../controls/list/react/detailsList/ReactDetailsList.resx","../../../controls/list/react/detailsList/fields/FieldsRender.resx","../../../controls/list/react/detailsList/fields/CustomFormatterRenderer.resx","../../../Groups.resx","../../../controls/siteHeader/SiteHeaderContainer.resx","../../../utilities/list/ListUtilities.resx","../../../models/item/Item.resx","../../../dataSources/item/ItemDataSource.resx","../../../dataSources/item/odb/ODBDataSource.resx","../../../dataSources/search/SearchShared.resx","@ms/odsp-utilities/lib/dateTime/DateTime.resx","../../../utilities/string/StringUtilities.resx","../../../controls/operation/monitor/OperationMonitor.resx","../../../controls/emptyFolder/EmptyFolder.resx","../../../controls/appView/AppView.resx","../../../controls/iframeLoader/IframeLoader.resx","../../../controls/smartBannerV2/SmartBannerV2.resx","../../../controls/leftPane/LeftPane.resx","../../../controls/breadcrumbBar/BreadcrumbBar.resx","../../../controls/languagePicker/LanguagePicker.resx","../../../controls/photos/Photos.resx","../../../controls/iFrameDialog/IFrameDialog.resx","../../../controls/itemTile/ItemTile.resx","../../../controls/sharing/sharerHeader/SharerHeader.resx","../../../controls/detailsHeader/DetailsHeader.resx","../../../controls/spotlightHost/SpotlightHost.resx","../../../dataSources/leftNav/splist/SPListLeftNavResx.resx","../../../dataSources/flow/spo/FlowTemplate.resx","../../../controls/listGroupHeader/ListGroupHeader.resx","../../../controls/listGroupSeeMore/ListGroupSeeMore.resx","../../../controls/columnsHeader/ColumnsHeader.resx","./SPOFiles.resx","../../../controls/overlays/dialog/DialogOverlay.resx","../../../controls/panelHost/PanelHost.resx","../../../controls/commands/Commands.resx","../../../utilities/selection/SelectionHelper.resx","../../../controls/leftNav/LeftNav.resx","../../../controls/leftNav/react/ReactLeftNav.resx","../../../controls/loadingSpinner/LoadingSpinner.resx","../../../controls/dragAndDrop/DragAndDrop.resx","../../../controls/userVoiceFeedback/UserVoiceFeedback.resx","../../../controls/userFeedback/UserFeedback.resx","../../../dataSources/notifications/odb/OdbNotifications.resx","../../../controls/spoApp/SPOApp.resx","../../../controls/fieldEditor/booleanEditor/BooleanEditor.resx","../../../controls/listFooter/ListFooter.resx","../../../utilities/complianceTag/ComplianceTagUtilities.resx","../../../controls/firstRunExperience/FirstRunExperience.resx","@ms/odsp-utilities/lib/string/StringUtilities.resx"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});