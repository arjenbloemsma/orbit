define("odsp-next/dataSources/item/odb/ListViewDataPrefetch",["require","exports","./ListViewDataPrefetchHelper","@ms/odsp-utilities/lib/navigation/AddressParser","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers","../../../utilities/features/Features"],function(e,t,a,i,r,n,o){"use strict";function s(e){return void 0!==e.webTitle}function l(e){f&&e&&((O=e.inputPageContextInfo).isSPO=!0);if(O&&null!==window.location&&null!==window.location.search){var t,l,g=O.webAbsoluteUrl,C=O.webTemplate,h=O.listBaseTemplate,b=O.isSPO;if(s(O)){t=O.serverRedirectedUrl;l=O.webServerRelativeUrl}var v=t&&t.indexOf("?")>=0?t.substring(t.indexOf("?")+1):"",B=window.location.search.slice(1)+(v?"&"+v:"");D=i.deserializeQuery(B);var S,F,E="21"!==C,P=-1!==[101,109,115,119].indexOf(h);if(E){F=u("listUrl",!0);S=u("listId",!0)}else F=l+"/Documents";if(!E||S||F){if(!E)for(var w in D)if(!m[w])return;var y=D.parent,A=function(){var e=u("viewId",!0),t=D.parent,a=r.default.escapeUrlForCallback(g)+"/_api/web/"+(F?"GetList(@listUrl)":"lists/getById('"+S+"')")+"/RenderListDataAsStream?"+(F?"@listUrl='"+c(F)+"'&":"")+(t?"View=":E?"View="+(e||""):"View=&SortField=LinkFilename&SortDir=Asc"),i=t||D.id||D.RootFolder;i&&(a+="&RootFolder="+r.default.encodeURIComponent(i));var n=u("ViewPath",!0);n&&!e&&E&&(a+="&ViewPath="+r.default.encodeURIComponent(n));if(!D.useFiltersInViewXml)for(var o in D)0===o.lastIndexOf("Filter",0)&&(a+="&"+o+"="+D[o]);var s=u("sortField");if(s){a+="&SortField="+s;a+="&SortDir="+("false"===u("isAscending").toLowerCase()?"Desc":"Asc")}if(t){var l=D.id.slice(t.length+1);a+="&FilterField1=FileLeafRef&FilterValue1="+r.default.encodeURIComponent(l)}return a},U=A(),I="";y?I=n.getViewXml({requestMetaInfo:!0,pageSize:1}):E||(I=n.getViewXml({sortField:"LinkFilename",itemIds:null,isAscending:"true",pageSize:100,requestMetaInfo:o.isFeatureEnabled(o.EnablePowerPointWrsPreview)||o.isFeatureEnabled(o.EnableWordWrsPreview)}));var R=y?{viewXml:I,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:o.isFeatureEnabled(o.ListDataRenderOptionChange)}:{needsSchema:!0,needsContentTypes:E,needsQuickLaunch:E&&"64"!==C,needsSpotlight:E&&P,needsViewMetadata:E,viewXml:I,requestDatesInUtc:C===p&&o.isFeatureEnabled(o.RequestDatesInUtc),allowMultipleValueFilterForTaxonomyFields:!!b||void 0,needClientSideComponentManifest:!1,needUpdatePageContext:!!f},T=u("groupBy");if(T){R.groupByOverride=T;R.groupReplace=!1}var N=a.getAdditionalPostData(R),x=a.createHashCode(U,N),L=a.initPrefetchData(x);window.DeferredListDataComplete=function(){d.bind(void 0,U)()};if(!d(U)){var V=new XMLHttpRequest;V.open("POST",U,!0);V.setRequestHeader("accept","application/json;odata=verbose");V.setRequestHeader("Content-Type","application/json;odata=verbose");var _=F?"listUrl="+F:"list="+S;E&&(_="NAVIGATIONSTRUCTURE, "+_);V.setRequestHeader("X-SP-REQUESTRESOURCES",_);V.onreadystatechange=function(){if(4===V.readyState&&!L.listData){var t=400;try{t=V.status}catch(e){}L.correlationId=V.getResponseHeader("SPRequestGuid");L.responseCode=t;if(t<300){L.listData=V.responseText;L.serverDuration=Number(V.getResponseHeader("SPClientServiceRequestDuration"))}f&&e.onePagePrefetchCompleteCallback?e.onePagePrefetchCompleteCallback(t,V.responseText,function(e){O=e;if(o.isFeatureEnabled(o.FasterOnePage))L.completedCallback&&L.completedCallback(t);else{var i=A();R.needUpdatePageContext=void 0;var r=a.getAdditionalPostData(R),n=a.createHashCode(i,r);a.setPrefetchData(n,L)}}):L.completedCallback&&L.completedCallback(t)}};V.send(N)}}}}function d(e){if(window.g_payload&&window.g_listData){var t=a.createHashCode("ListContenTypes","ListContenTypes");a.initPrefetchData(t).listData=window.g_listData.ListContenTypes;t=a.createHashCode(e,JSON.stringify(window.g_payload));window.DeferredListDataExpectedHash=t;var i=a.prefetchData(t);if(i){i.listData=JSON.stringify(window.g_listData);i.deferredListData=!0;i.completedCallback&&i.completedCallback(void 0,!0);i.contentTypesCallback&&i.contentTypesCallback();return!0}}return!1}function u(e,t){var a=t?e.toLowerCase():e,i=D[a]||O[e];if(i){var r=i.match(/\{(.*)\}/);return r?r[1]:i}return i}function c(e){return r.default.encodeURIComponent((e||"").replace(/'/g,"''"))}Object.defineProperty(t,"__esModule",{value:!0});var p="21";t.ONEPAGE_GLOABLS=["_spPageContextInfo","__themeState__","mark","require","requirejs","define","__assign","__extends","__decorate","__rest","_onErrorHandler","_perfMarks","_spModuleLink","__onePageContext"];var D,O=window._spPageContextInfo,f=!!window.__onePageContext,m={id:!0,parent:!0,p:!0};t.startPrefetch=l;try{if(!f){console.log("Not one page nav, startPrefetch");l()}}catch(e){console.log("startPrefetch error: "+e.toString())}});define("odsp-next/dataSources/item/odb/ListViewDataPrefetchHelper",["require","exports","../../../utilities/features/Features","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers"],function(e,t,a,i){"use strict";var r=function(){return function(){this.startTimeMark=(new Date).getTime();this.deferredListData=!1}}(),n=function(){function e(){}e.prefetchData=function(t){return e._prefetchData?e._prefetchData[t]:null};e.initPrefetchData=function(t){e._prefetchData||(e._prefetchData={});return e._prefetchData[t]=new r};e.setPrefetchData=function(t,a){e._prefetchData||(e._prefetchData={});e._prefetchData[t]=a};e.clearPrefetchData=function(t){e._prefetchData&&e._prefetchData[t]&&delete e._prefetchData[t]};e.getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=a.isFeatureEnabled(a.ListDataRenderOptionChange);e.isSpotlightFeatureEnabled=a.isFeatureEnabled(a.Spotlight);return i.getAdditionalPostData(e)};e.createHashCode=function(t,a){return"listviewdataprefetch-"+e.hashCode(decodeURIComponent(t))+"-"+e.hashCode(a)};e.hashCode=function(e){var t=0;if(!Boolean(e)||0===e.length)return t;for(var a=0;a<e.length;a++){t=(t<<5)-t+e.charCodeAt(a);t&=t}return t};return e}();n.shouldLogError=!0;return n});define("odsp-next/utilities/features/Features",["require","exports","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/navigation/AddressParser"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.On={Fallback:!0};t.Off={};t.InfoPaneActivityFeed={ODB:!0};t.SwitchBackToClassic={ODB:400};t.EnableMsJs={ODC:"EnableMsJs"};t.ShowEmailInPeoplePicker={ODC:!0};t.FirstPartyFolderPicker={ODC:"UseNewFolderPickerFirstParty",Fallback:!0};t.DebugWindow={ODB:336,ODC:"DebugWindowEnabled"};t.EnableUploadLogging={ODC:"EnableUploadLogging"};t.EnableTeachingBubbles={ODB:833,ODC:"EnableTeachingBubbles"};t.EnableFirstRunExperienceDialog={ODB:864,ODC:"EnableFirstRunExperienceDialog"};t.EnableFirstRunExperienceRobot={ODB:861,ODC:"EnableFirstRunExperienceRobot"};t.AddToOneDriveBubble={ODC:"isAddToOneDriveBubbleEnabled"};t.PhotosSearchBubble={ODC:"PhotosSearchBubble"};t.EnablePersonalSearchSuggestions={ODC:"EnablePersonalSearchSuggestions",ODB:886};t.NewFeatureExperience={ODB:518,ODC:"NewFeatureExperience"};t.LeftNavLinkGroupAriaLabelEnabled={ODB:!0,ODC:"LeftNavLinkGroupAriaLabelEnabled"};t.FileExtensionDataPipe={ODB:461};t.FileHandlerAddInPicker={ODB:512};t.ODBNextFileHandler={ODB:537};t.ODBNextFileCreation={ODB:553};t.SharingDialogRedux={ODB:539,ODC:"UseCommonSharingDialog"};t.RUMOne={ODB:499};t.EnableNotificationSubscriptions={ODC:"EnableNotificationSubscriptions"};t.UserActivity={ODC:"UserActivityWebUI"};t.ShowTagCountInPhotos={ODC:"ShowTagCountInPhotos"};t.CollaborativeAlbumsEnabled={ODC:"CollabAlbumsEnabled"};t.EnableSkypeOnSuiteNavHeader={ODC:"EnableSkypeOnSuiteNavHeader"};t.EnableNewFlexPaneOnSuiteNavHeader={ODC:"EnableNewFlexPaneOnSuiteNavHeader"};t.EnableMeFlexPaneOnSuiteNavHeader={ODC:"EnableMeFlexPaneOnSuiteNavHeader"};t.EnableExchangeOnSuiteNavHeader={ODC:"EnableExchangeOnSuiteNavHeader"};t.AlignPickerSelectionLimit={ODC:"AlignFilePickerSelectionWithODB"};t.PlacesForAllLocalesEnabled={ODC:"PlacesForAllLocalesEnabled"};t.UseNewAlbumStrip={ODC:"UseNewAlbumStrip"};t.UseNewMobileListViewUX={ODB:574,ODC:"UseNewMobileListViewUX"};t.UseNewResourcePreloader={ODC:"UseNewResourcePreloader"};t.RenderListDataAsStreamLeftNavOpt={ODB:561};t.ShortcutLink={ODB:563};t.RemoveFromSharedList={ODB:564};t.UseWebPdfViewer={ODB:817,ODC:"UseWebPdfViewer"};t.UseDragAndDropPageDecoration={ODB:400,ODC:"UseDragAndDropPageDecoration"};t.PromotedPhotosContentEnabled={ODC:"PromotedPhotosContentEnabled"};t.OneRmO365UpsellEnabled={ODC:"OneRmO365UpsellEnabled"};t.ODBSyncButtonDefaultNGSC={ODB:569};t.HideSyncButton={ODB:586};t.ODBNextSearchPage={ODB:580};t.OneDriveAspxRedirect={ODB:571};t.RecycleBinImmersive={ODB:572};t.DiscoverViewODB={ODB:735};t.BurstPhotoUI={ODC:"BurstPhotoUI"};t.Spotlight={ODB:573};t.DownloadAsZip={ODB:831,ODC:"UseDownloadMicroservice"};t.EnableManageAppDataPage={ODC:"EnableManageAppDataPage"};t.PolicyTipPanel={ODB:836};t.FileHandlersV2={ODB:841};t.AuthZenUserActivityInSight={ODB:14162};t.ValidateFileNamesOnUpload={ODC:"ValidateFileNamesOnUpload"};t.RequestDatesInUtc={ODB:865};t.ODBEnableAdminUx={ODB:848};t.HideODBSiteSettings={ODB:849};t.EnableExcelSurveyV2={ODB:964};t.EnableExcelSurveyV2LicenseCheck={ODB:968};t.UseOLSQueryForSearch={ODB:890};t.EnableStreamingUpload={ODB:113};t.DisableExcelSurveyV2TeamSite={ODB:928};t.DragAndDropRobotAnimation={ODC:"DragAndDropRobotAnimation",ODB:899};t.UseNewSiteSettings={ODB:794};t.FasterOnePage={ODB:77};t.SpListNext={ODB:556,Fallback:!0};t.SpListInPageSearch={Fallback:!0};t.SpListNextTheming={ODB:761};t.SuiteNavPrefersTenantTheme={ODB:516};t.NewParatureDesignEnabled={ODC:"NewParatureDesignEnabled"};t.UseModernEmbedPanel={ODC:"UseModernEmbedPanel"};t.Hashtags={ODB:581};t.HashtagsUI={ODB:824};t.OversharingMitigations={ODB:722};t.AlbumViewInFiles={ODC:"AlbumViewInFiles"};t.EnableDashlingVideo={ODB:585,ODC:!0};t.ODBNextUserFeedback={ODB:590};t.ODBNextUserFeedbackViaYammer={ODB:591};t.RecursiveUnsharing={ODB:725};t.EmptyMusicFolderGrooveStrings={ODC:"EmptyMusicFolderGrooveStrings"};t.MoveCopyFolderSelectionUX={ODB:727};t.CopyCrossSiteFromODB={ODB:728};t.UseNewDeleteAllApi={ODC:"UseNewDeleteAllApi"};t.CopyCrossSiteFromTeamSite={ODB:730};t.CopyCrossSiteSplitTech={ODB:729};t.MoveCrossSiteFromTeamSite={ODB:731};t.MoveCopyFolderUsePRIME={ODB:783};t.MoveCopyUsePRIMESplitJob={ODB:867};t.EnableGetSharingInformation={ODB:863,ODC:"EnableGetSharingInformation"};t.ItemAnalytics={ODB:308,ODC:"ItemAnalytics"};t.ItemAnalyticsUX={ODB:318,ODC:"ItemAnalyticsUX"};t.AllowVideoDiagnostics={ODB:336,ODC:"AllowVideoDiagnostics"};t.ShowPhotoThumbnailsInMobileDetailsList={ODC:"ShowPhotoThumbnailsInMobileDetailsList"};t.FileMoveSharingHint={ODB:734};t.ShowInfoPaneByDefault=t.Off;t.UseReactDetailsList={ODB:596,ODC:"UseReactDetailsList"};t.UseReactGridList={ODB:823};t.UseReactGridListGroup={ODB:-500};t.UseReactDetailsOneDrive={ODB:30,ODC:"UseReactDetailsList"};t.UseReactDetailsLibrary={ODB:32};t.UseReactLeftNav={ODB:759};t.CreateGroupSiteFromSP={ODB:742};t.CreateSiteAppCache={ODB:825};t.PowerApps={ODB:743};t.EmbeddedPowerApps={ODB:83};t.EmbeddedFlows={ODB:75};t.AuthZenJSTokenEndpoint={ODB:906};t.PowerAppDiscovery={ODB:921};t.ProcessSimple={ODB:744};t.PowerAppsAndAndProcessSimpleTestEnvironment={ODB:751};t.FlowForLibraries={ODB:796};t.ODBFlow={ODB:856};t.UseReactSPOHeader={ODB:706};t.UseBasePageInODB={ODB:801};t.EnablePushChannelAutoRefresh={ODB:818,ODC:"EnablePushChannelAutoRefresh"};t.EnablePushChannelLogging={ODB:819,ODC:"EnablePushChannelLogging"};t.AllowPushChannelLongPolling={ODB:859};t.AllowPushChannelDnsUrls={ODB:857};t.EnablePushChannel={ODB:860,ODC:"EnablePushChannel"};t.OfficeLens={ODC:"EnableOfficeLensCommand"};t.QuotaBundleEnabled={ODC:"QuotaBundleEnabled"};t.ShowFirstRunInLibraries={ODB:756};t.ShowFirstRunInLists={ODB:902};t.AutoAlbumBannerV2Enabled={ODC:"AutoAlbumBannerV2Enabled"};t.SPOAppPrecludeIE9={ODB:757};t.EnableGetItemsPrefetch={ODC:"EnableGetItemsPrefetch"};t.PeopleCards={ODB:804};t.PeopleCardsOnLoki={ODB:805};t.PeopleCardsReactComponent={ODB:809};t.PeopleCardsLinkedInIntegration={ODB:811};t.PeopleCardsImmersiveProfile={ODB:812};t.PeopleCardsLokiDogfood={ODB:813};t.ShareViaOWACompose={ODB:814,ODC:"ShareViaOWACompose"};t.ODBOpenInExplorer={ODB:815};t.UseThumbnailService={ODB:816,OneDrive:!0};t.UseReactContextualMenu={ODB:786};t.ExpandThumbnailSupport={ODB:820};t.GrooveNewProtocol={ODB:35};t.GroupCardPopup={ODB:59};t.EnablePdfCoversionForAllTypes={ODB:826};t.UseNewSharingDialog={ODB:821};t.EnableNeutralFolderColors=t.On;t.ListDataRenderOptionChange={ODB:788,OneDrive:!0};t.EnableEnhancedMobileUpsell={ODC:"EnableEnhancedMobileUpsell"};t.EnablePowerPointWrsPreview={ODB:268,OneDrive:!0};t.EnableWordWrsPreview={ODB:270,OneDrive:!0};t.EnableOneUpExcelPreview={ODB:159,OneDrive:!0};t.EnableWrsPreviewOutsideODB={ODB:872,OneDrive:!0};t.EnableOneUpFbxPreview={ODB:837,ODC:"EnableOneUpFbxPreview",OneDrive:!0};t.SPListEditNav={ODB:793};t.SupportPoundPercent={ODB:54};t.RecycleBinListFooter={ODB:842,ODC:"RecycleBinListFooter"};t.EnableHlsPretranscode={ODB:843};t.PermissionPile={ODB:863,ODC:"EnablePermissionsPile"};t.EnableViewInFolder={ODB:854,ODC:"EnableViewInFolder"};t.UseNewVersionHistory={ODB:717,ODC:"UseNewVersionHistory"};t.EnableMobileUpsellBanner={ODB:893,ODC:"EnableMobileUpsellBanner"};t.EnableLockdownDateTime={ODC:"EnableLockdownDateTime"};t.EnablePremiumMessaging={ODC:"EnablePremiumMessaging"};t.EnableFrozenDialogs={ODC:"EnableFrozenDialogs"};t.SPListNextOnePage={ODB:2};t.WexSitePagePublishing={ODB:932};t.EnableMinBarPremiumMessaging={ODC:"EnableMinBarPremiumMessaging"};t.UseFlashVideoPlayerFromManifest={ODB:!0,ODC:!1,Fallback:!0};t.VisioDrawingCreation={ODB:973};t.UseVroomUpload={ODB:873,ODC:"UseVroomUpload"};t.UseCommitForVroomUpload={ODB:874,ODC:"UseCommitForVroomUpload"};t.FieldCustomizerInListNext={ODB:711};t.CustomActionsInListNext={ODB:714};t.CustomActionsInModernPage={ODB:718};t.CustomFormatter={ODB:97};t.SPListNextColumnHeaderFilter={ODB:10};t.CreateChoiceColumnPanel={ODB:143};t.SyncButtonStringChange={ODB:712};t.VroomSingleFileDownload={ODC:"VroomSingleFileDownload"};t.MsaAutoRefresh={ODC:"MsaAutoRefresh"};t.EnableGuidedTour={ODB:835,ODC:"EnableGuidedTour"};t.EnableVideoSCFCaching={ODB:875,ODC:!1};t.SiteAnalyticsPage={ODB:922};t.SPOFlowIntegration={ODB:25};t.CreateGroupSiteDefaultPrivate={ODB:715};t.RenderLargeListPartialResult={ODB:64};t.FiltersInODB={ODB:876,ODC:!1};t.GroupThrottleSupport={ODB:12};t.ModernTheming={ODB:119};t.ShareV3={ODB:884};t.Enable15GBUpload={ODB:-1,ODC:"SyncEngine15GBFileSize"};t.DecodeShareWithMeUrls={ODB:71};t.UseActivitiesApi={ODB:887};t.ShowGetOneDriveAppsLink={ODB:891};t.RenderMetadataNavigationInFiltersPane={ODB:66};t.LaunchListFormsInPanel={ODB:114};t.PowerAppListForms={ODB:115};t.DownloadNotifications={ODB:885,ODC:"EnableDownloadPushChannelNotifications"};t.EnablePremiumWelcomeMessage={ODC:"EnablePremiumWelcomeMessage"};t.EnablePremiumNewFeaturesLightbox={ODC:"EnablePremiumNewFeaturesLightbox"};t.PremiumV1Features={ODC:"PremiumV1Features"};t.GroupDelete={ODB:116};t.VersionAllFiles={ODC:"VersionAllFiles"};t.SetGroupImage={ODB:117};t.EnableZipFilePreviewing={ODB:209};t.HideFromFiltersPane={ODB:96};t.HelpPanelImprovements={ODC:"HelpPanelImprovements"};t.UseOneUpTextEditor={ODB:894,ODC:"UseOneUpTextEditor",OneDrive:!0};t.ReactClientForm={ODB:895};t.EnableMsaOauthErrorRedirect={ODC:"EnableMsaOauthErrorRedirect"};t.Groupify={ODB:118};t.WebTemplateExtensions={ODB:705};t.RemoveOneUpSlideNavigation={ODB:834,ODC:"RemoveOneUpSlideNavigation",OneDrive:!0};t.UseVroomToGetVersionContent={ODC:"UseVroomToGetVersionContent"};t.PremiumV1PositioningExperiment={ODC:"PremiumV1PositioningExperiment"};t.EnablePhotoPreferencesPage={ODC:"EnablePhotoPreferencesPage"};t.ExposeRestoreVersion={ODC:"ExposeRestoreVersion"};t.VroomRestoreVersionEnabled={ODC:"VroomRestoreVersionEnabled"};t.ForceWrsDFBootstrapper={ODB:-20};t.ODBVroomSharedWithMe={ODB:716};t.WopiJsApiFrame={ODB:55};t.DocAspxForWord={ODB:164};t.DocAspxForPowerpoint={ODB:201};t.DocAspxCreateNewWord={ODB:202};t.CreateColumnPanels={ODB:147};t.UseMicroServiceForSitesLists={ODB:-800};t.EnableEvokeAlignments={ODC:"EnableEvokeAlignments"};t.UnauthenticatedBannerOneUp={ODC:"UnauthenticatedBannerOneUp"};t.OptimizelyEnabled={ODB:803,ODC:"OptimizelyEnabled"};t.FilterPanelTypeAhead={ODB:13};t.DisplayGuestPermittedInfoInModernHeader={ODB:363};t.RenderHierarchyInFiltersPane={ODB:108};t.AllowTryNewFeatureEnabledFeatures=[t.RenderMetadataNavigationInFiltersPane,t.RenderHierarchyInFiltersPane,t.HideFromFiltersPane,t.FilterPanelTypeAhead];t.tryNewFeatureUrlQueryKey="TryNewFeature";t.isTryNewFeatureEnabled=function(e){if(t.AllowTryNewFeatureEnabledFeatures.indexOf(e)>=0){var a=window.location.search;a&&"?"===a.charAt(0)&&(a=a.substr(1));var r=i.deserializeQuery(a),n=r&&r[t.tryNewFeatureUrlQueryKey];return"true"===n||"1"===n}return!1};t.isFeatureEnabled=function(e){return a.default.isFeatureEnabled(e)||t.isTryNewFeatureEnabled(e)}});define("@ms/odsp-utilities/lib/features/FeatureOverrides",["require","exports","./Features","../navigation/AddressParser","../models/store/BaseDataStore","../models/store/DataStoreCachingType"],function(e,t,a,i,r,n){"use strict";t.ENABLE_PARAM_KEY="enableFeatures";t.DISABLE_PARAM_KEY="disableFeatures";var o="Store",s={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},l={ODB:357,ODC:null,Fallback:!1},d={},u=new r.default("FeatureOverrides",n.default.session),c=a.default.isFeatureEnabled(s)||a.default.isFeatureEnabled(l);!function(){var e=u.getValue(o);d=e||{};var a=location.search?location.search.substring(1):"",r=i.deserializeQuery(a),n=r[t.ENABLE_PARAM_KEY];if(n)for(var s=0,l=n.split(",");s<l.length;s++){O=l[s];d[O]=!0}var c=r[t.DISABLE_PARAM_KEY];if(c)for(var p=0,D=c.split(",");p<D.length;p++){var O=D[p];d[O]=!1}u.setValue(o,d)}();var p=function(){function e(){}Object.defineProperty(e,"Overrides",{get:function(){return d},enumerable:!0,configurable:!0});e.isFeatureEnabled=function(e){if(c){if(e.ODB in d)return d[e.ODB];if(e.ODC in d)return d[e.ODC]}return a.default.isFeatureEnabled(e)};return e}();p.AllowFeatureOverrides=s;p.SPODebugOnlyCookieRedirect=l;Object.defineProperty(t,"__esModule",{value:!0});t.default=p});define("@ms/odsp-utilities/lib/features/Features",["require","exports"],function(e,t){"use strict";var a=function(){function e(){}e.initSPExpFeatures=function(t){e._expFeatures=t};e.isFeatureEnabled=function(t){var a=!!t.Fallback,i=window.PageContext,r=window.Flight,n=window.FilesConfig,o=window.Flighting,s=window._spPageContextInfo;if(!e._expFeatures&&s){!s.ExpFeatures&&o&&o.ExpFeatures&&(s.ExpFeatures=o.ExpFeatures);e.initSPExpFeatures(s.ExpFeatures)}var l=t.ODB;if("boolean"==typeof l)a=l;else if(l>0&&e._expFeatures){var d=Math.floor(l/32),u=1<<l%32;a=d<e._expFeatures.length&&0!=(e._expFeatures[d]&u)}t.ODC&&n&&("boolean"==typeof t.ODC?a=t.ODC:r&&r.Ramps&&r.Ramps[t.ODC]?a=!0:n&&n[t.ODC]&&(a=!0));t.OneDrive&&i&&(a=t.OneDrive);return a};return e}();a.On={Fallback:!0};a.Off={};a._expFeatures=null;Object.defineProperty(t,"__esModule",{value:!0});t.default=a});define("@ms/odsp-utilities/lib/navigation/AddressParser",["require","exports"],function(e,t){"use strict";t.deserializeQuery=function(e){var t={};if(e)for(var a=e.split("&"),i=0;i<a.length;i++){var r=a[i].split("=");void 0!==r[1]&&(r[1]=r[1].replace(/\+/g," "));t[r[0]]=decodeURIComponent(r[1])}return t};t.getQueryStringFromUrl=function(e){return e.substring(e.indexOf("?")+1)};t.getUrlWithoutQueryString=function(e){return e.substring(0,e.indexOf("?"))}});define("@ms/odsp-utilities/lib/models/store/BaseDataStore",["require","exports","./DataStoreCachingType"],function(e,t,a){"use strict";var i=function(){function e(t,i){void 0===i&&(i=a.default.none);e.init();this.dataStoreKey=t;this.defaultCachingType=i;if(i===a.default.none)this.dataStore={};else{void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={});this.dataStore=e._dataStore[this.dataStoreKey]}}e.hasStorageType=function(t){e.init();switch(t){case a.default.none:case a.default.sharedMemory:return!0;case a.default.session:return!!e._sessionStorage;case a.default.local:return!!e._localStorage}return!1};e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage);e._initialized=!0}};e.testStorage=function(e){var t="BrowserStorageTest",a=!1;try{e.setItem(t,"1");"1"===e.getItem(t)&&(a=!0);e.removeItem(t)}catch(e){}return a};e.prototype.setValue=function(e,t,a,i){void 0===i&&(i=!0);e=i?this.normalizeKey(e):e;this.dataStore[e]=t;var r=this.getStorage(a);if(r)try{var n=[],o=JSON.stringify(t,function(e,t){if("object"==typeof t&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t});n=null;r.setItem(this.dataStoreKey+e,o)}catch(e){}};e.prototype.getValue=function(e,t,a){void 0===a&&(a=!0);e=a?this.normalizeKey(e):e;var i=this.dataStore[e],r=this.getStorage(t);if(void 0===i&&r){var n=r.getItem(this.dataStoreKey+e);if(n)try{i=JSON.parse(n);this.dataStore[e]=i}catch(e){i=void 0}}return i};e.prototype.remove=function(e,t,a){void 0===a&&(a=!0);e=a?this.normalizeKey(e):e;var i=this.getStorage(t);i&&i.removeItem(this.dataStoreKey+e);delete this.dataStore[e]};e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case a.default.none:case a.default.sharedMemory:return null;case a.default.session:return e._sessionStorage;case a.default.local:return e._localStorage}return null};e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""};return e}();i._sessionStorage=null;i._localStorage=null;i._dataStore={};i._initialized=!1;Object.defineProperty(t,"__esModule",{value:!0});t.default=i});define("@ms/odsp-utilities/lib/models/store/DataStoreCachingType",["require","exports"],function(e,t){"use strict";var a;!function(e){e[e.none=0]="none";e[e.session=1]="session";e[e.local=2]="local";e[e.sharedMemory=3]="sharedMemory"}(a||(a={}));Object.defineProperty(t,"__esModule",{value:!0});t.default=a});define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers",["require","exports","./interfaces/IItemTypeFilter","../../../utilities/caml/CamlParsingBasic","../../../utilities/caml/CamlConstants"],function(e,t,a,i,r){"use strict";function n(e){var t=e.fieldSchema.Name,a=e.fieldSchema.Type,i=e.groupingId;if("DateTime"===a)try{var r=new Date(i);i=r.getUTCFullYear()+"-"+(r.getUTCMonth()+1)+"-"+r.getUTCDate()+"T00:00:00Z"}catch(e){}else"Boolean"===a&&""===i&&(i="-1");return'<Gt><FieldRef Name="'+t+'" /><Value Type="'+a+'">'+i+"</Value></Gt>"}function o(e){for(var t=[],i=[],r=0,n=e.filters;r<n.length;r++){var o=n[r];if("string"==typeof o)i.push('<Value Type="Text">'+o.slice(1)+"</Value>");else switch(o){case a.ItemTypeFilter.folder:t.push('<And><Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq><Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq></And>')}}i.length&&t.push('<In><FieldRef Name="File_x0020_Type" /><Values>'+i.join("")+"</Values></In>");return t.reduce(function(e,t){return e?"<Or>"+e+t+"</Or>":t})}function s(e){var t=e.fieldNames,a=void 0===t?[]:t,i=e.needsSchema,r=e.needsContentTypes,n=e.needsForms,o=e.needsQuickLaunch,s=e.needsSpotlight,l=e.needsViewMetadata,d=e.needsParentInfo,u=e.requestToken,O=e.isListDataRenderOptionChangeFeatureEnabled,f=e.isSpotlightFeatureEnabled,m=e.needUpdatePageContext,g=e.needClientSideComponentManifest,C=0;if(i||u){if(i){C|=c;O&&(C|=4096)}else C|=p;a.indexOf("name.FileSystemItemId")>-1&&(C|=32)}r&&(C|=16);f&&s&&_spPageContextInfo&&_spPageContextInfo.webTemplate&&_spPageContextInfo.webTemplate!==D&&(C|=258);n?C|=64:O&&(C|=4098);o&&(C|=128);l&&(C|=1536);d&&(C|=8192);m&&(C|=16384);g&&(C|=32768);return C}function l(e,t){var a="";e&&(a='<GroupBy Collapse="FALSE"><FieldRef Name="'+e+'"/></GroupBy>');t&&(a="<Query>"+a+"<Where>"+t+"</Where></Query>");return a}function d(e){var t=e.viewParams,a=e.query,i=e.pageSize,r=void 0===i?30:i,n=e.includeFields,o=e.fieldNames,s=void 0===o?[]:o,l=e.userIsAnonymous,d=void 0!==l&&l,c=e.requestMetaInfo,p=void 0!==c&&c;if(n){s=["_ip_UnifiedCompliancePolicyUIAction","ItemChildCount","FolderChildCount","SMTotalFileCount","SMTotalSize"].concat(s);p&&(s=["MediaServiceFastMetadata"].concat(s));d||(s=["SharedWith"].concat(s));s=["FSObjType","LinkFilename","Modified","Editor","FileSizeDisplay"].concat(s)}var D="";(s=u(s)).length&&(D="<ViewFields>"+s.map(function(e){return'<FieldRef Name="'+e+'"/>'}).join("")+"</ViewFields>");return"<View "+t+"><Query>"+a+"</Query>"+D+'<RowLimit Paged="TRUE">'+r+"</RowLimit></View>"}function u(e){var t;if(e){t=[];var a=void 0;a={};for(var i=0,r=e;i<r.length;i++){var n=r[i];if(!a[n]){a[n]=!0;t.push(n)}}}return t}Object.defineProperty(t,"__esModule",{value:!0});var c=7,p=2,D="21",O=new XMLSerializer;t.getAdditionalPostData=function(e,t){var a=e.viewXml,n=e.firstGroupOnly,o=e.expandGroups,d=e.allowMultipleValueFilterForTaxonomyFields,u=e.groupByOverride,c=e.requestDatesInUtc,p=e.groupReplace,D=e.additionalFiltersXml,f=s(e),m=u||D?l(u,D):void 0;if(a&&D)try{var g=i.getViewDomParts(a),C=g.where;if(!C){C=g.xmlDoc.createElement(r.CamlTags.where);g.query.appendChild(C)}C.innerHTML=C.innerHTML?"<And>"+C.innerHTML+D+"</And>":D;a=O.serializeToString(g.view);m=u?l(u,void 0):void 0}catch(e){}var h={__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:f>0?f:void 0,ViewXml:a||void 0,OverrideViewXml:m||void 0,AllowMultipleValueFilterForTaxonomyFields:d||void 0};c&&(h.DatesInUtc=!0);p&&(h.ReplaceGroup=!0);o&&(h.ExpandGroups=!0);n&&(h.FirstGroupOnly=!0);return JSON.stringify({parameters:h})};t.getFilterXmlToFetchNextGroup=n;t.getViewXml=function(e){var t=e.sortField,a=e.itemIds,i=e.isAscending,r=e.pageSize,s=e.fetchNextGroup,l=e.lastGroup,u=e.recurseInFolders,c=e.typeFilter,p=void 0===c?{filters:[]}:c,D=e.fieldNames,O=void 0===D?[]:D,f=e.groupBy,m=void 0===f?[]:f,g=e.userIsAnonymous,C=void 0!==g&&g,h=e.requestMetaInfo,b=void 0!==h&&h,v="",B="",S="",F="",E=!1;r||(r=1);if(s){v='<GroupBy Collapse="FALSE">'+m.map(function(e){return'<FieldRef Name="'+e+'"/>'}).join("")+"</GroupBy>";B="<Where>"+n(l)+"</Where>"}else if(a&&1===a.length){var P=a[0];B=isNaN(Number(P))?'<Where><Eq><FieldRef Name="UniqueId" /><Value Type="Guid">'+P+"</Value></Eq></Where>":'<Where><Eq><FieldRef Name="ID" /><Value Type="Number">'+P+"</Value></Eq></Where>";u&&(F='Scope="RecursiveAll"')}else if(a&&a.length>0){for(var w=[],y=[],A=0,U=a;A<U.length;A++){var I=U[A];isNaN(Number(I))?w.push(I):y.push(I)}var R=y.map(function(e){return'<Value Type="Counter">'+e+"</Value>"}).join(""),T=w.map(function(e){return'<Value Type="Guid">'+e+"</Value>"}).join(""),N="";R&&(N+='<In><FieldRef Name="ID" /><Values>'+R+"</Values></In>");T&&(N+='<In><FieldRef Name="UniqueId" /><Values>'+T+"</Values></In>");R&&T&&(N="<Or>"+N+"</Or>");B="<Where>"+N+"</Where>";u&&(F='Scope="RecursiveAll"')}else{S=t?'<OrderBy><FieldRef Name="'+t+'" Ascending="'+i+'"></FieldRef></OrderBy>':"";E=!0}if(p.filters.length){var x=o(p);x&&(B="<Where>"+x+"</Where>")}return d({viewParams:F,query:S+v+B,pageSize:r,includeFields:E,fieldNames:O,userIsAnonymous:C,requestMetaInfo:b})};t.getTypeFilterViewXml=o});define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/interfaces/IItemTypeFilter",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.any=0]="any";e[e.file=1]="file";e[e.folder=2]="folder";e[e.media=3]="media";e[e.photo=4]="photo";e[e.video=5]="video";e[e.document=6]="document";e[e.audio=7]="audio";e[e.word=8]="word";e[e.powerpoint=9]="powerpoint";e[e.excel=10]="excel";e[e.onenote=11]="onenote";e[e.zip=12]="zip";e[e.pdf=13]="pdf";e[e.text=14]="text"}(t.ItemTypeFilter||(t.ItemTypeFilter={}))});define("@ms/odsp-datasources/lib/utilities/caml/CamlParsingBasic",["require","exports","./CamlConstants","./CamlUtilities"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewDomParts=function(e){void 0===e&&(e="<View/>");var t=i.xmlToDom(e),r=t.documentElement;if(r.tagName!==a.CamlTags.view)throw new Error('View XML outer element tag name must be "View" (case-sensitive)');for(var n,o,s,l=0,d=r.childNodes.length;l<d;l++)(c=r.childNodes[l]).nodeType===Node.ELEMENT_NODE&&(c.tagName!==a.CamlTags.viewFields||n?c.tagName!==a.CamlTags.query||o?c.tagName!==a.CamlTags.rowLimit||s||(s=c):o=c:n=c);if(!n){n=t.createElement(a.CamlTags.viewFields);r.appendChild(n)}if(!o){o=t.createElement(a.CamlTags.query);r.appendChild(o)}for(var u={xmlDoc:t,view:r,query:o,viewFields:n,rowLimit:s},l=0,d=o.childNodes.length;l<d;l++){var c=o.childNodes[l];c.nodeType===Node.ELEMENT_NODE&&(c.tagName!==a.CamlTags.orderBy||u.orderBy?c.tagName!==a.CamlTags.groupBy||u.groupBy?c.tagName!==a.CamlTags.where||u.where||(u.where=c):u.groupBy=c:u.orderBy=c)}return u};t.parseViewFields=function(e){if(e)return Array.prototype.map.call(e.childNodes,function(e){return e.tagName===a.CamlTags.fieldRef?i.getAttr(e,a.CamlAttributes.name):void 0}).filter(function(e){return!!e})};t.containSmartFilters=function(e){var t=!1,a=e.where;if(a&&a.childElementCount){var i=a.querySelectorAll("[id]");i&&i.length&&(t=!0)}return t}});define("@ms/odsp-datasources/lib/utilities/caml/CamlConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CamlTags={view:"View",viewFields:"ViewFields",rowLimit:"RowLimit",query:"Query",orderBy:"OrderBy",groupBy:"GroupBy",where:"Where",and:"And",or:"Or",beginsWith:"BeginsWith",contains:"Contains",dateRangesOverlap:"DateRangesOverlap",eq:"Eq",greater:"Gt",greaterEq:"Geq",includes:"Includes",inTag:"In",isNotNull:"IsNotNull",isNull:"IsNull",less:"Lt",lessEq:"Leq",membership:"Membership",notEq:"Neq",notIncludes:"NotIncludes",fieldRef:"FieldRef",value:"Value",values:"Values",today:"Today"};t.CamlAttributes={name:"Name",collapse:"Collapse",ascending:"Ascending",type:"Type",includeTimeValue:"IncludeTimeValue",paged:"Paged",offset:"Offset",offsetDays:"OffsetDays",lookupId:"LookupId",id:"id"};t.CamlConstants={doctype:"application/xml",fieldNameQuery:'FieldRef[Name="{0}"]',datetimeRegex:/^(\d{4}-\d{2}-\d{2})T\d{2}:\d{2}:\d{2}Z$/,datetimeNoTimeRegex:/^(\d{4}-\d{2}-\d{2})T00:00:00Z$/,dateRegex:/^\d{4}-\d{2}-\d{2}/,todayRegex:/^\[today\]([+-]\d+)?$/i};t.default=t.CamlConstants});define("@ms/odsp-datasources/lib/utilities/caml/CamlUtilities",["require","exports","./CamlConstants"],function(e,t,a){"use strict";function i(e,t){var a=e.attributes[t]||e.attributes[t.toLowerCase()];if(a&&a.value&&a.name===t)return a.value}function r(e,t){var i=e.createElement(a.CamlTags.fieldRef);i.setAttribute(a.CamlAttributes.name,t.fieldName);"boolean"==typeof t.isAscending&&i.setAttribute(a.CamlAttributes.ascending,t.isAscending?"TRUE":"FALSE");return i}function n(e,t,a){"boolean"==typeof a?e.setAttribute(t,a?"TRUE":"FALSE"):e.removeAttribute(t)}Object.defineProperty(t,"__esModule",{value:!0});var o=new DOMParser;t.getAttr=i;t.getFieldRefDom=r;t.updateBooleanAttr=n;t.replaceField=function(e,t,o,s){if(o&&i(o,a.CamlAttributes.name)===t.fieldName)n(o,a.CamlAttributes.ascending,t.isAscending);else{var l=r(e,t);o?s.replaceChild(l,o):s.appendChild(l)}};t.combineFilters=function(e,t){void 0===t&&(t=a.CamlTags.and);return e&&e.length?""+new Array(e.length).join("<"+t+">")+e[0]+e.slice(1).map(function(e){return e+"</"+t+">"}).join(""):""};t.xmlToDom=function(e){var t;try{t=o.parseFromString(e,a.CamlConstants.doctype)}catch(e){throw new Error("Invalid XML (exception thrown)")}if(!t.documentElement)throw new Error("Invalid XML (documentElement does not exist)");if(t.querySelector("parsererror"))throw new Error("Invalid XML (parsererror found)");return t};t.isTodayString=function(e){return a.CamlConstants.todayRegex.test(e)};t.getTodayOffset=function(e){var t=e&&e.match(a.CamlConstants.todayRegex);return t?parseInt(t[1],10)||0:null};t.getTodayString=function(e){var t="[Today]";e&&(t+=(e>0?"+":"")+e);return t}});define("@ms/odsp-utilities/lib/encoding/UriEncoding",["require","exports"],function(e,t){"use strict";var a=function(){function e(){}e.encodeURIComponent=function(e,t,a,i){var r="",n=0;if(!e)return"";var o=e.length;for(n=0;n<o;n++){var s=e.charCodeAt(n),l=e.charAt(n);if(t&&("#"===l||"?"===l)){r+=e.substr(n);break}if(a&&"&"===l)r+=l;else if(s<=127)i?r+=l:s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(l)<0?r+=l:s<=15?r+="%0"+s.toString(16).toUpperCase():s<=127&&(r+="%"+s.toString(16).toUpperCase());else if(s<=2047){r+="%"+(192|s>>6).toString(16).toUpperCase();r+="%"+(128|63&s).toString(16).toUpperCase()}else if(55296!=(64512&s)){r+="%"+(224|s>>12).toString(16).toUpperCase();r+="%"+(128|(4032&s)>>6).toString(16).toUpperCase();r+="%"+(128|63&s).toString(16).toUpperCase()}else if(n<e.length-1){s=(1023&s)<<10;n++;s|=1023&e.charCodeAt(n);r+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase();r+="%"+(128|(258048&s)>>12).toString(16).toUpperCase();r+="%"+(128|(4032&s)>>6).toString(16).toUpperCase();r+="%"+(128|63&s).toString(16).toUpperCase()}}return r};e.escapeUrlForCallback=function(t){var a=t.indexOf("#"),i=t.indexOf("?");if(a>0&&(-1===i||a<i)){var r=t.substr(0,a);i>0&&(r+=t.substr(i));t=r}return e.encodeURIComponent(t,!0,!1,!0)};e.encodeRestUriStringToken=function(t){if(t){t=(t=t.replace(/'/g,"''")).replace(/%27/g,"%27%27");t=e.encodeURIComponent(t)}return t};return e}();Object.defineProperty(t,"__esModule",{value:!0});t.default=a});